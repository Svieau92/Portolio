[
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html",
    "title": "Advanced Data Analysis - Project 2",
    "section": "",
    "text": "The aim of the current study is to assess how treatment response differs for HIV+ patients 2 years after initiating Highly Active Antiretroviral Therapy (HAART) based on hard drug usage (such as heroin or cocaine). This study is of particular scientific interest because it is unclear whether the use of hard drugs inhibits the immune system in humans; treatment strategies may differ based on these results. The researchers are interested in comparing subjects who never used hard drugs to current hard drug users (those that use hard drugs at year 2) or previous hard drug users (those who used drugs at year 0 or 1). Outcomes of interest are: viral load (HIV copies in a mL of blood), CD4+ T cell count (a measure of immunologic health), and aggregate physical and quality of life scores from the SF-36.\nThe clinical hypothesis is that, if hard drugs inhibit the immune system in humans, subjects who currently or previously used hard drugs will have higher viral load and lower CD4+ T cell counts than those who never used hard drugs. Additionally, the researchers are interested in knowing if potential differences between the drug use groups can be explained by differences in adherence to the treatment regimen. The researchers are agnostic on how quality of life changes after treatment, since side effects of the treatment are significant.\nThe project description provided by the PI is available below:"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#labeling-categorical-variables",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#labeling-categorical-variables",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Labeling Categorical Variables",
    "text": "Labeling Categorical Variables\nLet’s factor and label our categorical variables so they are appropriately represented (and not doubles, which will yield incorrect results in models)\n\n# Converting all appropriate variables from doubles to categorical variables\n\ndata$HASHV &lt;- factor(data$HASHV,\n                     levels = c(1, 2),\n                     labels = c(\"No\", \"Yes\"))\n\ndata$HASHF &lt;- factor(data$HASHF,\n                     levels = c(0, 1, 2, 3, 4),\n                     labels = c(\"Never\", \"Daily\", \"Weekly\", \"Monthly\", \"Less Often\"))\n\ndata$income &lt;- factor(data$income,\n                      levels = c(1, 2, 3, 4, 5, 6, 7, 9),\n                      labels = c(\"Less than $10,000\", \"$10,000-$19,999\", \"$20,000-$29,999\", \"$30,000-$39,999\", \"$40,000-$49,999\", \"$50,000-$59,999\", \"$60,000 or more\", \"Do not wish to answer\"))\n\ndata$HBP &lt;- factor(data$HBP,\n                   levels = c(1, 2, 3, 4, 9, -1),\n                   labels = c(\"No\", \"Yes\", \"No, based on data trajectory\", \"Yes, based on data trajectory\", \"Insufficient data, may include reported treatment without diagnosis\", \"Improbable Value\"))\n\ndata$DIAB &lt;- factor(data$DIAB,\n                    levels = c(1, 2, 3, 4, 9),\n                    labels = c(\"No\", \"Yes\", \"No, based on data trajectory\", \"Yes, based on data trajectory\", \"Insufficient data\"))\n                      \ndata$LIV34 &lt;- factor(data$LIV34,\n                     levels = c(1, 2, 9),\n                     labels = c(\"No\", \"Yes\", \"Insufficient Data\"))\n\ndata$KID &lt;- factor(data$KID,\n                   levels = c(1, 2, 3, 4, 9),\n                   labels = c(\"No\", \"Yes\", \"No, based on data trajectory\", \"Yes, based on data trajectory\", \"Insufficient data\"))\n\ndata$FRP &lt;- factor(data$FRP,\n                   levels = c(1,2,9),\n                   labels = c(\"No\", \"Yes\", \"Insufficient Data\"))\n\ndata$FP &lt;- factor(data$FP,\n                  levels = c(1,2,9),\n                  labels = c(\"No\", \"Yes\", \"Insufficient Data\"))\n\ndata$DYSLIP &lt;- factor(data$DYSLIP,\n                      levels = c(1, 2, 3, 4, 9),\n                      labels = c(\"No\", \"Yes\", \"No, based on data trajectory\", \"Yes, based on data trajectory\", \"Insufficient data\"))\n\ndata$SMOKE &lt;- factor(data$SMOKE,\n                     levels = c(1, 2, 3),\n                     labels = c(\"Never Smoked\", \"Former Smoker\", \"Current Smoker\"))\n\ndata$DKGRP &lt;- factor(data$DKGRP,\n                     levels = c(0, 1, 2, 3),\n                     labels = c(\"None\", \"1-3 drinks/week\", \"4-13 drinks/week\", \"&gt;13 drinks/week\"))\n\ndata$HEROPIATE &lt;- factor(data$HEROPIATE,\n                         levels = c(1, 2, -9),\n                         labels = c(\"No\", \"Yes\", \"Not Specified\"))\n\ndata$IDU &lt;- factor(data$IDU,\n                   levels = c(1, 2),\n                   labels = c(\"No\", \"Yes\"))\n\ndata$ADH &lt;- factor(data$ADH,\n                   levels = c(1, 2, 3, 4),\n                   labels = c(\"100%\", \"95-99%\", \"75-94%\", \"&lt;75%\"))\n\ndata$RACE &lt;- factor(data$RACE,\n                    levels = c(1, 2, 3, 4, 5, 6, 7),\n                    labels = c(\"White, non-Hispanic\", \"White, Hispanic\", \"Black, non-Hispanic \", \"Black, Hispanic\",  \"American Indian or Alaskan Native\", \"Asian or Pacific Islander\", \"Other Hispanic\"))\n\ndata$EDUCBAS &lt;- factor(data$EDUCBAS,\n                       levels = c(1, 2, 3, 4, 5, 6, 7),\n                       labels = c(\"8th grade or less \", \"9,10, or 11th grade\", \"12th grade\", \"At least one year college but no degree\", \"Four years college or got degree\", \"Some graduate work\", \"Post-graduate degree\"))\n\ndata$hard_drugs &lt;- factor(data$hard_drugs,\n                          levels = c(0, 1),\n                          labels = c(\"No\", \"Yes\"))\n\n# Create labels for variables to make the names of each variable more professional in outputs\nlabel(data$newid) &lt;- \"ID\"\nlabel(data$AGG_MENT) &lt;- \"Aggregate Mental QOL Score\"\nlabel(data$AGG_PHYS) &lt;- \"Aggregate Physical QOL Score\"\nlabel(data$HASHF) &lt;- \"Hash/Marijuana Use Since Last Visit\"\nlabel(data$HASHV) &lt;- \"Frequency of Hash/Marijuana Use\"\nlabel(data$income) &lt;- \"Income\"\nlabel(data$HBP) &lt;- \"High Blood Pressure\"\nlabel(data$DIAB) &lt;- \"Diabetes\"\nlabel(data$LIV34) &lt;- \"Liver Disease Stage 3/4\"\nlabel(data$KID) &lt;-\"Kidney Disease\"\nlabel(data$FRP) &lt;- \"Frailty Related Phenotype\"\nlabel(data$FP) &lt;- \"Fraily Phenotype\"\nlabel(data$BMI) &lt;- \"BMI\"\nlabel(data$TCHOL) &lt;- \"Total Cholesterol\"\nlabel(data$TRIG) &lt;- \"Triglycerides\"\nlabel(data$LDL) &lt;- \"LDL\"\nlabel(data$DYSLIP) &lt; \"Dyslipidemia\"\nlabel(data$SMOKE) &lt; \"Smoking Status\"\nlabel(data$CESD) &lt;- \"CESD Depression Score\"\nlabel(data$SMOKE) &lt; \"Smoking Status\"\nlabel(data$DKGRP) &lt;- \"Drinking Group\"\nlabel(data$HEROPIATE) &lt;- \"Heroin or Opiate Use Since Last Visit\"\nlabel(data$IDU) &lt;- \"Intravenous Drug Usage Since Last Visit\"\nlabel(data$LEU3N) &lt;- \"CD4+ T Cell Count\"\nlabel(data$VLOAD) &lt;- \"Viral Load\"\nlabel(data$ADH) &lt;- \"Adherence to Treatment Regimen\"\nlabel(data$RACE) &lt;- \"Race\"\nlabel(data$EDUCBAS) &lt;- \"Education at Baseline\"\nlabel(data$hivpos) &lt;- \"HIV Serostatus\"\nlabel(data$age) &lt;- \"Age\"\nlabel(data$ART) &lt;- \"Antiretroviral Therapy\"\nlabel(data$years) &lt;- \"Year of Visit\"\nlabel(data$hard_drugs) &lt;- \"Hard Drug Usage\"\n\nLet’s take another look to check that those variables are no longer doubles.\n\n# Examine data\nglimpse(data)\n\nRows: 3,632\nColumns: 33\n$ newid      &lt;dbl&gt; 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4,…\n$ AGG_MENT   &lt;dbl&gt; 44.90710, 58.20754, 59.65136, 56.80657, 46.34190, 48.71791,…\n$ AGG_PHYS   &lt;dbl&gt; 52.52557, 41.29347, 48.54453, 46.73991, 27.92331, 38.03807,…\n$ HASHV      &lt;fct&gt; No, No, No, No, No, Yes, No, Yes, No, Yes, No, No, Yes, No,…\n$ HASHF      &lt;fct&gt; NA, Less Often, Never, Never, Never, Never, Never, Never, N…\n$ income     &lt;fct&gt; \"$30,000-$39,999\", \"$30,000-$39,999\", \"$30,000-$39,999\", \"$…\n$ BMI        &lt;dbl&gt; 24.71756, 26.06801, 27.16421, 25.71786, 26.66936, 25.96576,…\n$ HBP        &lt;fct&gt; \"No\", \"No\", \"No\", \"No\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", …\n$ DIAB       &lt;fct&gt; \"No\", \"No\", \"No\", \"No\", \"Insufficient data\", \"Insufficient …\n$ LIV34      &lt;fct&gt; No, No, No, No, No, No, No, No, No, No, No, No, No, No, Yes…\n$ KID        &lt;fct&gt; \"No\", \"No\", \"No\", \"No\", \"Insufficient data\", \"Insufficient …\n$ FRP        &lt;fct&gt; No, No, No, No, Yes, No, No, No, No, No, No, No, No, No, No…\n$ FP         &lt;fct&gt; No, No, No, No, Insufficient Data, Insufficient Data, No, N…\n$ TCHOL      &lt;dbl&gt; 133, 131, 180, 171, 125, NA, 134, 105, 141, 153, 170, 170, …\n$ TRIG       &lt;dbl&gt; 176, 107, 233, 139, NA, NA, NA, 104, 162, 127, NA, NA, 82, …\n$ LDL        &lt;dbl&gt; 62, 66, 86, 96, NA, NA, NA, 44, 73, 84, NA, NA, 127, NA, NA…\n$ DYSLIP     &lt;fct&gt; \"Yes\", \"No\", \"Yes\", \"No\", \"Yes\", \"Insufficient data\", \"Yes,…\n$ CESD       &lt;dbl&gt; 14, 2, 1, 18, 20, 18, 18, 21, 23, 17, 18, 22, 23, 14, 1, 1,…\n$ SMOKE      &lt;fct&gt; Current Smoker, Current Smoker, Current Smoker, Current Smo…\n$ DKGRP      &lt;fct&gt; None, &gt;13 drinks/week, None, 1-3 drinks/week, None, &gt;13 dri…\n$ HEROPIATE  &lt;fct&gt; No, No, No, No, No, No, No, No, No, No, No, No, No, No, No,…\n$ IDU        &lt;fct&gt; Yes, No, No, No, Yes, No, No, No, No, No, Yes, Yes, Yes, Ye…\n$ LEU3N      &lt;dbl&gt; 104.1659, 262.0061, 345.4010, 292.3271, 257.8278, 459.4562,…\n$ VLOAD      &lt;dbl&gt; 102013.000000, 27.000000, 60.000000, 9.000000, 8121.000000,…\n$ ADH        &lt;fct&gt; NA, 95-99%, 100%, 100%, NA, 100%, 100%, 100%, 100%, 100%, N…\n$ RACE       &lt;fct&gt; \"White, non-Hispanic\", \"White, non-Hispanic\", \"White, non-H…\n$ EDUCBAS    &lt;fct&gt; \"At least one year college but no degree\", \"At least one ye…\n$ hivpos     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ age        &lt;dbl&gt; 52, 53, 54, 55, 54, 55, 56, 60, 61, 62, 47, 48, 49, 51, 52,…\n$ ART        &lt;dbl&gt; 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1,…\n$ everART    &lt;dbl&gt; 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1,…\n$ years      &lt;dbl&gt; 0, 1, 2, 3, 0, 1, 2, 6, 7, 8, 0, 1, 2, 4, 5, 6, 7, 8, 0, 1,…\n$ hard_drugs &lt;fct&gt; Yes, No, No, No, Yes, No, No, No, No, No, Yes, Yes, Yes, Ye…\n\n\nLooks good."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#filtering-data-set",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#filtering-data-set",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Filtering Data Set",
    "text": "Filtering Data Set\nNow let’s take a look at the header to get a good feeling for our data.\n\n# Pretty print data header\npretty_print(head(data))\n\n\n\n\nnewid\nAGG_MENT\nAGG_PHYS\nHASHV\nHASHF\nincome\nBMI\nHBP\nDIAB\nLIV34\nKID\nFRP\nFP\nTCHOL\nTRIG\nLDL\nDYSLIP\nCESD\nSMOKE\nDKGRP\nHEROPIATE\nIDU\nLEU3N\nVLOAD\nADH\nRACE\nEDUCBAS\nhivpos\nage\nART\neverART\nyears\nhard_drugs\n\n\n\n\n1\n44.90710\n52.52557\nNo\nNA\n$30,000-$39,999\n24.71756\nNo\nNo\nNo\nNo\nNo\nNo\n133\n176\n62\nYes\n14\nCurrent Smoker\nNone\nNo\nYes\n104.1659\n102013\nNA\nWhite, non-Hispanic\nAt least one year college but no degree\n1\n52\n0\n0\n0\nYes\n\n\n1\n58.20754\n41.29346\nNo\nLess Often\n$30,000-$39,999\n26.06801\nNo\nNo\nNo\nNo\nNo\nNo\n131\n107\n66\nNo\n2\nCurrent Smoker\n&gt;13 drinks/week\nNo\nNo\n262.0061\n27\n95-99%\nWhite, non-Hispanic\nAt least one year college but no degree\n1\n53\n1\n1\n1\nNo\n\n\n1\n59.65136\n48.54453\nNo\nNever\n$30,000-$39,999\n27.16421\nNo\nNo\nNo\nNo\nNo\nNo\n180\n233\n86\nYes\n1\nCurrent Smoker\nNone\nNo\nNo\n345.4010\n60\n100%\nWhite, non-Hispanic\nAt least one year college but no degree\n1\n54\n1\n1\n2\nNo\n\n\n1\n56.80657\n46.73991\nNo\nNever\n$40,000-$49,999\n25.71786\nNo\nNo\nNo\nNo\nNo\nNo\n171\n139\n96\nNo\n18\nCurrent Smoker\n1-3 drinks/week\nNo\nNo\n292.3271\n9\n100%\nWhite, non-Hispanic\nAt least one year college but no degree\n1\n55\n1\n1\n3\nNo\n\n\n2\n46.34190\n27.92331\nNo\nNever\n$10,000-$19,999\n26.66936\nYes\nInsufficient data\nNo\nInsufficient data\nYes\nInsufficient Data\n125\nNA\nNA\nYes\n20\nCurrent Smoker\nNone\nNo\nYes\n257.8278\n8121\nNA\nBlack, non-Hispanic\n9,10, or 11th grade\n1\n54\n0\n0\n0\nYes\n\n\n2\n48.71791\n38.03807\nYes\nNever\nLess than $10,000\n25.96576\nYes\nInsufficient data\nNo\nInsufficient data\nNo\nInsufficient Data\nNA\nNA\nNA\nInsufficient data\n18\nCurrent Smoker\n&gt;13 drinks/week\nNo\nNo\n459.4562\n21\n100%\nBlack, non-Hispanic\n9,10, or 11th grade\n1\n55\n1\n1\n1\nNo\n\n\n\n\n\n\n\nHmm, we have 8 years worth of data points, but the experimenters are only interested in the first 2 years.\nOut of curiosity, let’s look at how many participants they had each year.\n\n# Visualize patient drop off over 8 years of study\nbarplot(table(data$years))\n\n\n\n\n\n\n\n# Check number of patients in each year\npretty_print(table(data$years))\n\n\n\n\nVar1\nFreq\n\n\n\n\n0\n550\n\n\n1\n550\n\n\n2\n550\n\n\n3\n414\n\n\n4\n381\n\n\n5\n338\n\n\n6\n325\n\n\n7\n272\n\n\n8\n252\n\n\n\n\n\n\n\nThis is interesting, we don’t seem to have as drastic a drop off as I expected. The researchers managed to retain all participants for the first 2 years, and 50% by the end of the 8-year study.\nLet’s filter to only include values from the first 2 years, as this is the timeframe the researchers are interested in.\n\n# Filter long form data set to be include only first 2 years\ndata_2 &lt;- data[data$years &lt;= 2,]\n\n# Check how many visits we have in the filtered data set.\ndim(data_2)\n\n[1] 1650   33\n\n\nWe went from 3632 visits in the 8 year data set to 1650 in the 2 year filtered data set.\n\n# Double check if any patients dropped out within the first 2 years\nany(is.na(data_2$years))\n\n[1] FALSE\n\n\nLuckily, no patients dropped out within the first 2 years of the study!"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#transpose-to-wideform",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#transpose-to-wideform",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Transpose to Wideform",
    "text": "Transpose to Wideform\nWe can also see that the provided data set is in longform. Let’s convert that to wideform.\n\n# Create new wideform data set for first 2 years of study              \ndata_wide_2 &lt;- pivot_wider(data_2, id_cols = newid, names_from = years, values_from = -c(newid, years))\n\nAnd take a look at the header to check that was done correctly.\n\n# Pretty print header of wideform data\npretty_print(head(data_wide_2))\n\n\n\n\nnewid\nAGG_MENT_0\nAGG_MENT_1\nAGG_MENT_2\nAGG_PHYS_0\nAGG_PHYS_1\nAGG_PHYS_2\nHASHV_0\nHASHV_1\nHASHV_2\nHASHF_0\nHASHF_1\nHASHF_2\nincome_0\nincome_1\nincome_2\nBMI_0\nBMI_1\nBMI_2\nHBP_0\nHBP_1\nHBP_2\nDIAB_0\nDIAB_1\nDIAB_2\nLIV34_0\nLIV34_1\nLIV34_2\nKID_0\nKID_1\nKID_2\nFRP_0\nFRP_1\nFRP_2\nFP_0\nFP_1\nFP_2\nTCHOL_0\nTCHOL_1\nTCHOL_2\nTRIG_0\nTRIG_1\nTRIG_2\nLDL_0\nLDL_1\nLDL_2\nDYSLIP_0\nDYSLIP_1\nDYSLIP_2\nCESD_0\nCESD_1\nCESD_2\nSMOKE_0\nSMOKE_1\nSMOKE_2\nDKGRP_0\nDKGRP_1\nDKGRP_2\nHEROPIATE_0\nHEROPIATE_1\nHEROPIATE_2\nIDU_0\nIDU_1\nIDU_2\nLEU3N_0\nLEU3N_1\nLEU3N_2\nVLOAD_0\nVLOAD_1\nVLOAD_2\nADH_0\nADH_1\nADH_2\nRACE_0\nRACE_1\nRACE_2\nEDUCBAS_0\nEDUCBAS_1\nEDUCBAS_2\nhivpos_0\nhivpos_1\nhivpos_2\nage_0\nage_1\nage_2\nART_0\nART_1\nART_2\neverART_0\neverART_1\neverART_2\nhard_drugs_0\nhard_drugs_1\nhard_drugs_2\n\n\n\n\n1\n44.90710\n58.20754\n59.65136\n52.52557\n41.29346\n48.54453\nNo\nNo\nNo\nNA\nLess Often\nNever\n$30,000-$39,999\n$30,000-$39,999\n$30,000-$39,999\n24.71756\n26.06801\n27.16421\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\n133\n131\n180\n176\n107\n233\n62\n66\n86\nYes\nNo\nYes\n14\n2\n1\nCurrent Smoker\nCurrent Smoker\nCurrent Smoker\nNone\n&gt;13 drinks/week\nNone\nNo\nNo\nNo\nYes\nNo\nNo\n104.1659\n262.0061\n345.4010\n102013.000\n27.00000\n60.00000\nNA\n95-99%\n100%\nWhite, non-Hispanic\nWhite, non-Hispanic\nWhite, non-Hispanic\nAt least one year college but no degree\nAt least one year college but no degree\nAt least one year college but no degree\n1\n1\n1\n52\n53\n54\n0\n1\n1\n0\n1\n1\nYes\nNo\nNo\n\n\n2\n46.34190\n48.71791\n45.41483\n27.92331\n38.03807\n37.32204\nNo\nYes\nNo\nNever\nNever\nNever\n$10,000-$19,999\nLess than $10,000\n$10,000-$19,999\n26.66936\n25.96576\n26.96037\nYes\nYes\nYes\nInsufficient data\nInsufficient data\nInsufficient data\nNo\nNo\nNo\nInsufficient data\nInsufficient data\nInsufficient data\nYes\nNo\nNo\nInsufficient Data\nInsufficient Data\nNo\n125\nNA\n134\nNA\nNA\nNA\nNA\nNA\nNA\nYes\nInsufficient data\nYes, based on data trajectory\n20\n18\n18\nCurrent Smoker\nCurrent Smoker\nCurrent Smoker\nNone\n&gt;13 drinks/week\n4-13 drinks/week\nNo\nNo\nNo\nYes\nNo\nNo\n257.8278\n459.4562\n263.0693\n8121.000\n21.00000\n48.00000\nNA\n100%\n100%\nBlack, non-Hispanic\nBlack, non-Hispanic\nBlack, non-Hispanic\n9,10, or 11th grade\n9,10, or 11th grade\n9,10, or 11th grade\n1\n1\n1\n54\n55\n56\n0\n1\n1\n0\n1\n1\nYes\nNo\nNo\n\n\n3\n40.22337\n44.42011\n41.70079\n60.06970\n62.71705\n58.51450\nNo\nNo\nYes\nLess Often\nLess Often\nLess Often\n$50,000-$59,999\n$50,000-$59,999\n$50,000-$59,999\n28.59085\n28.35320\n28.18510\nInsufficient data, may include reported treatment without diagnosis\nInsufficient data, may include reported treatment without diagnosis\nNo\nInsufficient data\nInsufficient data\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\n170\n170\n180\nNA\nNA\n82\nNA\nNA\n127\nYes\nYes\nYes\n18\n22\n23\nFormer Smoker\nFormer Smoker\nFormer Smoker\nNone\nNone\nNone\nNo\nNo\nNo\nYes\nYes\nYes\n563.1223\n488.9100\n405.1816\n4001.556\n2020.00000\n27.50917\nNA\n100%\n100%\nWhite, non-Hispanic\nWhite, non-Hispanic\nWhite, non-Hispanic\nPost-graduate degree\nPost-graduate degree\nPost-graduate degree\n1\n1\n1\n47\n48\n49\n0\n1\n1\n0\n1\n1\nYes\nYes\nYes\n\n\n4\n42.90638\n31.15971\n52.68223\n50.78850\n44.62883\n51.50533\nYes\nNo\nNo\nLess Often\nWeekly\nNever\nLess than $10,000\nLess than $10,000\nNA\n20.36451\n18.21865\n20.28485\nNo\nNo\nNo\nNo\nNo, based on data trajectory\nNo\nNo\nNo\nNo\nInsufficient data\nInsufficient data\nInsufficient data\nNo\nYes\nNo\nNo\nYes\nNo\n214\n197\n251\n97\nNA\n260\n147\nNA\n152\nYes\nYes, based on data trajectory\nYes\n14\n25\n13\nCurrent Smoker\nCurrent Smoker\nCurrent Smoker\n1-3 drinks/week\n4-13 drinks/week\nNone\nYes\nYes\nNo\nNo\nNo\nNo\n110.4218\n159.6297\n179.6409\n740.000\n26.64732\n27.00000\nNA\n75-94%\n95-99%\nWhite, non-Hispanic\nWhite, non-Hispanic\nWhite, non-Hispanic\nFour years college or got degree\nFour years college or got degree\nFour years college or got degree\n1\n1\n1\n44\n45\n46\n0\n1\n1\n0\n1\n1\nYes\nYes\nNo\n\n\n5\n56.42904\n56.21993\n66.50629\n43.75671\n30.47055\n18.82350\nNo\nNA\nYes\nMonthly\nMonthly\nLess Often\n$50,000-$59,999\n$10,000-$19,999\nDo not wish to answer\n22.26986\n24.97865\n20.80193\nNo\nNo\nNo\nInsufficient data\nInsufficient data\nInsufficient data\nNo\nNo\nInsufficient Data\nInsufficient data\nInsufficient data\nInsufficient data\nNo\nNo\nYes\nInsufficient Data\nInsufficient Data\nYes\n196\n204\nNA\n162\n192\nNA\n135\nNA\nNA\nYes\nInsufficient data\nYes, based on data trajectory\n1\n0\n1\nCurrent Smoker\nCurrent Smoker\nCurrent Smoker\nNone\n1-3 drinks/week\n1-3 drinks/week\nNot Specified\nNA\nNo\nYes\nYes\nYes\n252.6634\n92.6634\n59.6219\n62727.039\n30389.00000\n419.50000\nNA\n100%\n100%\nWhite, non-Hispanic\nWhite, non-Hispanic\nWhite, non-Hispanic\nPost-graduate degree\nPost-graduate degree\nPost-graduate degree\n1\n1\n1\n53\n54\n55\n0\n1\n1\n0\n1\n1\nYes\nYes\nYes\n\n\n6\n59.74437\n53.84956\n50.26010\n56.86261\n57.91396\n55.95668\nNo\nNo\nNo\nNA\nNA\nLess Often\n$30,000-$39,999\n$30,000-$39,999\nNA\n23.22166\n23.75318\n22.41001\nNo\nNo\nNo\nInsufficient data\nInsufficient data\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\n216\n216\n151\nNA\nNA\n125\nNA\nNA\n81\nInsufficient data\nInsufficient data\nNo\n3\n3\n4\nNever Smoked\nNever Smoked\nNever Smoked\n1-3 drinks/week\n1-3 drinks/week\n1-3 drinks/week\nNo\nNo\nNo\nNo\nNo\nYes\n634.1246\n745.6517\n893.4328\n15745.000\n7870.00000\n53.50000\nNA\n95-99%\n95-99%\nWhite, non-Hispanic\nWhite, non-Hispanic\nWhite, non-Hispanic\nSome graduate work\nSome graduate work\nSome graduate work\n1\n1\n1\n36\n37\n38\n0\n1\n1\n0\n1\n1\nNo\nNo\nYes\n\n\n\n\n\n\n\nGood. now we have a long and wide form of the data set for the first two years of the study.\nFinally, let’s just clean that wide data set up a bit to drop repeat measures of variables that are constant over time (race, education at baseline, HIV serostatus, everART)\n\n# Clean up the wide data set a bit by deleting multiple observations across time for constant variables such as race\ndata_wide_2 &lt;- data_wide_2 %&gt;% select(-RACE_1, -RACE_2, -EDUCBAS_1, -EDUCBAS_2, -hivpos_1, - hivpos_2, -everART_1, -everART_2)\n\nNow that our data sets are adequately prepared, we can move on to performing our data checks to ensure fidelity of the data set."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#removing-superfluous-variables",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#removing-superfluous-variables",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Removing Superfluous Variables",
    "text": "Removing Superfluous Variables\nWe previously determined that LDL, TRIG, DIAB, KID, and DYSLIP had excessive missing values (&gt;40%).\nNow that we have seen that they are not strongly related to the outcome variables, we can be assured that we can safely remove them with no need for imputation.\n\n# Drop variables with excessive missing values from the wideform data set\ndata_2 &lt;- data_2 %&gt;%\n  select(-LDL, -TRIG, -DIAB, -KID, -DYSLIP)\n\nFRP and FP are both precision variables for AGG_PHYS, but highly correlated to each other.\nFP has more missing values (22%) than FRP(~0%), and will thus be dropped.\n\n# Drop FP\ndata_2 &lt;- data_2 %&gt;%\n  select(-FP)\n\nEDUCBASE is highly correlated with income, TCHOL, SMOKE, and RACE.\nincome has 27% missing values and thus will be dropped from further analysis.\nTCHOL has 32% missing values and will thus be dropped.\nSMOKE and RACE will be dropped to avoid issues of multicollinearity, and EDUCBASE used as the covariate of choice.\n\n# Drop income, total cholesterol, smoke, and race\ndata_2 &lt;- data_2 %&gt;%\n  select(-income, -TCHOL, -SMOKE, -RACE)\n\nHard_drugs is highly correlated with HEROPIATE and IDU.\nHard_drugs is our main independent variable of interest and thus we drop HEROPIATE and IDU.\n\n# Drop income, total cholesterol, smoke, and race\ndata_2 &lt;- data_2 %&gt;%\n  select(-HEROPIATE, -IDU)\n\nHBP is lightly correlated with age and BMI. Let’s drop it to avoid multicollinearity.\n\n# Drop high blood pressure.\ndata_2 &lt;- data_2 %&gt;%\n  select(-HBP)"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#correlation-matrix-redux",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#correlation-matrix-redux",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Correlation Matrix Redux",
    "text": "Correlation Matrix Redux\nLet’s take another look at that correlation matrix now that we have cleaned up our data set to remove variables with excessive missing values and issues of multicollinearity.\n\n# Let's clean our output by making a trimmed dataset excluding extraneous variables\ndata_for_matrix &lt;- select(data_wide_2, AGG_MENT_CHANGE, AGG_PHYS_CHANGE, LEU3N_CHANGE, VLOAD_log_CHANGE, BMI_2, FRP_2, CESD_2, DKGRP_2, ADH_2, ADH_HIGHVSLOW, EDUC_COLLEGE, age_2, hard_drugs_grp)\n\n# We factored our variables at the start. To make a correlation matrix we must reconvert those back to numeric\ndata_for_matrix &lt;- data.frame(lapply(data_for_matrix, function(x) if (is.factor(x)) as.numeric(x) else x))\n\n# Make a correlation matrix with all variables of the trimmed data set\ncorrelation_matrix &lt;- cor(data_for_matrix, use = \"complete.obs\")\n\n# Plot the matrix\ncorrplot(correlation_matrix, method = \"circle\")\n\n\n\n\n\n\n\n\nLooking MUCH better! Here we can see some potentially strong relationships emerge.\n\nCESD as mentioned will be included as a precision variable for AGG_MENT\nFRP as mentioned will be included as a precision variable for AGG_PHYS\nEDUCBASE looks like it will be a predictor for all outcome variables except AGG_MENT\nBMI appears to have a weak correlation with all outcome variables and will likely be included in the final models.\nage also looks weakly correlated to all outcome variables except VLOAD_log\n\nLet’s run some individual regression and assess these relationships more closely.\np-values of &lt; 0.1 will be considered for the final models."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#log-viral-load-change-1",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#log-viral-load-change-1",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Log Viral Load Change",
    "text": "Log Viral Load Change\n\nFull ModelReduced Model - No InteractionConfoundingVisualizing Main Effects\n\n\nAs determined by interactive variable selection, the variables of interest for a model predicting VLOAD_log_CHANGE are hard_drug_grp, ADH_HIGHVSLOW, and EDUC_COLLEGE.\nThe researchers are interested in if differences in treatment response between the drug use groups can be explained by differences in adherence to the HAART regimen, so we will also include an interaction term between hard drug use group and adherence.\n\nAnalysisModel SelectionInterpretationVisualizing the Interaction\n\n\nLet’s run the regression for the full model.\n\n# Relevel reference group\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel reference group\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform the regression on log viral load change with the full model\nmodel_VLOAD_full1 &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\nlibrary(sjPlot)\n# Examine summary\nsummary(model_VLOAD_full1)\n\n\nCall:\nlm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.2508 -1.6120 -0.2134  1.1308  9.2569 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                              -4.9327     0.5241\nhard_drugs_grpPrevious User                               5.8083     1.1857\nhard_drugs_grpCurrent User                                3.4758     1.4138\nADH_HIGHVSLOWHigh Adherence                              -0.7876     0.4898\nEDUC_COLLEGECollege                                      -0.8489     0.2955\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -5.8479     1.2773\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   -2.7430     1.4659\n                                                        t value\n(Intercept)                                              -9.412\nhard_drugs_grpPrevious User                               4.898\nhard_drugs_grpCurrent User                                2.458\nADH_HIGHVSLOWHigh Adherence                              -1.608\nEDUC_COLLEGECollege                                      -2.872\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -4.578\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   -1.871\n                                                                    Pr(&gt;|t|)\n(Intercept)                                             &lt; 0.0000000000000002\nhard_drugs_grpPrevious User                                       0.00000130\nhard_drugs_grpCurrent User                                           0.01428\nADH_HIGHVSLOWHigh Adherence                                          0.10846\nEDUC_COLLEGECollege                                                  0.00424\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence           0.00000589\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence               0.06189\n                                                           \n(Intercept)                                             ***\nhard_drugs_grpPrevious User                             ***\nhard_drugs_grpCurrent User                              *  \nADH_HIGHVSLOWHigh Adherence                                \nEDUC_COLLEGECollege                                     ** \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.661 on 513 degrees of freedom\n  (30 observations deleted due to missingness)\nMultiple R-squared:  0.1001,    Adjusted R-squared:  0.08956 \nF-statistic:  9.51 on 6 and 513 DF,  p-value: 0.0000000006388\n\ntab_model(model_VLOAD_full1)\n\n\n\n\n\n\n\n\n\n\n \nLog Viral Load Change\nScore\n\n\nPredictors\nEstimates\nCI\np\n\n\n(Intercept)\n-4.93\n-5.96 – -3.90\n&lt;0.001\n\n\nhard_drugs_grp: Previous\nUser\n5.81\n3.48 – 8.14\n&lt;0.001\n\n\nhard_drugs_grp: Current\nUser\n3.48\n0.70 – 6.25\n0.014\n\n\nADH_HIGHVSLOW: High\nAdherence\n-0.79\n-1.75 – 0.17\n0.108\n\n\nCollege Status: College\n-0.85\n-1.43 – -0.27\n0.004\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n-5.85\n-8.36 – -3.34\n&lt;0.001\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n-2.74\n-5.62 – 0.14\n0.062\n\n\nObservations\n520\n\n\nR2 / R2 adjusted\n0.100 / 0.090\n\n\n\n\n\n\n\n\n# Print useful model parameters\nmodel_results(model_VLOAD_full1)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-4.9326626\n0.5240675\n-9.412266\n0.0000000\n0.0000000\n-5.9622450\n-3.9030801\n\n\nhard_drugs_grpPrevious User\n5.8083303\n1.1857389\n4.898490\n0.0000013\n0.0000091\n3.4788288\n8.1378317\n\n\nhard_drugs_grpCurrent User\n3.4757907\n1.4138375\n2.458409\n0.0142848\n0.0999936\n0.6981668\n6.2534145\n\n\nADH_HIGHVSLOWHigh Adherence\n-0.7876174\n0.4898289\n-1.607944\n0.1084627\n0.7592392\n-1.7499349\n0.1747001\n\n\nEDUC_COLLEGECollege\n-0.8489132\n0.2955395\n-2.872418\n0.0042421\n0.0296945\n-1.4295299\n-0.2682965\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n-5.8479420\n1.2773135\n-4.578314\n0.0000059\n0.0000412\n-8.3573508\n-3.3385331\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n-2.7429503\n1.4659004\n-1.871171\n0.0618904\n0.4332325\n-5.6228568\n0.1369561\n\n\n\n\n\n\n# Get the VIFs\nvif_values &lt;- vif(model_VLOAD_full1)\n\nthere are higher-order terms (interactions) in this model\nconsider setting type = 'predictor'; see ?vif\n\npretty_print(vif_values)\n\n\n\n\n\nGVIF\nDf\nGVIF^(1/(2*Df))\n\n\n\n\nhard_drugs_grp\n121.062588\n2\n3.317054\n\n\nADH_HIGHVSLOW\n1.307856\n1\n1.143615\n\n\nEDUC_COLLEGE\n1.090681\n1\n1.044357\n\n\nhard_drugs_grp:ADH_HIGHVSLOW\n125.887538\n2\n3.349621\n\n\n\n\n\n\n\nThe overall model is highly significant (p &lt; 0.000001) and we’re getting some interesting significant relationships. It looks like all of our main variables and interaction term are significant. Multicollinearity for this model is not a concern.\nFor low adherence, previous and current drug users have a higher increase in log viral load change over 2 years compared to never hard drug users (p &gt; 0.05).\nFor never drug users, there is no difference in log viral load over 2 years in those with high adherence compared to those with low adherence (p = 0.11).\nLet’s keep going.\nChange the reference category to high adherence, to compare the impact of hard drug use groups for those with high adherence to the treatment regiment.\n\n# Relevel reference group\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform the regression on log viral load change with the full model\nmodel_VLOAD_full2 &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\n# Examine summary\nsummary(model_VLOAD_full2)\n\n\nCall:\nlm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.2508 -1.6120 -0.2134  1.1308  9.2569 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                            -5.72028    0.27445\nhard_drugs_grpPrevious User                            -0.03961    0.45829\nhard_drugs_grpCurrent User                              0.73284    0.38167\nADH_HIGHVSLOWLow Adherence                              0.78762    0.48983\nEDUC_COLLEGECollege                                    -0.84891    0.29554\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  5.84794    1.27731\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   2.74295    1.46590\n                                                       t value\n(Intercept)                                            -20.843\nhard_drugs_grpPrevious User                             -0.086\nhard_drugs_grpCurrent User                               1.920\nADH_HIGHVSLOWLow Adherence                               1.608\nEDUC_COLLEGECollege                                     -2.872\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   4.578\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence    1.871\n                                                                   Pr(&gt;|t|)    \n(Intercept)                                            &lt; 0.0000000000000002 ***\nhard_drugs_grpPrevious User                                         0.93116    \nhard_drugs_grpCurrent User                                          0.05540 .  \nADH_HIGHVSLOWLow Adherence                                          0.10846    \nEDUC_COLLEGECollege                                                 0.00424 ** \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence           0.00000589 ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence               0.06189 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.661 on 513 degrees of freedom\n  (30 observations deleted due to missingness)\nMultiple R-squared:  0.1001,    Adjusted R-squared:  0.08956 \nF-statistic:  9.51 on 6 and 513 DF,  p-value: 0.0000000006388\n\n\n\n# Print useful model parameters\nmodel_results(model_VLOAD_full2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-5.7202799\n0.2744497\n-20.8427262\n0.0000000\n0.0000000\n-6.2594636\n-5.1810963\n\n\nhard_drugs_grpPrevious User\n-0.0396117\n0.4582879\n-0.0864341\n0.9311551\n1.0000000\n-0.9399637\n0.8607403\n\n\nhard_drugs_grpCurrent User\n0.7328404\n0.3816725\n1.9200766\n0.0554024\n0.3878167\n-0.0169930\n1.4826737\n\n\nADH_HIGHVSLOWLow Adherence\n0.7876174\n0.4898289\n1.6079437\n0.1084627\n0.7592392\n-0.1747001\n1.7499349\n\n\nEDUC_COLLEGECollege\n-0.8489132\n0.2955395\n-2.8724184\n0.0042421\n0.0296945\n-1.4295299\n-0.2682965\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence\n5.8479420\n1.2773135\n4.5783138\n0.0000059\n0.0000412\n3.3385331\n8.3573508\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence\n2.7429503\n1.4659004\n1.8711710\n0.0618904\n0.4332325\n-0.1369561\n5.6228568\n\n\n\n\n\n\n\nAt the high adherence levels, there is no difference between previous and current hard drug users and never hard drug users on log viral load change (p &gt; 0.05).\nChange the reference categories to previous users and low adherence to compare the impact of hard drug use groups for those with low adherence to the treatment regiment.\n\n# Relevel reference group\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel reference group\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform the regression on log viral load change with the full model\nmodel_VLOAD_full3 &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\n\n# Examine summary\nsummary(model_VLOAD_full3)\n\n\nCall:\nlm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.2508 -1.6120 -0.2134  1.1308  9.2569 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                              0.8757     1.1260\nhard_drugs_grpNever User                                -5.8083     1.1857\nhard_drugs_grpCurrent User                              -2.3325     1.7242\nADH_HIGHVSLOWHigh Adherence                             -6.6356     1.1785\nEDUC_COLLEGECollege                                     -0.8489     0.2955\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     5.8479     1.2773\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   3.1050     1.8278\n                                                       t value     Pr(&gt;|t|)    \n(Intercept)                                              0.778      0.43710    \nhard_drugs_grpNever User                                -4.898 0.0000012967 ***\nhard_drugs_grpCurrent User                              -1.353      0.17672    \nADH_HIGHVSLOWHigh Adherence                             -5.630 0.0000000297 ***\nEDUC_COLLEGECollege                                     -2.872      0.00424 ** \nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     4.578 0.0000058885 ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   1.699      0.08997 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.661 on 513 degrees of freedom\n  (30 observations deleted due to missingness)\nMultiple R-squared:  0.1001,    Adjusted R-squared:  0.08956 \nF-statistic:  9.51 on 6 and 513 DF,  p-value: 0.0000000006388\n\n# Print useful model parameters\nmodel_results(model_VLOAD_full3)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n0.8756677\n1.1259682\n0.777702\n0.4371032\n1.0000000\n-1.3364083\n3.0877438\n\n\nhard_drugs_grpNever User\n-5.8083303\n1.1857389\n-4.898490\n0.0000013\n0.0000091\n-8.1378317\n-3.4788288\n\n\nhard_drugs_grpCurrent User\n-2.3325396\n1.7242354\n-1.352796\n0.1767166\n1.0000000\n-5.7199709\n1.0548917\n\n\nADH_HIGHVSLOWHigh Adherence\n-6.6355594\n1.1785472\n-5.630287\n0.0000000\n0.0000002\n-8.9509321\n-4.3201866\n\n\nEDUC_COLLEGECollege\n-0.8489132\n0.2955395\n-2.872418\n0.0042421\n0.0296945\n-1.4295299\n-0.2682965\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence\n5.8479420\n1.2773135\n4.578314\n0.0000059\n0.0000412\n3.3385331\n8.3573508\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n3.1049916\n1.8277854\n1.698773\n0.0899684\n0.6297785\n-0.4858737\n6.6958570\n\n\n\n\n\n\n\nAt low adherence, there is a significant difference between previous and current drug users, with current drug users having a higher increase in log viral load over 2 years (p &lt; 0.0001).\nFor previous drug users, those with high adherence had less of an increase in log viral load over 2 years compared to those with low adherence (p &lt; 0.0001).\nChange the reference group to previous drug users and high adherence.\n\n# Relevel reference group\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel reference group\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform the regression on log viral load change with the full model\nmodel_VLOAD_full4 &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\n# Examine summary\nsummary(model_VLOAD_full4)\n\n\nCall:\nlm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.2508 -1.6120 -0.2134  1.1308  9.2569 \n\nCoefficients:\n                                                      Estimate Std. Error\n(Intercept)                                           -5.75989    0.43709\nhard_drugs_grpNever User                               0.03961    0.45829\nhard_drugs_grpCurrent User                             0.77245    0.56988\nADH_HIGHVSLOWLow Adherence                             6.63556    1.17855\nEDUC_COLLEGECollege                                   -0.84891    0.29554\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence   -5.84794    1.27731\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence -3.10499    1.82779\n                                                      t value\n(Intercept)                                           -13.178\nhard_drugs_grpNever User                                0.086\nhard_drugs_grpCurrent User                              1.355\nADH_HIGHVSLOWLow Adherence                              5.630\nEDUC_COLLEGECollege                                    -2.872\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    -4.578\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence  -1.699\n                                                                  Pr(&gt;|t|)    \n(Intercept)                                           &lt; 0.0000000000000002 ***\nhard_drugs_grpNever User                                           0.93116    \nhard_drugs_grpCurrent User                                         0.17587    \nADH_HIGHVSLOWLow Adherence                                    0.0000000297 ***\nEDUC_COLLEGECollege                                                0.00424 ** \nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence           0.0000058885 ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence              0.08997 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.661 on 513 degrees of freedom\n  (30 observations deleted due to missingness)\nMultiple R-squared:  0.1001,    Adjusted R-squared:  0.08956 \nF-statistic:  9.51 on 6 and 513 DF,  p-value: 0.0000000006388\n\n\n\n# Print useful model parameters\nmodel_results(model_VLOAD_full4)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-5.7598916\n0.4370859\n-13.1779394\n0.0000000\n0.0000000\n-6.6185902\n-4.9011931\n\n\nhard_drugs_grpNever User\n0.0396117\n0.4582879\n0.0864341\n0.9311551\n1.0000000\n-0.8607403\n0.9399637\n\n\nhard_drugs_grpCurrent User\n0.7724521\n0.5698803\n1.3554637\n0.1758663\n1.0000000\n-0.3471342\n1.8920383\n\n\nADH_HIGHVSLOWLow Adherence\n6.6355594\n1.1785472\n5.6302871\n0.0000000\n0.0000002\n4.3201866\n8.9509321\n\n\nEDUC_COLLEGECollege\n-0.8489132\n0.2955395\n-2.8724184\n0.0042421\n0.0296945\n-1.4295299\n-0.2682965\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence\n-5.8479420\n1.2773135\n-4.5783138\n0.0000059\n0.0000412\n-8.3573508\n-3.3385331\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence\n-3.1049916\n1.8277854\n-1.6987726\n0.0899684\n0.6297785\n-6.6958570\n0.4858737\n\n\n\n\n\n\n\nAt the high adherence level, there is no difference in log viral load change between current and previous hard drug users (p &gt; 0.05).\nChange the reference categories to current users and low adherence to compare the impact of hard drug use groups for those with low adherence to the treatment regiment.\n\n# Relevel reference group\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel reference group\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform the regression on log viral load change with the full model\nmodel_VLOAD_full5 &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\n# Examine summary\nsummary(model_VLOAD_full5)\n\n\nCall:\nlm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.2508 -1.6120 -0.2134  1.1308  9.2569 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                              -1.4569     1.3389\nhard_drugs_grpPrevious User                               2.3325     1.7242\nhard_drugs_grpNever User                                 -3.4758     1.4138\nADH_HIGHVSLOWHigh Adherence                              -3.5306     1.3823\nEDUC_COLLEGECollege                                      -0.8489     0.2955\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -3.1050     1.8278\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      2.7430     1.4659\n                                                        t value Pr(&gt;|t|)   \n(Intercept)                                              -1.088  0.27704   \nhard_drugs_grpPrevious User                               1.353  0.17672   \nhard_drugs_grpNever User                                 -2.458  0.01428 * \nADH_HIGHVSLOWHigh Adherence                              -2.554  0.01093 * \nEDUC_COLLEGECollege                                      -2.872  0.00424 **\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -1.699  0.08997 . \nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      1.871  0.06189 . \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.661 on 513 degrees of freedom\n  (30 observations deleted due to missingness)\nMultiple R-squared:  0.1001,    Adjusted R-squared:  0.08956 \nF-statistic:  9.51 on 6 and 513 DF,  p-value: 0.0000000006388\n\n\nFor current hard drug users, those with high adherence have a lower increase in log viral load over 2 years compared to those with low adherence (p = 0.011).\nTop of Tabset\n\n\nWe can see that all variables, including EDUC_COLLEGE, are significant, and thus there is no need to compare the full model to reduced models; this is our final model for VLOAD_log_CHANGE\nWe can double check this with a partial F-test comparing the full model with the reduced model without the interaction term\n\n# Perform full model with interaction term\nmodel_log_VLOAD_full &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + EDUC_COLLEGE + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Perform reduced model without interaction term\nmodel_log_VLOAD_red &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\n# Perform F-Test\nanova(model_log_VLOAD_red, model_log_VLOAD_full)\n\nAnalysis of Variance Table\n\nModel 1: VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + EDUC_COLLEGE\nModel 2: VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + EDUC_COLLEGE + \n    hard_drugs_grp * ADH_HIGHVSLOW\n  Res.Df    RSS Df Sum of Sq      F     Pr(&gt;F)    \n1    515 3794.7                                   \n2    513 3633.5  2    161.24 11.382 0.00001456 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nThe p-value is significant (p &lt; 0.0001), indicating that the interaction term adds explanatory power to the model and should be included. Thus we move on with interpreting the interaction.\nTop of Tabset\n\n\n\nOverall Model\nThere were significant differences in change in log viral load based on hard drug usage and adherence to the treatment regiment, while controlling for education at baseline (F~(6, 513)~= 9.51), p &lt; 0.0001).\n\n\nHard Drug Use\nThe relationship between hard drug use and change in log viral load over 2 years depended on adherence to the treatment regiment.\n\nHard Drug Use at Low Adherence\nFor those with low adherence to the treatment regiment, current hard drug users had a change in log viral load that was 3.48 log copies/mL (or change in copies/mL that was 32.32 times) higher than never hard drug users (t = 2.458, p-adjusted = 0.04284, 95% CI: 0.70 to 6.25 log copies/mL, or 2.01 to 519.78 times copies/mL). Additionally, for those with low adherence to the treatment regimen, previous hard drug users had a change in log viral load that was 5.81 log copies/mL (or change in copies/mL that was 333.05 times) greater than never hard drug users (t = 4.90, p-adjusted &lt; 0.0001, 95% CI: 3.48 to 8.14 log copies/mL, or 32.42 to 3421.49 times copies/mL).\nFor those with low adherence to the treatment regiment, the difference between previous and current drug users was not statistically significant (t = -1.35, p-adjusted = 0.177, 95% CI: -5.72 to 1.05 log copies/mL, or 0.0033 to 2.87 times copies/mL).\n\n\nHard Drug use at High Adherence\nFor those with high adherence to the protocol, there was no difference in log viral load between current and never hard drug users (t = 1.920, p-adjusted = 0.388, 95% CI: -0.017 to 1.48 log copies/mL), previous and never hard drug users (t = -0.086, p-adjusted = 1.00, 95% CI: -0.86 to 0.94 log copies/mL), or previous and current hard drug users (t = 1.355, p-adjusted = 1.00, 95% CI: -0.35 to 1.89 log copies/mL).\n\n\n\nAdherence\nThe relationship between adherence to the treatment regiment and change in log viral load over 2 years differed by hard drug use.\n\nAdherence for Current Hard Drug Users\nFor current hard drug users, those with high adherence had a change in log viral load that was 3.53 log copies/mL (or 0.029 times) less than that of those with low adherence (t = -2.554, p-adjusted = 0.0999936, 95% CI: -6.25 to -0.70 log copies/mL, or 0.0019 to 0.50 times). However, this relationship was not statistically significant following Bonferroni correction, likely due to the small number of patients who were hard drug users with low protocol adherence (n = 4). This relationship however does appear to be real based on trends in the data, and we recommend increasing the sample size to discover the true differences.\n\n\nAdherence for Previous Hard Drug Users\nFor previous hard drug users, those with high adherence had a change in log viral load that was 6.64 log copies/mL less (or 0.0013 times) than those with low adherence (t = -5.63, p-adjusted &lt; 0.0001, 95% CI: -8.95 to -4.32 log copies/mL, or 0.00013 to 0.013 times).\n\n\nAdherence for Never Hard Drug Users\nFor never hard drug users, the difference in log viral load between those with high adherence and low adherence was not statistically significant (t = -1.61, p-adusted = 0.759, 95% CI: -1.75 to 0.17 log copies/mL, or 0.17 to 1.19 times).\n\n\n\nAdditional Interaction Comparisons\nThere are additional comparisons we can make in the interaction between hard drug usage and adherence, but they are of little clinical relevance (e.g. current hard drug users with low adherence had a higher viral load compared to never hard drug users with high adherence). Basically, any comparison made between a current or previous hard drug user with low adherence was significant.\n\n\nCollege Education at Baseline\nEducation at baseline is a significant predictor for change in log viral load over 2 years, while controlling for hard drug use and adherence to treatment regiment (t = -2.872, p = 0.00424). On average, those with a college education had an 0.85 log copies/mL (or 2.34 times) greater decrease in log viral load than those without a college education (95% CI:-1.43 to -0.27 log copies/mL).\nTop of Tabset\n\n\n\nThe interaction between hard drug use and adherence group on log viral load can be visualized in the graph below.\n\n# Relevel reference group\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel reference group\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform a regression of the full model predicting log viral load change\nmodel_VLOAD_full &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\n# Use interactions package to plot interaction\ncat_plot(\n  model_VLOAD_full, \n  pred = hard_drugs_grp, \n  modx = ADH_HIGHVSLOW, \n  geom = \"line\", \n  colors = \"Pastel2\",\n  x.label = \"Hard Drugs Group\",\n  y.label = \"Predicted Log Viral Load Change\"\n)\n\n\n\n\n\n\n\n\nThis very clearly illustrates the relationships we saw in our model.\nWe can see the relationship between adherence and change in log viral load based on hard drug use: for previous and current hard drug users, those with high adherence had a reduced viral load compared to those with low adherence.\nSimilarly, we can see the relationship between hard drug use and change in log viral load based on adherence: For those with low adherence, previous and current drug users had a higher viral load compared to those with high adherence.\nInterestingly, viral load did not seem to differ for never users based on adherence, suggesting that the ART treatment is most important for those with current or previous hard drug use history.\nImportantly however, this plot is not replicated exactly when I recreate it in ggplot2.\n\n# Filter out NA values\ndata_no_na &lt;- data_wide_2 %&gt;% filter(!is.na(ADH_HIGHVSLOW))\n\n# Summarize the data (using mean as an example)\ndata_summary &lt;- data_no_na %&gt;%\n  group_by(hard_drugs_grp, ADH_HIGHVSLOW) %&gt;%\n  summarize(mean_VLOAD_log_CHANGE = mean(VLOAD_log_CHANGE, na.rm = TRUE))\n\n`summarise()` has grouped output by 'hard_drugs_grp'. You can override using\nthe `.groups` argument.\n\n# Create the plot with lines\nggplot(data_no_na, aes(x = hard_drugs_grp, y = VLOAD_log_CHANGE, fill = ADH_HIGHVSLOW)) +\n  geom_boxplot(alpha = 0.5) +\n  scale_fill_brewer(palette = \"Pastel2\") +\n  labs(title = \"Interaction between Hard Drugs and Adherence on Log Viral Load Change\",\n       x = \"Hard Drugs Group\",\n       y = \"Log Viral Load Change\") +\n  guides(fill = guide_legend(title = \"Adherence Group\")) +\n   theme_minimal() \n\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nWe can see that the boxplot for low adherence previous users (n = 4), and low adherence hard drug users (n = 6) are either really tiny or really large, respectively. This makes sense, because the sample size for both of those categories is so small.\n\n# Create table of hard drugs group by adherence group\npretty_print(table(data_wide_2$hard_drugs_grp, data_wide_2$ADH_HIGHVSLOW))\n\n\n\n\n\nLow Adherence\nHigh Adherence\n\n\n\n\nNever User\n33\n399\n\n\nCurrent User\n4\n56\n\n\nPrevious User\n6\n40\n\n\n\n\n\n\n\nAnd let’s examine how close those 4 values all are to each other.\n\ndata_wide_2 %&gt;%\n  filter(hard_drugs_grp == \"Current User\" & ADH_HIGHVSLOW == \"Low Adherence\") %&gt;%\n  select(newid, VLOAD_log_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW)\n\n# A tibble: 4 × 4\n  newid VLOAD_log_CHANGE hard_drugs_grp ADH_HIGHVSLOW\n  &lt;dbl&gt;            &lt;dbl&gt; &lt;fct&gt;          &lt;fct&gt;        \n1    11             1.21 Current User   Low Adherence\n2    15            -4.96 Current User   Low Adherence\n3   319             1.21 Current User   Low Adherence\n4   356            -4.99 Current User   Low Adherence\n\n\n\ndata_wide_2 %&gt;%\n  filter(hard_drugs_grp == \"Previous User\" & ADH_HIGHVSLOW == \"Low Adherence\") %&gt;%\n  select(newid, VLOAD_log_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW)\n\n# A tibble: 6 × 4\n  newid VLOAD_log_CHANGE hard_drugs_grp ADH_HIGHVSLOW\n  &lt;dbl&gt;            &lt;dbl&gt; &lt;fct&gt;          &lt;fct&gt;        \n1    20           0.0114 Previous User  Low Adherence\n2    36           0.0330 Previous User  Low Adherence\n3    52           0.0335 Previous User  Low Adherence\n4   425           0.0123 Previous User  Low Adherence\n5   504           0.0349 Previous User  Low Adherence\n6   547           0.0354 Previous User  Low Adherence\n\n\nThe values for current users with low adherence have low variance, explaining the tiny boxplot, and the values for previous users with low adherence have high variance, explaining the larger boxplot.\nSo I guess that’s just a testament to the fact that you can’t rely on packages!\n\n\n\n\n\n\nNote\n\n\n\nThis is a very important limitation that will need to be addressed in the discussion!!\nWhile we see this interaction between hard drug use and adherence on the outcome variables in the data, more data must be collected to get a minimum of 30 patients per group and the analyses re-run to confirm these relationships hold!!\n\n\nTop of Tabset\n\n\n\n\n\n\nAnalysisInterpretationComparisons\n\n\nUnderstanding the limitations of an interaction model with only n=4 or n=6 in some categories, we chose to also run the model without the interaction term to acquire the main effects of hard drug use group and adherence on log viral load change, while controlling for baseline education.\n\n# Relevel reference group\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Perform a regression on log viral load change without interaction term\nmodel_VLOAD_red1 &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\n# Examine summary\nsummary(model_VLOAD_red1)\n\n\nCall:\nlm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    EDUC_COLLEGE, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.7941 -1.7418 -0.2149  1.2043  9.3073 \n\nCoefficients:\n                            Estimate Std. Error t value             Pr(&gt;|t|)\n(Intercept)                  -4.0871     0.4910  -8.324 0.000000000000000771\nhard_drugs_grpCurrent User    0.9170     0.3755   2.442               0.0149\nhard_drugs_grpPrevious User   0.7190     0.4336   1.658               0.0978\nADH_HIGHVSLOWHigh Adherence  -1.8429     0.4377  -4.211 0.000030041916341915\nEDUC_COLLEGECollege          -0.6897     0.2970  -2.322               0.0206\n                               \n(Intercept)                 ***\nhard_drugs_grpCurrent User  *  \nhard_drugs_grpPrevious User .  \nADH_HIGHVSLOWHigh Adherence ***\nEDUC_COLLEGECollege         *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.714 on 515 degrees of freedom\n  (30 observations deleted due to missingness)\nMultiple R-squared:  0.06016,   Adjusted R-squared:  0.05286 \nF-statistic: 8.241 on 4 and 515 DF,  p-value: 0.000001901\n\n\n\n# Print useful model parameters\nmodel_results(model_VLOAD_red1)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-4.0870510\n0.4910084\n-8.323790\n0.0000000\n0.0000000\n-5.0516769\n-3.1224251\n\n\nhard_drugs_grpCurrent User\n0.9169947\n0.3754605\n2.442320\n0.0149284\n0.0746420\n0.1793722\n1.6546172\n\n\nhard_drugs_grpPrevious User\n0.7190166\n0.4335575\n1.658411\n0.0978434\n0.4892169\n-0.1327422\n1.5707754\n\n\nADH_HIGHVSLOWHigh Adherence\n-1.8428916\n0.4376635\n-4.210750\n0.0000300\n0.0001502\n-2.7027170\n-0.9830663\n\n\nEDUC_COLLEGECollege\n-0.6896592\n0.2969844\n-2.322207\n0.0206108\n0.1030539\n-1.2731090\n-0.1062094\n\n\n\n\n\n\n\n\n# Relevel reference group\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Perform a regression on log viral load change without interaction term\nmodel_VLOAD_red2 &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\n# Examine summary\nsummary(model_VLOAD_red2)\n\n\nCall:\nlm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    EDUC_COLLEGE, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.7941 -1.7418 -0.2149  1.2043  9.3073 \n\nCoefficients:\n                            Estimate Std. Error t value      Pr(&gt;|t|)    \n(Intercept)                  -3.3680     0.5718  -5.890 0.00000000697 ***\nhard_drugs_grpNever User     -0.7190     0.4336  -1.658        0.0978 .  \nhard_drugs_grpCurrent User    0.1980     0.5451   0.363        0.7166    \nADH_HIGHVSLOWHigh Adherence  -1.8429     0.4377  -4.211 0.00003004192 ***\nEDUC_COLLEGECollege          -0.6897     0.2970  -2.322        0.0206 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.714 on 515 degrees of freedom\n  (30 observations deleted due to missingness)\nMultiple R-squared:  0.06016,   Adjusted R-squared:  0.05286 \nF-statistic: 8.241 on 4 and 515 DF,  p-value: 0.000001901\n\n\n\n# Print useful model parameters\nmodel_results(model_VLOAD_red2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-3.3680344\n0.5718018\n-5.8902135\n0.0000000\n0.0000000\n-4.4913853\n-2.2446835\n\n\nhard_drugs_grpNever User\n-0.7190166\n0.4335575\n-1.6584112\n0.0978434\n0.4892169\n-1.5707754\n0.1327422\n\n\nhard_drugs_grpCurrent User\n0.1979781\n0.5451391\n0.3631698\n0.7166270\n1.0000000\n-0.8729918\n1.2689479\n\n\nADH_HIGHVSLOWHigh Adherence\n-1.8428916\n0.4376635\n-4.2107503\n0.0000300\n0.0001502\n-2.7027170\n-0.9830663\n\n\nEDUC_COLLEGECollege\n-0.6896592\n0.2969844\n-2.3222073\n0.0206108\n0.1030539\n-1.2731090\n-0.1062094\n\n\n\n\n\n\n\nThe overall model is significant (F(~4, 515)~= 8.241, p &lt; 0.0001).\nTop of Tabset\n\n\n\nHard Drug Use\nHard drug use is a significant predictor of log viral load change, while controlling for adherence to the treatment regiment and college education. Specifically, current hard drug users had a change in log viral load that was 0.92 log copies/mL (or 2.50 times) greater than never hard drug users (t = 2.442, p-adjusted = 0.0447, 95% CI: 0.18 to 1.65 log copies/mL, or 1.20 to 5.23 times). There was no difference between previous and current hard drug users in change in log viral load over 2 years (t = 0.363, p-adjusted = 1.00, 95% CI: -0.87 to 1.27 log copies/mL, or 0.42 to 4.81 times).\n\n\nAdherence\nAdherence to the treatment regiment is a significant predictor of change in log viral load, while controlling for hard drug usage and college education (t = -4.21, p &lt; 0.0001). Specifically, those with high adherence to the protocol had an average change in log viral load that was 1.84 log copies/mL (or 0.16 times) less than those with low adherence to the protocol.\n\n\nCollege Education at Baseline\nFinally, college education is a significant predictor of log viral load change, while controlling for hard drug usage and adherence to the treatment regiment (t = -2.32, p = 0.0206). On average, those with a college education had a change in log viral load that was 0.69 log copies/mL (or 1.99 times) less than those without a college education (95% CI: -2.70 to -0.98 log copies/mL, or 0.067 to 0.37 times).\nTop of Tabset\n\n\n\nThe reduced model without the interaction has an adjusted R-squared of 0.0529, compared to the full model with the interaction term (R^2-adjusted = 0.090).\nTherefore, dropping the interaction term causes us to lose explanation of 3.71% of the variance in log viral load change, but is also more statistically sound since we no longer have small sample size issues.\nTop of Tabset\n\n\n\n\n\nUnder the classical definition of a confounder, a variable Z is a confounder if:\n\n\nIt is associated with outcome Y\n\n\nIt is associated with PEV X\n\n\nIt is not on the causal pathway (not a mediator)\n\n\nWe know that ADH_HIGHVSLOW is a predictor of VLOAD_log_CHANGE.\nTo assess if ADH_HIGHVSLOW is associated with hard drug use group, we can run a Fisher’s test\n\n# Create a contingency table\ncontingency_table &lt;- table(data_wide_2$hard_drugs_grp, data_wide_2$ADH_HIGHVSLOW)\n\n# We have to run Fisher's Exact test since we have fewer than 5 observations in some categories\nfisher_test &lt;- fisher.test(contingency_table)\n\nfisher_test\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  contingency_table\np-value = 0.4168\nalternative hypothesis: two.sided\n\n\n\n# Create a contingency table\ncontingency_table &lt;- table(data_wide_2$hard_drugs_grp, data_wide_2$EDUC_COLLEGE)\n\n# We have to run Fisher's Exact test since we have fewer than 5 observations in some categories\nfisher_test &lt;- fisher.test(contingency_table)\n\nThey are not associated.\nHowever, it is not necessary for this associaton to be statistically significant for there to be important confounding present.\nWhen we ran drug_use_grp by itself as a predictor on log viral load, the overall model was significant, but after correcting for multiple pairwise comparisons, none of the between-group comparisons was significant (p &gt; 0.05).\nHowever, after including ADH_HIGHVSLOW in the model, the current vs never drug use comparison is significant, even after performing a Bonferroni correction (p-adjusted = 0.0447). In the model without ADH, this same comparison was p-adjusted = 0.1377.\nThus, ADH_HIGHVSLOW is associated with the outcome variable, and changes the relationship between the PEV and outcome variable in a meaningful way when included in the model (changes it from not significant to significant), meeting the definition of a confounder under the classical definition. However, the beta coefficient of the PEV does not change by &gt; 20%, not satisfying the operational definition of a confounder.\nAdherence to the treatment regiment is therefore a maverick variable!\nTop of Tabset\n\n\nHere we will create some simple plots to help with visualizing the main effects of hard drug use and adherence on log viral load change.\n\n# Create boxplots of log viral load change by hard drug use group\nggplot(data_wide_2, aes(x = hard_drugs_grp, y = VLOAD_log_CHANGE, fill = hard_drugs_grp)) +\n  geom_boxplot(alpha = 0.5) +\n  theme_minimal() +\n  scale_fill_brewer(palette=\"Pastel2\") +\n  labs(title = \"Boxplot of Log Viral Load Change by Hard Drug Use Group\",\n       x = \"Hard Drug Use Group\",\n       y = \"Log Viral Load Change\") +\n  guides(fill = guide_legend(title = \"Hard Drug Use Group\"))\n\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nWe can see that current and previous drug users had less of a decrease in log viral load over 2 years compared to never hard drug users.\n\n# Create boxplots of log viral load change by adherence group\nggplot(data_no_na, aes(x = ADH_HIGHVSLOW, y = VLOAD_log_CHANGE, fill = ADH_HIGHVSLOW)) +\n  geom_boxplot(alpha = 0.5) +\n  theme_minimal() +\n  scale_fill_brewer(palette=\"Pastel2\") +\n  labs(title = \"Boxplot of Log Viral Load Change by Adherence at Year 2\",\n       x = \"Adherence at year 2\",\n       y = \"Log Viral Load Change\") +\n  guides(fill = guide_legend(title = \"Adherence Group\"))\n\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nAnd here we can see those with high adherence had a higher decrease in log viral load over 2 years compared to those with low adherence.\n\n\n\n:::"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#cd4-t-cell-count-change-1",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#cd4-t-cell-count-change-1",
    "title": "Advanced Data Analysis - Project 2",
    "section": "CD4+ T Cell Count Change",
    "text": "CD4+ T Cell Count Change\nThe second outcome variable of interest was change in CD4+ T Cell Count over the first 2 years of the study.\n\nFull ModelReduced Model - No Interaction\n\n\n\nModel SelectionAnalysisInterpretationVisualizing the Interaction\n\n\nThe candidate variables for inclusion in our model predicting LEU3N_CHANGE were hard_drugs_grp, ADH_HIGHLOW, BMI_2, FRP_2, and EDUC_COLLEGE.\nThe researchers are interested in if differences in treatment response between the drug use groups can be explained by differences in adherence to the HAART regimen, so we will also include an interaction term between hard drug use group and adherence.\nWe begin by examining the full model with all these variables included.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group, include adherence as confounder, and BMI, frailty related phenotype, and college education as precision variables.\nmodel_LEU3N_full1 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + BMI_2 + FRP_2 + EDUC_COLLEGE + CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Exmamine the summary\nsummary(model_LEU3N_full1)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    BMI_2 + FRP_2 + EDUC_COLLEGE + CESD_2 + hard_drugs_grp * \n    ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-665.80 -119.44   -3.02  110.80 1080.47 \n\nCoefficients: (1 not defined because of singularities)\n                                                         Estimate Std. Error\n(Intercept)                                              -46.7866    63.8333\nhard_drugs_grpPrevious User                              -92.1062    31.5556\nhard_drugs_grpCurrent User                              -161.2223   132.3190\nADH_HIGHVSLOWHigh Adherence                               78.9814    35.0133\nBMI_2                                                      6.0075     2.1384\nFRP_2Yes                                                -101.6289    36.3579\nEDUC_COLLEGECollege                                       28.7527    21.5453\nCESD_2                                                    -1.0786     0.8141\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence        NA         NA\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    49.4909   134.8433\n                                                        t value Pr(&gt;|t|)   \n(Intercept)                                              -0.733  0.46397   \nhard_drugs_grpPrevious User                              -2.919  0.00369 **\nhard_drugs_grpCurrent User                               -1.218  0.22370   \nADH_HIGHVSLOWHigh Adherence                               2.256  0.02457 * \nBMI_2                                                     2.809  0.00518 **\nFRP_2Yes                                                 -2.795  0.00541 **\nEDUC_COLLEGECollege                                       1.335  0.18271   \nCESD_2                                                   -1.325  0.18588   \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence      NA       NA   \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    0.367  0.71377   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 180.3 on 448 degrees of freedom\n  (93 observations deleted due to missingness)\nMultiple R-squared:  0.1193,    Adjusted R-squared:  0.1036 \nF-statistic: 7.587 on 8 and 448 DF,  p-value: 0.000000001577\n\n\nWe get an NA for the interaction term. This is likely because we dropped the n=6 patients that were previous hard drug users with low adherence, making the interaction impossible to make. Indeed we can see we only have 7, 453 degrees of freedom.\nBMI is significant, but has 10% missing values. Let’s try running the regression without it so we can examine that interaction term, which is the main research question. (it’s also correlated to college education, so we can kind of capture it with that variable).\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group, include adherence as confounder, and BMI, frailty related phenotype, and college education as precision variables.\nmodel_LEU3N_red1 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + EDUC_COLLEGE + CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Exmamine the summary\nsummary(model_LEU3N_red1)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + EDUC_COLLEGE + CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, \n    data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-697.61 -112.73   -1.31  106.13 1073.99 \n\nCoefficients:\n                                                         Estimate Std. Error\n(Intercept)                                              -30.8189    92.4188\nhard_drugs_grpNever User                                 126.1630    96.3440\nhard_drugs_grpPrevious User                              355.9657   119.3430\nADH_HIGHVSLOWHigh Adherence                              104.4788    94.2502\nFRP_2Yes                                                -110.1432    35.5533\nEDUC_COLLEGECollege                                       25.0343    20.1854\nCESD_2                                                    -1.0187     0.7723\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     -17.0631    99.8903\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence -333.1581   126.6465\n                                                        t value Pr(&gt;|t|)   \n(Intercept)                                              -0.333  0.73892   \nhard_drugs_grpNever User                                  1.310  0.19096   \nhard_drugs_grpPrevious User                               2.983  0.00299 **\nADH_HIGHVSLOWHigh Adherence                               1.109  0.26816   \nFRP_2Yes                                                 -3.098  0.00206 **\nEDUC_COLLEGECollege                                       1.240  0.21547   \nCESD_2                                                   -1.319  0.18776   \nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     -0.171  0.86443   \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -2.631  0.00878 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 181.3 on 506 degrees of freedom\n  (35 observations deleted due to missingness)\nMultiple R-squared:  0.09847,   Adjusted R-squared:  0.08422 \nF-statistic: 6.908 on 8 and 506 DF,  p-value: 0.000000012\n\n\n\nBackwards Elimination\nWe will perform model selection using backwards elimination and BIC to select the most parsimonious model.\nA delta BIC of &gt;2 indicates a difference in model performance.\n\n# Perform backward elimination regression selection based on BIC \nols_step_backward_sbc(model_LEU3N_red1, include = c(\"hard_drugs_grp\", \"ADH_HIGHVSLOW\"))\n\n\n                                Stepwise Summary                                \n------------------------------------------------------------------------------\nStep    Variable          AIC         SBC         SBIC        R2       Adj. R2 \n------------------------------------------------------------------------------\n 0      Full Model      6828.740    6871.181    5380.046    0.09847    0.08422 \n 1      EDUC_COLLEGE    6828.303    6866.500    5355.906    0.09573    0.08324 \n 2      CESD_2          6828.406    6862.359    5356.186    0.09203    0.08130 \n------------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                           Model Summary                            \n-------------------------------------------------------------------\nR                         0.303       RMSE                 180.377 \nR-Squared                 0.092       MSE                32984.102 \nAdj. R-Squared            0.081       Coef. Var            114.193 \nPred R-Squared            0.076       AIC                 6828.406 \nMAE                     136.282       SBC                 6862.359 \n-------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                 ANOVA                                   \n------------------------------------------------------------------------\n                    Sum of                                              \n                   Squares         DF    Mean Square      F        Sig. \n------------------------------------------------------------------------\nRegression     1698306.434          6     283051.072    8.581    0.0000 \nResidual      16755923.716        508      32984.102                    \nTotal         18454230.150        514                                   \n------------------------------------------------------------------------\n\n                                                           Parameter Estimates                                                            \n-----------------------------------------------------------------------------------------------------------------------------------------\n                                                  model        Beta    Std. Error    Std. Beta      t        Sig        lower      upper \n-----------------------------------------------------------------------------------------------------------------------------------------\n                                            (Intercept)     -36.638        90.808                 -0.403    0.687    -215.043    141.767 \n                               hard_drugs_grpNever User     136.867        96.322        0.292     1.421    0.156     -52.373    326.106 \n                            hard_drugs_grpPrevious User     341.997       117.232        0.515     2.917    0.004     111.678    572.317 \n                            ADH_HIGHVSLOWHigh Adherence     116.056        94.071        0.168     1.234    0.218     -68.761    300.873 \n                                               FRP_2Yes    -113.844        35.435       -0.136    -3.213    0.001    -183.462    -44.226 \n   hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     -25.037        99.815       -0.059    -0.251    0.802    -221.138    171.064 \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence    -330.080       123.130       -0.467    -2.681    0.008    -571.988    -88.173 \n-----------------------------------------------------------------------------------------------------------------------------------------\n\n\nAs predicted, the most parsimonious model is with CESD_2 and EDUC_COLLEGE removed, and only including FRP_2 as a precision variable.\nTop of Tabset\n\n\n\nLet’s investigate the key relationships in the final model for LEU3N_CHANGE as determined through backwards selection.\nFirst let’s look at the impact of hard drug use on CD4+ T Cell change, at low adherence.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination\nmodel_LEU3N_final1 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_LEU3N_final1)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-700.74 -111.21   -1.67  112.23 1077.98 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                               107.46      31.59\nhard_drugs_grpCurrent User                               -144.10      96.02\nhard_drugs_grpPrevious User                               197.90      80.49\nADH_HIGHVSLOWHigh Adherence                                83.09      32.92\nFRP_2Yes                                                 -113.63      35.38\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     32.94      99.51\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -297.13      85.95\n                                                        t value Pr(&gt;|t|)    \n(Intercept)                                               3.402 0.000721 ***\nhard_drugs_grpCurrent User                               -1.501 0.134038    \nhard_drugs_grpPrevious User                               2.459 0.014277 *  \nADH_HIGHVSLOWHigh Adherence                               2.524 0.011895 *  \nFRP_2Yes                                                 -3.212 0.001402 ** \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    0.331 0.740764    \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -3.457 0.000592 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 181.3 on 512 degrees of freedom\n  (31 observations deleted due to missingness)\nMultiple R-squared:  0.08984,   Adjusted R-squared:  0.07917 \nF-statistic: 8.423 on 6 and 512 DF,  p-value: 0.000000009913\n\n\n\n# Print useful model parameters\nmodel_results(model_LEU3N_final1)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n107.46049\n31.58675\n3.4020752\n0.0007211\n0.0050476\n45.40491\n169.51607\n\n\nhard_drugs_grpCurrent User\n-144.09848\n96.01798\n-1.5007447\n0.1340380\n0.9382660\n-332.73618\n44.53922\n\n\nhard_drugs_grpPrevious User\n197.89868\n80.49146\n2.4586294\n0.0142768\n0.0999374\n39.76450\n356.03287\n\n\nADH_HIGHVSLOWHigh Adherence\n83.09406\n32.91813\n2.5242642\n0.0118953\n0.0832670\n18.42283\n147.76529\n\n\nFRP_2Yes\n-113.62595\n35.37733\n-3.2118295\n0.0014019\n0.0098130\n-183.12853\n-44.12336\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n32.93895\n99.50721\n0.3310208\n0.7407642\n1.0000000\n-162.55372\n228.43162\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n-297.12895\n85.95111\n-3.4569531\n0.0005918\n0.0041424\n-465.98920\n-128.26871\n\n\n\n\n\n\n\nThe overall model is highly significant (F(6,512)= 8.42, p &lt; 0.00001).\nAt low adherence, previous hard drug users have a higher CD4+ T Cell count than never hard drug users (p-adjusted = 0.043), but current hard drugs users did not differ from never drug users (p-adjusted = 0.40).\nAdditionally, for never hard drug users, those with high adherence have a higher CD4+ T Cell count than those with low adherence (p = 0.011895)\nNow let’s compare hard drug usage for those with high adherence.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination\nmodel_LEU3N_final2 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_LEU3N_final2)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-700.74 -111.21   -1.67  112.23 1077.98 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                              190.56       9.47\nhard_drugs_grpCurrent User                              -111.16      26.04\nhard_drugs_grpPrevious User                              -99.23      30.14\nADH_HIGHVSLOWLow Adherence                               -83.09      32.92\nFRP_2Yes                                                -113.63      35.38\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence    -32.94      99.51\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   297.13      85.95\n                                                       t value\n(Intercept)                                             20.123\nhard_drugs_grpCurrent User                              -4.269\nhard_drugs_grpPrevious User                             -3.292\nADH_HIGHVSLOWLow Adherence                              -2.524\nFRP_2Yes                                                -3.212\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   -0.331\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   3.457\n                                                                   Pr(&gt;|t|)    \n(Intercept)                                            &lt; 0.0000000000000002 ***\nhard_drugs_grpCurrent User                                        0.0000234 ***\nhard_drugs_grpPrevious User                                        0.001064 ** \nADH_HIGHVSLOWLow Adherence                                         0.011895 *  \nFRP_2Yes                                                           0.001402 ** \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence              0.740764    \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence             0.000592 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 181.3 on 512 degrees of freedom\n  (31 observations deleted due to missingness)\nMultiple R-squared:  0.08984,   Adjusted R-squared:  0.07917 \nF-statistic: 8.423 on 6 and 512 DF,  p-value: 0.000000009913\n\n\n\n# Print useful model parameters\nmodel_results(model_LEU3N_final2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n190.55455\n9.469605\n20.1227563\n0.0000000\n0.0000000\n171.9505\n209.15861\n\n\nhard_drugs_grpCurrent User\n-111.15953\n26.036468\n-4.2693782\n0.0000234\n0.0001636\n-162.3110\n-60.00807\n\n\nhard_drugs_grpPrevious User\n-99.23027\n30.144942\n-3.2917718\n0.0010643\n0.0074500\n-158.4533\n-40.00727\n\n\nADH_HIGHVSLOWLow Adherence\n-83.09406\n32.918132\n-2.5242642\n0.0118953\n0.0832670\n-147.7653\n-18.42283\n\n\nFRP_2Yes\n-113.62595\n35.377328\n-3.2118295\n0.0014019\n0.0098130\n-183.1285\n-44.12336\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence\n-32.93895\n99.507208\n-0.3310208\n0.7407642\n1.0000000\n-228.4316\n162.55372\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence\n297.12895\n85.951110\n3.4569531\n0.0005918\n0.0041424\n128.2687\n465.98920\n\n\n\n\n\n\n\nFor those with high adherence, previous hard drug users had a lower CD4+ T Cell count (p-adjusted = 0.0032), and current hard drug users had a lower CD4+ T Cell (p-adjusted &lt; 0.0001) count compared to never hard users.\nNow we make the same comparisons with previous hard drug users as the baseline.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination\nmodel_LEU3N_final2 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_LEU3N_final2)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-700.74 -111.21   -1.67  112.23 1077.98 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                              305.36      74.03\nhard_drugs_grpNever User                                -197.90      80.49\nhard_drugs_grpCurrent User                              -342.00     117.06\nADH_HIGHVSLOWHigh Adherence                             -214.03      79.41\nFRP_2Yes                                                -113.63      35.38\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     297.13      85.95\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   330.07     122.95\n                                                       t value  Pr(&gt;|t|)    \n(Intercept)                                              4.125 0.0000433 ***\nhard_drugs_grpNever User                                -2.459  0.014277 *  \nhard_drugs_grpCurrent User                              -2.922  0.003636 ** \nADH_HIGHVSLOWHigh Adherence                             -2.695  0.007266 ** \nFRP_2Yes                                                -3.212  0.001402 ** \nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     3.457  0.000592 ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   2.685  0.007497 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 181.3 on 512 degrees of freedom\n  (31 observations deleted due to missingness)\nMultiple R-squared:  0.08984,   Adjusted R-squared:  0.07917 \nF-statistic: 8.423 on 6 and 512 DF,  p-value: 0.000000009913\n\n\n\n# Print useful model parameters\nmodel_results(model_LEU3N_final2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n305.3592\n74.03481\n4.124535\n0.0000433\n0.0003034\n159.90978\n450.80856\n\n\nhard_drugs_grpNever User\n-197.8987\n80.49146\n-2.458629\n0.0142768\n0.0999374\n-356.03287\n-39.76450\n\n\nhard_drugs_grpCurrent User\n-341.9972\n117.05931\n-2.921572\n0.0036365\n0.0254554\n-571.97284\n-112.02148\n\n\nADH_HIGHVSLOWHigh Adherence\n-214.0349\n79.41319\n-2.695206\n0.0072658\n0.0508607\n-370.05069\n-58.01909\n\n\nFRP_2Yes\n-113.6259\n35.37733\n-3.211829\n0.0014019\n0.0098130\n-183.12853\n-44.12336\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence\n297.1290\n85.95111\n3.456953\n0.0005918\n0.0041424\n128.26871\n465.98920\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n330.0679\n122.94881\n2.684596\n0.0074971\n0.0524799\n88.52168\n571.61413\n\n\n\n\n\n\n\nAt low adherence, current hard drug users had a CD4+ T Cell count compared to previous hard drug users (p-adjusted = 0.011).\nAdditionally, for previous hard drug users, those with high adherence had a greater decrease in CD4+ T Cell count compared to those with low adherence (p = 0.0073).\nNow let’s change the reference level to compare high adherence previous vs current drug users.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination\nmodel_LEU3N_final3 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_LEU3N_final3)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-700.74 -111.21   -1.67  112.23 1077.98 \n\nCoefficients:\n                                                      Estimate Std. Error\n(Intercept)                                              91.32      28.73\nhard_drugs_grpNever User                                 99.23      30.14\nhard_drugs_grpCurrent User                              -11.93      37.60\nADH_HIGHVSLOWLow Adherence                              214.03      79.41\nFRP_2Yes                                               -113.63      35.38\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    -297.13      85.95\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence  -330.07     122.95\n                                                      t value Pr(&gt;|t|)    \n(Intercept)                                             3.179 0.001568 ** \nhard_drugs_grpNever User                                3.292 0.001064 ** \nhard_drugs_grpCurrent User                             -0.317 0.751150    \nADH_HIGHVSLOWLow Adherence                              2.695 0.007266 ** \nFRP_2Yes                                               -3.212 0.001402 ** \nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    -3.457 0.000592 ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence  -2.685 0.007497 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 181.3 on 512 degrees of freedom\n  (31 observations deleted due to missingness)\nMultiple R-squared:  0.08984,   Adjusted R-squared:  0.07917 \nF-statistic: 8.423 on 6 and 512 DF,  p-value: 0.000000009913\n\n\n\n# Print useful model parameters\nmodel_results(model_LEU3N_final3)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n91.32428\n28.72807\n3.1789217\n0.0015677\n0.0109736\n34.88488\n147.76367\n\n\nhard_drugs_grpNever User\n99.23027\n30.14494\n3.2917718\n0.0010643\n0.0074500\n40.00727\n158.45327\n\n\nhard_drugs_grpCurrent User\n-11.92926\n37.59689\n-0.3172937\n0.7511501\n1.0000000\n-85.79241\n61.93390\n\n\nADH_HIGHVSLOWLow Adherence\n214.03489\n79.41319\n2.6952058\n0.0072658\n0.0508607\n58.01909\n370.05069\n\n\nFRP_2Yes\n-113.62595\n35.37733\n-3.2118295\n0.0014019\n0.0098130\n-183.12853\n-44.12336\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence\n-297.12895\n85.95111\n-3.4569531\n0.0005918\n0.0041424\n-465.98920\n-128.26871\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence\n-330.06790\n122.94881\n-2.6845962\n0.0074971\n0.0524799\n-571.61413\n-88.52168\n\n\n\n\n\n\n\nFor those with high adherence, previous vs current hard drug users did not differ in CD4+ T Cell Count (p-adjusted= 1.00).\nFinally let’s compare the impact of adherence for hard drug users.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination\nmodel_LEU3N_final4 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_LEU3N_final4)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-700.74 -111.21   -1.67  112.23 1077.98 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                               -36.64      90.67\nhard_drugs_grpPrevious User                               342.00     117.06\nhard_drugs_grpNever User                                  144.10      96.02\nADH_HIGHVSLOWHigh Adherence                               116.03      93.93\nFRP_2Yes                                                 -113.63      35.38\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -330.07     122.95\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      -32.94      99.51\n                                                        t value Pr(&gt;|t|)   \n(Intercept)                                              -0.404  0.68633   \nhard_drugs_grpPrevious User                               2.922  0.00364 **\nhard_drugs_grpNever User                                  1.501  0.13404   \nADH_HIGHVSLOWHigh Adherence                               1.235  0.21729   \nFRP_2Yes                                                 -3.212  0.00140 **\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -2.685  0.00750 **\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     -0.331  0.74076   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 181.3 on 512 degrees of freedom\n  (31 observations deleted due to missingness)\nMultiple R-squared:  0.08984,   Adjusted R-squared:  0.07917 \nF-statistic: 8.423 on 6 and 512 DF,  p-value: 0.000000009913\n\n\n\n# Print useful model parameters\nmodel_results(model_LEU3N_final4)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-36.63799\n90.67376\n-0.4040639\n0.6863344\n1.0000000\n-214.77639\n141.50040\n\n\nhard_drugs_grpPrevious User\n341.99716\n117.05931\n2.9215715\n0.0036365\n0.0254554\n112.02148\n571.97284\n\n\nhard_drugs_grpNever User\n144.09848\n96.01798\n1.5007447\n0.1340380\n0.9382660\n-44.53922\n332.73618\n\n\nADH_HIGHVSLOWHigh Adherence\n116.03301\n93.93276\n1.2352773\n0.2172938\n1.0000000\n-68.50805\n300.57408\n\n\nFRP_2Yes\n-113.62595\n35.37733\n-3.2118295\n0.0014019\n0.0098130\n-183.12853\n-44.12336\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n-330.06790\n122.94881\n-2.6845962\n0.0074971\n0.0524799\n-571.61413\n-88.52168\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence\n-32.93895\n99.50721\n-0.3310208\n0.7407642\n1.0000000\n-228.43162\n162.55372\n\n\n\n\n\n\n\nFor current hard drug users, those with high adherence did not differ significantly compared to those with low adherence (p = 0.22)\nFRP_2 was a significant predictor for LEU3N_CHANGE, while controlling for hard drug use and adherence to the treatment regiment (t = -3.21, p = 0.0014). On average, those with a Frailty Related Phenotype had a decrease in CD4+ T cells that was 113.63 cells greater than those without a Frailty Related Phenotype (95% CI: 44.12 to 183.13 cells).\nTop of Tabset\n\n\n\nOverall Model\nThere were significant differences in change in CD4+ T Cell count over 2 years based on hard drug usage and adherence to the treatment regiment, while controlling for Frailty Related Phenotype (F(6,512) = 8.42, p &lt; 0.00001).\n\nHard Drug Use\nThe relationship between hard drug use and change in CD4+ T Cell count over 2 years depended on adherence to the treatment regiment.\n\nHard Drug Use at Low Adherence\nFor those with low adherence to the treatment regiment, previous hard drug users had on average a 197.90 cells greater increase in CD4+ T Cell count compared to never hard drug users (t = 2.46, p-adjusted = 0.043, 95%: 39.77 to 356.03). Current hard drug users did not differ from never hard drug users (t = -1.50, p-adjusted = 0.40, 95% CI: -332.74 to 44.54). Additionally, current hard drug users had on average a -342.00 cells greater decrease in CD4+ T Cell count compared to previous hard drug users (t = -2.922, p-adjusted = 0.011, 95% CI: -571.97 to -112.02).\n\n\nHard Drug Use at High Adherence\nFor those with high adherence to the treatment regiment, previous hard drug users had on average a 99.23 cells greater decrease (t = -3.29, p-adjusted = 0.0032, 95% CI: -158.4533 to -40.00727), and current hard drug users had on average a 111.16 cells greater decrease (t = -4.27, p-adjusted &lt; 0.0001, 95% CI: -162.31 to -60.00) compared to never hard drug users. in CD4+ T cell count compared never hard drug users. Current hard drug users did not differ from previous hard drug users on change in CD4+ T Cell count over 2 years (t = -0.32, p-adjusted= 1.00, 95% CI: -85.79 to 61.93).\n\n\n\n\nAdherence\nThe relationship between adherence to the treatment regiment and change in CD4+ T Cell count over 2 years differed by hard drug use.\n\nAdherence for Current Hard Drug Users\nFor current hard drug users, those with high adherence did not differ significantly in average change in CD4+ T Cells over two years compared to those with low adherence (t = 1.24, p-adjusted = 0.22, 95% CI: -68.51 to 300.57).\n\n\n\nAdherence for Previous Hard Drug Users\nFor previous hard drug users, those with high adherence had on average a 214.03 cells greater decrease in CD4+ T Cell count compared to those with low adherence (t = -2.70, p = 0.0073, 95% CI: -370.05 to -58.020).\n\n\nAdherence for Never Hard Drug Users\nFor never drug users, those with high adherence had on average a 83.09 cells greater decrease in CD4+ T Cell count compared to those with low adherence (t = 2.52, p = 0.0119, 95% CI: 18.42283 147.76529).\n\n\nAdditional Interaction Comparisons\nThere are additional comparisons we can make in the interaction between hard drug usage and adherence, but they are of little clinical relevance (e.g. comparing current hard drug users with low adherence to never hard drug users with high adherence). ### Frailty Related Phenotype\nFrailty Related Phenotype was a significant predictor for change in CD4+ T Cell count over 2 years, while controlling for hard drug use and adherence to the treatment regiment (t = -3.21, p = 0.0014). On average, those with a Frailty Related Phenotype had a 113.63 cells greater decrease in CD4+ T Cell count than those without a Frailty Related Phenotype (95% CI: 44.12 to 183.13 cells).\nTop of Tabset\n\n\n\nThe below plot is useful in interpreting the interaction\n\n# Use interactions package to plot interaction\ncat_plot(\n  model_LEU3N_final1, \n  pred = hard_drugs_grp, \n  modx = ADH_HIGHVSLOW, \n  geom = \"line\", \n  colors = \"Pastel2\",\n  x.label = \"Hard Drugs Group\",\n  y.label = \"Predicted CD4+ T Cell Count Change\")\n\n\n\n\n\n\n\n# Filter out NA values\ndata_no_na &lt;- data_wide_2 %&gt;% filter(!is.na(ADH_HIGHVSLOW))\n\n# Create the plot with lines\nggplot(data_no_na, aes(x = hard_drugs_grp, y = LEU3N_CHANGE, fill = ADH_HIGHVSLOW)) +\n  geom_boxplot(alpha = 0.5) +\n  scale_fill_brewer(palette = \"Pastel2\") +\n  labs(title = \"Interaction between Hard Drugs and Adherence on LEU3N Change\",\n       x = \"Hard Drugs Group\",\n       y = \"LEU3N Change\") +\n  guides(fill = guide_legend(title = \"Adherence Group\")) +\n   theme_minimal() \n\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nHere we can see the key relationships in our model.\nFor current hard drug users, those with high adherence did not differ from those with low adherence. This may be an artifact of the small number of current hard drug users with low adherence, however (n = 6).\nFor previous hard drug users, those with high adherence had a smaller increase in CD4+ T Cell count compared to those with low adherence. This is a counter-inuitive finding and may be an artifact of the small number of previous hard drug users with low adherence, however (n=4). It may be of interest to the clinicians however, and we therefore report it here.\nFor never hard drug users, those with high adherence had a greater increase in CD4+ T Cell count compared to those with low adherence.\nAt low adherence, previous hard drug users had greater increase in CD4+ T Cell count compared to never hard drug users, and also when compared to current hard drug users. Current hard drugs users did not differ crom never hard drug users in change in CD4+ T Cell count at low adherence.\nAt high adherence, never drug users had a greater increase in CD4+ T cell count compared to previous and current hard drug users. Current hard drug users did not differ from previous hard drug users at high adherence.\nTop of Tabset\n\n\n\n\n\n\nAnalysisInterpretationVisualizing Main Effects\n\n\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination\nmodel_LEU3N_final_noX1 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2, data = data_wide_2)\n\n# Examine the summary\nsummary(model_LEU3N_final_noX1)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-697.88 -115.61   -3.14  114.98 1080.85 \n\nCoefficients:\n                            Estimate Std. Error t value    Pr(&gt;|t|)    \n(Intercept)                   140.88      28.36   4.967 0.000000927 ***\nhard_drugs_grpCurrent User   -112.84      25.38  -4.446 0.000010724 ***\nhard_drugs_grpPrevious User   -62.31      28.51  -2.185     0.02932 *  \nADH_HIGHVSLOWHigh Adherence    46.81      29.24   1.601     0.11000    \nFRP_2Yes                     -114.33      35.72  -3.201     0.00145 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 183.2 on 514 degrees of freedom\n  (31 observations deleted due to missingness)\nMultiple R-squared:  0.06752,   Adjusted R-squared:  0.06026 \nF-statistic: 9.305 on 4 and 514 DF,  p-value: 0.000000289\n\n\n\n# Examine the summary\nmodel_results(model_LEU3N_final_noX1)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n140.8774\n28.36272\n4.966993\n0.0000009\n0.0000046\n85.15631\n196.598539\n\n\nhard_drugs_grpCurrent User\n-112.8387\n25.37954\n-4.446049\n0.0000107\n0.0000536\n-162.69908\n-62.978288\n\n\nhard_drugs_grpPrevious User\n-62.3112\n28.51439\n-2.185255\n0.0293209\n0.1466044\n-118.33027\n-6.292117\n\n\nADH_HIGHVSLOWHigh Adherence\n46.8124\n29.24046\n1.600946\n0.1100033\n0.5500164\n-10.63312\n104.257925\n\n\nFRP_2Yes\n-114.3343\n35.72007\n-3.200841\n0.0014550\n0.0072749\n-184.50955\n-44.158969\n\n\n\n\n\n\n\nChange the reference level to previous users and re-run the model\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination\nmodel_LEU3N_final_noX2 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2, data = data_wide_2)\n\n# Examine the summary\nsummary(model_LEU3N_final_noX2)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-697.88 -115.61   -3.14  114.98 1080.85 \n\nCoefficients:\n                            Estimate Std. Error t value Pr(&gt;|t|)   \n(Intercept)                    78.57      37.09   2.118  0.03462 * \nhard_drugs_grpNever User       62.31      28.51   2.185  0.02932 * \nhard_drugs_grpCurrent User    -50.53      36.00  -1.403  0.16110   \nADH_HIGHVSLOWHigh Adherence    46.81      29.24   1.601  0.11000   \nFRP_2Yes                     -114.33      35.72  -3.201  0.00145 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 183.2 on 514 degrees of freedom\n  (31 observations deleted due to missingness)\nMultiple R-squared:  0.06752,   Adjusted R-squared:  0.06026 \nF-statistic: 9.305 on 4 and 514 DF,  p-value: 0.000000289\n\n\n\n# Examine the summary\nmodel_results(model_LEU3N_final_noX2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n78.56623\n37.08694\n2.118434\n0.0346175\n0.1730874\n5.705608\n151.42685\n\n\nhard_drugs_grpNever User\n62.31120\n28.51439\n2.185255\n0.0293209\n0.1466044\n6.292117\n118.33027\n\n\nhard_drugs_grpCurrent User\n-50.52749\n36.00333\n-1.403412\n0.1610979\n0.8054896\n-121.259266\n20.20429\n\n\nADH_HIGHVSLOWHigh Adherence\n46.81240\n29.24046\n1.600946\n0.1100033\n0.5500164\n-10.633119\n104.25793\n\n\nFRP_2Yes\n-114.33426\n35.72007\n-3.200841\n0.0014550\n0.0072749\n-184.509547\n-44.15897\n\n\n\n\n\n\n\n\n\n\nOverall Model\nThe overall model is significant (F~(4, 514)~ = 9.31, p &lt; .0001).\n\n\nHard Drug Use\nHard drug use is a significant predictor of change in CD4+ T Cell count over 2 years.\nCurrent hard drug users had an average change in CD4+ T Cell count that was 112.84 cells lower than never drug users, while controlling for adherence to treatment regiment and Frailty Related Phenotype (p-adjusted &lt; 0.0001, 95% CI: -162.70 to -62.98).\nPrevious hard drug users did not differ from never hard drugs users (p-adjusted = 0.088, 95% CI:-118.33 to -6.29), or current hard drug users (p-adjusted = 0.483, 95% CI: -121.26 to 20.20).\n\n\nAdherence\nAdherence was not a significant predictor for change in CD4+ T Cell count over 2 years, after controlling for hard drug use and Frailty Related Phenotype (t = 1.60, p = 0.110).\n\n\nFrailty Related Phenotype\nFrailty related phenotype is a significant predictor for change in CD4+ T Cell count over 2 years, while controlling for hard drug use and adherence to the treatment regiment (t = -3.20, p = 0.00145). On average, those with a frailty related phenotype had a change in CD4+ T Cell count that was 114.33 cells lower than those without a frailty related phenotype (95% CI: -184.51 to -44.16).\nTop of Tabset\n\n\n\n\nHard Drug Use\nHere we will create some simple plots to help with visualizing the main effects of hard drug use and adherence on change in CD4+ T Cell count.\n\n# Relevel to change the reference cateory to Never User\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Create boxplots of CD4+ T Cell count change by hard drug use group\nggplot(data_wide_2, aes(x = hard_drugs_grp, y = LEU3N_CHANGE, fill = hard_drugs_grp)) +\n  geom_boxplot(alpha = 0.5) +\n  theme_minimal() +\n  scale_fill_brewer(palette=\"Pastel2\") +\n  labs(title = \"Boxplot of CD4+ T Cell Count Change by Hard Drug Use Group\",\n       x = \"Hard Drug Use Group\",\n       y = \"CD4+ T Cell Count Change\") +\n  guides(fill = guide_legend(title = \"Hard Drug Use Group\"))\n\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nCurrent hard drug users had less of an increase in CD4+ T Cells over 2 years compared to never hard drug users. All other between-group comparisons were not significant.\n\n\nAdherence\n\n# Create boxplots of CD4+ T Cell count change by adherence group\nggplot(data_no_na, aes(x = ADH_HIGHVSLOW, y = LEU3N_CHANGE, fill = ADH_HIGHVSLOW)) +\n  geom_boxplot(alpha = 0.5) +\n  theme_minimal() +\n  scale_fill_brewer(palette = \"Pastel2\") +\n  labs(title = \"Boxplot of CD4+ T Cell Count Change by Adherence at Year 2\",\n       x = \"Adherence Level\",\n       y = \"CD4+ T Cell Count Change\") +\n  guides(fill = guide_legend(title = \"Adherence Group\"))\n\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nChange in CD4+ T Cell count did not differ based on adherence.\n\n\nFrailty Related Phenotype\n\n# Filter out NA values\ndata_no_na &lt;- data_wide_2 %&gt;% filter(!is.na(FRP_2))\n\n# Create boxplots of CD4+ T Cell count change by frailty related phenotype at year 2\nggplot(data_no_na, aes(x = FRP_2, y = LEU3N_CHANGE, fill = FRP_2)) +\n  geom_boxplot(alpha = 0.5) +\n  theme_minimal() +\n  scale_fill_brewer(palette = \"Pastel2\") +\n  labs(title = \"Boxplot of CD4+ T Cell Count Change by Frailty Related Phenotype\",\n       x = \"Frailty Related Phenotype\",\n       y = \"CD4+ T Cell Count Change\") +\n  guides(fill = guide_legend(title = \"Frailty Related Phenotype\"))\n\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nThose with a Frailty Related Phenotype had less of an increase in CD4+ T Cell count compared to those without."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#mental-qol-change",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#mental-qol-change",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Mental QOL Change",
    "text": "Mental QOL Change\nThe candidate variables for mental QOL change as determined by interactive variable selection are hard_drug_grp, ADH_HIGHLOW, CESD_2.\n\nModel ExplorationModel 1 - Main Research QuestionModel 2 - Depression Interaction TermConclusionBonus - Predicting Depression\n\n\n\nAnalysesDepression as a ConfounderIncluding Depression Interaction Term\n\n\nLet’s begin by running the full model as determined by interactive model selection.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_full1 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_full1)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.537  -6.126  -1.540   5.582  38.662 \n\nCoefficients:\n                                                         Estimate Std. Error\n(Intercept)                                               3.42934    2.16906\nhard_drugs_grpPrevious User                              -6.80279    5.39588\nhard_drugs_grpCurrent User                                9.20460    6.18696\nADH_HIGHVSLOWHigh Adherence                               2.68386    2.14723\nCESD_2                                                   -0.30407    0.04914\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  10.70651    5.68836\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -10.79007    6.40420\n                                                        t value      Pr(&gt;|t|)\n(Intercept)                                               1.581        0.1145\nhard_drugs_grpPrevious User                              -1.261        0.2080\nhard_drugs_grpCurrent User                                1.488        0.1374\nADH_HIGHVSLOWHigh Adherence                               1.250        0.2119\nCESD_2                                                   -6.188 0.00000000123\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   1.882        0.0604\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   -1.685        0.0926\n                                                           \n(Intercept)                                                \nhard_drugs_grpPrevious User                                \nhard_drugs_grpCurrent User                                 \nADH_HIGHVSLOWHigh Adherence                                \nCESD_2                                                  ***\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence .  \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.66 on 521 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 \nF-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878\n\n\nCompare hard drug use groups at high adherence\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_full2 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_full2)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.537  -6.126  -1.540   5.582  38.662 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                              6.11320    0.81275\nhard_drugs_grpPrevious User                              3.90372    1.94422\nhard_drugs_grpCurrent User                              -1.58547    1.68651\nADH_HIGHVSLOWLow Adherence                              -2.68386    2.14723\nCESD_2                                                  -0.30407    0.04914\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence -10.70651    5.68836\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   10.79007    6.40420\n                                                       t value\n(Intercept)                                              7.522\nhard_drugs_grpPrevious User                              2.008\nhard_drugs_grpCurrent User                              -0.940\nADH_HIGHVSLOWLow Adherence                              -1.250\nCESD_2                                                  -6.188\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -1.882\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence    1.685\n                                                                Pr(&gt;|t|)    \n(Intercept)                                            0.000000000000239 ***\nhard_drugs_grpPrevious User                                       0.0452 *  \nhard_drugs_grpCurrent User                                        0.3476    \nADH_HIGHVSLOWLow Adherence                                        0.2119    \nCESD_2                                                 0.000000001234665 ***\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence            0.0604 .  \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence             0.0926 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.66 on 521 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 \nF-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878\n\n\nCompare hard drug use groups at low adherence\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_full3 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_full3)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.537  -6.126  -1.540   5.582  38.662 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                             -3.37346    5.22804\nhard_drugs_grpNever User                                 6.80279    5.39588\nhard_drugs_grpCurrent User                              16.00739    7.63391\nADH_HIGHVSLOWHigh Adherence                             13.39037    5.29906\nCESD_2                                                  -0.30407    0.04914\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence   -10.70651    5.68836\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence -21.49658    8.01958\n                                                       t value      Pr(&gt;|t|)\n(Intercept)                                             -0.645       0.51904\nhard_drugs_grpNever User                                 1.261       0.20797\nhard_drugs_grpCurrent User                               2.097       0.03649\nADH_HIGHVSLOWHigh Adherence                              2.527       0.01180\nCESD_2                                                  -6.188 0.00000000123\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    -1.882       0.06037\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -2.681       0.00758\n                                                          \n(Intercept)                                               \nhard_drugs_grpNever User                                  \nhard_drugs_grpCurrent User                             *  \nADH_HIGHVSLOWHigh Adherence                            *  \nCESD_2                                                 ***\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence   .  \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.66 on 521 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 \nF-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878\n\n\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_full4 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_full4)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.537  -6.126  -1.540   5.582  38.662 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                            10.01691    1.98635\nhard_drugs_grpNever User                               -3.90372    1.94422\nhard_drugs_grpCurrent User                             -5.48919    2.41509\nADH_HIGHVSLOWLow Adherence                            -13.39037    5.29906\nCESD_2                                                 -0.30407    0.04914\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    10.70651    5.68836\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence  21.49658    8.01958\n                                                      t value      Pr(&gt;|t|)    \n(Intercept)                                             5.043 0.00000063408 ***\nhard_drugs_grpNever User                               -2.008       0.04517 *  \nhard_drugs_grpCurrent User                             -2.273       0.02344 *  \nADH_HIGHVSLOWLow Adherence                             -2.527       0.01180 *  \nCESD_2                                                 -6.188 0.00000000123 ***\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence     1.882       0.06037 .  \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   2.681       0.00758 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.66 on 521 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 \nF-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878\n\n\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_full5 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_full5)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.537  -6.126  -1.540   5.582  38.662 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                              4.52773    1.76048\nhard_drugs_grpPrevious User                              5.48919    2.41509\nhard_drugs_grpNever User                                 1.58547    1.68651\nADH_HIGHVSLOWLow Adherence                               8.10621    6.03476\nCESD_2                                                  -0.30407    0.04914\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence -21.49658    8.01958\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    -10.79007    6.40420\n                                                       t value      Pr(&gt;|t|)\n(Intercept)                                              2.572       0.01039\nhard_drugs_grpPrevious User                              2.273       0.02344\nhard_drugs_grpNever User                                 0.940       0.34761\nADH_HIGHVSLOWLow Adherence                               1.343       0.17978\nCESD_2                                                  -6.188 0.00000000123\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -2.681       0.00758\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence     -1.685       0.09262\n                                                          \n(Intercept)                                            *  \nhard_drugs_grpPrevious User                            *  \nhard_drugs_grpNever User                                  \nADH_HIGHVSLOWLow Adherence                                \nCESD_2                                                 ***\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence ** \nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.66 on 521 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 \nF-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878\n\n\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_full6 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_full6)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.537  -6.126  -1.540   5.582  38.662 \n\nCoefficients:\n                                                         Estimate Std. Error\n(Intercept)                                              12.63393    5.89652\nhard_drugs_grpPrevious User                             -16.00739    7.63391\nhard_drugs_grpNever User                                 -9.20460    6.18696\nADH_HIGHVSLOWHigh Adherence                              -8.10621    6.03476\nCESD_2                                                   -0.30407    0.04914\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  21.49658    8.01958\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     10.79007    6.40420\n                                                        t value      Pr(&gt;|t|)\n(Intercept)                                               2.143       0.03261\nhard_drugs_grpPrevious User                              -2.097       0.03649\nhard_drugs_grpNever User                                 -1.488       0.13742\nADH_HIGHVSLOWHigh Adherence                              -1.343       0.17978\nCESD_2                                                   -6.188 0.00000000123\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   2.681       0.00758\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      1.685       0.09262\n                                                           \n(Intercept)                                             *  \nhard_drugs_grpPrevious User                             *  \nhard_drugs_grpNever User                                   \nADH_HIGHVSLOWHigh Adherence                                \nCESD_2                                                  ***\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence ** \nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.66 on 521 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 \nF-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878\n\n\nInterestingly, we have lost a lot of the significant relationships we were seeing before with our main predictors of hard drug use and adherence.\nIt seems that the main driver of this model, and best predictor of change in mental QOL score is depression score.\nWithin adherence levels, none of the hard drug use groups differed from each other on QOL (p-adjusted &gt; 0.05).\nThe only significant difference in mental QOL change is for previous drug users. For previous drug users, those with low adherence have a mental QOL change that is on average 13.39 points lower than those with high adherence (p= 0.0118). Depending on how we handle multiple pairwise comparisons, this may not be significant!\nSomething fishy is going on here…\nLet’s examine this in a simplified model with no interactions.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_simple &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_simple)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.274  -6.421  -1.574   5.343  39.297 \n\nCoefficients:\n                            Estimate Std. Error t value        Pr(&gt;|t|)    \n(Intercept)                  6.17713    2.64623   2.334           0.020 *  \nhard_drugs_grpCurrent User  -3.44081    2.30106  -1.495           0.135    \nhard_drugs_grpNever User    -2.70142    1.85281  -1.458           0.145    \nADH_HIGHVSLOWHigh Adherence  2.94279    1.90898   1.542           0.124    \nCESD_2                      -0.32881    0.04803  -6.845 0.0000000000214 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.72 on 523 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.09648,   Adjusted R-squared:  0.08957 \nF-statistic: 13.96 on 4 and 523 DF,  p-value: 0.00000000007883\n\n\nIndeed, we can see that, when including depression in the model, hard drug use and adherence are no longer significant predictors of change in mental QOL!\nThis suggests that depression score is either a mediator, a moderator, or a confounder for the relationship between hard drug use and adherence on mental QOL.\nLet’s explore.\nTop of Tabset\n\n\n\nConfounder is related to PEV\nWe saw earlier that hard drug use was a significant predictor for depression. Specifically:\nHard drug use is a significant predictor of depression score (F~(2, 542)~= 14.31). On average, current hard drug users had depression scores that were 5.23 points higher than never hard drug users (p &lt; 0.0001), and previous hard drug users had depression scores that were 7.29 points higher than those who never used hard drugs (p &lt; 0.0001).\nThus, depression meets criteria 1 of the classical definition for a confounder: It is related to the PEV.\n\n\nConfounder is related to the Outcome Measure\nWe also saw in the interactive variable selection that depression was significantly related change in mental QOL change.\nThus depression meets criteria 2 of the classical definition for a confounder: it is related to the main outcome.\n\n\nConfounder is not a Mediator\nIt is possible that depression is on the causal pathway for mental QOL (hard drug use -&gt; depression -&gt; mental QOL), but it is likewise possible that mental QOL is on the causal pathway for depression (hard drug use -&gt; mental QOL -&gt; depression). Thus we cannot conclude that depression is a mediator.\n\n\nConfounder Meaningfully Changes the Relationship of PEV on Outcome\nWe also saw that including depression in the model changed hard drug use from being significant to not significant. Thus depression score changes the relationship between the PEV and outcome measure in a very meaningful way.\nI therefore feel justified in exploring depression as a confounder, and analyzing whether an interaction term between hard drug use group and depression will add explanatory power to our model.\nTop of Tabset\n\n\n\nLet’s run a new full model, with the included interaction term between hard drug use group and depression. In essence we are running a three way interaction. It will need to be emphasized in the discussion that this was exploratory data analysis.\n\n# Relevel to change to the reference group\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_newfull &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW + hard_drugs_grp*CESD_2, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_newfull)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW + hard_drugs_grp * \n    CESD_2, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-33.459  -6.016  -1.375   5.512  37.513 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                              9.51665    6.16622\nhard_drugs_grpPrevious User                             30.31096   10.51019\nhard_drugs_grpNever User                                -7.17735    6.52016\nADH_HIGHVSLOWHigh Adherence                             -7.87736    5.82799\nCESD_2                                                  -0.13089    0.14003\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence -7.15661    8.97026\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    10.75016    6.18586\nhard_drugs_grpPrevious User:CESD_2                      -1.15503    0.21476\nhard_drugs_grpNever User:CESD_2                         -0.09391    0.14973\n                                                        t value    Pr(&gt;|t|)    \n(Intercept)                                               1.543     0.12336    \nhard_drugs_grpPrevious User                               2.884     0.00409 ** \nhard_drugs_grpNever User                                 -1.101     0.27150    \nADH_HIGHVSLOWHigh Adherence                              -1.352     0.17708    \nCESD_2                                                   -0.935     0.35038    \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -0.798     0.42534    \nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      1.738     0.08283 .  \nhard_drugs_grpPrevious User:CESD_2                       -5.378 0.000000114 ***\nhard_drugs_grpNever User:CESD_2                          -0.627     0.53083    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.26 on 519 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.1729,    Adjusted R-squared:  0.1601 \nF-statistic: 13.56 on 8 and 519 DF,  p-value: &lt; 0.00000000000000022\n\n\nWe get a highly significant p-value for the interaction between hard drug use group and depression (p &lt; 0.0001)\nOur adjusted R-squared also shot up from 0.090 to 0.16. We’re on to something here.\nLet’s run backwards model selection and examine the BIC to see if we need to include the hard drug use * depression interaction score.\n\nBackwards Elimination\nWe are going to force inclusion of our main variables of interest, hard_drugs_grp and ADH_HIGHVSLOW, and the interaction between them, since those were the main questions the researchers posed.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_newfull &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW + hard_drugs_grp*CESD_2, data = data_wide_2)\n\n# Perform backward elimination regression selection based on BIC \nols_step_backward_sbc(model_MENT_newfull, include = c(\"hard_drugs_grp\", \"ADH_HIGHVSLOW\", \"hard_drugs_grp:ADH_HIGHVSLOW\"))\n\n[1] \"No variables have been removed from the model.\"\n\n\nNo variable was removed from the model, indicating that the interaction between hard drug use group and depression adds significant explanatory power and should be included in the model.\nThis puts us in a tricky position, it is clear that there is a relationship between hard drug use and mental quality of life, and that this differs based on both adherence and depression. However we don’t necessarily have the sample size to run a three-way interaction.\n\n\nNext Steps\nThus, we will proceed in two ways from here, and run separate models for:\n\n\nDoes the relationship between hard drug use and mental QOL differ based on adherence (irrespective of depression)?\n\n\nDoes the relationship between hard drug use and mental QOL differ based on depression (irrespective of adherence)?\n\n\nRemoving the confounder of depression in model 1 allows us to answer the main research question for this project. Model 2) will be presented as an exploratory data analysis and allows us to explore how depression is related to hard drug use, and how that is affecting our main model.\nTop of Tabset\n\n\n\n\n\n\nThis is the model predicting AGG_MENT_CHANGE, including only hard_drugs_grp and ADH_HIGHVSLOW, and their interaction term.\nThis addresses the main research question of how mental QOL is impacted by ART, based on hard drug use and adherence to the treatment regimen.\n\nAnalysisInterpretationVisualizing the Interaction\n\n\nLet’s run the regression as specified.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_main1 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW+ hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_main1)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-37.392  -5.850  -0.839   5.089  38.498 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                              -0.8003     2.0950\nhard_drugs_grpCurrent User                                7.9610     6.3718\nhard_drugs_grpPrevious User                             -15.9522     5.3413\nADH_HIGHVSLOWHigh Adherence                               3.4343     2.1812\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -11.1387     6.5996\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  18.7589     5.7025\n                                                        t value Pr(&gt;|t|)   \n(Intercept)                                              -0.382  0.70261   \nhard_drugs_grpCurrent User                                1.249  0.21207   \nhard_drugs_grpPrevious User                              -2.987  0.00295 **\nADH_HIGHVSLOWHigh Adherence                               1.574  0.11598   \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   -1.688  0.09204 . \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.290  0.00107 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.03 on 526 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.04347,   Adjusted R-squared:  0.03438 \nF-statistic: 4.781 on 5 and 526 DF,  p-value: 0.0002777\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_main1)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-0.8003171\n2.095019\n-0.3820094\n0.7026087\n1.0000000\n-4.9159498\n3.315316\n\n\nhard_drugs_grpCurrent User\n7.9609869\n6.371753\n1.2494186\n0.2120677\n1.0000000\n-4.5562212\n20.478195\n\n\nhard_drugs_grpPrevious User\n-15.9522320\n5.341272\n-2.9865976\n0.0029525\n0.0177150\n-26.4450776\n-5.459386\n\n\nADH_HIGHVSLOWHigh Adherence\n3.4342726\n2.181205\n1.5744837\n0.1159769\n0.6958614\n-0.8506712\n7.719216\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n-11.1386718\n6.599562\n-1.6877895\n0.0920444\n0.5522667\n-24.1034081\n1.826064\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n18.7589336\n5.702522\n3.2895855\n0.0010705\n0.0064233\n7.5564192\n29.961448\n\n\n\n\n\n\n# Get the VIFs\nvif_values &lt;- vif(model_MENT_main1)\n\nthere are higher-order terms (interactions) in this model\nconsider setting type = 'predictor'; see ?vif\n\npretty_print(vif_values)\n\n\n\n\n\nGVIF\nDf\nGVIF^(1/(2*Df))\n\n\n\n\nhard_drugs_grp\n119.991456\n2\n3.309692\n\n\nADH_HIGHVSLOW\n1.298281\n1\n1.139422\n\n\nhard_drugs_grp:ADH_HIGHVSLOW\n121.957959\n2\n3.323170\n\n\n\n\n\n\n\nThe overall model is significant (F(5,526) = 4.78, p = 0.000278, and we are getting significant interactions.\nAt the same time, this is a weaker model than when we included depression. Our R-adjusted is now 0.034, meaning we now only explain 3.4% of the variance in mental QOL (compared to 16% in the full model).\nAt low adherence, the previous group has a greater decrease in mental QOL compared to never users.\nFor never users, there is no difference in mental QOL based on high or low adherence (t = 1.5744837, p-adjusted = 0.116, 95% CI: -0.85 to 7.72).\nChange the reference group to compare drug use group at high adherence\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_main2 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW+ hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_main2)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-37.392  -5.850  -0.839   5.089  38.498 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                              2.6340     0.6071\nhard_drugs_grpCurrent User                              -3.1777     1.7190\nhard_drugs_grpPrevious User                              2.8067     1.9974\nADH_HIGHVSLOWLow Adherence                              -3.4343     2.1812\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   11.1387     6.5996\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence -18.7589     5.7025\n                                                       t value  Pr(&gt;|t|)    \n(Intercept)                                              4.339 0.0000172 ***\nhard_drugs_grpCurrent User                              -1.849   0.06508 .  \nhard_drugs_grpPrevious User                              1.405   0.16056    \nADH_HIGHVSLOWLow Adherence                              -1.574   0.11598    \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence    1.688   0.09204 .  \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -3.290   0.00107 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.03 on 526 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.04347,   Adjusted R-squared:  0.03438 \nF-statistic: 4.781 on 5 and 526 DF,  p-value: 0.0002777\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_main2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n2.633955\n0.607084\n4.338700\n0.0000172\n0.0001031\n1.441349\n3.8265623\n\n\nhard_drugs_grpCurrent User\n-3.177685\n1.719008\n-1.848557\n0.0650828\n0.3904967\n-6.554649\n0.1992793\n\n\nhard_drugs_grpPrevious User\n2.806702\n1.997389\n1.405185\n0.1605566\n0.9633394\n-1.117138\n6.7305412\n\n\nADH_HIGHVSLOWLow Adherence\n-3.434273\n2.181205\n-1.574484\n0.1159769\n0.6958614\n-7.719216\n0.8506712\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence\n11.138672\n6.599562\n1.687790\n0.0920444\n0.5522667\n-1.826064\n24.1034081\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence\n-18.758934\n5.702522\n-3.289585\n0.0010705\n0.0064233\n-29.961448\n-7.5564192\n\n\n\n\n\n\n\nAt high adherence, there is no difference in mental QOL between previous and never hard drug users (t = 1.41, p-adjusted = 0.48, 95% CI: -1.12 to 6.73), or between current and never hard drug users (t = -1.85, p-adjusted = 0.195, 95% CI: -6.55 to 0.20).\nChange reference level to compare previous hard drug users at low adherence.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_main3 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW+ hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_main3)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-37.392  -5.850  -0.839   5.089  38.498 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                             -16.753      4.913\nhard_drugs_grpNever User                                 15.952      5.341\nhard_drugs_grpCurrent User                               23.913      7.769\nADH_HIGHVSLOWHigh Adherence                              22.193      5.269\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    -18.759      5.703\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -29.898      8.158\n                                                       t value  Pr(&gt;|t|)    \n(Intercept)                                             -3.410  0.000700 ***\nhard_drugs_grpNever User                                 2.987  0.002953 ** \nhard_drugs_grpCurrent User                               3.078  0.002191 ** \nADH_HIGHVSLOWHigh Adherence                              4.212 0.0000298 ***\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    -3.290  0.001071 ** \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -3.665  0.000273 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.03 on 526 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.04347,   Adjusted R-squared:  0.03438 \nF-statistic: 4.781 on 5 and 526 DF,  p-value: 0.0002777\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_main3)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-16.75255\n4.913256\n-3.409663\n0.0007004\n0.0042022\n-26.404563\n-7.100535\n\n\nhard_drugs_grpNever User\n15.95223\n5.341272\n2.986598\n0.0029525\n0.0177150\n5.459386\n26.445078\n\n\nhard_drugs_grpCurrent User\n23.91322\n7.768540\n3.078213\n0.0021911\n0.0131465\n8.652045\n39.174393\n\n\nADH_HIGHVSLOWHigh Adherence\n22.19321\n5.268880\n4.212130\n0.0000298\n0.0001786\n11.842574\n32.543838\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence\n-18.75893\n5.702522\n-3.289585\n0.0010705\n0.0064233\n-29.961448\n-7.556419\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n-29.89761\n8.158288\n-3.664691\n0.0002728\n0.0016365\n-45.924434\n-13.870777\n\n\n\n\n\n\n\nHere we can see that all our p-values are now very low (all have at least 2 decimal places). This gives me confidence that this is a meaningful and strong model. All the most important comparisons are with previous drug users at low adherence!\nAt low adherence, current hard drug users have a higher mental QOL (p-adjusted = 0.00657), and never hard drug users have a higher mental QOL (p-adjusted = 0.00886) compared to previous hard drug users.\nAdditionally, for previous hard drug users, those with high adherence had a higher increase in mental QOL compared to those with low adherence (p &lt; 0.0001).\nChange reference category to compare high adherence previous hard drug users.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_main4 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_main4)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-37.392  -5.850  -0.839   5.089  38.498 \n\nCoefficients:\n                                                      Estimate Std. Error\n(Intercept)                                              5.441      1.903\nhard_drugs_grpNever User                                -2.807      1.997\nhard_drugs_grpCurrent User                              -5.984      2.491\nADH_HIGHVSLOWLow Adherence                             -22.193      5.269\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence     18.759      5.703\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   29.898      8.158\n                                                      t value  Pr(&gt;|t|)    \n(Intercept)                                             2.859  0.004416 ** \nhard_drugs_grpNever User                               -1.405  0.160557    \nhard_drugs_grpCurrent User                             -2.402  0.016654 *  \nADH_HIGHVSLOWLow Adherence                             -4.212 0.0000298 ***\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence     3.290  0.001071 ** \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   3.665  0.000273 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.03 on 526 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.04347,   Adjusted R-squared:  0.03438 \nF-statistic: 4.781 on 5 and 526 DF,  p-value: 0.0002777\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_main4)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n5.440657\n1.902896\n2.859146\n0.0044164\n0.0264985\n1.702448\n9.178866\n\n\nhard_drugs_grpNever User\n-2.806702\n1.997389\n-1.405185\n0.1605566\n0.9633394\n-6.730541\n1.117138\n\n\nhard_drugs_grpCurrent User\n-5.984387\n2.491476\n-2.401945\n0.0166539\n0.0999236\n-10.878851\n-1.089922\n\n\nADH_HIGHVSLOWLow Adherence\n-22.193206\n5.268880\n-4.212130\n0.0000298\n0.0001786\n-32.543838\n-11.842574\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence\n18.758934\n5.702522\n3.289585\n0.0010705\n0.0064233\n7.556419\n29.961448\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence\n29.897605\n8.158288\n3.664691\n0.0002728\n0.0016365\n13.870777\n45.924434\n\n\n\n\n\n\n\nAt high adherence, there is a borderline significant difference between previous and current drug users (p-adjusted = 0.050). Considering the small sample size in both categories, this could become a non significant difference with a larger N.\nChange the reference level to compare current hard drug users\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_main5 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_main5)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-37.392  -5.850  -0.839   5.089  38.498 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                                7.161      6.017\nhard_drugs_grpPrevious User                              -23.913      7.769\nhard_drugs_grpNever User                                  -7.961      6.372\nADH_HIGHVSLOWHigh Adherence                               -7.704      6.229\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   29.898      8.158\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      11.139      6.600\n                                                        t value Pr(&gt;|t|)    \n(Intercept)                                               1.190 0.234592    \nhard_drugs_grpPrevious User                              -3.078 0.002191 ** \nhard_drugs_grpNever User                                 -1.249 0.212068    \nADH_HIGHVSLOWHigh Adherence                              -1.237 0.216668    \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.665 0.000273 ***\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      1.688 0.092044 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.03 on 526 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.04347,   Adjusted R-squared:  0.03438 \nF-statistic: 4.781 on 5 and 526 DF,  p-value: 0.0002777\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_main5)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n7.160670\n6.017485\n1.189977\n0.2345922\n1.0000000\n-4.660585\n18.981925\n\n\nhard_drugs_grpPrevious User\n-23.913219\n7.768540\n-3.078213\n0.0021911\n0.0131465\n-39.174393\n-8.652045\n\n\nhard_drugs_grpNever User\n-7.960987\n6.371753\n-1.249419\n0.2120677\n1.0000000\n-20.478195\n4.556221\n\n\nADH_HIGHVSLOWHigh Adherence\n-7.704399\n6.228689\n-1.236922\n0.2166682\n1.0000000\n-19.940561\n4.531762\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n29.897605\n8.158288\n3.664691\n0.0002728\n0.0016365\n13.870777\n45.924434\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence\n11.138672\n6.599562\n1.687790\n0.0920444\n0.5522667\n-1.826064\n24.103408\n\n\n\n\n\n\n\nFor current hard drug users, there was no difference in mental QOL based on adherence (t = -1.24, p = 0.227, 95% CI: -19.94 to 4.53).\nTop of Tabset\n\n\n\nOverall model\nThere were significant differences in change mental QOL over 2 years based on hard drug usage and adherence to the treatment regiment (F(5,526) = 4.78, p = 0.000278).\n\n\nHard Drug Use\nThe relationship between hard drug use and change in mental QOL over 2 years depended on adherence to the treatment regiment.\n\nHard Drug Use at Low Adherence\nFor those with low adherence to the treatment regiment, previous hard drug users had a 15.95 point decrease in mental QOL compared to never hard drug users (t = -2.99, p-adjusted = 0.00886, 95% CI: -26.46 to -5.50), and a 23.91 point decrease compared to current hard drug users (t = 3.078, p-adjusted = 0.00657, 95% CI: 8.65 to 39.17). There was no difference in mental QOL between current and never hard drug users at low adherence (t = 1.25, p-adjusted = 0.636, 95% CI: -4.56 to 20.48).\n\n\nHard Drug use at High Adherence\nFor those with low adherence to the treatment regiment, there was no difference in mental QOL between previous and never hard drug users (t = 1.41, p-adjusted = 0.48, 95% CI: -1.12 to 6.73), or between current and never hard drug users (t = -1.85, p-adjusted = 0.195, 95% CI: -6.55 to 0.20). The difference in mental QOL for current and previous users was borderline significant (t= -2.40, p-adjusted = 0.050, 95% CI: -10.88 to -1.09), and with a larger sample size may become non-significant.\n\n\n\nAdherence\nThe relationship between adherence to the treatment regiment and change in mental QOL over 2 years differed by hard drug use.\n\nAdherence for Current Hard Drug Users\nFor current hard drug users,there was no difference in mental QOL change over 2 years based on adherence (t = -1.24, p = 0.227, 95% CI: -19.94 to 4.53).\n\n\nAdherence for Previous Hard Drug Users\nFor previous hard drug users, there was a statistically significant difference in change in mental QOL over 2 years based on adherence (t = 4.21, p-adjusted = 0.000536). On average, previous hard drug users with high adherence had a 22.19 point increase in mental QOL over 2 years compared to those with low adherence (95% CI: 11.84 to 32.54).\n\n\nAdherence for Never Hard Drug Users\nFor never hard drug users, there was no difference in change in mental QOL over 2 years based on high or low adherence (t = 1.5744837, p-adjusted = 0.116, 95% CI: -0.85 to 7.72).\nTop of Tabset\n\n\n\n\nThe below plot is useful in interpreting the interaction\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Use interactions package to plot interaction\ncat_plot(\n  model_MENT_main1, \n  pred = hard_drugs_grp, \n  modx = ADH_HIGHVSLOW, \n  geom = \"line\", \n  colors = \"Pastel2\",\n  x.label = \"Hard Drugs Group\",\n  y.label = \"Predicted Mental QOL Change\")\n\n\n\n\n\n\n\n\nHere we see the main interaction finding: for previous users, those with low adherence had a decrease in mental QOL over 2 years compared to those with high adherence who had an slight increase.\nAdditionally, for those with low adherence, previous hard drug users had a decrease in mental QOL over 2 years compared to current hard drug users and never hard drug users.\nWe interpret this to mean that previous hard drug users (those in either their first or second year of sobriety) are struggling to deal with withdrawals, addiction, or the adverse effects of the treatment. While current users are in the midst of using hard drugs as a coping mechanism, and thus are protected from the negative impact of the treatment on mental QOL.\nThus, previous hard drug users are a vulnerable population, and high adherence to the treatment regiment might buffer them against the adverse effects of the HAART treatment.\nTop of Tabset\n\n\n\n\n\nThis is the model predicting AGG_MENT_CHANGE, including only hard_drugs_grp and CESD_2, and their interaction term.\nThis addresses the confounding of depression on the relationship between hard drug use and change in mental QOL.\n\nAnalysisInterpretationVisualizing the Interaction\n\n\nCompare slopes for never users.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_sub1 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + CESD_2 + hard_drugs_grp*CESD_2, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_sub1)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + CESD_2 + hard_drugs_grp * \n    CESD_2, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-34.141  -6.071  -1.545   5.758  37.779 \n\nCoefficients:\n                                   Estimate Std. Error t value       Pr(&gt;|t|)\n(Intercept)                         5.10534    0.81668   6.251 0.000000000836\nhard_drugs_grpCurrent User         -3.04165    2.90324  -1.048          0.295\nhard_drugs_grpPrevious User        16.97744    2.91062   5.833 0.000000009463\nCESD_2                             -0.23480    0.05313  -4.419 0.000011998960\nhard_drugs_grpCurrent User:CESD_2   0.10992    0.15093   0.728          0.467\nhard_drugs_grpPrevious User:CESD_2 -0.80296    0.13010  -6.172 0.000000001341\n                                      \n(Intercept)                        ***\nhard_drugs_grpCurrent User            \nhard_drugs_grpPrevious User        ***\nCESD_2                             ***\nhard_drugs_grpCurrent User:CESD_2     \nhard_drugs_grpPrevious User:CESD_2 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.36 on 532 degrees of freedom\n  (12 observations deleted due to missingness)\nMultiple R-squared:  0.1571,    Adjusted R-squared:  0.1492 \nF-statistic: 19.84 on 5 and 532 DF,  p-value: &lt; 0.00000000000000022\n\n# Get the VIFs\nvif_values &lt;- vif(model_MENT_sub1)\n\nthere are higher-order terms (interactions) in this model\nconsider setting type = 'predictor'; see ?vif\n\npretty_print(vif_values)\n\n\n\n\n\nGVIF\nDf\nGVIF^(1/(2*Df))\n\n\n\n\nhard_drugs_grp\n9.440857\n2\n1.752883\n\n\nCESD_2\n1.416421\n1\n1.190135\n\n\nhard_drugs_grp:CESD_2\n11.642359\n2\n1.847184\n\n\n\n\n\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_sub1)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n5.1053388\n0.8166797\n6.2513354\n0.0000000\n0.0000000\n3.5010261\n6.7096514\n\n\nhard_drugs_grpCurrent User\n-3.0416518\n2.9032412\n-1.0476745\n0.2952643\n1.0000000\n-8.7448750\n2.6615715\n\n\nhard_drugs_grpPrevious User\n16.9774420\n2.9106247\n5.8329203\n0.0000000\n0.0000001\n11.2597144\n22.6951696\n\n\nCESD_2\n-0.2347979\n0.0531285\n-4.4194338\n0.0000120\n0.0000720\n-0.3391653\n-0.1304305\n\n\nhard_drugs_grpCurrent User:CESD_2\n0.1099198\n0.1509341\n0.7282635\n0.4667728\n1.0000000\n-0.1865801\n0.4064197\n\n\nhard_drugs_grpPrevious User:CESD_2\n-0.8029584\n0.1301049\n-6.1716247\n0.0000000\n0.0000000\n-1.0585407\n-0.5473761\n\n\n\n\n\n\n\nThe overall model is highly significant (F~(5, 532)~ = 19.84, p &lt; 0.0001, adjusted R-squared = 0.149).\nFor never hard drug users, there was a significant relationship between depression and mental QOL (t = -4.42, p &lt; 0.0001). Specifically, for never hard drug users, a 1 point increase in depression score was associated with 0.23 point decrease in mental QOL (95% CI: -0.34 to -0.13).\nCurrent hard drug users did not differ significantly from never hard drug users while controlling for the other variables in the model (t = -1.05, p-adjusted = 0.89, 95% CI: -8.74 to 2.66). Previous hard drug users had on average a 16.98 higher increase in mental QOL compared to never hard drug users (at low depression scores?) (t = 2.91062, p-adjusted &lt; 0.0001.\nThe slope for depression on mental QOL did not differ between current and never hard drug users (t = 0.73, p-adjusted = 1.00, 95% CI: -0.19 to 0.41). However, the slope for depression on mental QOL did differ between previous and never hard drug users (t = -6.17, p-adjusted &lt; 0.0001). For each point increase in depression, the mental QOL score for previous hard drug users decreases an additional 0.80 points compared to never hard drug users (95% CI: -1.06 to -0.55).\nPrevious hard drug users have an increase of approximately 16.98 units in mental QOL, holding all other variables constant. This difference is statistically significant, suggesting that prior hard drug use is associated with a considerably higher outcome measure in this model. (It’s significant because we’re not account for the interaction with this estimate.)\nCompare slopes for previous users.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_sub2 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + CESD_2 + hard_drugs_grp*CESD_2, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_sub2)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + CESD_2 + hard_drugs_grp * \n    CESD_2, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-34.141  -6.071  -1.545   5.758  37.779 \n\nCoefficients:\n                                  Estimate Std. Error t value\n(Intercept)                        22.0828     2.7937   7.904\nhard_drugs_grpNever User          -16.9774     2.9106  -5.833\nhard_drugs_grpCurrent User        -20.0191     3.9455  -5.074\nCESD_2                             -1.0378     0.1188  -8.738\nhard_drugs_grpNever User:CESD_2     0.8030     0.1301   6.172\nhard_drugs_grpCurrent User:CESD_2   0.9129     0.1846   4.946\n                                              Pr(&gt;|t|)    \n(Intercept)                         0.0000000000000156 ***\nhard_drugs_grpNever User            0.0000000094634100 ***\nhard_drugs_grpCurrent User          0.0000005392622284 ***\nCESD_2                            &lt; 0.0000000000000002 ***\nhard_drugs_grpNever User:CESD_2     0.0000000013409353 ***\nhard_drugs_grpCurrent User:CESD_2   0.0000010165357517 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.36 on 532 degrees of freedom\n  (12 observations deleted due to missingness)\nMultiple R-squared:  0.1571,    Adjusted R-squared:  0.1492 \nF-statistic: 19.84 on 5 and 532 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_sub2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n22.0827808\n2.7937019\n7.904487\n0.0000000\n0.0000000\n16.5947401\n27.5708214\n\n\nhard_drugs_grpNever User\n-16.9774420\n2.9106247\n-5.832920\n0.0000000\n0.0000001\n-22.6951696\n-11.2597144\n\n\nhard_drugs_grpCurrent User\n-20.0190937\n3.9454549\n-5.073963\n0.0000005\n0.0000032\n-27.7696761\n-12.2685114\n\n\nCESD_2\n-1.0377563\n0.1187629\n-8.738048\n0.0000000\n0.0000000\n-1.2710581\n-0.8044544\n\n\nhard_drugs_grpNever User:CESD_2\n0.8029584\n0.1301049\n6.171625\n0.0000000\n0.0000000\n0.5473761\n1.0585407\n\n\nhard_drugs_grpCurrent User:CESD_2\n0.9128781\n0.1845619\n4.946190\n0.0000010\n0.0000061\n0.5503186\n1.2754377\n\n\n\n\n\n\n\nFor previous hard drug users, there was a significant relationship between depression and mental QOL (t = -8.74, p &lt; 0.0001). Specifically, for previous hard drug users, a 1 point increase in depression score was associated with a 1.04 point decrease in mental QOL (95% CI: -1.27 to -0.80). That is nearly 5 times more of a decrease compared to never users!\nCompare slopes for current users.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_sub3 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + CESD_2 + hard_drugs_grp*CESD_2, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_sub3)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + CESD_2 + hard_drugs_grp * \n    CESD_2, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-34.141  -6.071  -1.545   5.758  37.779 \n\nCoefficients:\n                                   Estimate Std. Error t value    Pr(&gt;|t|)    \n(Intercept)                          2.0637     2.7860   0.741       0.459    \nhard_drugs_grpPrevious User         20.0191     3.9455   5.074 0.000000539 ***\nhard_drugs_grpNever User             3.0417     2.9032   1.048       0.295    \nCESD_2                              -0.1249     0.1413  -0.884       0.377    \nhard_drugs_grpPrevious User:CESD_2  -0.9129     0.1846  -4.946 0.000001017 ***\nhard_drugs_grpNever User:CESD_2     -0.1099     0.1509  -0.728       0.467    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.36 on 532 degrees of freedom\n  (12 observations deleted due to missingness)\nMultiple R-squared:  0.1571,    Adjusted R-squared:  0.1492 \nF-statistic: 19.84 on 5 and 532 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_sub3)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n2.0636870\n2.7860086\n0.7407325\n0.4591825\n1.0000000\n-3.4092406\n7.5366146\n\n\nhard_drugs_grpPrevious User\n20.0190937\n3.9454549\n5.0739634\n0.0000005\n0.0000032\n12.2685114\n27.7696761\n\n\nhard_drugs_grpNever User\n3.0416518\n2.9032412\n1.0476745\n0.2952643\n1.0000000\n-2.6615715\n8.7448750\n\n\nCESD_2\n-0.1248781\n0.1412744\n-0.8839402\n0.3771278\n1.0000000\n-0.4024022\n0.1526460\n\n\nhard_drugs_grpPrevious User:CESD_2\n-0.9128781\n0.1845619\n-4.9461896\n0.0000010\n0.0000061\n-1.2754377\n-0.5503186\n\n\nhard_drugs_grpNever User:CESD_2\n-0.1099198\n0.1509341\n-0.7282635\n0.4667728\n1.0000000\n-0.4064197\n0.1865801\n\n\n\n\n\n\n\nFor current users, the relationship between depression and mental QOL is not significant (t = 0.88, p = 0.377, 95% CI: -0.40 to 0.15).\nThe slope for depression on mental QOL depended on hard drug use (t = -4.946, p-adjusted &lt; 0.0001). For each point increase in depression, the mental QOL score for previous hard drug users decreased by an additional 0.91 points compared to current hard drug users (95%: -1.28 to -0.55).\nTop of Tabset\n\n\n\nOverall Model\nThe overall model is highly significant (F~(5, 532)~ = 19.84, p &lt; 0.0001, adjusted R-squared = 0.149).\nThe relationship between depression and mental QOL depended on hard drug use.\n\n\nDepression Slopes within Hard Drug Use Group\n\nDepression for Current Hard Drug Users\nFor current hard drug users, the relationship between depression and mental QOL is not significant (t = 0.88, p = 0.377, 95% CI: -0.40 to 0.15).\n\n\nDepression for Previous Hard Drug Users\nFor previous hard drug users, there was a significant relationship between depression and mental QOL (t = -8.74, p &lt; 0.0001). Specifically, a 1 point increase in depression score was associated with a 1.04 point decrease in mental QOL for previous hard drug users (95% CI: -1.27 to -0.80). That is nearly 5 times more of a decrease compared to never users!\n\n\nDepression for Never Hard Drug Users\nFor never hard drug users, there was a significant relationship between depression and mental QOL (t = -4.42, p &lt; 0.0001). Specifically, a 1 point increase in depression score was associated with 0.23 point decrease in mental QOL for never hard drug users (95% CI: -0.34 to -0.13).\n\n\n\nDepression Slopes between Hard Drug use Group\nThe slopes for the relationship between depression and QOL differed based on hard drug use.\nFor each point increase in depression, the mental QOL score for previous hard drug users decreased an additional 0.80 points compared to never hard drug users (t = -6.17, p-adjusted &lt; 0.0001, 95% CI: -1.06 to -0.55).\nAdditionally, for each point increase in depression, the mental QOL score for previous hard drug users decreased by an additional 0.91 points compared to current hard drug users (t = -4.946, p-adjusted &lt; 0.0001, 95%: -1.28 to -0.55).\nThe slope for depression on mental QOL did not differ between current and never hard drug users (t = 0.73, p-adjusted = 1.00, 95% CI: -0.19 to 0.41).\nTop of Tabset\n\n\n\nThe plot below is helpful in interpreting the interaction between hard drug use and depression on mental QOL.\n\n# Create a scatterplot of mental QOLchange by depression score, colored by hard drug use group.\nggplot(data_wide_2, aes(x = CESD_2, y = AGG_MENT_CHANGE, color = hard_drugs_grp)) + \n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  theme_minimal() +\n  labs(title = \"Mental QOL Change by Depression at 2 years, Colored by Hard Drug Use Group\",\n       y = \"Mental QOL Change\",\n       x = \"Depression Score\") + \n  scale_fill_brewer(palette = \"Pastel2\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\nWarning: Removed 12 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n\n\nWarning: Removed 12 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nHere we can see the key relationships found in the model.\nThere is a negative relationship between depression and mental QOL scores at each level of drug usage. However, this relationship is much stronger for previous hard drug users, where every 1 point increase in depression scores is associated with an almost 5x greater decrease in mental QOL score over 2 years (~1 point for previous users compared to ~0.2 points for current and never user).\nAnd most importantly the slopes differed significantly by hard drug use group, with previous hard drug users having an additional 0.8 or 0.9 greater decrease in mental QOL score compared to never and current hard drug users, respectively.\nThus, we used this relationship as further evidence that previous hard drug users are a vulnerable group. They are susceptible to losses in mental QOL if they have low adherence to the treatment regiment, and depression has a greater impact on the mental QOL of previous hard drug users compared to current and never hard drug users.\nTop of Tabset\n\n\n\n\n\nWe found a dual interaction where the impact of hard drug use on mental QOL depended on both adherence to the treatment regimen and depression.\nFor adherence, those with previous hard drug use had a decrease in mental QOL if and only if they had low adherence to the treatment regiment.\nFor depression, previous hard drug users had a larger decrease in mental QOL compared to never and current hard drug users.\nThus, we used both of these relationships as strong evidence that previous hard drug users are a vulnerable population. They are susceptible to losses in mental QOL if they have low adherence to the treatment regiment, and depression has a greater impact on their mental QOL compared to current and never hard drug users.\nThis finding has great clinical relevance for the treatment of HIV in hard drug users. Specifically, extra efforts should be made to help previous hard drug users in two ways: One, adherence appears to serve as a buffer for previous hard drug users in the relationship between hard drug use and mental QOL. Efforts to increase adherence should therefore be made to help patients receive this ameliorative effect. Two, previous hard drug users do not have the coping mechanism of heroin or opiates available to them to buffer against the impact of adverse effects from ART, and thus extra aid perhaps in the form of increased therapy should be provided to these patients to provide them with alternate coping strategies.\nTop of Tabset\n\n\nJust for completion’s sake, we can run a regression predicting depression score based on the interaction between hard drug use and adherence.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_full1 &lt;- lm(CESD_2 ~ hard_drugs_grp + ADH_HIGHVSLOW+ hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_full1)\n\n\nCall:\nlm(formula = CESD_2 ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp * \n    ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-15.679  -8.508  -2.508   6.492  38.492 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                               13.750      1.848\nhard_drugs_grpCurrent User                                 4.250      5.544\nhard_drugs_grpPrevious User                               30.250      4.651\nADH_HIGHVSLOWHigh Adherence                               -2.242      1.921\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     0.921      5.742\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -26.708      4.964\n                                                        t value\n(Intercept)                                               7.440\nhard_drugs_grpCurrent User                                0.767\nhard_drugs_grpPrevious User                               6.504\nADH_HIGHVSLOWHigh Adherence                              -1.167\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    0.160\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -5.380\n                                                                 Pr(&gt;|t|)    \n(Intercept)                                             0.000000000000411 ***\nhard_drugs_grpCurrent User                                          0.444    \nhard_drugs_grpPrevious User                             0.000000000181686 ***\nADH_HIGHVSLOWHigh Adherence                                         0.244    \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence              0.873    \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence 0.000000111914533 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.45 on 528 degrees of freedom\n  (16 observations deleted due to missingness)\nMultiple R-squared:  0.1175,    Adjusted R-squared:  0.1091 \nF-statistic: 14.06 on 5 and 528 DF,  p-value: 0.0000000000006409\n\n\n\n# Use interactions package to plot interaction\ncat_plot(model_MENT_full1, pred = hard_drugs_grp, modx = ADH_HIGHVSLOW, geom = \"line\", colors = \"Pastel2\")\n\n\n\n\n\n\n\n\nThe interaction is significant, and we can see that previous hard drug users with low adherence had higher depression scores at year 2, and that those with high adherance were buffered from this effect.\nThe fact that depression and mental QOL both have this relationship, and are similar constructs, lends credence to the likelihood that this is a real relationship, and a strong one at that."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#Phys",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#Phys",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Physical QOL Score",
    "text": "Physical QOL Score\nThe fourth outcome variable of interest was change physcal QOL over the first 2 years of the study.\n\nFull Model\n\n\n\nModel SelectionAnalysisInterpretationVisualizing the Interaction\n\n\nThe candidate variables for inclusion in our model predicting AGG_PHYS_CHANGE were hard_drugs_grp, ADH_HIGHVSLOW, FRP_2, CESD_2, BMI, and DKGRP_2\nWe will remove BMI based on the missing values issue identified in the mental QOL model.\nLet’s run the full model including all those variables and the interaction between hard drug use group and adherence high vs low.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on Physical QOL change\nmodel_PHYS_full1 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + CESD_2 + DKGRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the model\nsummary(model_PHYS_full1)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + CESD_2 + DKGRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, \n    data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.215  -3.939   0.013   3.673  31.134 \n\nCoefficients:\n                                                          Estimate Std. Error\n(Intercept)                                              -4.584386   1.612457\nhard_drugs_grpCurrent User                              -10.266222   4.130948\nhard_drugs_grpPrevious User                             -11.067396   3.633010\nADH_HIGHVSLOWHigh Adherence                               3.209555   1.451052\nFRP_2Yes                                                -12.656122   1.481490\nCESD_2                                                    0.007245   0.033055\nDKGRP_21-3 drinks/week                                    0.651656   0.906606\nDKGRP_24-13 drinks/week                                   2.333646   1.035604\nDKGRP_2&gt;13 drinks/week                                   -0.398119   1.636008\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    6.472409   4.284786\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  12.329569   3.847471\n                                                        t value\n(Intercept)                                              -2.843\nhard_drugs_grpCurrent User                               -2.485\nhard_drugs_grpPrevious User                              -3.046\nADH_HIGHVSLOWHigh Adherence                               2.212\nFRP_2Yes                                                 -8.543\nCESD_2                                                    0.219\nDKGRP_21-3 drinks/week                                    0.719\nDKGRP_24-13 drinks/week                                   2.253\nDKGRP_2&gt;13 drinks/week                                   -0.243\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    1.511\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.205\n                                                                    Pr(&gt;|t|)\n(Intercept)                                                          0.00465\nhard_drugs_grpCurrent User                                           0.01327\nhard_drugs_grpPrevious User                                          0.00244\nADH_HIGHVSLOWHigh Adherence                                          0.02742\nFRP_2Yes                                                &lt; 0.0000000000000002\nCESD_2                                                               0.82659\nDKGRP_21-3 drinks/week                                               0.47260\nDKGRP_24-13 drinks/week                                              0.02466\nDKGRP_2&gt;13 drinks/week                                               0.80783\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence               0.13152\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence              0.00144\n                                                           \n(Intercept)                                             ** \nhard_drugs_grpCurrent User                              *  \nhard_drugs_grpPrevious User                             ** \nADH_HIGHVSLOWHigh Adherence                             *  \nFRP_2Yes                                                ***\nCESD_2                                                     \nDKGRP_21-3 drinks/week                                     \nDKGRP_24-13 drinks/week                                 *  \nDKGRP_2&gt;13 drinks/week                                     \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.757 on 510 degrees of freedom\n  (29 observations deleted due to missingness)\nMultiple R-squared:  0.2022,    Adjusted R-squared:  0.1865 \nF-statistic: 12.92 on 10 and 510 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Get the VIFs\nvif_values &lt;- vif(model_PHYS_full1)\n\nthere are higher-order terms (interactions) in this model\nconsider setting type = 'predictor'; see ?vif\n\npretty_print(vif_values)\n\n\n\n\n\nGVIF\nDf\nGVIF^(1/(2*Df))\n\n\n\n\nhard_drugs_grp\n125.173912\n2\n3.344864\n\n\nADH_HIGHVSLOW\n1.321733\n1\n1.149667\n\n\nFRP_2\n1.031224\n1\n1.015492\n\n\nCESD_2\n1.157182\n1\n1.075724\n\n\nDKGRP_2\n1.052687\n3\n1.008594\n\n\nhard_drugs_grp:ADH_HIGHVSLOW\n124.834338\n2\n3.342593\n\n\n\n\n\n\n\nThe overall model is highly significant (F(10,510) = 12.92, p &lt; 0.0001, Adjusted R-squared = 0.187).\nWe have some nice significant covariates, but it looks like FRP_2 is the main driver for this model.\nWe might have another double interaction situation like we did for the mental QOL model. Let’s create an interaction term between hard_drugs_grp and FRP_2 and run it through backwards elimination to select our final model based on BIC.\n\nBackwards Elimination\nWe will perform model selection using backwards elimination and BIC to select the most parsimonious model.\nA delta BIC of &gt;2 indicates a difference in model performance.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on physical QOL change\nmodel_PHYS_full1 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + CESD_2 + DKGRP_2 + hard_drugs_grp*ADH_HIGHVSLOW + hard_drugs_grp*FRP_2, data = data_wide_2)\n\n# Perform backward elimination regression selection based on BIC \nols_step_backward_sbc(model_PHYS_full1, include = c(\"hard_drugs_grp\", \"ADH_HIGHVSLOW\", \"hard_drugs_grp:ADH_HIGHVSLOW\"))\n\n\n                                    Stepwise Summary                                    \n--------------------------------------------------------------------------------------\nStep    Variable                  AIC         SBC         SBIC        R2       Adj. R2 \n--------------------------------------------------------------------------------------\n 0      Full Model              3622.820    3682.401    2164.416    0.21322    0.19463 \n 1      DKGRP_2                 3623.753    3670.567    2159.814    0.20268    0.18864 \n 2      CESD_2                  3621.873    3664.430    2147.887    0.20250    0.19004 \n 3      hard_drugs_grp:FRP_2    3625.025    3659.071    2143.951    0.19147    0.18204 \n--------------------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                         Model Summary                           \n----------------------------------------------------------------\nR                       0.438       RMSE                  7.726 \nR-Squared               0.191       MSE                  60.507 \nAdj. R-Squared          0.182       Coef. Var          -408.677 \nPred R-Squared          0.174       AIC                3625.025 \nMAE                     5.577       SBC                3659.071 \n----------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                ANOVA                                  \n----------------------------------------------------------------------\n                 Sum of                                               \n                Squares         DF    Mean Square      F         Sig. \n----------------------------------------------------------------------\nRegression     7365.193          6       1227.532    20.287    0.0000 \nResidual      31100.658        514         60.507                     \nTotal         38465.851        520                                    \n----------------------------------------------------------------------\n\n                                                         Parameter Estimates                                                           \n--------------------------------------------------------------------------------------------------------------------------------------\n                                                  model       Beta    Std. Error    Std. Beta      t        Sig       lower     upper \n--------------------------------------------------------------------------------------------------------------------------------------\n                                            (Intercept)     -3.611         1.398                 -2.583    0.010     -6.357    -0.864 \n                             hard_drugs_grpCurrent User     -9.617         4.133       -0.352    -2.327    0.020    -17.736    -1.497 \n                            hard_drugs_grpPrevious User    -10.860         3.470       -0.351    -3.130    0.002    -17.676    -4.043 \n                            ADH_HIGHVSLOWHigh Adherence      3.202         1.452        0.100     2.205    0.028      0.349     6.055 \n                                               FRP_2Yes    -12.737         1.468       -0.345    -8.674    0.000    -15.622    -9.852 \n hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence      5.711         4.286        0.203     1.332    0.183     -2.710    14.132 \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence     12.158         3.713        0.368     3.274    0.001      4.863    19.453 \n--------------------------------------------------------------------------------------------------------------------------------------\n\n\nThe final model selected for AGG_PHYS_CHANGE includes the PEVs of hard_drugs_grp and ADH_HIGHVSLOW and their interaction term, and FRP_2 as a precision variable. Luckily we only have to interpret one interaction for this model!\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on Physical QOL change\nmodel_PHYS_full1 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + CESD_2 + DKGRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the model\nsummary(model_PHYS_full1)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + CESD_2 + DKGRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, \n    data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.215  -3.939   0.013   3.673  31.134 \n\nCoefficients:\n                                                          Estimate Std. Error\n(Intercept)                                              -4.584386   1.612457\nhard_drugs_grpCurrent User                              -10.266222   4.130948\nhard_drugs_grpPrevious User                             -11.067396   3.633010\nADH_HIGHVSLOWHigh Adherence                               3.209555   1.451052\nFRP_2Yes                                                -12.656122   1.481490\nCESD_2                                                    0.007245   0.033055\nDKGRP_21-3 drinks/week                                    0.651656   0.906606\nDKGRP_24-13 drinks/week                                   2.333646   1.035604\nDKGRP_2&gt;13 drinks/week                                   -0.398119   1.636008\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    6.472409   4.284786\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  12.329569   3.847471\n                                                        t value\n(Intercept)                                              -2.843\nhard_drugs_grpCurrent User                               -2.485\nhard_drugs_grpPrevious User                              -3.046\nADH_HIGHVSLOWHigh Adherence                               2.212\nFRP_2Yes                                                 -8.543\nCESD_2                                                    0.219\nDKGRP_21-3 drinks/week                                    0.719\nDKGRP_24-13 drinks/week                                   2.253\nDKGRP_2&gt;13 drinks/week                                   -0.243\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    1.511\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.205\n                                                                    Pr(&gt;|t|)\n(Intercept)                                                          0.00465\nhard_drugs_grpCurrent User                                           0.01327\nhard_drugs_grpPrevious User                                          0.00244\nADH_HIGHVSLOWHigh Adherence                                          0.02742\nFRP_2Yes                                                &lt; 0.0000000000000002\nCESD_2                                                               0.82659\nDKGRP_21-3 drinks/week                                               0.47260\nDKGRP_24-13 drinks/week                                              0.02466\nDKGRP_2&gt;13 drinks/week                                               0.80783\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence               0.13152\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence              0.00144\n                                                           \n(Intercept)                                             ** \nhard_drugs_grpCurrent User                              *  \nhard_drugs_grpPrevious User                             ** \nADH_HIGHVSLOWHigh Adherence                             *  \nFRP_2Yes                                                ***\nCESD_2                                                     \nDKGRP_21-3 drinks/week                                     \nDKGRP_24-13 drinks/week                                 *  \nDKGRP_2&gt;13 drinks/week                                     \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.757 on 510 degrees of freedom\n  (29 observations deleted due to missingness)\nMultiple R-squared:  0.2022,    Adjusted R-squared:  0.1865 \nF-statistic: 12.92 on 10 and 510 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on Physical QOL change by hard drugs group, full model\nmodel_PHYS_full &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Exmamine the summary\nsummary(model_PHYS_full)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-36.596  -3.832   0.574   4.155  33.175 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                               -3.964      1.443\nhard_drugs_grpCurrent User                                -9.263      4.389\nhard_drugs_grpPrevious User                              -10.506      3.679\nADH_HIGHVSLOWHigh Adherence                                2.890      1.503\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     4.642      4.546\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   11.967      3.928\n                                                        t value Pr(&gt;|t|)   \n(Intercept)                                              -2.747  0.00622 **\nhard_drugs_grpCurrent User                               -2.110  0.03529 * \nhard_drugs_grpPrevious User                              -2.856  0.00447 **\nADH_HIGHVSLOWHigh Adherence                               1.923  0.05498 . \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    1.021  0.30771   \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.046  0.00243 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.29 on 526 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.07391,   Adjusted R-squared:  0.06511 \nF-statistic: 8.396 on 5 and 526 DF,  p-value: 0.0000001181\n\n# Use interactions package to plot interaction\ncat_plot(model_PHYS_full, pred = hard_drugs_grp, modx = ADH_HIGHVSLOW, geom = \"line\", colors = \"Pastel2\")\n\n\n\n\n\n\n\n\nTop of Tabset\n\n\n\nLet’s investigate the key relationships in the final model for AGG_PHYS_CHANGE as determined through backwards selection.\nFirst let’s look at the impact of hard drug use on physical QOL at low adherence.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on phys QOL\nmodel_PHYS_final1 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_PHYS_final1)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-33.074  -4.227  -0.026   3.800  32.493 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                               -3.578      1.351\nhard_drugs_grpCurrent User                                -9.650      4.106\nhard_drugs_grpPrevious User                              -10.893      3.442\nADH_HIGHVSLOWHigh Adherence                                3.185      1.406\nFRP_2Yes                                                 -12.756      1.463\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     5.713      4.255\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   12.309      3.675\n                                                        t value\n(Intercept)                                              -2.648\nhard_drugs_grpCurrent User                               -2.350\nhard_drugs_grpPrevious User                              -3.164\nADH_HIGHVSLOWHigh Adherence                               2.265\nFRP_2Yes                                                 -8.719\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    1.343\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.349\n                                                                    Pr(&gt;|t|)\n(Intercept)                                                         0.008328\nhard_drugs_grpCurrent User                                          0.019144\nhard_drugs_grpPrevious User                                         0.001644\nADH_HIGHVSLOWHigh Adherence                                         0.023912\nFRP_2Yes                                                &lt; 0.0000000000000002\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence              0.179911\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence             0.000868\n                                                           \n(Intercept)                                             ** \nhard_drugs_grpCurrent User                              *  \nhard_drugs_grpPrevious User                             ** \nADH_HIGHVSLOWHigh Adherence                             *  \nFRP_2Yes                                                ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.756 on 525 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.1911,    Adjusted R-squared:  0.1818 \nF-statistic: 20.67 on 6 and 525 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Print useful model parameters\nmodel_results(model_PHYS_final1)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-3.577634\n1.350818\n-2.648494\n0.0083285\n0.0582993\n-6.2313069\n-0.9239609\n\n\nhard_drugs_grpCurrent User\n-9.649910\n4.106380\n-2.349980\n0.0191437\n0.1340061\n-17.7168637\n-1.5829561\n\n\nhard_drugs_grpPrevious User\n-10.892966\n3.442355\n-3.164394\n0.0016441\n0.0115089\n-17.6554473\n-4.1304844\n\n\nADH_HIGHVSLOWHigh Adherence\n3.184855\n1.406039\n2.265126\n0.0239116\n0.1673814\n0.4227021\n5.9470082\n\n\nFRP_2Yes\n-12.755668\n1.462953\n-8.719122\n0.0000000\n0.0000000\n-15.6296286\n-9.8817067\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n5.713316\n4.254723\n1.342817\n0.1799114\n1.0000000\n-2.6450571\n14.0716887\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n12.309256\n3.675079\n3.349385\n0.0008681\n0.0060767\n5.0895895\n19.5289225\n\n\n\n\n\n\n\nThe overall model is highly significant (F~(6, 525)~ = 20.67, p &lt; 0.0001, adjusted R-squared = 0.1818).\nAt low adherence, previous hard drug users had on average a 10.89 point decrease in physical QOL compared to never hard drug users (t = -3.16, p-adjusted = 0.00493, 95% CI: -17.66 to -4.13). Current hard drug users did not differ significantly from never hard drug users at low adherence (t = -2.35, p-adjusted =0.0574, 95% CI: -17.72 to -1.58), although with a larger sample size that could become significant.\nFor never hard drug users, those with high adherence had a 3.19 point increase in physical QOL compared to those with low adherence (t = 2.27, p = 0.0239).\nCompare hard drug use groups at high adherence\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on phys QOL\nmodel_PHYS_final2 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_PHYS_final2)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-33.074  -4.227  -0.026   3.800  32.493 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                             -0.3928     0.3990\nhard_drugs_grpCurrent User                              -3.9366     1.1106\nhard_drugs_grpPrevious User                              1.4163     1.2872\nADH_HIGHVSLOWLow Adherence                              -3.1849     1.4060\nFRP_2Yes                                               -12.7557     1.4630\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   -5.7133     4.2547\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence -12.3093     3.6751\n                                                       t value\n(Intercept)                                             -0.985\nhard_drugs_grpCurrent User                              -3.545\nhard_drugs_grpPrevious User                              1.100\nADH_HIGHVSLOWLow Adherence                              -2.265\nFRP_2Yes                                                -8.719\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   -1.343\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -3.349\n                                                                   Pr(&gt;|t|)    \n(Intercept)                                                        0.325315    \nhard_drugs_grpCurrent User                                         0.000428 ***\nhard_drugs_grpPrevious User                                        0.271705    \nADH_HIGHVSLOWLow Adherence                                         0.023912 *  \nFRP_2Yes                                               &lt; 0.0000000000000002 ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence              0.179911    \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence             0.000868 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.756 on 525 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.1911,    Adjusted R-squared:  0.1818 \nF-statistic: 20.67 on 6 and 525 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Print useful model parameters\nmodel_results(model_PHYS_final2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-0.3927788\n0.3989561\n-0.9845163\n0.3253152\n1.0000000\n-1.176525\n0.3909676\n\n\nhard_drugs_grpCurrent User\n-3.9365941\n1.1105611\n-3.5446893\n0.0004282\n0.0029973\n-6.118283\n-1.7549047\n\n\nhard_drugs_grpPrevious User\n1.4162901\n1.2871848\n1.1003005\n0.2717054\n1.0000000\n-1.112375\n3.9449554\n\n\nADH_HIGHVSLOWLow Adherence\n-3.1848551\n1.4060388\n-2.2651261\n0.0239116\n0.1673814\n-5.947008\n-0.4227021\n\n\nFRP_2Yes\n-12.7556677\n1.4629531\n-8.7191225\n0.0000000\n0.0000000\n-15.629629\n-9.8817067\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence\n-5.7133158\n4.2547230\n-1.3428173\n0.1799114\n1.0000000\n-14.071689\n2.6450571\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence\n-12.3092560\n3.6750790\n-3.3493854\n0.0008681\n0.0060767\n-19.528923\n-5.0895895\n\n\n\n\n\n\n\nAt high adherence, current hard drug users had on average a 3.94 point decrease in physical QOL compared to never hard drug users (t = -3.545, p-adjusted = 0.00128, 95% CI: -6.12 to -1.75). Additionally, previous hard drug users did not differ significantly from never hard drug users at high adherence (t = 1.100, p-adjusted = 0.815, 95% CI: -1.11 to 3.94).\nChange reference level to compare previous users\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on phys QOL\nmodel_PHYS_final3 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_PHYS_final3)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-33.074  -4.227  -0.026   3.800  32.493 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                             -14.471      3.166\nhard_drugs_grpNever User                                 10.893      3.442\nhard_drugs_grpCurrent User                                1.243      5.006\nADH_HIGHVSLOWHigh Adherence                              15.494      3.396\nFRP_2Yes                                                -12.756      1.463\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    -12.309      3.675\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   -6.596      5.258\n                                                       t value\n(Intercept)                                             -4.570\nhard_drugs_grpNever User                                 3.164\nhard_drugs_grpCurrent User                               0.248\nADH_HIGHVSLOWHigh Adherence                              4.562\nFRP_2Yes                                                -8.719\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    -3.349\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -1.254\n                                                                   Pr(&gt;|t|)    \n(Intercept)                                                      0.00000608 ***\nhard_drugs_grpNever User                                           0.001644 ** \nhard_drugs_grpCurrent User                                         0.804000    \nADH_HIGHVSLOWHigh Adherence                                      0.00000631 ***\nFRP_2Yes                                               &lt; 0.0000000000000002 ***\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence               0.000868 ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence             0.210242    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.756 on 525 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.1911,    Adjusted R-squared:  0.1818 \nF-statistic: 20.67 on 6 and 525 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Print useful model parameters\nmodel_results(model_PHYS_final3)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-14.470600\n3.166243\n-4.5702741\n0.0000061\n0.0000426\n-20.690662\n-8.250537\n\n\nhard_drugs_grpNever User\n10.892966\n3.442355\n3.1643937\n0.0016441\n0.0115089\n4.130484\n17.655447\n\n\nhard_drugs_grpCurrent User\n1.243056\n5.006270\n0.2482998\n0.8039995\n1.0000000\n-8.591726\n11.077838\n\n\nADH_HIGHVSLOWHigh Adherence\n15.494111\n3.396206\n4.5621830\n0.0000063\n0.0000442\n8.822290\n22.165933\n\n\nFRP_2Yes\n-12.755668\n1.462953\n-8.7191225\n0.0000000\n0.0000000\n-15.629629\n-9.881707\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence\n-12.309256\n3.675079\n-3.3493854\n0.0008681\n0.0060767\n-19.528923\n-5.089589\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n-6.595940\n5.258100\n-1.2544342\n0.2102424\n1.0000000\n-16.925439\n3.733559\n\n\n\n\n\n\n\nAt low adherence, previous hard drug users did not differ significantly on change in physical QOL compared to current hard drug users (t = 0.25, p-adjusted = 1.00, 95% CI: -8.59 to 11.08).\nFor previous hard drug users, those with high adherence to the treatment regiment had on average a 15.49 point increase in physical QOL compared to those with low adherence (t = 4.56, p-adjusted &lt; 0.0001, 95% CI: 8.82 to 22.17).\nChange the reference level to current hard drug users.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on phys QOL\nmodel_PHYS_final4 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_PHYS_final4)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-33.074  -4.227  -0.026   3.800  32.493 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                              -13.228      3.878\nhard_drugs_grpPrevious User                               -1.243      5.006\nhard_drugs_grpNever User                                   9.650      4.106\nADH_HIGHVSLOWHigh Adherence                                8.898      4.017\nFRP_2Yes                                                 -12.756      1.463\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence    6.596      5.258\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      -5.713      4.255\n                                                        t value\n(Intercept)                                              -3.411\nhard_drugs_grpPrevious User                              -0.248\nhard_drugs_grpNever User                                  2.350\nADH_HIGHVSLOWHigh Adherence                               2.215\nFRP_2Yes                                                 -8.719\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   1.254\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     -1.343\n                                                                    Pr(&gt;|t|)\n(Intercept)                                                         0.000697\nhard_drugs_grpPrevious User                                         0.804000\nhard_drugs_grpNever User                                            0.019144\nADH_HIGHVSLOWHigh Adherence                                         0.027180\nFRP_2Yes                                                &lt; 0.0000000000000002\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence             0.210242\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence                0.179911\n                                                           \n(Intercept)                                             ***\nhard_drugs_grpPrevious User                                \nhard_drugs_grpNever User                                *  \nADH_HIGHVSLOWHigh Adherence                             *  \nFRP_2Yes                                                ***\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence    \nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence       \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.756 on 525 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.1911,    Adjusted R-squared:  0.1818 \nF-statistic: 20.67 on 6 and 525 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Print useful model parameters\nmodel_results(model_PHYS_final4)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-13.227544\n3.877840\n-3.4110595\n0.0006970\n0.0048787\n-20.845533\n-5.609554\n\n\nhard_drugs_grpPrevious User\n-1.243056\n5.006270\n-0.2482998\n0.8039995\n1.0000000\n-11.077838\n8.591726\n\n\nhard_drugs_grpNever User\n9.649910\n4.106380\n2.3499799\n0.0191437\n0.1340061\n1.582956\n17.716864\n\n\nADH_HIGHVSLOWHigh Adherence\n8.898171\n4.017005\n2.2151255\n0.0271799\n0.1902593\n1.006793\n16.789549\n\n\nFRP_2Yes\n-12.755668\n1.462953\n-8.7191225\n0.0000000\n0.0000000\n-15.629629\n-9.881707\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n6.595940\n5.258100\n1.2544342\n0.2102424\n1.0000000\n-3.733559\n16.925439\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence\n-5.713316\n4.254723\n-1.3428173\n0.1799114\n1.0000000\n-14.071689\n2.645057\n\n\n\n\n\n\n\nFor current hard drug users, those with high adherence had on average an 8.90 point increase in physical QOL compared to those with low adherence (t = 2.22, p = 0.027, 95% CI: 1.00 to 16.79).\nChange reference level to high adherence to compare last group.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on phys QOL\nmodel_PHYS_final5 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_PHYS_final5)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-33.074  -4.227  -0.026   3.800  32.493 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                              -4.329      1.048\nhard_drugs_grpPrevious User                               5.353      1.608\nhard_drugs_grpNever User                                  3.937      1.111\nADH_HIGHVSLOWLow Adherence                               -8.898      4.017\nFRP_2Yes                                                -12.756      1.463\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   -6.596      5.258\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence       5.713      4.255\n                                                       t value\n(Intercept)                                             -4.130\nhard_drugs_grpPrevious User                              3.329\nhard_drugs_grpNever User                                 3.545\nADH_HIGHVSLOWLow Adherence                              -2.215\nFRP_2Yes                                                -8.719\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -1.254\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence      1.343\n                                                                   Pr(&gt;|t|)    \n(Intercept)                                                       0.0000421 ***\nhard_drugs_grpPrevious User                                        0.000931 ***\nhard_drugs_grpNever User                                           0.000428 ***\nADH_HIGHVSLOWLow Adherence                                         0.027180 *  \nFRP_2Yes                                               &lt; 0.0000000000000002 ***\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence             0.210242    \nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence                0.179911    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.756 on 525 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.1911,    Adjusted R-squared:  0.1818 \nF-statistic: 20.67 on 6 and 525 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Print useful model parameters\nmodel_results(model_PHYS_final5)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-4.329373\n1.048183\n-4.130362\n0.0000421\n0.0002950\n-6.388520\n-2.270226\n\n\nhard_drugs_grpPrevious User\n5.352884\n1.607753\n3.329419\n0.0009314\n0.0065198\n2.194464\n8.511304\n\n\nhard_drugs_grpNever User\n3.936594\n1.110561\n3.544689\n0.0004282\n0.0029973\n1.754905\n6.118283\n\n\nADH_HIGHVSLOWLow Adherence\n-8.898171\n4.017005\n-2.215126\n0.0271799\n0.1902593\n-16.789549\n-1.006793\n\n\nFRP_2Yes\n-12.755668\n1.462953\n-8.719122\n0.0000000\n0.0000000\n-15.629629\n-9.881707\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence\n-6.595940\n5.258100\n-1.254434\n0.2102424\n1.0000000\n-16.925439\n3.733559\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence\n5.713316\n4.254723\n1.342817\n0.1799114\n1.0000000\n-2.645057\n14.071689\n\n\n\n\n\n\n\nAt high adherence, current hard drug users had on average a change in physical QOL that was 5.35 points less than previous hard drug users (t = 3.33, p-adjusted = 0.00279, 95% CI: 2.19 to 8.51).\nTop of Tabset\n\n\n\nOverall Model\nThere were significant differences in change in physical QOL over 2 years based on hard drug usage and adherence to the treatment regiment, while controlling for Frailty Related Phenotype (F~(6, 525)~ = 20.67, p &lt; 0.0001, adjusted R-squared = 0.1818).\n\nHard Drug Use\nThe relationship between hard drug use and change in physical QOL over 2 years depended on adherence to the treatment regiment.\n\n\nHard Drug Use at Low Adherence\nAt low adherence, previous hard drug users had on average a 10.89 point decrease in physical QOL compared to never hard drug users (t = -3.16, p-adjusted = 0.00493, 95% CI: -17.66 to -4.13), but did not differ significantly on change in physical QOL compared to current hard drug users (t = 0.25, p-adjusted = 1.00, 95% CI: -8.59 to 11.08). . Current hard drug users did not differ significantly from never hard drug users at low adherence (t = -2.35, p-adjusted =0.0574, 95% CI: -17.72 to -1.58), although with a larger sample size that could become significant.\n\n\nHard Drug Use at High Adherence\nAt high adherence, current hard drug users had on average a 3.94 point decrease in physical QOL compared to never hard drug users (t = -3.545, p-adjusted = 0.00128, 95% CI: -6.12 to -1.75), and 5.35 points decrease compared to previous hard drug users (t = 3.33, p-adjusted = 0.00279, 95% CI: 2.19 to 8.51). Additionally, previous hard drug users did not differ significantly from never hard drug users at high adherence (t = 1.100, p-adjusted = 0.815, 95% CI: -1.11 to 3.94).\n\n\n\nAdherence\nThe relationship between adherence and change in physical QOL over 2 years depended on hard drug use.\n\nAdherence for Current Hard Drug Users\nFor current hard drug users, those with high adherence had on average an 8.90 point increase in physical QOL compared to those with low adherence (t = 2.22, p = 0.027, 95% CI: 1.00 to 16.79).\n\n\nAdherence for Previous Hard Drug Users\nFor previous hard drug users, those with high adherence to the treatment regiment had on average a 15.49 point increase in physical QOL compared to those with low adherence (t = 4.56, p-adjusted &lt; 0.0001, 95% CI: 8.82 to 22.17).\n\n\nAdherence for Never Hard Drug Users\nFor never hard drug users, those with high adherence had a 3.19 point increase in physical QOL compared to those with low adherence (t = 2.27, p = 0.0239).\n\n\n\nFrailty Related Phenotype\nFrailty related phenotype was a significant predictor of change in physical QOL over 2 years (t = -8.72, p &lt; 0.0001). On average, those with a frailty related phenotype had a 12.76 decrease in physical QOL compared to those without a frailty related phenotype (95% CI: -15.63 to -9.88).\nTop of Tabset\n\n\n\nThe below plot is useful in interpreting the interaction.\n\n# Use interactions package to plot interaction\ncat_plot(\n  model_PHYS_final1, \n  pred = hard_drugs_grp, \n  modx = ADH_HIGHVSLOW, \n  geom = \"line\", \n  colors = \"Pastel2\",\n  x.label = \"Hard Drugs Group\",\n  y.label = \"Predicted Physical QOL Change\")\n\n\n\n\n\n\n\n\nFor those with low adherence, previous users had a greater decrease in physical QOL compared to never users. The difference between current and never hard drug users at low adherence is borderline significant, and may be so with a larger sample size.\nFor those with high adherence, the current hard drug use group had a greater decrease in physical QOL compared to both never and previous hard drug users.\nAnd most importantly, for previous hard drug users, those with low adherence had a decrease in physical QOL when compared to those with high adherence.\nWe take this as further evidence that previous hard drug users are at a vulnerable population. High adherence serves as a buffer and could protect patients that have quit heroin or opiates within the past 2 years.\nAdditionally, we have evidence that even at high adherence, current hard drug users have worse overall physical QOL."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#log-viral-load-1",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#log-viral-load-1",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Log Viral Load",
    "text": "Log Viral Load\n\nLinearityIndependenceNormalityEqual Variances (Homoscedasticity)Residuals Centered Around ZeroSummary\n\n\nSince the mains IVs are categorical, we do not need to evaluate linearity.\nTop of Tabset\n\n\nIndependence can be assessed in part by the study design and how the data was collected. Based on the information provided by the PI, I will assume subjects are independent from each other.\nAdditionally, we can examine a scatter plot of the model’s residuals against any time point variable (such as ID).\n\ndata_VLOAD &lt;- data_wide_2 %&gt;%\n  dplyr::select(newid, VLOAD_log_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW, EDUC_COLLEGE) %&gt;%\n  filter(\n    !is.na(newid) & \n    !is.na(VLOAD_log_CHANGE) &\n    !is.na(hard_drugs_grp) & \n    !is.na(ADH_HIGHVSLOW) & \n    !is.na(EDUC_COLLEGE) \n  )\n\n# Create a scatterplot of jackknife residuals vs ID to assess independence \nggplot(data_VLOAD, aes(x = newid, y = jackknife_residuals_VLOAD)) + \n  geom_point() +\n  geom_hline(yintercept = 0) +\n  labs(title = \"Scatterplot of Jackknife Residuals vs ID for Log Viral Load\",\n       x = \"ID\",\n       y = \"Jackknife Residuals\")\n\n\n\n\n\n\n\n\nWe may have some non-independence as seen by the further spread above 0.\nTop of Tabset\n\n\nHere we will asses that, for any fixed value of X, Y has a normal distribution. We will do this using Q-Q plots and histograms of the residuals.\n\n# Make the Q-Q plots using the jackknife residuals\nqqnorm(jackknife_residuals_VLOAD, main = \"Q-Q plots of Jackknife Residuals for Log Viral Load\")\nqqline(jackknife_residuals_VLOAD, col = \"black\")\n\n\n\n\n\n\n\n# Create histogram of jackknife residuals\nhist(jackknife_residuals_VLOAD, main = \"Histogram of Jackknife Residuals\",\n     breaks = 24,\n     xlab = \"Jackknife Residuals\",\n     col = \"lightblue\",\n     border = \"black\")\n\n\n\n\n\n\n\n\nWe can also include the Shapiro-Wilk test of normality, which provides a p-value and allows us to numerically establish that the assumption of normality is met. If the p-value is &lt; 0.05 you conclude that the assumption of normality is not met.\n\nshapiro.test(jackknife_residuals_VLOAD)\n\n\n    Shapiro-Wilk normality test\n\ndata:  jackknife_residuals_VLOAD\nW = 0.97025, p-value = 0.000000008927\n\n\nWe have some non-normality as seen by the higher end of the Q-Q Plot.\nLooking at the histograms, the pattern is slightly bimodal, and may have some outliers at the high range.\nWe also fail Shapiro-Wilk’s test, indicating non-normality.\nTop of Tabset\n\n\nTo assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_VLOAD, aes(x = hard_drugs_grp, y = jackknife_residuals_VLOAD)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Hard Drug Use for Log Viral Load\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_VLOAD, aes(x = ADH_HIGHVSLOW, y = jackknife_residuals_VLOAD)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Adherence for Log Viral Load\",\n       x = \"Adherence\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n\nIt appears that our hard drug use groups have unequal variances.\nAdditionally, while it is not recommended to perform a statistical test to assess for equality of variances (because formal tests of equality of variance are not very powerful), we can still do this using Bartlett’s test. The null hypothesis of the Bartlett test is that the variances are equal. Thus failing to reject the null (p &gt; 0.05) indicates that the data are consistent with the equal variance assumption.\n\n# Perform Bartlett's test to check for homogeneity of variances\nbartlett.test(VLOAD_log_CHANGE ~ hard_drugs_grp, data = data_VLOAD)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  VLOAD_log_CHANGE by hard_drugs_grp\nBartlett's K-squared = 23.563, df = 2, p-value = 0.000007644\n\n\nWe also do not meet the assumption for equality of variances (p &lt; 0.05).\nThis is likely because our patients were not randomly assigned into these groups!\nTop of Tabset\n\n\nTo start, we can simply check that the mean of our residuals is close to 0.\n\n# Generate the mean of the jackknife residuals. Should be close to 0.\nmean(jackknife_residuals_VLOAD)\n\n[1] 0.0004681325\n\n# Generate vectors containing the fitted values vs jackknife residuals so we can plot them \nfitted_values_VLOAD &lt;- fitted(model_VLOAD_full1)\n\nggplot(data_VLOAD, aes(x = fitted_values_VLOAD, y = jackknife_residuals_VLOAD)) + \n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nWe definitely have outliers present.\nThe mean is close to 0.\nA more sophisticated approach is to plot the fitted values vs jackknife residuals. We can then compare the trend between groups to see if they are random. The fitted line should gravitate around 0 with no obvious trends.\nTop of Tabset\n\n\nTop of Tabset"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#cd4-t-cell-count-3",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#cd4-t-cell-count-3",
    "title": "Advanced Data Analysis - Project 2",
    "section": "CD4+ T Cell Count",
    "text": "CD4+ T Cell Count\n\nLinearityIndependenceNormalityEqual Variances (Homoscedasticity)Residuals Centered Around ZeroSummary\n\n\nWe do not need to assess linearity since our main PEVs are categorical.\nTop of Tabset\n\n\nIndependence can be assessed in part by the study design and how the data was collected. Based on the information provided by the PI, I will assume subjects are independent from each other.\nAdditionally, we can examine a scatter plot of the model’s residuals against any time point variable (such as ID).\n\n# Filter to create same data set as in the final analysis\ndata_LEU3N &lt;- data_wide_2 %&gt;%\n  dplyr::select(newid, LEU3N_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW, FRP_2) %&gt;%\n  filter(\n    !is.na(newid) & \n    !is.na(LEU3N_CHANGE) &\n    !is.na(hard_drugs_grp) & \n    !is.na(ADH_HIGHVSLOW) & \n    !is.na(FRP_2) \n  )\n\n# Create a scatterplot of jackknife residuals vs ID to assess independence \nggplot(data_LEU3N, aes(x = newid, y = jackknife_residuals_LEU3N)) + \n  geom_point() +\n  geom_hline(yintercept = 0) +\n  labs(title = \"Scatterplot of Jackknife Residuals vs ID for CD4+ T Cells\",\n       x = \"ID\",\n       y = \"Jackknife Residuals\")\n\n\n\n\n\n\n\n\nLooks like we have 4 outlier points beyound 3 residuals from 0, but otherwise looking good.\nTop of Tabset\n\n\nHere we will asses that, for any fixed value of X, Y has a normal distribution. We will do this using Q-Q plots and histograms of the residuals.\n\n# Make the Q-Q plots using the jackknife residuals\nqqnorm(jackknife_residuals_LEU3N, main = \"Q-Q plots of Jackknife Residuals for Log Viral Load\")\nqqline(jackknife_residuals_LEU3N, col = \"black\")\n\n\n\n\n\n\n\n# Create histogram of jackknife residuals\nhist(jackknife_residuals_LEU3N, main = \"Histogram of Jackknife Residuals\",\n     breaks = 24,\n     xlab = \"Jackknife Residuals\",\n     col = \"lightblue\",\n     border = \"black\")\n\n\n\n\n\n\n\n\nWe look very normal here, sans some obvious outliers.\n\nshapiro.test(jackknife_residuals_LEU3N)\n\n\n    Shapiro-Wilk normality test\n\ndata:  jackknife_residuals_LEU3N\nW = 0.97052, p-value = 0.00000001042\n\n\nWe have non-normality, but that is due to outliers.\nTop of Tabset\n\n\nTo assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_LEU3N, aes(x = hard_drugs_grp, y = jackknife_residuals_LEU3N)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Hard Drug Use for CD4+ T Cell Count Change\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_LEU3N, aes(x = ADH_HIGHVSLOW, y = jackknife_residuals_LEU3N)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Adherence for CD4+ T Cell Count Change\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n\n\n# Perform Bartlett's test to check for homogeneity of variances\nbartlett.test(LEU3N_CHANGE ~ hard_drugs_grp, data = data_LEU3N)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  LEU3N_CHANGE by hard_drugs_grp\nBartlett's K-squared = 5.8811, df = 2, p-value = 0.05284\n\n\nWe can actually conclude that we have equality of variances! This will look even better once we get rid of outliers.\nTop of Tabset\n\n\nto start, we can simply check that the mean of our residuals is close to 0.\n\n# Generate the mean of the jackknife residuals. Should be close to 0.\nmean(jackknife_residuals_LEU3N)\n\n[1] 0.0004433429\n\n# Generate vectors containing the fitted values vs jackknife residuals so we can plot them \nfitted_values_LEU3N &lt;- fitted(model_LEU3N_final1)\n\nggplot(data_LEU3N, aes(x = fitted_values_LEU3N, y = jackknife_residuals_LEU3N)) + \n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nThe mean is close to 0. The residuals look centered around 0 excepting the outliers.\nTop of Tabset\n\n\nTop of Tabset"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#mental-quality-of-life",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#mental-quality-of-life",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Mental Quality of Life",
    "text": "Mental Quality of Life\n\nLinearityIndependenceNormalityEqual Variances (Homoscedasticity)Residuals Centered Around ZeroSummary\n\n\nWe do not need to assess linearity since our main PEVs are categorical.\nTop of Tabset\n\n\nIndependence can be assessed in part by the study design and how the data was collected. Based on the information provided by the PI, I will assume subjects are independent from each other.\nAdditionally, we can examine a scatter plot of the model’s residuals against any time point variable (such as ID).\n\n# Filter to create same data set as in the final analysis\ndata_MENT_main &lt;- data_wide_2 %&gt;%\n  dplyr::select(newid, AGG_MENT_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW) %&gt;%\n  filter(\n    !is.na(newid) & \n    !is.na(AGG_MENT_CHANGE) &\n    !is.na(hard_drugs_grp) & \n    !is.na(ADH_HIGHVSLOW) \n  )\n\n# Create a scatterplot of jackknife residuals vs ID to assess independence \nggplot(data_MENT_main, aes(x = newid, y = jackknife_residuals_MENT_main)) + \n  geom_point() +\n  geom_hline(yintercept = 0) +\n  labs(title = \"Scatterplot of Jackknife Residuals vs ID for Mental QOL Change\",\n       x = \"ID\",\n       y = \"Jackknife Residuals\")\n\n\n\n\n\n\n\n\nNo clear pattern, we meet the assumption of independence.\nTop of Tabset\n\n\nHere we will asses that, for any fixed value of X, Y has a normal distribution. We will do this using Q-Q plots and histograms of the residuals.\n\n# Make the Q-Q plots using the jackknife residuals\nqqnorm(jackknife_residuals_MENT_main, main = \"Q-Q plots of Jackknife Residuals for Mental QOL Change\")\nqqline(jackknife_residuals_MENT_main, col = \"black\")\n\n\n\n\n\n\n\n# Create histogram of jackknife residuals\nhist(jackknife_residuals_MENT_main, main = \"Histogram of Jackknife Residuals\",\n     breaks = 24,\n     xlab = \"Jackknife Residuals\",\n     col = \"lightblue\",\n     border = \"black\")\n\n\n\n\n\n\n\n\n\nshapiro.test(jackknife_residuals_MENT_main)\n\n\n    Shapiro-Wilk normality test\n\ndata:  jackknife_residuals_MENT_main\nW = 0.96193, p-value = 0.0000000001675\n\n\nWe have non-normality. It does not look like outliers are driving this.\nTop of Tabset\n\n\nTo assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_MENT_main, aes(x = hard_drugs_grp, y = jackknife_residuals_MENT_main)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Hard Drug Use for Mental QOL Change\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_MENT_main, aes(x = ADH_HIGHVSLOW, y = jackknife_residuals_MENT_main)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Adherence for Mental QOL Change\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n\n\n# Perform Bartlett's test to check for homogeneity of variances\nbartlett.test(AGG_MENT_CHANGE ~ hard_drugs_grp, data = data_MENT_main)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  AGG_MENT_CHANGE by hard_drugs_grp\nBartlett's K-squared = 19.522, df = 2, p-value = 0.00005765\n\n\nThe test is significant, and we conclude we do not have homogeneity of variances.\nTop of Tabset\n\n\n\n# Generate the mean of the jackknife residuals. Should be close to 0.\nmean(jackknife_residuals_MENT_main)\n\n[1] 0.0001715436\n\n# Generate vectors containing the fitted values vs jackknife residuals so we can plot them \nfitted_values_MENT_main &lt;- fitted(model_MENT_main1)\n\nggplot(data_MENT_main, aes(x = fitted_values_MENT_main, y = jackknife_residuals_MENT_main)) + \n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nOur residuals look centered around 0, sans a few outlier points.\nTop of Tabset\n\n\nWe have non-normality and non homogeneity of variances.\nTop of Tabset"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#physical-quality-of-life",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#physical-quality-of-life",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Physical Quality of Life",
    "text": "Physical Quality of Life\n\nLinearityIndependenceNormalityEqual Variances (Homoscedasticity)Residuals Centered Around ZeroSummaryResiduals Centered Around ZeroSummary\n\n\nWe do not need to assess linearity since our main PEVs are categorical.\nTop of Tabset\n\n\nIndependence can be assessed in part by the study design and how the data was collected. Based on the information provided by the PI, I will assume subjects are independent from each other.\nAdditionally, we can examine a scatter plot of the model’s residuals against any time point variable (such as ID).\n\n# Filter to create same data set as in the final analysis\ndata_PHYS &lt;- data_wide_2 %&gt;%\n  dplyr::select(newid, AGG_PHYS_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW, FRP_2) %&gt;%\n  filter(\n    !is.na(newid) & \n    !is.na(AGG_PHYS_CHANGE) &\n    !is.na(hard_drugs_grp) & \n    !is.na(ADH_HIGHVSLOW) &\n    !is.na(FRP_2)\n  )\n\n# Create a scatterplot of jackknife residuals vs ID to assess independence \nggplot(data_PHYS, aes(x = newid, y = jackknife_residuals_PHYS)) + \n  geom_point() +\n  geom_hline(yintercept = 0) +\n  labs(title = \"Scatterplot of Jackknife Residuals vs ID for Physical QOL Change\",\n       x = \"ID\",\n       y = \"Jackknife Residuals\")\n\n\n\n\n\n\n\n\nIndependence looks pretty good.\nTop of Tabset\n\n\nHere we will asses that, for any fixed value of X, Y has a normal distribution. We will do this using Q-Q plots and histograms of the residuals.\n\n# Make the Q-Q plots using the jackknife residuals\nqqnorm(jackknife_residuals_PHYS, main = \"Q-Q plots of Jackknife Residuals for Mental QOL Change\")\nqqline(jackknife_residuals_PHYS, col = \"black\")\n\n\n\n\n\n\n\n# Create histogram of jackknife residuals\nhist(jackknife_residuals_PHYS, main = \"Histogram of Jackknife Residuals\",\n     breaks = 24,\n     xlab = \"Jackknife Residuals\",\n     col = \"lightblue\",\n     border = \"black\")\n\n\n\n\n\n\n\nshapiro.test(jackknife_residuals_PHYS)\n\n\n    Shapiro-Wilk normality test\n\ndata:  jackknife_residuals_PHYS\nW = 0.9682, p-value = 0.000000002488\n\n\nPhysical QOL looks mostly normal. There may be 1 outier at the upper and lower bound.\nShapiro Wilk’s does say we fail normality however.\nTop of Tabset\n\n\nTo assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_PHYS, aes(x = hard_drugs_grp, y = jackknife_residuals_PHYS)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Hard Drug Use for Physical QOL Change\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n# Perform Bartlett's test to check for homogeneity of variances\nbartlett.test(AGG_PHYS_CHANGE ~ hard_drugs_grp, data = data_PHYS)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  AGG_PHYS_CHANGE by hard_drugs_grp\nBartlett's K-squared = 4.2398, df = 2, p-value = 0.12\n\n\nWe do have homogeneity of variances for physical QOL.\nTop of Tabset\n\n\n\n# Generate the mean of the jackknife residuals. Should be close to 0.\nmean(jackknife_residuals_PHYS)\n\n[1] 0.0002469251\n\n# Generate vectors containing the fitted values vs jackknife residuals so we can plot them \nfitted_values_PHYS &lt;- fitted(model_PHYS_final1)\n\nggplot(data_PHYS, aes(x = fitted_values_PHYS, y = jackknife_residuals_PHYS)) + \n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nTop of Tabset\n\n\nThe assumptions for CD4+ T cell count are almost met. Likely once removing those 4 or so outliers they would be perfect.\nTop of Tabset\nTo assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_PHYS, aes(x = hard_drugs_grp, y = jackknife_residuals_PHYS)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Hard Drug Use for Physical QOL Change\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_PHYS, aes(x = ADH_HIGHVSLOW, y = jackknife_residuals_PHYS)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Adherence for Physical QOL Change\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n\n\n# Perform Bartlett's test to check for homogeneity of variances\nbartlett.test(AGG_PHYS_CHANGE ~ hard_drugs_grp, data = data_PHYS)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  AGG_PHYS_CHANGE by hard_drugs_grp\nBartlett's K-squared = 4.2398, df = 2, p-value = 0.12\n\n\nWe do have homogeneity of variances.\n\n\n\n# Generate the mean of the jackknife residuals. Should be close to 0.\nmean(jackknife_residuals_PHYS)\n\n[1] 0.0002469251\n\n# Generate vectors containing the fitted values vs jackknife residuals so we can plot them \nfitted_values_PHYS &lt;- fitted(model_PHYS_final1)\n\nggplot(data_PHYS, aes(x = fitted_values_PHYS, y = jackknife_residuals_PHYS)) + \n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nThe residuals appear centered around zero, for the most part.\n\n\nWe do not meet the assumption of normality for physical QOL."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#descriptive-statistics-filter",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#descriptive-statistics-filter",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Descriptive Statistics Filter",
    "text": "Descriptive Statistics Filter\nFiltered table 1 based on variables used in final models, dropping extraneous variables.\n\n# Create Table 1 for the wideform data set,stratified by hard drug use group\ntable1 &lt;- table1(~RACE_WHITEYN + EDUC_COLLEGE + age_0 + FRP_2 + CESD_0 + ADH_HIGHVSLOW + AGG_MENT_CHANGE + AGG_PHYS_CHANGE + VLOAD_log_CHANGE + LEU3N_CHANGE| hard_drugs_grp, data = data_wide_2, caption = \"Descriptive Statistics at Baseline\", overall = c(left=\"Total\"))\ntable1\n\n\n\nDescriptive Statistics at Baseline\n\n\n\n\n\n\n\n\n\n\nTotal\n(N=550)\nCurrent User\n(N=60)\nPrevious User\n(N=46)\nNever User\n(N=444)\n\n\n\n\nRace\n\n\n\n\n\n\nNon-White\n186 (33.8%)\n18 (30.0%)\n26 (56.5%)\n142 (32.0%)\n\n\nWhite\n340 (61.8%)\n42 (70.0%)\n14 (30.4%)\n284 (64.0%)\n\n\nMissing\n24 (4.4%)\n0 (0%)\n6 (13.0%)\n18 (4.1%)\n\n\nCollege Status\n\n\n\n\n\n\nNo College\n125 (22.7%)\n8 (13.3%)\n24 (52.2%)\n93 (20.9%)\n\n\nCollege\n425 (77.3%)\n52 (86.7%)\n22 (47.8%)\n351 (79.1%)\n\n\nAge\n\n\n\n\n\n\nMean (SD)\n43.4 (8.80)\n44.5 (6.63)\n44.5 (10.8)\n43.2 (8.83)\n\n\nMedian [Min, Max]\n43.0 [20.0, 73.0]\n47.0 [32.0, 55.0]\n49.0 [29.0, 61.0]\n43.0 [20.0, 73.0]\n\n\nFRP_2\n\n\n\n\n\n\nNo\n518 (94.2%)\n54 (90.0%)\n44 (95.7%)\n420 (94.6%)\n\n\nYes\n30 (5.5%)\n6 (10.0%)\n2 (4.3%)\n22 (5.0%)\n\n\nMissing\n2 (0.4%)\n0 (0%)\n0 (0%)\n2 (0.5%)\n\n\nCESD Depression Score\n\n\n\n\n\n\nMean (SD)\n14.3 (11.6)\n13.4 (10.2)\n21.7 (7.59)\n13.6 (11.9)\n\n\nMedian [Min, Max]\n11.0 [0, 51.0]\n9.00 [1.00, 30.0]\n21.0 [10.0, 32.0]\n10.0 [0, 51.0]\n\n\nMissing\n16 (2.9%)\n6 (10.0%)\n0 (0%)\n10 (2.3%)\n\n\nADH_HIGHVSLOW\n\n\n\n\n\n\nHigh Adherence\n495 (90.0%)\n56 (93.3%)\n40 (87.0%)\n399 (89.9%)\n\n\nLow Adherence\n43 (7.8%)\n4 (6.7%)\n6 (13.0%)\n33 (7.4%)\n\n\nMissing\n12 (2.2%)\n0 (0%)\n0 (0%)\n12 (2.7%)\n\n\nAggregate Mental QOL Change Score\n\n\n\n\n\n\nMean (SD)\n2.13 (12.3)\n-0.0301 (10.5)\n2.55 (17.7)\n2.39 (11.8)\n\n\nMedian [Min, Max]\n1.31 [-38.2, 41.1]\n0.328 [-25.0, 18.6]\n2.91 [-31.1, 28.2]\n1.31 [-38.2, 41.1]\n\n\nMissing\n7 (1.3%)\n0 (0%)\n0 (0%)\n7 (1.6%)\n\n\nAggregate Physical QOL Change Score\n\n\n\n\n\n\nMean (SD)\n-1.86 (8.51)\n-6.20 (7.01)\n-1.55 (9.07)\n-1.30 (8.49)\n\n\nMedian [Min, Max]\n-1.54 [-37.7, 32.1]\n-4.37 [-24.9, 6.01]\n0.223 [-16.1, 12.8]\n-0.906 [-37.7, 32.1]\n\n\nMissing\n7 (1.3%)\n0 (0%)\n0 (0%)\n7 (1.6%)\n\n\nLog Viral Load Change Score\n\n\n\n\n\n\nMean (SD)\n-6.10 (2.87)\n-5.49 (1.94)\n-5.30 (3.82)\n-6.27 (2.84)\n\n\nMedian [Min, Max]\n-6.35 [-12.8, 7.59]\n-5.03 [-8.92, 1.21]\n-5.47 [-12.7, 0.0354]\n-6.45 [-12.8, 7.59]\n\n\nMissing\n18 (3.3%)\n0 (0%)\n0 (0%)\n18 (4.1%)\n\n\nCD4+ T Cell Count Change Score\n\n\n\n\n\n\nMean (SD)\n161 (189)\n60.3 (219)\n114 (202)\n180 (178)\n\n\nMedian [Min, Max]\n169 [-510, 1270]\n18.4 [-269, 478]\n142 [-224, 415]\n177 [-510, 1270]\n\n\nMissing\n18 (3.3%)\n0 (0%)\n0 (0%)\n18 (4.1%)"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#mental-qol",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#mental-qol",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Mental QOL",
    "text": "Mental QOL\n\n# Get rid of that value of 1 for adherence at baseline for patient 426\ndata$ADH[data$years == 0] &lt;- NA\n\n# Get means for each year\nsummary_data &lt;- data %&gt;%\n  group_by(ADH, years) %&gt;%\n  summarize(Average_QOL = mean(AGG_MENT, na.rm = TRUE))\n\n`summarise()` has grouped output by 'ADH'. You can override using the `.groups`\nargument.\n\n# Create plot\np &lt;- ggplot(summary_data, aes(x = years, y = Average_QOL, color = ADH)) +\n  geom_line(size = 1) +   # Line plot\n  geom_point(size = 2) +  # Add points for clarity\n  labs(title = \"Average Mental QOL Score by Adherence Group Over 8 Years\",\n       x = \"Year\",\n       y = \"Average Mental QOL Score\",\n       color = \"Adherence Group\") +\n  theme_minimal() +       # Clean theme\n  scale_color_brewer(palette = \"Pastel2\")  # Nice color palette for groups\n\nggplotly(p)\n\n\n\n\n\nSuccess! This is very interesting. It appears that the 100% adherence group has the highest average mental QOL score across the 8 year study, followed by the 95-99% group, followed by the &lt;75% group and followed by (with some variation) the &lt;75% and 75-94% groups."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#physical-qol",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#physical-qol",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Physical QOL",
    "text": "Physical QOL\nLet’s do the same thing but for AGG_PHYS.\n\n# Get means for each year\nsummary_data &lt;- data %&gt;%\n  group_by(ADH, years) %&gt;%\n  summarize(Average_QOL = mean(AGG_PHYS, na.rm = TRUE))\n\n`summarise()` has grouped output by 'ADH'. You can override using the `.groups`\nargument.\n\n# Create plot\nggplot(summary_data, aes(x = years, y = Average_QOL, color = ADH)) +\n  geom_line(size = 1) +   # Line plot\n  geom_point(size = 2) +  # Add points for clarity\n  labs(title = \"Average Physical QOL Score by Adherence Group Over 8 Years\",\n       x = \"Year\",\n       y = \"Average Physical QOL Score\",\n       color = \"Adherence Group\") +\n  theme_minimal() +       # Clean theme\n  scale_color_brewer(palette = \"Pastel2\")  # Nice color palette for groups\n\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_line()`).\n\n\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nWe see a similiar relationship here, though there’s more variation. For some reason that &lt;75% group likes to spike in their QOL at year 7. Interesting."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#log-viral-load-3",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#log-viral-load-3",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Log Viral Load",
    "text": "Log Viral Load\n\n# Get means for each year\nsummary_data &lt;- data %&gt;%\n  group_by(ADH, years) %&gt;%\n  summarize(Average_LEU3N = mean(LEU3N, na.rm = TRUE))\n\n`summarise()` has grouped output by 'ADH'. You can override using the `.groups`\nargument.\n\n# Create plot\np &lt;- ggplot(summary_data, aes(x = years, y = Average_LEU3N, color = ADH)) +\n  geom_line(size = 1) +   # Line plot\n  geom_point(size = 2) +  # Add points for clarity\n  labs(title = \"Average LEU3N  by Adherence Group Over 8 Years\",\n       x = \"Year\",\n       y = \"Average LEU3N\",\n       color = \"Adherence Group\") +\n  theme_minimal() +       # Clean theme\n  scale_color_brewer(palette = \"Pastel2\")  # Nice color palette for groups\n\nggplotly(p)"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#cd4-t-cell-count-5",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#cd4-t-cell-count-5",
    "title": "Advanced Data Analysis - Project 2",
    "section": "CD4+ T Cell Count",
    "text": "CD4+ T Cell Count\n\n# Create log vload variable for original 8 year data set.\ndata$VLOAD_log &lt;- log(data$VLOAD)\n\n# Get means for each year\nsummary_data &lt;- data %&gt;%\n  group_by(ADH, years) %&gt;%\n  summarize(Average_VLOAD_log = mean(VLOAD_log, na.rm = TRUE))\n\n`summarise()` has grouped output by 'ADH'. You can override using the `.groups`\nargument.\n\n# Create plot\np &lt;- ggplot(summary_data, aes(x = years, y = Average_VLOAD_log, color = ADH)) +\n  geom_line(size = 1) +   # Line plot\n  geom_point(size = 2) +  # Add points for clarity\n  labs(title = \"Average VLOAD log by Adherence Group Over 8 Years\",\n       x = \"Year\",\n       y = \"Average VLOAD log\",\n       color = \"Adherence Group\") +\n  theme_minimal() +       # Clean theme\n  scale_color_brewer(palette = \"Pastel2\")  # Nice color palette for groups\n\nggplotly(p)\n\n\n\n\n\nThat’s very interesting. The groups with the highest vload log had the least adherence. There is an inverse relationship here.\nThis is strong evidence that the treatment is efficacious and the ADH should be considered as a confounder.\nOhhhhh, that’s super cool. So there is an inverse relationship between LEU3N and VLOAD_log, such that spikes in one should be dips in the other. We can see that in this data set! It appears that for the adherence group of &lt;75%, they had viral load spikes at years 5 and 7, which correspond with leukocyte dips at years 5 and 7! They weren’t adhering to the protocol, which resulted in them getting infected (?) more and having more of the virus present compared to the other groups."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2_Submission.html#comparing-high-vs-low-adherence-groups",
    "href": "Project_2/Project_2_R/Code/Project2_Submission.html#comparing-high-vs-low-adherence-groups",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Comparing High Vs Low Adherence Groups",
    "text": "Comparing High Vs Low Adherence Groups\n\ndata$ADH_HIGHLOW &lt;- ifelse(data$ADH == \"&lt;75%\" | data$ADH == \"75-94%\", 0, 1)\n\ndata$ADH_HIGHLOW &lt;- factor(data$ADH_HIGHLOW,\n                           levels = c(0,1),\n                           labels = c(\"Low Adherence\", \"High Adherence\"))\n\n#### tRY WITH HIGH LOW ADH\n# Create log vload variable for original 8 year data set.\ndata$VLOAD_log &lt;- log(data$VLOAD)\n\n# Get means for each year\nsummary_data &lt;- data %&gt;%\n  group_by(ADH_HIGHLOW, years) %&gt;%\n  summarize(Average_VLOAD_log = mean(VLOAD_log, na.rm = TRUE))\n\n`summarise()` has grouped output by 'ADH_HIGHLOW'. You can override using the\n`.groups` argument.\n\n# Create plot\np &lt;- ggplot(summary_data, aes(x = years, y = Average_VLOAD_log, color = ADH_HIGHLOW)) +\n  geom_line(size = 1) +   # Line plot\n  geom_point(size = 2) +  # Add points for clarity\n  labs(title = \"Average VLOAD log by Adherence Group Over 8 Years\",\n       x = \"Year\",\n       y = \"Average VLOAD log\",\n       color = \"Adherence Group\") +\n  theme_minimal() +       # Clean theme\n  scale_color_brewer(palette = \"Pastel2\")  # Nice color palette for groups\n\nggplotly(p)\n\n\n\n\n\nHigh adherence patients have lower viral load then low adherence\nSame for leu3n\n\n#### tRY WITH HIGH LOW ADH\n\n# Get means for each year\nsummary_data &lt;- data %&gt;%\n  group_by(ADH_HIGHLOW, years) %&gt;%\n  summarize(Average_LEU3N = mean(LEU3N, na.rm = TRUE))\n\n`summarise()` has grouped output by 'ADH_HIGHLOW'. You can override using the\n`.groups` argument.\n\n# Create plot\np &lt;- ggplot(summary_data, aes(x = years, y = Average_LEU3N, color = ADH_HIGHLOW)) +\n  geom_line(size = 1) +   # Line plot\n  geom_point(size = 2) +  # Add points for clarity\n  labs(title = \"Average LEU3N by Adherence Group Over 8 Years\",\n       x = \"Year\",\n       y = \"Average LEU3N\",\n       color = \"Adherence Group\") +\n  theme_minimal() +       # Clean theme\n  scale_color_brewer(palette = \"Pastel2\")  # Nice color palette for groups\n\nggplotly(p)\n\n\n\n\n\nHigh adherence users have higher CD4+ T Cells, for the most part."
  },
  {
    "objectID": "Project_1_Regression/Project_1_Regression_SAS/untitled.html",
    "href": "Project_1_Regression/Project_1_Regression_SAS/untitled.html",
    "title": "Quarto stuff",
    "section": "",
    "text": "Quarto stuff\nblah blah blah"
  },
  {
    "objectID": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html",
    "href": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html",
    "title": "Advanced Data Analysis - Project 1",
    "section": "",
    "text": "The aim of the current study is to assess whether a new gel treatment for gum disease results in lower whole-mouth average pocket depth and attachment loss after one year. Average pocket depth and attachment loss were taken at baseline, and participants were assigned into one of five groups (1 = placebo, 2 = no treatment, 3 = low concentration, 4 = medium concentration, 5 = high concentration) and instructed to apply the gel to their gums twice a day. After 1-year, average pocket depth and attachment loss were recorded again. Data was received as a .csv file containing treatment level, average pocket depth and attachment loss at baseline and at one-year, demographic information, gender, age, number of sites measured, and smoking status. The clinical hypothesis is that average pocket depth and attachment loss in participants who applied the gel will be lower compared to participants who did not. Gender, age, ethnicity, and smoking status will be investigated as potential covariates.\nThe project description provided by the PI is available below:\n\n\n\nFirst we begin by loading in the necessary packages\n\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(knitr)\nlibrary(kableExtra) # This lets me pretty print the tables\nlibrary(naniar) # Used to visualize missing data\nlibrary(glue) # This is used for f-strings in R\nlibrary(purrr) # Used for summary tables\nlibrary(corrplot) # Used to make the correlation matrix\nlibrary(corrtable) # used to make the table for the correlation matrix\nlibrary(xtable) # Used to make the table for the correlation matrix\nlibrary(htmlTable) # Used to make Table 1\nlibrary(boot) # Used to make Table 1\nlibrary(table1) # Used to make Table 1\nlibrary(sjPlot) # Used to generate publication quality tables for regressions\nlibrary(mice) # Used for multiple imputation\nlibrary(car) # Used for outlier diagnostics with jackknife residuals\n\nThen we will import the dataset\n\n# Import dataset\ndata &lt;- read.csv(\"C:\\\\Users\\\\sviea\\\\Documents\\\\Advanced Data Analysis\\\\Project 1 MLR with Covariates\\\\Project1_data.csv\")\nnames(data)[1] &lt;- \"id\" # Renaming the weird character out of this colname\n\nAnd visualize the dataset\n\n# Create a nicely formatted table, code adapted from ChatGPT\nkable(head(data), format = \"html\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"))\n\n\n\n\nid\ntrtgroup\ngender\nrace\nage\nsmoker\nsites\nattachbase\nattach1year\npdbase\npd1year\n\n\n\n\n101\n4\n2\n5\n44.57221\n1\n162\n2.432099\n2.577640\n3.246914\n3.407407\n\n\n102\n5\n2\n5\n35.57290\n1\n162\n2.543210\nNA\n3.006173\nNA\n\n\n103\n2\n2\n5\n47.94524\n1\n144\n2.881944\n3.076389\n3.118056\n3.125000\n\n\n104\n3\n2\n5\n55.17864\n1\n138\n4.956522\n5.304348\n5.217391\n4.891304\n\n\n105\n1\n2\n2\n43.79740\n1\n168\n1.773810\n1.452381\n3.363095\n2.898810\n\n\n106\n4\n2\n5\n42.14921\n1\n168\n2.369048\n1.922619\n3.910714\n3.083333\n\n\n\n\n\n\n# Acquire number of variables and observations of the data set\ndim(data)\n\n[1] 130  11\n\n\nOur data set is comprised of 130 observations, with 11 variables\n\n\nThe variables in the provided data set are as follows:\n\nid: Patient ID\ntrtgroup: Treatment group (1 = placebo, 2 = no treatment control, 3 = low concentration, 4 = medium concentration, 5 = high concentration gel)\ngender: Gender (1 = male, 2 = female)\nrace: Race, (1 = Native American, 2 = African American, 3 = Not used, 4 = Asian, 5 = White)\nage: Age in years\nsmoker: Smoking status (0 = No, 1 = Yes)\nsites: Number of sites gum measurements were averaged from\nattachbase: Whole-mouth average attachment loss taken at base timepoint\nattach1year: Whole-mouth average attachment loss after 1 year\npdbase: Whole-mouth average pocket loss at base timepoint\npd1year: Whole-mouth average pocket loss after 1 year\n\n\n\n\n\n\n\nNote\n\n\n\nPocket depth and attachment loss are both measurements of how far the gums have pulled away from the teeth, hence smaller values are better"
  },
  {
    "objectID": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#data-preparation",
    "href": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#data-preparation",
    "title": "Advanced Data Analysis - Project 1",
    "section": "",
    "text": "First we begin by loading in the necessary packages\n\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(knitr)\nlibrary(kableExtra) # This lets me pretty print the tables\nlibrary(naniar) # Used to visualize missing data\nlibrary(glue) # This is used for f-strings in R\nlibrary(purrr) # Used for summary tables\nlibrary(corrplot) # Used to make the correlation matrix\nlibrary(corrtable) # used to make the table for the correlation matrix\nlibrary(xtable) # Used to make the table for the correlation matrix\nlibrary(htmlTable) # Used to make Table 1\nlibrary(boot) # Used to make Table 1\nlibrary(table1) # Used to make Table 1\nlibrary(sjPlot) # Used to generate publication quality tables for regressions\nlibrary(mice) # Used for multiple imputation\nlibrary(car) # Used for outlier diagnostics with jackknife residuals\n\nThen we will import the dataset\n\n# Import dataset\ndata &lt;- read.csv(\"C:\\\\Users\\\\sviea\\\\Documents\\\\Advanced Data Analysis\\\\Project 1 MLR with Covariates\\\\Project1_data.csv\")\nnames(data)[1] &lt;- \"id\" # Renaming the weird character out of this colname\n\nAnd visualize the dataset\n\n# Create a nicely formatted table, code adapted from ChatGPT\nkable(head(data), format = \"html\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"))\n\n\n\n\nid\ntrtgroup\ngender\nrace\nage\nsmoker\nsites\nattachbase\nattach1year\npdbase\npd1year\n\n\n\n\n101\n4\n2\n5\n44.57221\n1\n162\n2.432099\n2.577640\n3.246914\n3.407407\n\n\n102\n5\n2\n5\n35.57290\n1\n162\n2.543210\nNA\n3.006173\nNA\n\n\n103\n2\n2\n5\n47.94524\n1\n144\n2.881944\n3.076389\n3.118056\n3.125000\n\n\n104\n3\n2\n5\n55.17864\n1\n138\n4.956522\n5.304348\n5.217391\n4.891304\n\n\n105\n1\n2\n2\n43.79740\n1\n168\n1.773810\n1.452381\n3.363095\n2.898810\n\n\n106\n4\n2\n5\n42.14921\n1\n168\n2.369048\n1.922619\n3.910714\n3.083333\n\n\n\n\n\n\n# Acquire number of variables and observations of the data set\ndim(data)\n\n[1] 130  11\n\n\nOur data set is comprised of 130 observations, with 11 variables\n\n\nThe variables in the provided data set are as follows:\n\nid: Patient ID\ntrtgroup: Treatment group (1 = placebo, 2 = no treatment control, 3 = low concentration, 4 = medium concentration, 5 = high concentration gel)\ngender: Gender (1 = male, 2 = female)\nrace: Race, (1 = Native American, 2 = African American, 3 = Not used, 4 = Asian, 5 = White)\nage: Age in years\nsmoker: Smoking status (0 = No, 1 = Yes)\nsites: Number of sites gum measurements were averaged from\nattachbase: Whole-mouth average attachment loss taken at base timepoint\nattach1year: Whole-mouth average attachment loss after 1 year\npdbase: Whole-mouth average pocket loss at base timepoint\npd1year: Whole-mouth average pocket loss after 1 year\n\n\n\n\n\n\n\nNote\n\n\n\nPocket depth and attachment loss are both measurements of how far the gums have pulled away from the teeth, hence smaller values are better"
  },
  {
    "objectID": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#Descriptives",
    "href": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#Descriptives",
    "title": "Advanced Data Analysis - Project 1",
    "section": "Descriptive Statistics",
    "text": "Descriptive Statistics\nHere we will acquire the descriptive statistics of our data set and create Table 1. Code modified from cran.r-project.org\n\n# Duplicate the dataset so we are not modifying the original\ndata2 &lt;- data\n\n# Factor the basic variables that we're interested in\ndata2$trtgroup &lt;- factor(data2$trtgroup,\n                                levels = c(1,2,3,4,5),\n                                labels = c(\"Placebo\", \"Control\", \"Low\", \"Medium\", \"High\"))\n\ndata2$gender &lt;- factor(data2$gender,\n                              levels = c(1,2),\n                              labels = c(\"Male\", \"Female\"))\n\ndata2$race &lt;- factor(data2$race,\n                             levels = c(1,2,4,5),\n                             labels = c(\"Native American\", \"African American\", \"White\", \"Asian\"))\n                             \ndata2$smoker &lt;- factor(data2$smoker,\n                               levels = c(0,1),\n                               labels = c(\"Non-Smoker\", \"Smoker\"))\n\n# Create labels to make the names of each variable more professional\nlabel(data2$gender) &lt;- \"Gender\"\nlabel(data2$race) &lt;- \"Race\"\nlabel(data2$age) &lt;- \"Age (Years)\"\nlabel(data2$smoker) &lt;- \"Smoking Status\"\nlabel(data2$sites) &lt;- \"Sites\"\nlabel(data2$attachbase) &lt;- \"Attachment Loss at Baseline\"\nlabel(data2$attach1year) &lt;- \"Attachment Loss at 1 Year\"\nlabel(data2$pdbase) &lt;- \"Pocket Depth at Baseline\"\nlabel(data2$pd1year) &lt;- \"Pocket Depth at 1 Year\"\nlabel(data2$attachchange) &lt;- \"Attachment Loss Change\"\nlabel(data2$pdchange) &lt;- \"Pocket Depth Change\"\n\n\n# Create table 1\ntable1 &lt;- table1(~ gender + race + age + smoker + sites + attachbase + attach1year + pdbase + pd1year + attachchange + pdchange| trtgroup,  data = data2, caption = \"Descriptive Statistics\", overall = c(left=\"Total\"))\ntable1\n\n\n\nDescriptive Statistics\n\n\n\n\n\n\n\n\n\n\n\n\nTotal\n(N=130)\nPlacebo\n(N=26)\nControl\n(N=26)\nLow\n(N=26)\nMedium\n(N=26)\nHigh\n(N=26)\n\n\n\n\nGender\n\n\n\n\n\n\n\n\nMale\n54 (41.5%)\n11 (42.3%)\n10 (38.5%)\n11 (42.3%)\n11 (42.3%)\n11 (42.3%)\n\n\nFemale\n76 (58.5%)\n15 (57.7%)\n16 (61.5%)\n15 (57.7%)\n15 (57.7%)\n15 (57.7%)\n\n\nRace\n\n\n\n\n\n\n\n\nNative American\n4 (3.1%)\n0 (0%)\n1 (3.8%)\n1 (3.8%)\n0 (0%)\n2 (7.7%)\n\n\nAfrican American\n9 (6.9%)\n2 (7.7%)\n1 (3.8%)\n5 (19.2%)\n0 (0%)\n1 (3.8%)\n\n\nWhite\n3 (2.3%)\n1 (3.8%)\n1 (3.8%)\n0 (0%)\n1 (3.8%)\n0 (0%)\n\n\nAsian\n114 (87.7%)\n23 (88.5%)\n23 (88.5%)\n20 (76.9%)\n25 (96.2%)\n23 (88.5%)\n\n\nAge (Years)\n\n\n\n\n\n\n\n\nMean (SD)\n49.9 (10.0)\n47.1 (8.61)\n50.7 (9.90)\n51.9 (10.8)\n49.0 (9.49)\n50.8 (11.2)\n\n\nMedian [Min, Max]\n48.6 [28.6, 74.5]\n44.7 [30.4, 67.1]\n49.2 [36.1, 73.3]\n51.5 [36.9, 71.9]\n48.1 [28.6, 70.9]\n49.9 [34.1, 74.5]\n\n\nMissing\n1 (0.8%)\n1 (3.8%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n\n\nSmoking Status\n\n\n\n\n\n\n\n\nNon-Smoker\n81 (62.3%)\n15 (57.7%)\n17 (65.4%)\n18 (69.2%)\n14 (53.8%)\n17 (65.4%)\n\n\nSmoker\n48 (36.9%)\n11 (42.3%)\n9 (34.6%)\n8 (30.8%)\n11 (42.3%)\n9 (34.6%)\n\n\nMissing\n1 (0.8%)\n0 (0%)\n0 (0%)\n0 (0%)\n1 (3.8%)\n0 (0%)\n\n\nSites\n\n\n\n\n\n\n\n\nMean (SD)\n158 (11.3)\n160 (10.1)\n154 (10.9)\n161 (8.54)\n155 (15.7)\n157 (9.65)\n\n\nMedian [Min, Max]\n162 [114, 168]\n162 [138, 168]\n159 [126, 168]\n162 [138, 168]\n162 [114, 168]\n159 [138, 168]\n\n\nAttachment Loss at Baseline\n\n\n\n\n\n\n\n\nMean (SD)\n2.15 (0.797)\n1.79 (0.646)\n2.46 (0.687)\n2.07 (0.987)\n2.17 (0.656)\n2.24 (0.858)\n\n\nMedian [Min, Max]\n2.03 [0.895, 5.09]\n1.71 [0.899, 3.64]\n2.48 [1.22, 4.39]\n1.77 [0.895, 4.96]\n2.12 [1.02, 4.01]\n1.97 [1.26, 5.09]\n\n\nAttachment Loss at 1 Year\n\n\n\n\n\n\n\n\nMean (SD)\n2.10 (0.772)\n1.74 (0.542)\n2.33 (0.551)\n2.08 (1.06)\n2.24 (0.652)\n2.15 (0.915)\n\n\nMedian [Min, Max]\n1.98 [0.865, 5.30]\n1.64 [0.964, 3.10]\n2.23 [1.46, 3.49]\n1.74 [0.865, 5.30]\n2.25 [1.35, 3.83]\n1.71 [1.22, 4.04]\n\n\nMissing\n27 (20.8%)\n3 (11.5%)\n3 (11.5%)\n5 (19.2%)\n6 (23.1%)\n10 (38.5%)\n\n\nPocket Depth at Baseline\n\n\n\n\n\n\n\n\nMean (SD)\n3.14 (0.437)\n3.09 (0.372)\n3.28 (0.473)\n3.17 (0.593)\n3.05 (0.402)\n3.11 (0.273)\n\n\nMedian [Min, Max]\n3.10 [2.26, 5.22]\n3.11 [2.47, 4.08]\n3.11 [2.65, 4.77]\n3.07 [2.26, 5.22]\n3.09 [2.42, 3.91]\n3.14 [2.62, 3.60]\n\n\nPocket Depth at 1 Year\n\n\n\n\n\n\n\n\nMean (SD)\n2.88 (0.488)\n2.75 (0.482)\n2.95 (0.455)\n3.02 (0.578)\n2.84 (0.469)\n2.80 (0.423)\n\n\nMedian [Min, Max]\n2.90 [1.96, 4.89]\n2.70 [1.96, 3.75]\n2.90 [2.24, 4.07]\n2.97 [2.16, 4.89]\n2.90 [2.05, 3.78]\n2.87 [2.04, 3.40]\n\n\nMissing\n27 (20.8%)\n3 (11.5%)\n3 (11.5%)\n5 (19.2%)\n6 (23.1%)\n10 (38.5%)\n\n\nAttachment Loss Change\n\n\n\n\n\n\n\n\nMean (SD)\n-0.0995 (0.276)\n-0.0871 (0.242)\n-0.222 (0.280)\n-0.0178 (0.266)\n-0.00656 (0.231)\n-0.165 (0.326)\n\n\nMedian [Min, Max]\n-0.0679 [-1.05, 0.452]\n-0.0247 [-0.599, 0.452]\n-0.123 [-0.901, 0.194]\n0.0298 [-0.705, 0.348]\n-0.0160 [-0.446, 0.339]\n-0.0579 [-1.05, 0.199]\n\n\nMissing\n27 (20.8%)\n3 (11.5%)\n3 (11.5%)\n5 (19.2%)\n6 (23.1%)\n10 (38.5%)\n\n\nPocket Depth Change\n\n\n\n\n\n\n\n\nMean (SD)\n-0.294 (0.268)\n-0.350 (0.277)\n-0.338 (0.232)\n-0.206 (0.279)\n-0.203 (0.272)\n-0.382 (0.245)\n\n\nMedian [Min, Max]\n-0.284 [-0.858, 0.455]\n-0.383 [-0.858, 0.161]\n-0.367 [-0.759, 0.0145]\n-0.244 [-0.661, 0.455]\n-0.200 [-0.827, 0.175]\n-0.347 [-0.845, 0.0536]\n\n\nMissing\n27 (20.8%)\n3 (11.5%)\n3 (11.5%)\n5 (19.2%)\n6 (23.1%)\n10 (38.5%)"
  },
  {
    "objectID": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#Preliminary",
    "href": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#Preliminary",
    "title": "Advanced Data Analysis - Project 1",
    "section": "Preliminary Evaluation of Assumptions",
    "text": "Preliminary Evaluation of Assumptions\nBefore we begin digging into the data, let’s take a closer look at the relationships between our variables.\nWe will first run a correlation matrix to assess the correlations between our IVs. Then we will explore any high correlations that which could affect our analysis.\nFinally we will make histograms of attachment loss and pocket depth change to gauge whether they will be normally distributed or if we need to run some transformations.\n\nCorrelation MatrixGender and MissingnessNormality of Dependent Variables\n\n\nFirst we will begin by making a correlation matrix to assess whether any of our IVs are related to each other (multicollinearity). This will inform which variables to incorporate into the final model.\n\n# Since we made dummy codes, we will get spurious correlations that will obfuscate the main relationships we are interested in (e.g. between 'medium' and 'trtgroup'. So we will first make a separate dataset excluding the dummy coded variables\ndata_for_matrix &lt;- select(data_missing, -placebo, -control, -low, -medium,  -high, -trt, -trt3groups)\n\n# Make a correlation matrix with all variables of the trimmed data set\ncorrelation_matrix &lt;- cor(data_for_matrix, use = \"complete.obs\")\n\n# Plot the matrix\ncorrplot(correlation_matrix, method = \"circle\")\n\n\n\n\n\n\n\n# Trim the matrix\ncorrelation_matrix[upper.tri(correlation_matrix)] &lt;- NA\n\n# Save the matrix as a LaTex file for paper\ncor_table &lt;- xtable(correlation_matrix, caption = \"Correlation Matrix\", label = \"tab:correlation\")\nprint(cor_table, type = \"latex\", file = \"correlation_matrix999.tex\")\n\nkable(correlation_matrix, format = \"html\", table.attr = \"class='table table-bordered'\")\n\n\n\n\n\nid\ntrtgroup\ngender\nrace\nage\nsmoker\nsites\nattachbase\nattach1year\npdbase\npd1year\nattachchange\npdchange\n\n\n\n\nid\n1.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\ntrtgroup\n-0.1452850\n1.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\ngender\n-0.8306185\n0.1428866\n1.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nrace\n0.1319767\n-0.0314771\n-0.0955531\n1.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nage\n0.0593032\n0.1100051\n-0.0453862\n0.1787040\n1.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nsmoker\n-0.2742888\n-0.0495029\n0.0206456\n0.0377211\n-0.2229620\n1.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nsites\n0.0520821\n-0.0393742\n-0.1291127\n0.0505164\n-0.0274695\n-0.0226381\n1.0000000\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nattachbase\n-0.1641513\n0.1440999\n0.2416242\n0.0313438\n0.1354434\n0.1456234\n-0.4237813\n1.0000000\nNA\nNA\nNA\nNA\nNA\n\n\nattach1year\n-0.1440182\n0.1671499\n0.2021284\n0.0671713\n0.0850851\n0.1987327\n-0.4042743\n0.9450189\n1.0000000\nNA\nNA\nNA\nNA\n\n\npdbase\n-0.2010672\n-0.0224838\n0.2645908\n0.0182289\n-0.0884687\n0.2614919\n-0.1805543\n0.6047132\n0.6093346\n1.0000000\nNA\nNA\nNA\n\n\npd1year\n-0.0685783\n0.0126731\n0.1362804\n0.0606735\n-0.1246106\n0.2447030\n-0.1901940\n0.5601052\n0.6685457\n0.8436653\n1.0000000\nNA\nNA\n\n\nattachchange\n0.0964391\n0.0296043\n-0.1696216\n0.0928969\n-0.1742586\n0.1135740\n0.1578683\n-0.3976360\n-0.0757224\n-0.1342018\n0.1679506\n1.0000000\nNA\n\n\npdchange\n0.2251487\n0.0622762\n-0.2123192\n0.0789059\n-0.0731704\n-0.0091784\n-0.0323859\n-0.0317726\n0.1579534\n-0.2031295\n0.3543035\n0.5400668\n1\n\n\n\n\n\n\n\nVisually, we can see a cluster of high positive correlations between all of attachment loss and pocket depth at baseline and 1 year. This makes sense, as all measurements were taken from the same sites in the gums. This will be explored later (See Exploratory Data Analysis - Dependent Variables)\nJust for sanity (and practice), let’s make a table of our correlation coefficients.\n\n# Convert the matrix to a dataframe for better formatting\ncorrelation_df &lt;- as.data.frame(correlation_matrix)\n\n# Use Kable to pretty print the table\nkable(correlation_df, caption = \"Correlation Matrix\", format = \"html\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"))\n\n\nCorrelation Matrix\n\n\n\nid\ntrtgroup\ngender\nrace\nage\nsmoker\nsites\nattachbase\nattach1year\npdbase\npd1year\nattachchange\npdchange\n\n\n\n\nid\n1.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\ntrtgroup\n-0.1452850\n1.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\ngender\n-0.8306185\n0.1428866\n1.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nrace\n0.1319767\n-0.0314771\n-0.0955531\n1.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nage\n0.0593032\n0.1100051\n-0.0453862\n0.1787040\n1.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nsmoker\n-0.2742888\n-0.0495029\n0.0206456\n0.0377211\n-0.2229620\n1.0000000\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nsites\n0.0520821\n-0.0393742\n-0.1291127\n0.0505164\n-0.0274695\n-0.0226381\n1.0000000\nNA\nNA\nNA\nNA\nNA\nNA\n\n\nattachbase\n-0.1641513\n0.1440999\n0.2416242\n0.0313438\n0.1354434\n0.1456234\n-0.4237813\n1.0000000\nNA\nNA\nNA\nNA\nNA\n\n\nattach1year\n-0.1440182\n0.1671499\n0.2021284\n0.0671713\n0.0850851\n0.1987327\n-0.4042743\n0.9450189\n1.0000000\nNA\nNA\nNA\nNA\n\n\npdbase\n-0.2010672\n-0.0224838\n0.2645908\n0.0182289\n-0.0884687\n0.2614919\n-0.1805543\n0.6047132\n0.6093346\n1.0000000\nNA\nNA\nNA\n\n\npd1year\n-0.0685783\n0.0126731\n0.1362804\n0.0606735\n-0.1246106\n0.2447030\n-0.1901940\n0.5601052\n0.6685457\n0.8436653\n1.0000000\nNA\nNA\n\n\nattachchange\n0.0964391\n0.0296043\n-0.1696216\n0.0928969\n-0.1742586\n0.1135740\n0.1578683\n-0.3976360\n-0.0757224\n-0.1342018\n0.1679506\n1.0000000\nNA\n\n\npdchange\n0.2251487\n0.0622762\n-0.2123192\n0.0789059\n-0.0731704\n-0.0091784\n-0.0323859\n-0.0317726\n0.1579534\n-0.2031295\n0.3543035\n0.5400668\n1\n\n\n\n\n\n\n\nOther than that, there is a correlation between gender and ID which seems spurious. Let’s investigate that in the next tab.\nBack to top of tabset\n\n\nThere is a correlation between gender and ID. Let’s make a simple plot to investigate.\n\n# Creating a simple plot of id and gender\nggplot(data_missing, aes(x = factor(gender), y = id)) + \n  geom_point() + \n  labs(title = \"ID by Gender\")\n\n\n\n\n\n\n\n\nInterestingly, it appears that the experimenters assigned ID based on gender. That is, females received ID’s starting at 101, and males received ID’s starting at 201 (for some reason there’s a few females with ID’s &gt; 200).\nIt will be important to double check with the PI’s how they assigned participants to treatment group to ensure it was in fact random.\nLet’s make a contingency table to see what the breakdown between gender and treatment group is.\n\n# First make a contingency table of both variables\ncontingency_table &lt;- table(data_missing$gender, data_missing$trtgroup)\n\n# Set the row and column names\ndimnames(contingency_table) &lt;- list(\n  \"Gender\" = c(\"Male\", \"Female\"),\n  \"Treatment Condition\" = c(\"Placebo\", \"Control\", \"Low\", \"Medium\", \"High\"))\n\n# Convert the table to a dataframe for better formatting (from ChatGPT)\ncontingency_df &lt;- as.data.frame.matrix(contingency_table)\n\n# Pretty print the table using kable\nkable(contingency_df, format = \"html\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"))\n\n\n\n\n\nPlacebo\nControl\nLow\nMedium\nHigh\n\n\n\n\nMale\n10\n7\n9\n7\n3\n\n\nFemale\n13\n16\n12\n13\n13\n\n\n\n\n\n\n\nThat’s not good! It looks like males were less likely to be in the high treatment condition compared to females.\nThis could be because males were more likely to drop out then females. Let’s make a quick table using the original data set before we dropped the missing variables.\n\n# First make a contingency table of both variables\ncontingency_table_clean &lt;- table(data$gender, data$trtgroup)\n\n# Set the row and column names\ndimnames(contingency_table_clean) &lt;- list(\n  \"Gender\" = c(\"Male\", \"Female\"),\n  \"Treatment Condition\" = c(\"Placebo\", \"Control\", \"Low\", \"Medium\", \"High\"))\n\n# Convert the table to a dataframe for better formatting (from ChatGPT)\ncontingency_df_clean &lt;- as.data.frame.matrix(contingency_table_clean)\n\n# Pretty print the table using kable\nkable(contingency_df_clean, format = \"html\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"))\n\n\n\n\n\nPlacebo\nControl\nLow\nMedium\nHigh\n\n\n\n\nMale\n11\n10\n11\n11\n11\n\n\nFemale\n15\n16\n15\n15\n15\n\n\n\n\n\n\n\nIt looks more balanced before I took out participants with missing data.\nChi-square is known to be unsuitable if a cell has &lt; 5 counts, which we have in this case (3 males in high concentration condition). So I will run Fisher’s test to see if that difference is statistically significant.\n\nfisher_test &lt;- fisher.test(contingency_table)\nfisher_test\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  contingency_table\np-value = 0.506\nalternative hypothesis: two.sided\n\n\nThe p-value is not signficant (p = 0.506).\nWe know from visualizing the missing data that there were 27 missing data points for the gum measurement DVs, and these all belong to the same people. Furthermore, it appears that males in the treatment groups were more likely to have missing values than in the placebo (and maybe control) group. Is it possible that the gel was having an adverse effect on these participants? Does the gel have an adverse effect only on males and not females for some reason? Let’s explore.\nFirst, I want to investigate if males were more likely to have missing data points. It’s possible if their gums were hurting they simply rejected or avoided having these measurements taken.\nLet’s repeat this process and make a contingency table of gender and missing variables.\n\n# First let's add a new dummy code for if a participant is missing any data points\ndata$missing &lt;- ifelse(apply(data, 1, function(row) any(is.na(row))), 1, 0)\n\n# First make a contingency table of both variables\ncontingency_table_missing &lt;- table(data$gender, data$missing)\n\n# Set the row and column names\ndimnames(contingency_table_missing) &lt;- list(\n  \"Gender\" = c(\"Male\", \"Female\"),\n  \"Missing\" = c(\"Not Missing\", \"Missing\"))\n\n# Convert the table to a dataframe for better formatting (from ChatGPT)\ncontingency_df_missing &lt;- as.data.frame.matrix(contingency_table_missing)\n\n# Pretty print the table using kable\nkable(contingency_df_missing, format = \"html\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"))\n\n\n\n\n\nNot Missing\nMissing\n\n\n\n\nMale\n35\n19\n\n\nFemale\n66\n10\n\n\n\n\n\n\n\nProportionally, it appears that males may be more likely to have missing variables than females. Let’s run a chi-square to check.\n\nchi_square_test &lt;- chisq.test(contingency_df_missing)\nchi_square_test\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  contingency_df_missing\nX-squared = 7.6127, df = 1, p-value = 0.005796\n\n\nSuccess! Males were more likely to have missing values compared to females (p = 0.005796). This could be a problem (counfound) if something was causing males to avoid having their gums measured compared to females (such as adverse reactions from the gel)\nLet’s do a quick chi square test to check if there is a relationship between missing values and treatment condition.\nWe start off the same way by making a contingency table and running a chi-square test.\n\n# First make a contingency table of both variables\ncontingency_table_missing2 &lt;- table(data$missing, data$trtgroup)\n\n# Set the row and column names\ndimnames(contingency_table_missing2) &lt;- list(\"Missing\" = c(\"Not Missing\", \"Missing\"),\n                                             \"Treatmtent Condition\" = c(\"Placebo\", \"Control\", \"Low\", \"Medium\", \"High\"))\n\n# Convert the table to a dataframe for better formatting (from ChatGPT)\ncontingency_df_missing2 &lt;- as.data.frame.matrix(contingency_table_missing2)\n\n# Pretty print the table using kable\nkable(contingency_df_missing2, format = \"html\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"))\n\n\n\n\n\nPlacebo\nControl\nLow\nMedium\nHigh\n\n\n\n\nNot Missing\n22\n23\n21\n19\n16\n\n\nMissing\n4\n3\n5\n7\n10\n\n\n\n\n\n\n\nIt does appear that there are more missing variables in the high concentration condition. Is it statistically significant?\n\n# Run a Fisher's Exact Test (since we have &lt; 5 observations in cells)\nfisher_test &lt;- fisher.test(contingency_df_missing2)\nfisher_test\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  contingency_df_missing2\np-value = 0.1675\nalternative hypothesis: two.sided\n\n\nNot significant (p = 0.1675). So we can conclude that there is no difference in gender or missing values based on treatment condition (i.e., participants in all treatment conditions were equally likely to be male or female, or have missing values)\nHowever, across the board, males were more likely to have missing values than females. This will be important to note as a caveat during interpretation of the final results.\nBack to top of tabset\n\n\nHere we will simply plot the histograms of attachment loss and pocket depth changes scores, to assess if they appear normally distributed or if we will have to perform a transformation of some kind.\n\n# Plot simple histogram of attachment loss change score\nhist(data_missing$attachchange,\n     main  = \"Histogram of Attachment Loss Change\",\n     xlab = \"Attachment Loss Change\",\n     ylab = \"Frequency\")\n\n\n\n\n\n\n\n# Plot simple histogram of pocket depth change score\nhist(data_missing$pdchange,\n     main  = \"Histogram of Attachment Loss Change\",\n     xlab = \"Pocket Depth Change\",\n     ylab = \"Frequency\")\n\n\n\n\n\n\n\n\nBoth attachment loss and pocket depth change appear to be normally distributed and will not need to be transformed. Attachment loss change is slightly left-tailed but this could be due to outliers, or may just not impact the analysis."
  },
  {
    "objectID": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#Exploratory",
    "href": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#Exploratory",
    "title": "Advanced Data Analysis - Project 1",
    "section": "Exploratory Data Analysis",
    "text": "Exploratory Data Analysis\nHere I will plot the data and perform a number of simple linear regressions to examine relationships between variables in order to determine which covariates to include in the model.\n\nPrimary Explanatory VariableCovariatesDependent VariablesSummary\n\n\n\n5 Treatment Groups3 Treatment Groups\n\n\nLet’s examine if there appears to be a difference in the average attachment loss and pocket depth change according to treatment level\n\nggplot(data_missing, aes(x = factor(trtgroup), y = attachchange)) + \n  geom_boxplot() +\n  labs(title = \"Boxplot of Attachment Loss change by Treatment\")\n\n\n\n\n\n\n\nggplot(data_missing, aes(x = factor(trtgroup), y = pdchange)) + \n  geom_boxplot()  +\n  labs(title = \"Boxplot of Pocket Depth Change by treatment\")\n\n\n\n\n\n\n\n\nAttachment Loss Change\nVisually, there does not appear to be a difference between the treatment group levels (low, medium, high concentration gel) compared to each other. Additionally, there does not seem to be a difference between the treatment groups and the placebo for attachment loss change.\nPocket Depth Change\nInterestingly, the high concentration condition appears to have had a negative effect. Additionally, there seems to be a difference in the treatment groups compared to the no treatment control, but NOT when compared to the placebo. The exception is the low concentration condition compared to the placebo when looking at pocket depth change. Further analysis will reveal whether these differences are statistically significant or not.\nBack to top of tabset\n\n\nThe relationship between low vs medium vs high gel concentration does not look very strong. Furthermore, we technically do not have a large enough sample size in the high concentration condition to include it.\nFor those reasons, let’s make the same comparisons but while combining all treatment levels into one group called treatment.\n\nggplot(data_missing, aes(x = factor(trt3groups), y = attachchange)) + \n  geom_boxplot()\n\n\n\n\n\n\n\nggplot(data_missing, aes(x = factor(trt3groups), y = attachchange)) +\n  geom_boxplot() +\n  labs(title = \"Boxplot of Attachment Loss Change by Treatment\")\n\n\n\n\n\n\n\nggplot(data_missing, aes(x = factor(trt3groups), y = pdchange)) + \n  geom_boxplot() +\n  labs(title = \"Boxplot of Pocket Depth Change by Treatment\")\n\n\n\n\n\n\n\n\nBy eye, it appears as if there is no difference between the placebo and collapsed treatment groups in attachment loss change or pocket depth change. However, both placebo and any treatment conditions appear to have decreased (?) attachment loss and pocket depth. It may be that this study has null results, unless including one of the covariates changes the results. We will see come the analysis section.\nBack to top of tabset\n\n\n\n\n\nNow we will exlore the relationships between our potential covariates and attachment loss and pocket depth change\n\nAgeSitesGenderRaceSmoking Status\n\n\n\n# Plot age vs attachment loss change\nggplot(data_missing, aes(x = age, y = attachchange)) + \n  geom_point() + \n  labs(title = \"Scatterplot of Age vs Attachment Loss Change\")\n\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n# Plot age vs pocket depth change\nggplot(data_missing, aes(x = age, y = pdchange)) +\n  geom_point() + \n  labs(title = \"Scatterplot of Age vs Pocket Depth Change\")\n\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nThere does not appear to be any kind of linear relationship between age and attachment loss change or pocket depth change. I will run a model where I include age, but it will likely be removed in the final model.\nBack to top of tabset\n\n\nIs there any relationship between the number of sites measured from and attachment loss change or pocket depth change (e.g. a lower number of sites could lead to less accurate readings)? If so this could be something to include in our data analysis\n\n# Plot sites vs attachment change loss\nggplot(data_missing, aes(x = sites, y = attachchange)) + \n  geom_point() +\n  labs(title = \"Scatterplot of Attachment Loss Change vs Sites\")\n\n\n\n\n\n\n\n# Plot sites vs pocket depth chagne\nggplot(data_missing, aes(x = sites, y = pdchange)) + \n  geom_point() +\n  labs(title = \"Scatterplot of Pocket Depth Change by Sites\")\n\n\n\n\n\n\n\n\nThere does not seem to be a dramatic difference in attachment loss or pocket depth change based on the number of sites measured from. It’s a bit hard to tell with those two low site subjects, but the points are similar enough to the rest of the dataset that I do not think we have to worry about site number in our analysis.\nBack to top of tabset\n\n\nIt is conceivable that there are sex differences in regards to gum health. Let’s examine if there is a difference in attachment loss or pocket depth change based on gender\n\n# Plot gender vs attachment loss change\nggplot(data_missing, aes(x = factor(gender), y = attachchange)) +\n  geom_boxplot() + \n  labs(title = \"Boxplot of Attachment Loss Change by Gender\",\n      x = \"Gender\")\n\n\n\n\n\n\n\n# Plot gender vs pocket depth change\nggplot(data_missing, aes(x = factor(gender), y = pdchange)) +\n  geom_boxplot() + \n  labs(title = \"Boxplot of Pocket Depth Change by Gender\",\n      x = \"Gender\")\n\n\n\n\n\n\n\n\nBy eye, it appears that males may have more pocket depth loss compared with females. This will be a good variable to include as a covariate.\nLet’s try a t-test to see if there is any difference in attachment loss or pocket depth change based on gender\n\n# Running a t-test on attachment loss change by gender\nmale &lt;- data_missing$attachchange[data_missing$gender == 1]\nfemale &lt;- data_missing$attachchange[data_missing$gender == 2]\nt_test_result &lt;- t.test(male, female)\nt_test_result\n\n\n    Welch Two Sample t-test\n\ndata:  male and female\nt = 2.1969, df = 100.8, p-value = 0.03032\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n 0.01003279 0.19682842\nsample estimates:\n  mean of x   mean of y \n-0.03217094 -0.13560154 \n\n\nThere is a significant difference in attachment loss change score based on gender (t = 2.0502, p = 0.04299)\nLet’s repeat for pocket depth change\n\n# Running a t-test on pocket depth change by gender\nmale &lt;- data_missing$pdchange[data_missing$gender == 1]\nfemale &lt;- data_missing$pdchange[data_missing$gender == 2]\nt_test_result &lt;- t.test(male, female)\nt_test_result\n\n\n    Welch Two Sample t-test\n\ndata:  male and female\nt = 2.3534, df = 81.683, p-value = 0.02101\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n 0.01884469 0.22488042\nsample estimates:\n mean of x  mean of y \n-0.2150844 -0.3369470 \n\n\nThere is also a statistically significant difference in pocket depth change based on gender (t = 2.2626, p = 0.02641).\nTherefore I will include gender as a covariate in the analysis!\nBack to top of tabset\n\n\n\n# Plot race vs attachment loss change\nggplot(data_missing, aes(x = factor(race), y = attachchange)) +\n  geom_boxplot() +\n  labs(title = \"Boxplot of Attachment Change by Race\",\n       x = \"Race\")\n\n\n\n\n\n\n\nggplot(data_missing, aes(x = factor(race), y = pdchange)) + \n  geom_boxplot() +\n  labs(title = \"Boxplot of Pocket Depth Change by Race\",\n  x = \"Race\")\n\n\n\n\n\n\n\n\nThere does not seem to be much of a difference in attachment loss or pocket depth based on race. MAYBE African Americans (2) have more pocket depth loss compared to Asians(4), but the sample size was very small for both races (88.1% of the sample identified as White)\nBack to top of tabset\n\n\nWhether the participant is a smoker or not likely has a dramatic effect on gum health. Let’s assess\n\n# Plot smoking status vs attachment loss change\nggplot(data_missing, aes(x = factor(smoker), y = attachchange)) +\n  geom_boxplot() +\n  labs(title = \"Attachment loss by smoking status\",\n       x = \"Smoking Status\")\n\n\n\n\n\n\n\n# Plot smoking status vs pocket depth change\nggplot(data_missing, aes(x = factor(smoker), y = pdchange)) +\n  geom_boxplot() +\n  labs(title = \"Attachment loss by smoking status\",\n       x = \"Smoking Status\")\n\n\n\n\n\n\n\n\nThere does not appear to be any difference in attachment loss or pocket depth change based on smoking status. I will test a model with smoking status included, but it will likely be dropped in the final model.\nBack to top of tabset\n\n\n\n\n\n\nBaseline vs 1 YearAttachment Loss vs Pocket Depth\n\n\nI am curious what the relationship between base line and 1 year measurements are. The study is an RCT so even if baseline measurements affect 1 year measurements, participants should have been randomly assigned to groups so it is essentially controlled for in the study design. It will still be important to assess this relationship as a moderator however. Maybe treatment only worked for those with high attachment loss or pocket depth at the beginning?\nFirst let’s make a simple plot of attachment loss at baseline and at 1 year\n\n# Creating a scatter plot of attachment loss at baseline and 1 year\nggplot(data_missing, aes(x = attachbase, y = attach1year)) + \n  geom_point() +\n  labs(title = \"Scatterplot of Attachment Loss at Baseline and 1 Year\")\n\n\n\n\n\n\n\n\nLet’s check the correlation coefficient.\n\n# Run a correlation test between attachment at base and 1 year\ncorrelation &lt;- cor.test(data_missing$attachbase, data_missing$attach1year)\ncorrelation\n\n\n    Pearson's product-moment correlation\n\ndata:  data_missing$attachbase and data_missing$attach1year\nt = 29.198, df = 101, p-value &lt; 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9204657 0.9628839\nsample estimates:\n      cor \n0.9455558 \n\n\nThose are highly correlated (R = 0.946, p &lt;.0001)! Let’s run a simple linear regression\n\n# Run a regression with attachment loss at 1 year as the DV and attachment at base as the IV\nmodel &lt;- lm(attach1year ~ attachbase, data = data_missing)\nsummary(model)\n\n\nCall:\nlm(formula = attach1year ~ attachbase, data = data_missing)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.55683 -0.15641 -0.01841  0.15202  0.82062 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  0.19872    0.06975   2.849  0.00531 ** \nattachbase   0.86452    0.02961  29.198  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2525 on 101 degrees of freedom\nMultiple R-squared:  0.8941,    Adjusted R-squared:  0.893 \nF-statistic: 852.5 on 1 and 101 DF,  p-value: &lt; 2.2e-16\n\n# Plot the model\nggplot(data_missing, aes(x = attachbase, y = attach1year)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", col = \"blue\") +\n  labs(title = \"Simple Linear Regression of Attachment Loss at Baseline and 1 Year\",\n      x = \"Attachment Loss at Baseline\",\n      y = \"Attachment Loss at 1 Year\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nAttachment loss at baseline is a significant predictor of attachment loss at 1 year (t = 29.20, p &lt;.0001). This is important! We should account for attachment loss at baseline by including it as a covariate in our final model!\nLet’s do the same process of pocket depth at baseline and 1 year\n\n# Create a scatterplot of pocket depth at base vs 1 year\nggplot(data_missing, aes(x = pdbase, y = pd1year)) +\n  geom_point() +\n  labs(title = \"Scatterplot of Pocket Depth at Baseline and 1 Year\")\n\n\n\n\n\n\n\n\nSimilar to attachment loss, we see a relationship between pocket depth at baseline and 1 year. Let’s run the correlation.\n\n# Run a correlation between pocket depth at baseline and 1 year\ncorrelation &lt;- cor.test(data_missing$pdbase, data_missing$pd1year)\ncorrelation\n\n\n    Pearson's product-moment correlation\n\ndata:  data_missing$pdbase and data_missing$pd1year\nt = 15.767, df = 101, p-value &lt; 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.7764571 0.8913340\nsample estimates:\n      cor \n0.8432691 \n\n\nWhile not as strong as attachment loss, there is still a strong relationship between pocket depth at baseline and 1 year (R = 0.84, p &lt;.0001). Let’s run the SLR.\n\n# Run an SLR with pocket depth at 1 year as the DV and pocket depth at baseline as the DV\nmodel &lt;- lm(pd1year ~ pdbase, data = data_missing)\nsummary(model)\n\n\nCall:\nlm(formula = pd1year ~ pdbase, data = data_missing)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.55105 -0.17484  0.01996  0.19627  0.64381 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  0.07504    0.17948   0.418    0.677    \npdbase       0.88346    0.05603  15.767   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2634 on 101 degrees of freedom\nMultiple R-squared:  0.7111,    Adjusted R-squared:  0.7082 \nF-statistic: 248.6 on 1 and 101 DF,  p-value: &lt; 2.2e-16\n\n# Plot the model\nggplot(data_missing, aes(x = pdbase, y = pd1year)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", col = \"blue\") +\n  labs(title = \"Simple Linear Regression of Pocket Depth at Baseline and 1 Year\",\n       x = \"Pocket Depth at Baseline\",\n       y = \"Pocket Depth at 1 year\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nPocket depth at baseline is also a significant predictor of pocket depth at 1 year (t = 15.78, p = &lt;.0001). We should also therefore include pocket depth at baseline as a covariate in our model to control for it!\nBack to top of tabset\n\n\nI am interested in how attachment loss and pocket depth change are related. Since they are both measurements taken from the same sites in the gums, they are likely to be highly correlated. This could have implications on how we perform the analysis and interpret the results.\nFirst, we plot attachment loss change against pocket depth change\n\n# Creating a scatter plot of attachment loss change against pocket depth change \nggplot(data_missing, aes(x = attachchange, y = pdchange)) + \n  geom_point() +\n  labs(title = \"Scatterplot of Attachment Loss Change and Pocket Depth Change\")\n\n\n\n\n\n\n\n\nThat looks like a linear relationship! Let’s run a correlation and an SLR.\n\n# Running the correlation\ncorrelation &lt;- cor.test(data_missing$attachchange, data_missing$pdchange)\ncorrelation\n\n\n    Pearson's product-moment correlation\n\ndata:  data_missing$attachchange and data_missing$pdchange\nt = 6.3717, df = 101, p-value = 5.621e-09\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.3814636 0.6605362\nsample estimates:\n      cor \n0.5354593 \n\n# Running the regression\nmodel &lt;- lm(attachchange ~ pdchange, data = data_missing)\nsummary(model)\n\n\nCall:\nlm(formula = attachchange ~ pdchange, data = data_missing)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.83130 -0.12683  0.00563  0.14913  0.46480 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  0.06312    0.03441   1.835   0.0695 .  \npdchange     0.55231    0.08668   6.372 5.62e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2343 on 101 degrees of freedom\nMultiple R-squared:  0.2867,    Adjusted R-squared:  0.2797 \nF-statistic:  40.6 on 1 and 101 DF,  p-value: 5.621e-09\n\n# Creating the plot\nggplot(data_missing, aes(x = attachchange, y = pdchange)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", col = \"blue\") +\n  labs(title = \"Simple Linear Regression of Attachment Loss and Pocket Depth Change\",\n       x = \"Pocket Depth Change\",\n       y = \"Attachment Loss Change\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nThe correlation shows that attachment loss and pocket depth change are very correlated (R = 0.54, p &lt; .0001). The simple linear regression shows that pocket depth change significantly predicts attachment loss change (t = 6.37, p &lt;.0001).\nHowever, multicollinearity is only an issue when IVs are correlated with each other. We can still run a multivariate multiple linear regression even though the DVs are correlated. In fact this is often the case, and is one of the justifications for using a multivariate MLR in the first place! Back to top of tabset\n\n\n\n\n\nTreatment Condition\nCollapsing the low, medium, and high concentration gel groups into 1 group does not seem to improve the relationship between treatment and attachment loss or pocket depth change. Only models including all 5 treatment groups will therefore be considered from here on out to keep in alignment with the original study design.\nGender\nGender is related to attachment loss and pocket depth change, and as such will be included in the final model.\nSupressor / Counfound Variables\nA model will be tested with all covariates to assess for possible suppressor / confound variables. But the other potential covariates of race, age, sites, and smoking status were not related to attachment loss or pocket depth change by themselves.\nBaseline vs 1 Year Measurements\nThe baseline measurements of attachment loss and pocket depth were significant predictors of attachment loss and pocket depth at 1 year, respectively. While the RCT nature of the study should ensure that participants were randomly assigned into treatment condition regardless of their baseline measurements, it will still be good practice to include baseline attachment loss and pocket depth into the final model.\nAttachment Loss vs Pocket Depth Change Scores\nAttachment loss and pocket depth change are highly related to each other, but this should not impact the analysis. PI’s will need to be consulted to interpret the clinical significance of findings, and to help fully understand the implications of any possible differences that may arise between attachment loss and pocket depth change in the analysis.\nBack to top of tabset"
  },
  {
    "objectID": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#Model_1",
    "href": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#Model_1",
    "title": "Advanced Data Analysis - Project 1",
    "section": "Running the Model",
    "text": "Running the Model\nFor ease of interpretation I will be performing this analysis as two separate linear regressions, one for each outcome variable of either attachment loss or pocket depth change. I will begin with a simple linear regression only including the PEV and either attachment loss change or pocket depth change.\n\nAttachment Loss ChangePocket Depth ChangePost-Hoc Analysis\n\n\nWe start by constructing a model with attachment loss change as the dependent variable, and treatment group as the independent variable.\n\n# Running a SLR with attachment loss change as the DV, treatment group as the IV with no treatment as the reference group\nmodel_attach1 &lt;- lm(attachchange ~ placebo + low +  medium + high, data = data_missing)\nsummary(model_attach1)\n\n\nCall:\nlm(formula = attachchange ~ placebo + low + medium + high, data = data_missing)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.88283 -0.14813  0.05115  0.17174  0.53945 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -0.22169    0.05590  -3.966 0.000139 ***\nplacebo      0.13462    0.07906   1.703 0.091771 .  \nlow          0.20388    0.08092   2.520 0.013365 *  \nmedium       0.21514    0.08197   2.625 0.010063 *  \nhigh         0.05690    0.08728   0.652 0.515950    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2681 on 98 degrees of freedom\nMultiple R-squared:  0.09368,   Adjusted R-squared:  0.05669 \nF-statistic: 2.532 on 4 and 98 DF,  p-value: 0.0451\n\n# Apply Bonferroni correction\np_values &lt;- summary(model_attach1)$coefficients[,4] # This line selects the fourth column of the resulting coefficients table from summary(model_attach), which is the p-values\np_adjusted &lt;- p.adjust(p_values, method = \"bonferroni\")\n\n# Compare adjusted p-values to unadjusted p-values\np_comparison &lt;- cbind(p_values, p_adjusted)\np_comparison\n\n                p_values   p_adjusted\n(Intercept) 0.0001392148 0.0006960742\nplacebo     0.0917709125 0.4588545624\nlow         0.0133650749 0.0668253747\nmedium      0.0100625287 0.0503126435\nhigh        0.5159498143 1.0000000000\n\n# Get confidence intervals\nconf_intervals &lt;- confint(model_attach1)\nconf_intervals\n\n                  2.5 %     97.5 %\n(Intercept) -0.33262557 -0.1107577\nplacebo     -0.02226569  0.2915028\nlow          0.04330175  0.3644540\nmedium       0.05247446  0.3777966\nhigh        -0.11629489  0.2300962\n\n\nThe overall model is significant (F(4,98) = 2.53, p = 0.0451). Looking at the individual t-statistics, we see that - following adjustment for multiple pairwise comparisons - the placebo group (p = 0.549), low concentration group (p = 0.0668), and high concentration group (p = 1.000) are not statistically different from the control group. The medium concentration group is approaching significance (p = 0.0503).\nThat was with the no treatment control group as the reference. Let’s see if any of our treatment conditions were different from the placebo group.\n\n# Running a SLR with attachment loss change as the DV, treatment group as the IV with placebo as the reference group\nmodel_attach2 &lt;- lm(attachchange ~ control + low +  medium + high, data = data_missing)\nsummary(model_attach2)\n\n\nCall:\nlm(formula = attachchange ~ control + low + medium + high, data = data_missing)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.88283 -0.14813  0.05115  0.17174  0.53945 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)  \n(Intercept) -0.08707    0.05590  -1.558   0.1225  \ncontrol     -0.13462    0.07906  -1.703   0.0918 .\nlow          0.06926    0.08092   0.856   0.3941  \nmedium       0.08052    0.08197   0.982   0.3284  \nhigh        -0.07772    0.08728  -0.890   0.3754  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2681 on 98 degrees of freedom\nMultiple R-squared:  0.09368,   Adjusted R-squared:  0.05669 \nF-statistic: 2.532 on 4 and 98 DF,  p-value: 0.0451\n\n# Apply Bonferroni correction\np_values &lt;- summary(model_attach2)$coefficients[,4] # This line selects the fourth column of the resulting coefficients table from summary(model_attach), which is the p-values\np_adjusted &lt;- p.adjust(p_values, method = \"bonferroni\")\n\n# Compare adjusted p-values to unadjusted p-values\np_comparison &lt;- cbind(p_values, p_adjusted)\np_comparison\n\n              p_values p_adjusted\n(Intercept) 0.12254523  0.6127262\ncontrol     0.09177091  0.4588546\nlow         0.39412117  1.0000000\nmedium      0.32836700  1.0000000\nhigh        0.37538435  1.0000000\n\n# Get confidence intervals\nconf_intervals &lt;- confint(model_attach2)\nconf_intervals\n\n                  2.5 %     97.5 %\n(Intercept) -0.19800701 0.02386082\ncontrol     -0.29150281 0.02226569\nlow         -0.09131681 0.22983549\nmedium      -0.08214410 0.24317801\nhigh        -0.25091345 0.09547760\n\n\nAfter applying a bonferroni correction, none of the groups are significantly different from the placebo group (p &gt; .05).\nConclusion\nWhile the overall model was significant, the only groups that were statistically different from the no treatment control were the low and medium concentration gel groups (p &lt; 0.05). However, since this was a placebo-controlled RCT, and none of the treatment groups were significantly different from the placebo group, we can conclude that we fail to reject the null hypothesis that the average attachment loss over 1 year is the same between all groups.\nTables\n\n\nNote: p-values are unadjusted.\nBack to top of tabset\n\n\nNow we will create our model with pocket depth change as the dependent variable and treatment group as the independent variable.\n\n# Running the regression with pocket depth change as the DV, treatment group as the IV with no treatment as the reference group\nmodel_pd &lt;- lm(pdchange ~ placebo + low + medium + high, data = data_missing)\nsummary(model_pd)\n\n\nCall:\nlm(formula = pdchange ~ placebo + low + medium + high, data = data_missing)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.62483 -0.14595 -0.01768  0.16029  0.66130 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -0.33817    0.05466  -6.187 1.43e-08 ***\nplacebo     -0.01152    0.07730  -0.149   0.8818    \nlow          0.13200    0.07912   1.668   0.0984 .  \nmedium       0.13562    0.08015   1.692   0.0938 .  \nhigh        -0.04413    0.08534  -0.517   0.6063    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2621 on 98 degrees of freedom\nMultiple R-squared:  0.07806,   Adjusted R-squared:  0.04043 \nF-statistic: 2.074 on 4 and 98 DF,  p-value: 0.08994\n\n\nThe overall model is not statistically significant (F(4,98)= 2.074, p = 0.0899). Based on this model, it appears that the gel treatment has no effect on pocket depth change after 1 year.\nConclusion\nNo groups were significantly different from each other in pocket depth change after 1 year (F(4,98)= 2.074, p = 0.0899), and we fail to reject the null hypothesis that the average pocket depth change over 1 year is the same between all groups.\nTables\n\nNote: p-values are unadjusted\nBack to top of tabset\n\n\nWe did not find a main effect based on treatment group. However I am still interested if including any of the covariates changes the results.\n\n# Run a SLR with attachment loss change as the DV and gender as a covariate\nmodel2_attach &lt;- lm(attachchange ~ placebo + low + medium + high + gender, data = data_missing) \nsummary(model2_attach)\n\n\nCall:\nlm(formula = attachchange ~ placebo + low + medium + high + gender, \n    data = data_missing)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.86656 -0.17533  0.02334  0.16395  0.57717 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)  \n(Intercept) -0.07460    0.10988  -0.679   0.4988  \nplacebo      0.12330    0.07883   1.564   0.1210  \nlow          0.19310    0.08064   2.395   0.0186 *\nmedium       0.21118    0.08143   2.593   0.0110 *\nhigh         0.06704    0.08690   0.771   0.4423  \ngender      -0.08675    0.05593  -1.551   0.1242  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2662 on 97 degrees of freedom\nMultiple R-squared:  0.1156,    Adjusted R-squared:  0.07003 \nF-statistic: 2.536 on 5 and 97 DF,  p-value: 0.03346\n\n# Apply Bonferroni correction\np_values &lt;- summary(model2_attach)$coefficients[,4] # This line selects the fourth column of the resulting coefficients table from summary(model_attach), which is the p-values\np_adjusted &lt;- p.adjust(p_values, method = \"bonferroni\")\n\n# Compare adjusted p-values to unadjusted p-values\np_comparison &lt;- cbind(p_values, p_adjusted)\np_comparison\n\n              p_values p_adjusted\n(Intercept) 0.49883151 1.00000000\nplacebo     0.12104977 0.72629859\nlow         0.01856222 0.11137333\nmedium      0.01097151 0.06582903\nhigh        0.44234244 1.00000000\ngender      0.12415264 0.74491582\n\n# Get confidence intervals\nconf_intervals &lt;- confint(model2_attach)\nconf_intervals\n\n                  2.5 %     97.5 %\n(Intercept) -0.29268916 0.14349242\nplacebo     -0.03315881 0.27976619\nlow          0.03304940 0.35315426\nmedium       0.04956814 0.37278247\nhigh        -0.10544029 0.23951403\ngender      -0.19775102 0.02425639\n\n\nA model including gender does not seem to help anything. What about with all covariates (just for fun)?\n\n# Run a SLR with attachment loss change as the DV and gender as a covariate\nmodel3_attach &lt;- lm(attachchange ~ placebo + low + medium + high + gender + race + age + smoker + sites + attachbase + pdbase , data = data_missing) \nsummary(model3_attach)\n\n\nCall:\nlm(formula = attachchange ~ placebo + low + medium + high + gender + \n    race + age + smoker + sites + attachbase + pdbase, data = data_missing)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.60415 -0.16360  0.02131  0.16645  0.57481 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  0.160630   0.480855   0.334 0.739127    \nplacebo      0.017898   0.079113   0.226 0.821541    \nlow          0.151477   0.077598   1.952 0.054074 .  \nmedium       0.172196   0.079066   2.178 0.032060 *  \nhigh         0.045948   0.081336   0.565 0.573557    \ngender      -0.050360   0.054953  -0.916 0.361924    \nrace         0.032325   0.026871   1.203 0.232181    \nage         -0.002472   0.002709  -0.912 0.364067    \nsmoker       0.069384   0.055052   1.260 0.210844    \nsites       -0.001501   0.002539  -0.591 0.555885    \nattachbase  -0.165154   0.043233  -3.820 0.000246 ***\npdbase       0.094444   0.072226   1.308 0.194370    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2456 on 89 degrees of freedom\n  (2 observations deleted due to missingness)\nMultiple R-squared:  0.2908,    Adjusted R-squared:  0.2032 \nF-statistic: 3.318 on 11 and 89 DF,  p-value: 0.0007435\n\n# Apply Bonferroni correction\np_values &lt;- summary(model3_attach)$coefficients[,4] # This line selects the fourth column of the resulting coefficients table from summary(model_attach), which is the p-values\np_adjusted &lt;- p.adjust(p_values, method = \"bonferroni\")\n\n# Compare adjusted p-values to unadjusted p-values\np_comparison &lt;- cbind(p_values, p_adjusted)\np_comparison\n\n               p_values  p_adjusted\n(Intercept) 0.739127379 1.000000000\nplacebo     0.821540779 1.000000000\nlow         0.054074263 0.648891153\nmedium      0.032060232 0.384722790\nhigh        0.573556835 1.000000000\ngender      0.361924208 1.000000000\nrace        0.232180658 1.000000000\nage         0.364067210 1.000000000\nsmoker      0.210844428 1.000000000\nsites       0.555885079 1.000000000\nattachbase  0.000246493 0.002957916\npdbase      0.194369803 1.000000000\n\n# Get confidence intervals\nconf_intervals &lt;- confint(model3_attach)\nconf_intervals\n\n                   2.5 %       97.5 %\n(Intercept) -0.794818756  1.116078333\nplacebo     -0.139298371  0.175094025\nlow         -0.002709329  0.305662938\nmedium       0.015093048  0.329298305\nhigh        -0.115665991  0.207561289\ngender      -0.159551369  0.058830891\nrace        -0.021067104  0.085716311\nage         -0.007855313  0.002911679\nsmoker      -0.040003508  0.178771331\nsites       -0.006546011  0.003543891\nattachbase  -0.251056725 -0.079251471\npdbase      -0.049067286  0.237955593\n\n\nNope. Interestingly the best predictor of attachment loss at 1 year is attachment loss at baseline. The results for pocket depth are likely the same.\nI also want to assess if controlling for baseline attachment loss or pocket depth change affects things, since those were strong predictors of each measurement at 1 year (still need to add those SLRs).\n\nmodel4_attach &lt;- lm(attachchange ~ placebo + low + medium + high + attachbase, data = data_missing)\nsummary(model4_attach)\n\n\nCall:\nlm(formula = attachchange ~ placebo + low + medium + high + attachbase, \n    data = data_missing)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.52469 -0.16400  0.02084  0.15231  0.73422 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  0.10707    0.09304   1.151   0.2527    \nplacebo      0.04202    0.07616   0.552   0.5824    \nlow          0.14605    0.07592   1.924   0.0573 .  \nmedium       0.17586    0.07622   2.307   0.0232 *  \nhigh         0.02665    0.08087   0.330   0.7425    \nattachbase  -0.12902    0.03039  -4.246 4.99e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2475 on 97 degrees of freedom\nMultiple R-squared:  0.2357,    Adjusted R-squared:  0.1963 \nF-statistic: 5.984 on 5 and 97 DF,  p-value: 7.236e-05\n\n# Apply Bonferroni correction\np_values &lt;- summary(model4_attach)$coefficients[,4] # This line selects the fourth column of the resulting coefficients table from summary(model_attach), which is the p-values\np_adjusted &lt;- p.adjust(p_values, method = \"bonferroni\")\n\n# Compare adjusted p-values to unadjusted p-values\np_comparison &lt;- cbind(p_values, p_adjusted)\np_comparison\n\n                p_values   p_adjusted\n(Intercept) 2.526878e-01 1.0000000000\nplacebo     5.824313e-01 1.0000000000\nlow         5.731590e-02 0.3438953943\nmedium      2.317045e-02 0.1390227138\nhigh        7.424826e-01 1.0000000000\nattachbase  4.989769e-05 0.0002993861\n\n\nAfter controlling for treatment group, the only significant predictor of attachment loss change is baseline attachment loss scores (padj = 0.001)\nThese models were just for exploration, fun, and practice. The final models selected are the SLR’s with treatment group as the IV and either attachment loss change or pocket depth change as the DV. Back to top of tabset"
  },
  {
    "objectID": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#Assumptions",
    "href": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#Assumptions",
    "title": "Advanced Data Analysis - Project 1",
    "section": "Evaluating Assumptions",
    "text": "Evaluating Assumptions\nIn order to evaluate the assumptions of our models, we will first gather the residuals of the model predicting attachment loss change score and the model predicting pocket depth change score.\n\n# Calculate the jackknife residuals of model_attach\njackknife_residuals_attach &lt;- rstudent(model_attach1)\n\n# Calculate the jackknife residuals of model_pd\njackknife_residuals_pd &lt;- rstudent(model_pd)\n\nNow that we have our residuals, we can take a closer look at the assumptions.\n\nLinearityIndependenceNormalityEqual Variances (Homoscedasticity)Residuals Centered Around ZeroSummary\n\n\nSince the IV is categorical, we do not need to assess linearity.\nBack to top of tabset\n\n\nIndependence can be assessed in part by the study design and how the data was collected. Based on the information provided by the PI, I will assume subjects are independent from each other (e.g. not siblings).\nAdditionally, we can examine a scatter plot of the model’s residuals against any time point variable (such as ID). Let’s do that.\n\n# Create a scatterplot of jackknife residuals vs ID to assess independence for pocket depth change\nggplot(data_missing, aes(x = id, y = jackknife_residuals_attach)) + \n  geom_point() +\n  geom_hline(yintercept = 0) +\n  labs(title = \"Scatterplot of Jackknife Residuals vs ID for Attachment Loss Change\",\n       x = \"ID\",\n       y = \"Jackknife Residuals\")\n\n\n\n\n\n\n\n# Create a scatterplot of jackknife residuals vs ID to assess independence for pocket depth change\nggplot(data_missing, aes(x = id, y = jackknife_residuals_pd)) + \n  geom_point() +\n  geom_hline(yintercept = 0) +\n  labs(title = \"Scatterplot of Residuals vs ID for Pocket Depth Change\",\n       x = \"ID\",\n       y = \"Jackknife Residuals\")\n\n\n\n\n\n\n\n\nThe pattern appears random, suggesting independence.\nNote: The gap between ID’s 170 and 200 looks odd, but is an artifact from how the experimenters assigned ID, with females starting at 101, and males starting at 201.\nBack to top of tabset\n\n\nHere we will asses that, for any fixed value of X, Y has a normal distribution. We will do this using Q-Q plots and histograms of the residuals.\n\n# Make the Q-Q plots using the jackknife residuals for attachment loss change\nqqnorm(jackknife_residuals_attach, main = \"Q-Q plots of Jackknife Residuals for model_attach\")\nqqline(jackknife_residuals_attach, col = \"black\")\n\n\n\n\n\n\n\n# Create histogram of jackknife residuals for model_attach\nhist(jackknife_residuals_attach, main = \"Histogram of Jackknife Residuals\",\n     xlab = \"Jackknife Residuals\",\n     col = \"lightblue\",\n     border = \"black\")\n\n\n\n\n\n\n\n# Make the Q-Q plots using the jackknife residuals for pocket depth change\nqqnorm(jackknife_residuals_pd, main = \"Q-Q plots of Jackknife Residuals for model_pd\")\nqqline(jackknife_residuals_pd, col = \"black\")\n\n\n\n\n\n\n\n# Create histogram of jackknife residuals for model_pd\nhist(jackknife_residuals_pd, main = \"Histogram of Jackknife Residuals\",\n     xlab = \"Jackknife Residuals\",\n     col = \"lightblue\",\n     border = \"black\")\n\n\n\n\n\n\n\n\nThe histogram for attachment loss change is a little left-tailed. This could be from an outlier. Comparatively, the Q-Q plot and histogram of the residuals for pocket depth change are normally distributed.\nWe can also include the Shapiro-Wilk test of normality, which provides a p-value and allows us to numerically establish that the assumption of normality is met. If the p-value is &lt; 0.05 you conclude that the assumption of normality is not met.\n\nshapiro.test(jackknife_residuals_attach)\n\n\n    Shapiro-Wilk normality test\n\ndata:  jackknife_residuals_attach\nW = 0.9604, p-value = 0.003601\n\nshapiro.test(jackknife_residuals_pd)\n\n\n    Shapiro-Wilk normality test\n\ndata:  jackknife_residuals_pd\nW = 0.99059, p-value = 0.6933\n\n\nThe assumption of normality is violated for the attachment loss change model (p = 0.0036), but not for the pocket depth change model (p = 0.6933). Looking at the histogram of the residuals for attachment loss change, this is likely due to an outlier.\nSummary\nFor attachment loss change, we have a slight violation of normality, which could be due to the presence of an outlier. However, regressions are robust to violations of assumptions and this may not actually be an issue. Outliers in the model will be assessed using jackknife residuals to confirm that these points do not have an excessive amount of influence on the model.\nBased on the Q-Q plots and histograms of the residuals for pocket depth change, we can conclude that we satisfy the assumption of normality.\nBack to top of tabset\n\n\nUsing the scale-location plot will allow us to evaluate the constant variance assumption. This will allow us to see whether the variability of the residuals is roughly constant between each group (Source).\nTo assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.\n\n# Make the residual scatterplot using the jackknife residuals for model_attach\nggplot(data_missing, aes(x = trtgroup, y = jackknife_residuals_attach)) +\n  geom_point() + \n  labs(title = \"Jackknife Residuals vs Treatment Condition for Attachment Loss Change\",\n       x = \"Treatment Condition\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n# Make the residual scatterplot using the jackknife residuals for model_pd\nggplot(data_missing, aes(x = trtgroup, y = jackknife_residuals_pd)) +\n  geom_point() + \n  labs(title = \"Jackknife Residuals vs Treatment Condition for Pocket Depth Change\",\n       x = \"Treatment Condition\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n\nIt appears that our variances in all groups are equal!\nAdditionally, while it is not recommended to perform a statistical test to assess for equality of variances (because formal tests of equality of variance are not very powerful), we can still do this using Bartlett’s test.\n\nbartlett.test(attachchange ~ trtgroup, data = data_missing)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  attachchange by trtgroup\nBartlett's K-squared = 2.5462, df = 4, p-value = 0.6364\n\n\nThe null hypothesis of the Bartlett test is that the variances are equal. Thus failing to reject the null (p &gt; 0.05) indicates that the data are consistent with the equal variance assumption.\nSo we meet the assumption of equality of variances, looking good!\nBack to top of tabset\n\n\nTo start, we can simply check that the mean of our residuals is close to 0.\n\n#### For attachment loss change score\n# Generate the mean of the jackknife residuals for attachment loss change. Should be close to 0.\nmean(jackknife_residuals_attach)\n\n[1] -0.004132486\n\n\nWe are looking good for attachment loss change score. What about for pocket depth change?\n\n#### For pocket depth change score\n# Generate the mean of the jackknife residuals for attachment loss change. Should be close to 0.\nmean(jackknife_residuals_pd)\n\n[1] -6.695748e-06\n\n\nA more sophisticated approach is to plot the fitted values vs jackknife residuals. We can then compare the trend between groups to see if they are random. The fitted line should gravitate around 0 with no obvious trends.\n\n# Generate vectors containing the fitted values vs jackknife residuals so we can plot them \nfitted_values_pd &lt;- fitted(model_pd)\n\nggplot(data_missing, aes(x = fitted_values_pd, y = jackknife_residuals_pd)) + \n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n  labs(title = \"Jackknife Residuals vs Fitted Values for Attachment Loss Change\",\n       x = \"Fitted Values\",\n       y = \"Jackknife Residuals\")\n\n$x\n[1] \"Fitted Values\"\n\n$y\n[1] \"Jackknife Residuals\"\n\n$title\n[1] \"Jackknife Residuals vs Fitted Values for Attachment Loss Change\"\n\nattr(,\"class\")\n[1] \"labels\"\n\n\nThe pattern looks random and we can conclude we meet this assumption.\nBack to top of tabset\n\n\nWe meet the assumptions of independence, equal variances, and errors centered around zero required for this analysis. There is a slight violation of normality for the attachment loss change model, but this could be due to an outlier."
  },
  {
    "objectID": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#Multiple_imputation",
    "href": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#Multiple_imputation",
    "title": "Advanced Data Analysis - Project 1",
    "section": "Multiple Imputation",
    "text": "Multiple Imputation\n\nBackgroundCoding ExamplePerforming the Multiple Imputation\n\n\nNote: This information is taken from Biostats II (BIOS 6612) slides, week 13 lecture 20, and from Flexible Imputation of Missing Data 2nd edition.\nMissing Data\nTo review, there are several assumptions for missing data. The first is MCAR (Missing Completely at Random). This is when the probability of having a missing value is the same for everyone, and is rarely ever the case with real data.\nThe second is MAR (missing at random). This is when the probability of having a missing value is the same within groups defined by the observed data. That is, if we know that second variable by which the data is NOT MCAR, in addition to the measurements, we can assume MCAR within that second variable. For instance, if we know the missing data is not equal between the sexes, then we can assume MCAR within groups defined by sex. MAR is often observed in situations such as males missing more data than females, or older participants missing more data than younger ones, etc. MAR is more general and more realistic than MCAR. Modern missing data assumptions typically start from the MAR assumption.\nMNAR (Missing Not At Random) is the final category of missingness, and is when the the probability of having a missing value varies for reasons that are unknown to you. For example, in public opinion research, those with weaker opinions may respond less than those with stronger opinions, and you may not know this ahead of time. MNAR is the most complex and if you have it, you have your work cut out for you. In that situation, you can find more data about the causes for the missingness, or run lots and lots of sensitivity analyses.\nAnd as they say, the best way to handle missing data is not to have it.\nMultiple Imputation\nIn the current experiment, we know that data is not MCAR (males are missing more data than females), and thus cannot simply throw out subjects with missing values. If the data are not MCAR, listwise deletion (deleting any subject with a missing value) can severely bias estimates of means, regression coefficients and correlations.\nMultiple Imputation is a commonly used method to handle missing data when data is not MCAR, but is MAR. It is a process by which you use observed data to “predict” missing data, then use those “imputed” values in further analyses. Multiple imputation builds upon and pools together “single” imputation approaches.\nFor example, there exists very simple ways of imputing data, such as plugging in the average or median values in place of missing values. This is not sophisticated and kind of sketchy.\nThen there exists regression imputation, where for each variable you fit a regression model of it to the observed data, and then use that model to predict missing values, and use those predictions in place of the missing values. However, this injects bias into the estimate for the correlation between X and Y (since the values fall perfectly in line with the hypothesis that X and Y have a non zero correlation. (and are in a perfect line)).\n\nThen there is stochastic regression imputation, which is like regression imputation but adds noise back into the imputations based on the variance of their residuals. This helps account for variance in the results due to missing data.\n\nMultiple imputation works by fitting multiple stochastic imputation models (can be 100’s or 1000’s), analyzing each dataset separately to produce estimates of interest, and finally pooling together these statistics of interest. If done properly, the pooled statistics are unbiased under MAR, and the SE’s will be correct!\n\nMultiple Imputation is “simple, elegant and powerful. It is simple because it fills the holes in the data with plausible values. It is elegant because the uncertainty about the unknown data is coded in the data itself. And it is powerful because it can solve “other” problems that are actually missing data problems in disguise.” - Stef van Buuren\nBack to top of tabset\n\n\nFirst we will begin with an example of multiple imputation using the built in airquality dataset in R.\n\n# Examining data set and missingness\nhead(airquality)\n\n  Ozone Solar.R Wind Temp Month Day\n1    41     190  7.4   67     5   1\n2    36     118  8.0   72     5   2\n3    12     149 12.6   74     5   3\n4    18     313 11.5   62     5   4\n5    NA      NA 14.3   56     5   5\n6    28      NA 14.9   66     5   6\n\ncolSums(is.na(airquality))\n\n  Ozone Solar.R    Wind    Temp   Month     Day \n     37       7       0       0       0       0 \n\nvis_miss(airquality)\n\n\n\n\n\n\n\n\nWe’re missing 37 values in the Ozone column (24% of values!). We will have to address this missing data somehow.\nMean Imputation\nWe could quickly fill in missing data with mean imputation…\n\n# Here's how you do mean imputation in mice\nimp &lt;- mice(airquality, method = \"mean\", m = 1, maxit = 1)\n\n\n iter imp variable\n  1   1  Ozone  Solar.R\n\n\nBut mean imputation will “underestimate the variance, disturb the relations between variables, bias almost any estimate other than the mean and bias the estimate of the mean when data are not MCAR.” You can use mean imputation as a quick fix when there’s a handful of missing values, but it should be avoided in general.\nRegression Imputation\nWe could alternatively do regression imputation, where we fit a model and then use that model to predict the missing values. In regression imputation, you are essentially using the observed data to predict the missing data.\n\n# Performing regression imputation using the mice package\ndata_example &lt;- airquality[, c(\"Ozone\", \"Solar.R\")]\nimp &lt;- mice(data_example, method = \"norm.predict\", seed = 1,\n           m = 1, print = FALSE)\n\n# Plotting missing vs observed values\nxyplot(imp, Ozone ~ Solar.R,\n       main = \"Missing vs Observed values for Ozone ~ Solar.R\",\n       auto.key = list(corner = c(0,1),\n                  points = TRUE, \n                  text = c(\"Observed\", \"Missing\"), col = c(\"steelblue\", \"red3\")))\n\n\n\n\n\n\n\n\nYou predict the values of the missing datapoints with the regression equation resulting from your model. That is, the imputed values correspond to the most likely values under that model. However, the imputed values (red) vary less than the observed values (blue). So each value is the best under the model, but it is very unlikely that the real values would have had this distribution.\nRegression imputation yields unbiased estimates of the means and of the regression weights of the model under MCAR. It also does so under MAR, provided that the factors that influence missinginess are part of the model. However, correlations are biased to be greater/higher.\n“Regression imputation, as well as its modern incarnations in machine learning is probably the most dangerous of all methods described here. We may be led to believe that we’re to do a good job by preserving the relations between the variables. In reality however, regression imputation artificially strengthens the relations in the data. Correlations are biased upwards. Variability is underestimated. Imputations are too good to be true. Regression imputation is a recipe for false positive and spurious relations.”\nStochastic regression imputation\nStochastic regression imputation is a refinement of regression imputation that attempts to address correlation bias by adding noise back into the predictions of the missing values.\n\n# Impute Ozone from Solar.R by stochastic regression imputation using the mice package.\ndata_example &lt;- airquality[, c(\"Ozone\", \"Solar.R\")]\n\n# Perform stochastic regression imputation\nimp &lt;- mice(data_example, method = \"norm.nob\", m = 1, maxit = 1, seed = 1, print = FALSE)\n\n# Plotting missing vs observed values\nxyplot(imp, Ozone ~ Solar.R,\n       main = \"Missing vs Observed values for Ozone ~ Solar.R\",\n       auto.key = list(corner = c(0,1),\n                  points = TRUE, \n                  text = c(\"Observed\", \"Missing\"), col = c(\"steelblue\", \"red3\")))\n\n\n\n\n\n\n\n\n“The method = norm.nob argument requests a plain, non-Bayesian, stochastic regression method. This method first estimates the intercept, slope and residual variance under the linear model, then calculates the predicted value for each missing value, and adds a random draw from the residual to the prediction”.\nThis can create issues though, such as we have one imputed value that is negative! Which might not be plausible (such as in this case, there is no such thing as a negative ozone level).\nA more convenient solution is multiple imputation\nMultiple Imputation\nMultiple imputation creates m &gt; 1 complete data sets. The m results are then pooled into a final point estimate plus standard error. So each data set is identical in observed values, but differs in imputed values.\nWe then estimate the parameters of interest from each dataset. This is done by applying the analytic method you would have used if the dataset was complete in the first place (here, a regression). The results of the model on each dataset will differ because the data is different. These differences are caused by the uncertainty of what value to impute.\nThe last step is that these parameter estimates are then pooled together into a single value, and its variance estimated. The variance is assessed by combining the “within-imputation variance with the extra variance caused by the missing data (between-imputation variance)”. So under the appropriate conditions the pooled estimates are unbiased. MI solves the problem of ‘too small’ SEs of other imputation methods we just covered.\nNow let’s perform the multiple imputation on the airquality data set.\n\n# Perform multiple imputation on the airquality data set\nimp &lt;- mice(airquality, seed = 1, m = 20, print = FALSE) # This line imputes the missing data 20 times\n\n# Fit a linear regression \nmodel_imp &lt;- with(imp, lm(Ozone ~ Wind + Temp + Solar.R)) # You have to run the regression with \"with(imp, lm(etc))\n                  \nsummary(model_imp) # This runs a regression on each imputed dataset (so 20 different regressions)\n\n# A tibble: 80 × 6\n   term        estimate std.error statistic  p.value  nobs\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;\n 1 (Intercept) -60.7      17.9        -3.40 8.78e- 4   153\n 2 Wind         -2.95      0.514      -5.75 4.96e- 8   153\n 3 Temp          1.53      0.197       7.74 1.42e-12   153\n 4 Solar.R       0.0671    0.0184      3.64 3.70e- 4   153\n 5 (Intercept) -56.8      18.5        -3.07 2.56e- 3   153\n 6 Wind         -3.33      0.532      -6.25 4.04e- 9   153\n 7 Temp          1.56      0.205       7.58 3.49e-12   153\n 8 Solar.R       0.0554    0.0191      2.89 4.37e- 3   153\n 9 (Intercept) -74.0      18.7        -3.95 1.19e- 4   153\n10 Wind         -2.69      0.540      -4.99 1.67e- 6   153\n# ℹ 70 more rows\n\nsummary(pool(model_imp)) # This pools together the parameters of all 20 regressions (statistic is Wald's test) into a single model.\n\n         term     estimate   std.error statistic       df      p.value\n1 (Intercept) -65.87829658 23.09377412 -2.852643 69.97033 5.696702e-03\n2        Wind  -3.01897171  0.66252377 -4.556775 70.51194 2.125022e-05\n3        Temp   1.63483547  0.25107557  6.511328 75.99913 7.203792e-09\n4     Solar.R   0.05861581  0.02267832  2.584662 90.10797 1.135441e-02\n\n\n\n# mids workflow using pipes\nest3 &lt;- airquality %&gt;%\n  mice(seed = 1, print = FALSE, m = 20) %&gt;%\n  with(lm(formula = Ozone ~ Wind + Temp + Solar.R)) %&gt;%\n  pool()\nsummary(est3)\n\n         term     estimate   std.error statistic       df      p.value\n1 (Intercept) -65.87829658 23.09377412 -2.852643 69.97033 5.696702e-03\n2        Wind  -3.01897171  0.66252377 -4.556775 70.51194 2.125022e-05\n3        Temp   1.63483547  0.25107557  6.511328 75.99913 7.203792e-09\n4     Solar.R   0.05861581  0.02267832  2.584662 90.10797 1.135441e-02\n\n\n\n# Run a regression on the imputed airquality data set. \nimp &lt;- mice(airquality, seed = 1, print = FALSE)\n\nfit &lt;- with(imp, lm(Ozone ~ Solar.R))\n\n# Print out the estimates for the first and second data set\ncoef(fit$analyses[[1]])\n\n(Intercept)     Solar.R \n 22.2963201   0.1057437 \n\ncoef(fit$analyses[[2]])\n\n(Intercept)     Solar.R \n 20.7891622   0.1140081 \n\n\nNotice that the paremter estimates differ because of the uncertainty created by the missing data.\nApplying the standard pooling rules is done with\n\nest &lt;- pool(fit)\nsummary(est)\n\n         term   estimate  std.error statistic       df      p.value\n1 (Intercept) 21.5321395 5.67991951  3.790923 136.3544 0.0002245626\n2     Solar.R  0.1091546 0.02846503  3.834693 102.7169 0.0002170873\n\n\nAny R expression produced by expression() can be used on the multiply imputed data…\n\n# Extract residuals and fitted values\n\n# This gets you ALL the residuals for ALL the models/dataset\nimp_residuals &lt;- sapply(model_imp[[4]], residuals)\n\n# Same thing but for the fitted\nimp_fitted &lt;- sapply(model_imp[[4]],fitted)\n\n# Don't know where to go from here. Apparently you can take the average of all of these to get the average residuals, but it's not published anywhere.\n\nWe can compare the results of our multiple imputation model with the listwise deletion model to see how different they came out.\n\nmodel_non_imp &lt;- lm(Ozone ~ Wind + Temp + Solar.R, data = airquality, na.action = na.omit)\nsummary(model_non_imp)\n\n\nCall:\nlm(formula = Ozone ~ Wind + Temp + Solar.R, data = airquality, \n    na.action = na.omit)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-40.485 -14.219  -3.551  10.097  95.619 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -64.34208   23.05472  -2.791  0.00623 ** \nWind         -3.33359    0.65441  -5.094 1.52e-06 ***\nTemp          1.65209    0.25353   6.516 2.42e-09 ***\nSolar.R       0.05982    0.02319   2.580  0.01124 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 21.18 on 107 degrees of freedom\n  (42 observations deleted due to missingness)\nMultiple R-squared:  0.6059,    Adjusted R-squared:  0.5948 \nF-statistic: 54.83 on 3 and 107 DF,  p-value: &lt; 2.2e-16\n\nsummary(pool(model_imp))\n\n         term     estimate   std.error statistic       df      p.value\n1 (Intercept) -65.87829658 23.09377412 -2.852643 69.97033 5.696702e-03\n2        Wind  -3.01897171  0.66252377 -4.556775 70.51194 2.125022e-05\n3        Temp   1.63483547  0.25107557  6.511328 75.99913 7.203792e-09\n4     Solar.R   0.05861581  0.02267832  2.584662 90.10797 1.135441e-02\n\n\nOur regression using MI and the complete case (i.e. listwise deletion) data set are comparable!\nNote: what we are NOT doing in multiple imputation is taking an average of the imputed data and running a model on that as if its a single, complete data set. “Researchers are often tempted to average the multiply imputed data, and analyze the averaged data as if it were complete. This method yields incorrect standard errors, confidence intervals and p-values, and thus should not be used if any form of statistical testing or uncertainty analysis is to be done on the imputed data. The reason is that the procedure ignores the between-imputation variability, and hence shares all the drawbacks of single imputation”.\nNote: It’s recommended to impute then transform, because if you create variables based on other variables, there are relationships between those variables that MI doesn’t account for (it might create combinations of variables that are unrealistic)\nYou can do this as\n\n# Example of impute then transform method (i.e. how to add variables to an imputed dataset)\ndata_ex &lt;- boys[, c(\"age\", \"hgt\", \"wgt\", \"hc\", \"reg\")]\nimp &lt;- mice(data_ex, print = FALSE, seed = 1)\n \n# put the data in long format\nlong &lt;- mice::complete(imp, \"long\", include = TRUE)\n\nlong$new_var &lt;- with(long, 100 * wgt / hgt)\n\nimp.itt &lt;- as.mids(long)\n\nBack to top of tabset\n\n\nNow that we have reviewed the background and gone through coding examples of multiple imputation, we are ready to perform it for the dataset for Project 1.\n\n# Pool the parameters of interest for a regression on the imputed values for attach change control as reference\nmodel_imp &lt;- data %&gt;%\n  mice(seed = 1, print = FALSE, m = 20) %&gt;%\n  with(lm(attachchange ~ placebo + low + medium + high)) %&gt;%\n  pool()\n\nWarning: Number of logged events: 1158\n\n\nNone of the p-values for the pooled regressions on the MI data are significant (p &gt; 0.05).\nHow do those parameter estimates compare to the complete case analysis model?\n\n# Compare coefficients to complete case analysis for attachment loss with control as reference category\nMI &lt;- summary(model_imp)\nMI\n\n         term   estimate  std.error  statistic       df     p.value\n1 (Intercept) -0.1853493 0.06920536 -2.6782512 65.79196 0.009337056\n2     placebo  0.1158204 0.09076258  1.2760813 91.37003 0.205161055\n3         low  0.1608502 0.10027097  1.6041549 59.48514 0.113976747\n4      medium  0.1612700 0.11393844  1.4154130 37.61151 0.165174849\n5        high  0.0930271 0.15435067  0.6026997 18.41109 0.554060413\n\ncomplete_case &lt;- summary(model_attach1)\ncomplete_case$coefficients\n\n               Estimate Std. Error    t value     Pr(&gt;|t|)\n(Intercept) -0.22169165 0.05590110 -3.9657832 0.0001392148\nplacebo      0.13461856 0.07905610  1.7028232 0.0917709125\nlow          0.20387790 0.08091650  2.5196086 0.0133650749\nmedium       0.21513551 0.08196711  2.6246567 0.0100625287\nhigh         0.05690063 0.08727557  0.6519652 0.5159498143\n\n\nThey are drastically different, although still not significant.\nWe can also plot the imputed values for a sample of m dataset (not too many or it’s hard to see!) in order to visually assess that our imputed values are comparabe to the observed values.\n\n# Plot imputed values for m = 5 data set\nimpy &lt;- mice(data, seed = 1, print = FALSE, m = 5)\n\nWarning: Number of logged events: 285\n\nmodel_impy &lt;- with(imp, attachchange ~ trtgroup)\n\n# This is cool, here's how I can plot the imputed values for attach change \nxyplot(impy, attachchange ~ trtgroup,\n       main = \"Example of Imputed Values for m = 5 Dataset\",\n       auto.key = list(space = \"right\",\n        points = TRUE, \n        text = c(\"Observed\", \"Missing\"), col = c(\"blue4\", \"red3\")))\n\n\n\n\n\n\n\n\nWhat about for the same model but with placebo as the reference group?\n\n# Pool the parameters of interest for a regression on the imputed values for attach change placebo as reference\nmodel_imp &lt;- data %&gt;%\n  mice(seed = 1, print = FALSE, m = 20) %&gt;%\n  with(lm(attachchange ~ control + low + medium + high)) %&gt;%\n  pool()\n\nWarning: Number of logged events: 1158\n\n# Compare coefficients for complete case analysis with attachment with placebo as reference category\nsummary(model_imp)\n\n         term    estimate  std.error  statistic       df   p.value\n1 (Intercept) -0.06952890 0.06697153 -1.0381859 75.81298 0.3024834\n2     control -0.11582043 0.09076258 -1.2760813 91.37003 0.2051611\n3         low  0.04502973 0.11027780  0.4083299 41.79227 0.6851161\n4      medium  0.04544952 0.11870540  0.3828766 33.28878 0.7042453\n5        high -0.02279333 0.16350701 -0.1394028 16.62753 0.8908064\n\nsummary(model_attach2)$coefficients\n\n               Estimate Std. Error    t value   Pr(&gt;|t|)\n(Intercept) -0.08707309 0.05590110 -1.5576275 0.12254523\ncontrol     -0.13461856 0.07905610 -1.7028232 0.09177091\nlow          0.06925934 0.08091650  0.8559360 0.39412117\nmedium       0.08051695 0.08196711  0.9823081 0.32836700\nhigh        -0.07771793 0.08727557 -0.8904889 0.37538435\n\n\nThe estimates are more comparable, although still pretty different. Still not significant with both methods.\nAnd finally for pocket depth change.\n\n# Pool the parameters of interest for a regression on the imputed values for pocket depth  change placebo as reference\nmodel_imp &lt;- data %&gt;%\n  mice(seed = 1, print = FALSE, m = 20) %&gt;%\n  with(lm(pdchange ~ placebo + low + medium + high)) %&gt;%\n  pool()\n\nWarning: Number of logged events: 1158\n\n# Compare coefficients with complete case analysis for pocket depth change\nMI &lt;- summary(model_imp)\nMI\n\n         term    estimate  std.error  statistic       df      p.value\n1 (Intercept) -0.33597389 0.06144440 -5.4679330 66.87925 7.296278e-07\n2     placebo -0.00982096 0.08061544 -0.1218248 92.74234 9.033013e-01\n3         low  0.11415425 0.07995226  1.4277802 96.05307 1.565984e-01\n4      medium  0.11260463 0.08900896  1.2650932 60.47912 2.106907e-01\n5        high -0.02704497 0.10936047 -0.2473011 30.38938 8.063384e-01\n\n\nHere the models are a LOT more comparable, although still not significant. It seems we can conclude that missing values impact the attachment loss measurements more than pocket depth change.\nLet’s finish by plotting the imputed values for pocket depth change\n\n# Plot imputed values for m = 5 data set\nimpy &lt;- mice(data, seed = 1, print = FALSE, m = 5)\n\nWarning: Number of logged events: 285\n\nmodel_impy &lt;- with(imp, pdchange ~ trtgroup)\n\n# This is cool, here's how I can plot the imputed values for attach change \nxyplot(impy, pdchange ~ trtgroup,\n       main = \"Example of Imputed Values for m = 5 Dataset\",\n       auto.key = list(space = \"right\",\n        points = TRUE, \n        text = c(\"Observed\", \"Missing\"), col = c(\"blue4\", \"red3\")))\n\n\n\n\n\n\n\n\nLooks pretty good.\nBack to top of tabset"
  },
  {
    "objectID": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#Jackknife",
    "href": "Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html#Jackknife",
    "title": "Advanced Data Analysis - Project 1",
    "section": "Identify Outliers using Jackknife Residuals",
    "text": "Identify Outliers using Jackknife Residuals\nIn this section we will explore how our analysis would have changed if we identified outliers using the jackknife residuals.\n\nBackgroundIdentifying OutliersRerunning the Model with Outliers Removed\n\n\n*Note: This information is from BIOS 6602 Week 6 Lecture 10\nJackknife residuals are a type of residual used in regressions that allows us to detect outliers that have a significant impact on the regression coefficients of the model.\nJackknife residuals are calculated by systematically leaving out one observation (i) at a time from a dataset, fitting the regression model to the remaining dataset, and predicting the left out observation. The residual for each observation is then computed based on that prediction.\nThis process follows three step:\n\nFit the regression model to the data, excluding observation (i)\nUse the model to predict the left-out observation (i)\nCalculate the jackknife residual as the difference between the actual value and that fitted value\n\nJackknife residuals are similar to standardized residuals. Standardized residuals are standardized by the standard error of the regression, and are primarily used for identifying outliers. Jackknife residuals on the other hand allow you to assess the leverage of individuals data points, to see how much they actually influence the model (Source)\n\nJackknife residuals follow exactly a t(n-p-2) distribution, where approximately 5% of residuals are expected to exceed 1.96 in absolute value. Jackknife residuals make suspicious values more obvious compared to other residuals.\nDefinitions vary, but we generally consider a residual to be an outlier if the jackknife residual is +- 3.\nHowever, a potential outlier value may not actually have that dramatic of an impact on the model (which is what we are concerned that outliers will do). That is why we use jackknife residuals to investigate leverage and influence.\n\nExtreme X values can have high leverage.\nExtreme X values can have high influence\nA high-leverage point becomes an influential point if its Y value doesn’t follow the pattern of the rest of the data (i.e. is too low or too high)\n\n\nAn observation is influential if removing it substantially changes the estimate of the coefficients for that model. We use five measurements to assess influence: Jackknife residuals, Leverage, Cook’s Distance (Cook’s D), DFFITS, and DFBETAS.\n\nLeverage: Measures how far a measurement deviates from the mean. You want to examine values greater than 2(p+1)/n\nCook’s D: Measures the influence of an observation on regression predictions. You want to examine observations with d_i &gt; 1.0\nDFFITS: Measures the influence of an observation on regression predictions (related to Cook’s D). You want to examine observations outside the range of +-2(sqrt(p+10n)). If h_i is near zero, then that observation has little effect.\nDDFBETAS: Measure the influence of an observation on *individual* coefficient estimates. You want to examine estimates outside the range of +- 2/sqrt(n). A large DFBETA for variable k indicates that the i-th observation has a sizeable impact on the k-th regression coefficient.\n\nNote: p = the number of variables in the model\n\nBack to top of tabset\n\n\nThis website was used for coding information for this section, alongside the notes from BIOS 6602\nNow that we have covered the background for jackknife residuals, we can apply that knowledge to assess for outliers in our dataset for this project!\n\nAttachment LossPocket Depth\n\n\n\nSet upJackknife ResidualsLeverageCook’s DDFFITSDFBETASAdditional PlotsFinal Look and Conclusion\n\n\nRecall that we computed the jackknife residuals earlier.\n\n# Calculate the jackknife residuals of model_attach\njackknife_residuals_attach &lt;- rstudent(model_attach1)\n\n# Calculate the jackknife residuals of model_pd\njackknife_residuals_pd &lt;- rstudent(model_pd)\n\nLet’s generate a table so we can handily compare: ID, jackknife residual, leverage (diagonal hat), DFFITS, and DFBETAs for each participant.\n\n# Get leverage values (hat values)\nhat_values_attach &lt;- hatvalues(model_attach1)\n\n# Get Cook's D values\ncooks_d_attach &lt;- cooks.distance(model_attach1)\n\n# Get the DFFITS values\ndffits_attach &lt;- dffits(model_attach1)\n\n# Get the DFBETAS\ndfbetas_attach &lt;- dfbetas(model_attach1)\n\n# Make a table with ID and all diagnostic values\ndiagnostics_attach &lt;- data.frame(id = data_missing$id, jackknife_residuals = jackknife_residuals_attach, leverage = hat_values_attach, cooks_D = cooks_d_attach, dffits = dffits_attach, dfbetas = dfbetas_attach)\n\nkable(head(diagnostics_attach), caption = \"Diagnostics for Attachment Loss Change Model\", format = \"html\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"))\n\n\nDiagnostics for Attachment Loss Change Model\n\n\nid\njackknife_residuals\nleverage\ncooks_D\ndffits\ndfbetas..Intercept.\ndfbetas.placebo\ndfbetas.low\ndfbetas.medium\ndfbetas.high\n\n\n\n\n101\n0.5800959\n0.0500000\n0.0035664\n0.1330831\n0.0000000\n0.0000000\n0.0000000\n0.0973313\n0.0000000\n\n\n103\n1.5996714\n0.0434783\n0.0228989\n0.3410511\n0.3410511\n-0.2411595\n-0.2356149\n-0.2325949\n-0.2184475\n\n\n104\n1.4044559\n0.0476190\n0.0195311\n0.3140459\n0.0000000\n0.0000000\n0.2270548\n0.0000000\n0.0000000\n\n\n105\n-0.8928811\n0.0434783\n0.0072626\n-0.1903629\n0.0000000\n-0.1346069\n0.0000000\n0.0000000\n0.0000000\n\n\n106\n-1.6995151\n0.0500000\n0.0298289\n-0.3898955\n0.0000000\n0.0000000\n0.0000000\n-0.2851530\n0.0000000\n\n\n107\n-2.7107885\n0.0476190\n0.0690131\n-0.6061507\n0.0000000\n0.0000000\n-0.4382463\n0.0000000\n0.0000000\n\n\n\n\n\n\n\nBack to top of tabset\n\n\nWe can start by making a plot of the jackknife residuals to assess if there are outliers &lt; -3 or &gt; 3 SDs).\n\n# Plot jackknife outiers and label any values that are &gt; 3 or &lt; -3.\nggplot(data_missing, aes(x = id, y = jackknife_residuals_attach)) + geom_point() + \n  geom_hline(yintercept = c(-3,0,3)) + ylim(-4,4) + \n  labs(y = \"Jackknife Residuals\",\n       title = \"Jackknife Residuals vs ID\") + \n  geom_text(aes(label = ifelse(jackknife_residuals_attach &gt; 3 | jackknife_residuals_attach &lt; -3, id, '')), \n            vjust = -1)\n\n\n\n\n\n\n\n\nParticipant 168 is a potential outlier based on the residual value.\nLet’s look at this participant more closely.\n\n# Examine participant 168 to assess what values could make them an outlier\ndata_missing[data_missing$id == 168,]\n\n    id trtgroup gender race      age smoker sites attachbase attach1year\n58 168        5      2    5 54.20397      0   168   5.089286    4.041667\n     pdbase  pd1year attachchange   pdchange placebo control low medium high\n58 3.410714 2.904762    -1.047619 -0.5059524       0       0   0      0    1\n   trt trt3groups\n58   1          3\n\n# Sort our dataset by descending order of attachment at baseline to see if participant 168 is the highest\n\nkable(head(data_missing[order(-data_missing$attachbase),]), caption = \"Diagnostics for Attachment Loss Change Model\", format = \"html\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"))\n\n\nDiagnostics for Attachment Loss Change Model\n\n\n\nid\ntrtgroup\ngender\nrace\nage\nsmoker\nsites\nattachbase\nattach1year\npdbase\npd1year\nattachchange\npdchange\nplacebo\ncontrol\nlow\nmedium\nhigh\ntrt\ntrt3groups\n\n\n\n\n58\n168\n5\n2\n5\n54.20397\n0\n168\n5.089286\n4.041667\n3.410714\n2.904762\n-1.0476190\n-0.5059524\n0\n0\n0\n0\n1\n1\n3\n\n\n3\n104\n3\n2\n5\n55.17864\n1\n138\n4.956522\n5.304348\n5.217391\n4.891304\n0.3478261\n-0.3260870\n0\n0\n1\n0\n0\n1\n3\n\n\n40\n144\n2\n2\n2\n49.07598\n0\n126\n4.388889\n3.488000\n3.666667\n3.230159\n-0.9008889\n-0.4365079\n0\n1\n0\n0\n0\n0\n2\n\n\n102\n269\n3\n1\n5\n64.90075\n0\n162\n4.080247\n3.685185\n3.370370\n3.265432\n-0.3950617\n-0.1049383\n0\n0\n1\n0\n0\n1\n3\n\n\n18\n121\n4\n2\n5\n54.49692\n1\n138\n4.014493\n3.825000\n3.608696\n3.783333\n-0.1894928\n0.1746377\n0\n0\n0\n1\n0\n1\n3\n\n\n17\n120\n3\n2\n5\n41.83710\n1\n150\n3.886667\n3.920000\n4.200000\n3.880000\n0.0333333\n-0.3200000\n0\n0\n1\n0\n0\n1\n3\n\n\n\n\n\n\n\nWe have confirmed that participant 168 has the largest values for attachment loss at baseline (5.09). If that’s the case however, participant 3 is not far behind them (4.96) (who incidentally has the highest baseline pocket depth measurement), followed by participant 40 a large amount lower (4.39).\nWe can also (apparently) run a test statistic to test if we have an outlier using the ‘car’ package\n\noutlierTest(model_attach1)\n\nNo Studentized residuals with Bonferroni p &lt; 0.05\nLargest |rstudent|:\n    rstudent unadjusted p-value Bonferroni p\n58 -3.602896         0.00049863     0.051359\n\n\nThis is a test of a hypothesis that we do not have an outlier. We reject that hypothesis (p &lt; 0.05) so we have an outlier (I think).\nBack to top of tabset\n\n\nLeverage is a measure of geometric distance of an observation’s predictor point from the center point of the predictor space. In other words, leverage is a measurement of how far that observation deviates from the mean of that variable. High leverage observations have the potential to be very influential, but they are not necessarily influential. It’s possible for a high leverage point to not be influential, but very difficult for a low leverage point to be influential.\nLeverage is calculated as\n&lt;img src=“Media/leverage.png” width=“90%&gt;\nIf X _i is close to Xbar, then h_i is small (i.e. the i-th point has low leverage).\n\n# Caculate cutoff for leverage\ncutoff_leverage &lt;- 2*((4+1)/103)\ncutoff_leverage\n\n[1] 0.09708738\n\n# Make leverage plot in ggplot. Set a horizontal line at the cutoff point, and label ID's for participants that pass that line\nggplot(diagnostics_attach, aes(x = id, y = leverage)) +\n  geom_point() + \n  geom_hline(yintercept = cutoff_leverage) +\n  labs(title = \"Leverage Plot with Cutoff Line\",\n       x = \"ID\",\n       y = \"Hat Values\") + \n  geom_text(aes(label = ifelse(leverage &gt; cutoff_leverage, id, \"\")), vjust = -0.5)\n\n\n\n\n\n\n\n\nNone of our data points pass the cutoff point for leverage/hat values. I think this may be because the IV is categorical which changes the pattern and interpretation. Will check with a professor.\nBack to top of tabset\n\n\nCook’s D combines information about the residuals and leverage into a single value. A higher Cook’s D value signifies that the data point woud greatly change the regression coefficients, and is therefore influential and may impact the model’s accuracy.\nApparently we actually want to look at a cutoff of Cook’s D as 4/(n-p-1). Let’s calculate that and store it.\n\n# Calculate cutoff for Cook's D\ncutoff_d &lt;- 4/((nrow(data_missing) - length(model_attach1$coefficients) - 1))\ncutoff_d\n\n[1] 0.04123711\n\n# Make Cook's D plot in ggplot. Set a horizontal line at the cutoff point, and label ID's for participants that pass that line\nggplot(diagnostics_attach, aes(x = id, y = cooks_D)) +\n  geom_point() + \n  geom_hline(yintercept = cutoff_d) +\n  labs(title = \"Cook's D with Cutoff Line\",\n       x = \"ID\",\n       y = \"Cook's D\") + \n  geom_text(aes(label = ifelse(cooks_D &gt; cutoff_d, id, \"\")), vjust = -0.5)\n\n\n\n\n\n\n\n\nWe see that participants 107, 144, 146 and 168 are past the cutoff for Cook’s D. As when looking at the residuals plot, participant 168 is drastically different compared to the other potential outliers.\nBack to top of tabset\n\n\nNow we will examine DFFITS (Difference in fits). DFFITS is a measure used to identify influential data points in a regression analysis. It quantifes how much the predicted values (Y) of a model change when that particular observation is left out from the analysis. So in this case it is the difference in attachment loss change if we take out observation i from the analysis.\nLet’s make a plot where we label the values that are past the cutoff.\n\n# Calculate the cutoff for DFFITS\ncutoff_dffits &lt;- 2 * sqrt((4+1)/103)\ncutoff_dffits\n\n[1] 0.4406526\n\n# Make DFFITS plot in ggplot. Set a horizontal line at the cutoff points, and label ID's for participants that pass those lines.\nggplot(diagnostics_attach, aes(x = id, y = dffits)) + \n  geom_point() +\n  geom_hline(yintercept = c(cutoff_dffits, -cutoff_dffits)) + \n  geom_text(aes(label = ifelse(dffits &lt; -cutoff_dffits | dffits &gt; cutoff_dffits, id, \"\")), vjust = -0.5) +\n  labs(title = \"DFFITS by ID\",\n       x = \"ID\",\n       y = \"DFFITS\")\n\n\n\n\n\n\n\n\nAgain we are flagging participants 107, 113, 144, 168. The new addition is 113, who is right on the cutoff line. Again participant 168 is the most egregious, and the other potential outliers are a lot closer to the cutoff.\nBack to top of tabset\n\n\nNow we can look at the DFBETAs (Difference in Betas). DFBETAS quantify how much the beta coefficients for each variable in the model change when you exclude observation i from the analysis.\n\n# Calculate the cutoff for DFBETAS\ncutoff_dfbetas &lt;- 2/sqrt(103)\ncutoff_dfbetas\n\n[1] 0.1970659\n\n# Make DFBETAS plot in ggplot. Set a horizontal line at the cutoff points, and label ID's for participants that pass those lines.\n\n# For placebo group\nggplot(diagnostics_attach, aes(x = id, y = dfbetas.placebo)) + \n  geom_point() +\n  geom_hline(yintercept = c(cutoff_dfbetas, -cutoff_dfbetas)) + \n  geom_text(aes(label = ifelse(dfbetas.placebo &lt; -cutoff_dfbetas | dfbetas.placebo &gt; cutoff_dfbetas, id, \"\")), vjust = -0.5) +\n  labs(title = \"DFBETAS by ID for Placebo\",\n       x = \"ID\",\n       y = \"DFBETA\")\n\n\n\n\n\n\n\n# For low dose group\nggplot(diagnostics_attach, aes(x = id, y = dfbetas.low)) + \n  geom_point() +\n  geom_hline(yintercept = c(cutoff_dfbetas, -cutoff_dfbetas)) + \n  geom_text(aes(label = ifelse(dfbetas.low &lt; -cutoff_dfbetas | dfbetas.low &gt; cutoff_dfbetas, id, \"\")), vjust = -0.5) +\n  labs(title = \"DFBETAS by ID for Low Dose\",\n       x = \"ID\",\n       y = \"DFBETA\")\n\n\n\n\n\n\n\n# For medium dose group\nggplot(diagnostics_attach, aes(x = id, y = dfbetas.medium)) + \n  geom_point() +\n  geom_hline(yintercept = c(cutoff_dfbetas, -cutoff_dfbetas)) + \n  geom_text(aes(label = ifelse(dfbetas.medium &lt; -cutoff_dfbetas | dfbetas.medium &gt; cutoff_dfbetas, id, \"\")), vjust = -0.5) +\n  labs(title = \"DFBETAS by ID for Medium Dose\",\n       x = \"ID\",\n       y = \"DFBETA\")\n\n\n\n\n\n\n\n# For high does group\nggplot(diagnostics_attach, aes(x = id, y = dfbetas.high)) + \n  geom_point() +\n  geom_hline(yintercept = c(cutoff_dfbetas, -cutoff_dfbetas)) + \n  geom_text(aes(label = ifelse(dfbetas.high &lt; -cutoff_dfbetas | dfbetas.high &gt; cutoff_dfbetas, id, \"\")), vjust = -0.5) +\n  labs(title = \"DFBETAS by ID for High Dose\",\n       x = \"ID\",\n       y = \"DFBETA\")\n\n\n\n\n\n\n\n\nThat’s a lot of points that are past the cutoff! I think for these plots it might matter less if we’re pass that point. I think the idea here is we get a fine tune look at, for instance, how participant 168 drastically changes the beta for high, compared to how much any other point changes the betas. Other possible values of concern are 144 and 146. All the other data points are still roughly around the cutoff of .20, but 168 is around .7!\nBack to top of tabset\n\n\nThe car package in R has some handy plots that we can use to help us with diagnosing outliers.\nThe first is the influence plot, which essentially combines the jackknife residuals plot with the Cook’s D plot.\n\n# Influence plot\ninfluencePlot(model_attach1, main = \"Influence Plot\",\n              sub = \"Circle size is proportional to Cook's Distance\")\n\n\n\n\n\n\n\n\n      StudRes        Hat       CookD\n6  -2.7107885 0.04761905 0.069013121\n8  -0.5238664 0.06250000 0.003686439\n12  1.4073671 0.06250000 0.026147438\n58 -3.6028957 0.06250000 0.154223694\n\n\nUsing this plot, we can see that obseration 58 (ID 168) has the largest residual value and Cook’s D value by a large margin!\nAdditionally, a single line of code provides us with some useful diagnostic plots.\n\n# infIndexPlot gives us a series of plots that we need to investigate influence points\ninfIndexPlot(model_attach1)\n\n\n\n\n\n\n\n\nThe first plot is the Cook’s D plot, the second plot is the studentized residuals plot, and the leverage/hat values plot, all of which we plotted before. New is the third plot which is the Bonferroni P-value plot.\nBased on these plots we can see pretty readily that participant 168 is a true outlier. That is, they are a point that has high leverage AND influence in this model.\nBack to top of tabset\n\n\nWe saw that participant 168 is the most egregious offender, and participants 107, 144, 146, and MAYBE 113 are flagging past our different cutoff points.\nLet’s take one last look at the table of these participants\n\n# Pretty print diagnostics table of potential outliers\nkable(diagnostics_attach[diagnostics_attach$id %in% c(107,113,144,146,168),], caption = \"Correlation Matrix\", format = \"html\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"))\n\n\nCorrelation Matrix\n\n\n\nid\njackknife_residuals\nleverage\ncooks_D\ndffits\ndfbetas..Intercept.\ndfbetas.placebo\ndfbetas.low\ndfbetas.medium\ndfbetas.high\n\n\n\n\n6\n107\n-2.710789\n0.0476190\n0.0690131\n-0.6061507\n0.0000000\n0.0000000\n-0.4382463\n0.0000000\n0.0000000\n\n\n11\n113\n2.092587\n0.0434783\n0.0384816\n0.4461411\n0.0000000\n0.3154694\n0.0000000\n0.0000000\n0.0000000\n\n\n40\n144\n-2.670168\n0.0434783\n0.0610008\n-0.5692818\n-0.5692818\n0.4025431\n0.3932880\n0.3882470\n0.3646322\n\n\n42\n146\n-2.291912\n0.0434783\n0.0457672\n-0.4886373\n-0.4886373\n0.3455188\n0.3375748\n0.3332479\n0.3129784\n\n\n58\n168\n-3.602896\n0.0625000\n0.1542237\n-0.9302637\n0.0000000\n0.0000000\n0.0000000\n0.0000000\n-0.7143938\n\n\n\n\n\n\n\nAcross the board we can see that participant 168 has worse values for almost everything, in particular the jackknife residual, Cook’s D, and DFFITS values. I can confidently conclude that we should remove participant 168 as an outlier, and feel justified in keeping participants 107, 113, 144, and 146 based on the closeness to the rest of the data points on the previous plots.\n\n\n\n\n\n\nSet UpJackknife ResidualsLeverageCook’s DDFFITSDFBETASAdditional PlotsFinal Look and Conclusion\n\n\nLet’s generate a table so we can handily compare: ID, jackknife residual, leverage (diagonal hat), DFFITS, and DFBETAs for each participant.\n\n# Get leverage values (hat values)\nhat_values_pd &lt;- hatvalues(model_pd)\n\n# Get Cook's D values\ncooks_d_pd &lt;- cooks.distance(model_pd)\n\n# Get the DFFITS values\ndffits_pd &lt;- dffits(model_pd)\n\n# Get the DFBETAS\ndfbetas_pd &lt;- dfbetas(model_pd)\n\n# Make a table with ID and all diagnostic values\ndiagnostics_pd &lt;- data.frame(id = data_missing$id, jackknife_residuals = jackknife_residuals_pd, leverage = hat_values_pd, cooks_D = cooks_d_pd, dffits = dffits_pd, dfbetas = dfbetas_pd)\n\nkable(head(diagnostics_pd), caption = \"Diagnostics for Attachment Loss Change Model\", format = \"html\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"))\n\n\nDiagnostics for Attachment Loss Change Model\n\n\nid\njackknife_residuals\nleverage\ncooks_D\ndffits\ndfbetas..Intercept.\ndfbetas.placebo\ndfbetas.low\ndfbetas.medium\ndfbetas.high\n\n\n\n\n101\n1.4284091\n0.0500000\n0.0212518\n0.3276995\n0.0000000\n0.0000000\n0.0000000\n0.2396655\n0.0000000\n\n\n103\n1.3517762\n0.0434783\n0.0164727\n0.2881997\n0.2881997\n-0.2037879\n-0.1991025\n-0.1965505\n-0.1845955\n\n\n104\n-0.4668576\n0.0476190\n0.0021971\n-0.1043925\n0.0000000\n0.0000000\n-0.0754757\n0.0000000\n0.0000000\n\n\n105\n-0.4451251\n0.0434783\n0.0018161\n-0.0949010\n0.0000000\n-0.0671051\n0.0000000\n0.0000000\n0.0000000\n\n\n106\n-2.5107398\n0.0500000\n0.0629491\n-0.5760032\n0.0000000\n0.0000000\n0.0000000\n-0.4212642\n0.0000000\n\n\n107\n-1.7949702\n0.0476190\n0.0315049\n-0.4013675\n0.0000000\n0.0000000\n-0.2901882\n0.0000000\n0.0000000\n\n\n\n\n\n\n\nBack to top of tabset\n\n\nWe can start by making a plot of the jackknife residuals to assess if there are outliers &lt; -3 or &gt; 3 SDs).\n\n# Plot jackknife outiers and label any values that are &gt; 3 or &lt; -3.\nggplot(data_missing, aes(x = id, y = jackknife_residuals_pd)) + geom_point() + \n  geom_hline(yintercept = c(-3,0,3)) + ylim(-4,4) + \n  labs(y = \"Jackknife Residuals\",\n       title = \"Jackknife Residuals vs ID\") + \n  geom_text(aes(label = ifelse(jackknife_residuals_pd &gt; 3 | jackknife_residuals_pd &lt; -3, id, '')), \n            vjust = -1)\n\n\n\n\n\n\n\n\nWe have no jackknife residuals +- 3. That’s a good sign!\nLet’s sort our dataset and see who has the highest pocket depth at baseline.\n\n# Sort our dataset by descending order of pocket depth at baseline to see who is the highest\nkable(head(data_missing[order(-data_missing$pdbase),]), caption = \"Diagnostics for Attachment Loss Change Model\", format = \"html\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"))\n\n\nDiagnostics for Attachment Loss Change Model\n\n\n\nid\ntrtgroup\ngender\nrace\nage\nsmoker\nsites\nattachbase\nattach1year\npdbase\npd1year\nattachchange\npdchange\nplacebo\ncontrol\nlow\nmedium\nhigh\ntrt\ntrt3groups\n\n\n\n\n3\n104\n3\n2\n5\n55.17864\n1\n138\n4.956522\n5.304348\n5.217391\n4.891304\n0.3478261\n-0.3260870\n0\n0\n1\n0\n0\n1\n3\n\n\n20\n124\n2\n2\n5\n41.01574\n1\n162\n2.901235\n2.808642\n4.771605\n4.067901\n-0.0925926\n-0.7037037\n0\n1\n0\n0\n0\n0\n2\n\n\n17\n120\n3\n2\n5\n41.83710\n1\n150\n3.886667\n3.920000\n4.200000\n3.880000\n0.0333333\n-0.3200000\n0\n0\n1\n0\n0\n1\n3\n\n\n77\n234\n1\n2\n5\n51.12115\n0\n144\n2.756944\n2.527778\n4.083333\n3.631944\n-0.2291667\n-0.4513889\n1\n0\n0\n0\n0\n0\n1\n\n\n5\n106\n4\n2\n5\n42.14921\n1\n168\n2.369048\n1.922619\n3.910714\n3.083333\n-0.4464286\n-0.8273810\n0\n0\n0\n1\n0\n1\n3\n\n\n6\n107\n3\n2\n5\n37.15811\n1\n156\n3.544872\n2.839744\n3.897436\n3.237179\n-0.7051282\n-0.6602564\n0\n0\n1\n0\n0\n1\n3\n\n\n\n\n\n\n\nParticipant 104 has the highest baseline pocket depth. Interestingly it is not 168, who was our outlier for attachment loss.\nLet’s run that test we did earlier to see if there’s an outlier in the pocket depth model.\n\noutlierTest(model_pd)\n\nNo Studentized residuals with Bonferroni p &lt; 0.05\nLargest |rstudent|:\n   rstudent unadjusted p-value Bonferroni p\n82 2.664155          0.0090393      0.93105\n\n\nThis is a test of a hypothesis that we do not have an outlier. We fail to reject the null and thus have more evidence that we do not have outliers for the pocket depth model.\nBack to top of tabset\n\n\nLet’s plot leverage for our model on pocket depth change.\n\n# Caculate cutoff for leverage\ncutoff_leverage &lt;- 2*((4+1)/103)\ncutoff_leverage\n\n[1] 0.09708738\n\n# Make leverage plot in ggplot. Set a horizontal line at the cutoff point, and label ID's for participants that pass that line\nggplot(diagnostics_pd, aes(x = id, y = leverage)) +\n  geom_point() + \n  geom_hline(yintercept = cutoff_leverage) +\n  labs(title = \"Leverage Plot with Cutoff Line\",\n       x = \"ID\",\n       y = \"Hat Values\") + \n  geom_text(aes(label = ifelse(leverage &gt; cutoff_leverage, id, \"\")), vjust = -0.5)\n\n\n\n\n\n\n\n\nAgain we are good on leverage.\nBack to top of tabset\n\n\nLet’s make our plot for Cook’s D for pocket depth change.\n\n# Calculate cutoff for Cook's D\ncutoff_d &lt;- 4/((nrow(data_missing) - length(model_attach1$coefficients) - 1))\ncutoff_d\n\n[1] 0.04123711\n\n# Make Cook's D plot in ggplot. Set a horizontal line at the cutoff point, and label ID's for participants that pass that line\nggplot(diagnostics_pd, aes(x = id, y = cooks_D)) +\n  geom_point() + \n  geom_hline(yintercept = cutoff_d) +\n  labs(title = \"Cook's D with Cutoff Line\",\n       x = \"ID\",\n       y = \"Cook's D\") + \n  geom_text(aes(label = ifelse(cooks_D &gt; cutoff_d, id, \"\")), vjust = -0.5)\n\n\n\n\n\n\n\n\nWe see that participants 106, 118, and 239 have Cook’s D values past the cutoff. Interestingly participant 104 who had the highest baseline pocket depth did not flag here.\nBack to top of tabset\n\n\nLet’s make the DFFITS plot for pocket depth change.\n\n# Calculate the cutoff for DFFITS\ncutoff_dffits &lt;- 2 * sqrt((4+1)/103)\ncutoff_dffits\n\n[1] 0.4406526\n\n# Make DFFITS plot in ggplot. Set a horizontal line at the cutoff points, and label ID's for participants that pass those lines.\nggplot(diagnostics_pd, aes(x = id, y = dffits)) + \n  geom_point() +\n  geom_hline(yintercept = c(cutoff_dffits, -cutoff_dffits)) + \n  geom_text(aes(label = ifelse(dffits &lt; -cutoff_dffits | dffits &gt; cutoff_dffits, id, \"\")), vjust = -0.5) +\n  labs(title = \"DFFITS by ID\",\n       x = \"ID\",\n       y = \"DFFITS\")\n\n\n\n\n\n\n\n\nParticipants 106, 118, and 239 are flagging here again. In addition we have 137 and 233, which are near enough to the cutoff that we can ignore them.\nBack to top of tabset\n\n\nNow we can look at the DFBETAS plot for pocket depth change.\n\n# Calculate the cutoff for DFBETAS\ncutoff_dfbetas &lt;- 2/sqrt(103)\ncutoff_dfbetas\n\n[1] 0.1970659\n\n# Make DFBETAS plot in ggplot. Set a horizontal line at the cutoff points, and label ID's for participants that pass those lines.\n\n# For placebo group\nggplot(diagnostics_pd, aes(x = id, y = dfbetas.placebo)) + \n  geom_point() +\n  geom_hline(yintercept = c(cutoff_dfbetas, -cutoff_dfbetas)) + \n  geom_text(aes(label = ifelse(dfbetas.placebo &lt; -cutoff_dfbetas | dfbetas.placebo &gt; cutoff_dfbetas, id, \"\")), vjust = -0.5) +\n  labs(title = \"DFBETAS by ID for Placebo\",\n       x = \"ID\",\n       y = \"DFBETA\")\n\n\n\n\n\n\n\n# For low dose group\nggplot(diagnostics_pd, aes(x = id, y = dfbetas.low)) + \n  geom_point() +\n  geom_hline(yintercept = c(cutoff_dfbetas, -cutoff_dfbetas)) + \n  geom_text(aes(label = ifelse(dfbetas.low &lt; -cutoff_dfbetas | dfbetas.low &gt; cutoff_dfbetas, id, \"\")), vjust = -0.5) +\n  labs(title = \"DFBETAS by ID for Low Dose\",\n       x = \"ID\",\n       y = \"DFBETA\")\n\n\n\n\n\n\n\n# For medium dose group\nggplot(diagnostics_pd, aes(x = id, y = dfbetas.medium)) + \n  geom_point() +\n  geom_hline(yintercept = c(cutoff_dfbetas, -cutoff_dfbetas)) + \n  geom_text(aes(label = ifelse(dfbetas.medium &lt; -cutoff_dfbetas | dfbetas.medium &gt; cutoff_dfbetas, id, \"\")), vjust = -0.5) +\n  labs(title = \"DFBETAS by ID for Medium Dose\",\n       x = \"ID\",\n       y = \"DFBETA\")\n\n\n\n\n\n\n\n# For high does group\nggplot(diagnostics_pd, aes(x = id, y = dfbetas.high)) + \n  geom_point() +\n  geom_hline(yintercept = c(cutoff_dfbetas, -cutoff_dfbetas)) + \n  geom_text(aes(label = ifelse(dfbetas.high &lt; -cutoff_dfbetas | dfbetas.high &gt; cutoff_dfbetas, id, \"\")), vjust = -0.5) +\n  labs(title = \"DFBETAS by ID for High Dose\",\n       x = \"ID\",\n       y = \"DFBETA\")\n\n\n\n\n\n\n\n\nAgain we have a lot of points that are past the cutoff here. None as far off as 168 in the attachment loss model, 239 is the only one that is concerning.\nBack to top of tabset\n\n\nThe car package in R has some handy plots that we can use to help us with diagnosing outliers.\nThe first is the influence plot, which essentially combines the jackknife residuals plot with the Cook’s D plot.\n\n# Influence plot\ninfluencePlot(model_pd, main = \"Influence Plot\",\n              sub = \"Circle size is proportional to Cook's Distance\")\n\n\n\n\n\n\n\n\n      StudRes        Hat       CookD\n5  -2.5107398 0.05000000 0.062949101\n8  -0.8158788 0.06250000 0.008905825\n12  0.4184503 0.06250000 0.002354494\n82  2.6641548 0.04761905 0.066819586\n\n\nHere we can see that none of our residuals are +- 3, but we do have some concerns with large Cook’s distance, particularly with observation 82 (ID = 239).\nAdditionally, a single line of code provides us with some useful diagnostic plots.\n\n# infIndexPlot gives us a series of plots that we need to investigate influence points\ninfIndexPlot(model_pd)\n\n\n\n\n\n\n\n\nBased on these plots, it is arguable that participant 239 is an outlier for pocket depth. Though they do not have an extreme jackknife residual, the large Cook’s distance suggests that this data point has substantial infuence on the model’s parameters.\nHowever, a closer look reveals that the influence and leverage values for the pocket depth model are all comparable to the potential outliers in the attachmnet loss model we chose to keep (Cook’s D ~0.06). Specifically, while it appears that participant 239 here has a large Cook’s D (0.068) compared to the rest of the values, it is nowhere near as high as participant 168 was in the attachment loss model (0.15)!\nBack to top of tabset\n\n\nParticipants 106 and 239 were the only potential concerns here. However, as noted, their Cook’s D is comparable to the values we kept in the attachment loss model, and are &lt; 1/2 of what the Cook’s D was for participant 168 who we plan to remove as an outlier in the attachment loss model!\n\n# Pretty print diagnostics table of potential outliers\nkable(diagnostics_pd[diagnostics_attach$id %in% c(106,239),], caption = \"Correlation Matrix\", format = \"html\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"))\n\n\nCorrelation Matrix\n\n\n\nid\njackknife_residuals\nleverage\ncooks_D\ndffits\ndfbetas..Intercept.\ndfbetas.placebo\ndfbetas.low\ndfbetas.medium\ndfbetas.high\n\n\n\n\n5\n106\n-2.510740\n0.050000\n0.0629491\n-0.5760032\n0\n0\n0.0000000\n-0.4212642\n0\n\n\n82\n239\n2.664155\n0.047619\n0.0668196\n0.5957231\n0\n0\n0.4307071\n0.0000000\n0\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Remove participant 168 from the dataset\ndata_missing_outlier &lt;- data_missing[data_missing$id != 168,]\n\n# Run model 1 attachment loss\nmodel_attach1_outlier &lt;- lm(attachchange ~ placebo + low + medium + high, data = data_missing_outlier)\nsummary(model_attach1_outlier)\n\n\nCall:\nlm(formula = attachchange ~ placebo + low + medium + high, data = data_missing_outlier)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.68731 -0.16279  0.04936  0.16823  0.53945 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -0.22169    0.05277  -4.201  5.9e-05 ***\nplacebo      0.13462    0.07463   1.804  0.07435 .  \nlow          0.20388    0.07638   2.669  0.00891 ** \nmedium       0.21514    0.07737   2.780  0.00652 ** \nhigh         0.11576    0.08399   1.378  0.17130    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2531 on 97 degrees of freedom\nMultiple R-squared:  0.09493,   Adjusted R-squared:  0.05761 \nF-statistic: 2.543 on 4 and 97 DF,  p-value: 0.04442\n\n# Run model 2 attachmnent loss\nmodel_attach2_outlier &lt;- lm(attachchange ~ control + low + medium + high, data = data_missing_outlier)\nsummary(model_attach2_outlier)\n\n\nCall:\nlm(formula = attachchange ~ control + low + medium + high, data = data_missing_outlier)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.68731 -0.16279  0.04936  0.16823  0.53945 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)  \n(Intercept) -0.08707    0.05277  -1.650   0.1022  \ncontrol     -0.13462    0.07463  -1.804   0.0743 .\nlow          0.06926    0.07638   0.907   0.3668  \nmedium       0.08052    0.07737   1.041   0.3006  \nhigh        -0.01886    0.08399  -0.225   0.8228  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2531 on 97 degrees of freedom\nMultiple R-squared:  0.09493,   Adjusted R-squared:  0.05761 \nF-statistic: 2.543 on 4 and 97 DF,  p-value: 0.04442\n\n# Run the pocket depth model\nmodel_pd_outlier &lt;- lm(pdchange ~ control + low + medium + high, data = data_missing_outlier)\nsummary(model_pd_outlier)\n\n\nCall:\nlm(formula = pdchange ~ control + low + medium + high, data = data_missing_outlier)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-0.6248 -0.1513 -0.0129  0.1616  0.6613 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -0.34969    0.05488  -6.372 6.26e-09 ***\ncontrol      0.01152    0.07761   0.148   0.8823    \nlow          0.14352    0.07943   1.807   0.0739 .  \nmedium       0.14714    0.08046   1.829   0.0705 .  \nhigh        -0.02437    0.08734  -0.279   0.7809    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2632 on 97 degrees of freedom\nMultiple R-squared:  0.07456,   Adjusted R-squared:  0.0364 \nF-statistic: 1.954 on 4 and 97 DF,  p-value: 0.1077\n\n\nThere is no difference in our models after removing outlier 168."
  },
  {
    "objectID": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html",
    "href": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html",
    "title": "Automated Treadmill Data Cleaning",
    "section": "",
    "text": "This was the final project for my BIOS 6644 Data Wrangling course.\nIn this project, we create a program to automate the data cleaning of vital mouse treadmill data needed to validate Genetically Encoded Voltage Indicators for visualizing neuronal activity, exponentially saving experimenter time on manually cleaning data files and greatly expediting the data analysis process."
  },
  {
    "objectID": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#the-motivator",
    "href": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#the-motivator",
    "title": "Automated Treadmill Data Cleaning",
    "section": "The Motivator",
    "text": "The Motivator\nAt this point, we had successfully expressed and captured neuronal activity in a single VIP+ neuron using a GEVI, which can be seen here.\n\n\n\nImage and Plots made by Forest Speed\n\n\nHowever, we now needed to validate these signals against a control. That is, we needed to prove that we were capturing real voltage signals.\nOne approach to this problem was to perform voltage imaging with a GEVI in the motor cortex and correlate that activity to a physiological indicator of movement - mice walking on a treadmill. The idea is simple: If we were capturing true voltage signals, we would see spikes every time the mice walked.\nThus, we created a paradigm where we could image mice while they walked on a treadmill. (This experimental set-up would also allow for further experiments down the road of particular interest to my lab, such as documenting the relationships between inhibitory interneurons during locomotion).\nThis experimental set up can be seen here."
  },
  {
    "objectID": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#the-problem",
    "href": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#the-problem",
    "title": "Automated Treadmill Data Cleaning",
    "section": "The Problem",
    "text": "The Problem\nWe had successfully created a paradigm where we could perform voltage imaging on freely moving mice. However, the data we were receiving would have to be cleaned before we could do anything with it!\nSpecifically the recording on the treadmill was beginning before the recording on the camera. This resulted in treadmill files that were capturing data when the camera was turned off at both at the beginning and end of each treadmill file.\nThis can be visualized here.\n\n\n\nThus, the treadmill data would have to be cleaned in order for the treadmill and camera recordings to be synchronized with each other."
  },
  {
    "objectID": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#outline",
    "href": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#outline",
    "title": "Automated Treadmill Data Cleaning",
    "section": "Outline",
    "text": "Outline\nAs can be seen in the previous image, the recording software for the camera was detecting the timepoint that the camera was turned on as a change from 0 to ~3 Volts. This is the timestamp that we will use to sychronize the treadmill data with the camera recordings.\nTo do so, we need all of the treadmill recordings to have this timepoint where the camera switches from 0 to 3 Volts as timestamp 0.00 seconds.\nThis will also have to be done en masse, to clean as many treadmill files as needed simultaneously.\n\nPseudo Code\nThus, the pseudo code for the program is laid out as follows:\n\nIterate through all the treadmill.xlsx’s in a specified folder.\nIn each treadmill.xlsx:\n\nDelete every second row (since these are empty rows)\nCheck the second column of the treadmill.xlsx (which detects when the Camera was turned on)\nOnly consider rows where the camera was turned on (i.e. the “Camera On/Off” value &gt; 3)\nConsider the first row as time stamp 0.\nFrom that point on, all remaining time stamps will be shifted by x seconds, where x is the timestamp where the camera was turned on.\nSave the .xlsx in a new folder with the exact same file name but appended with the suffix “_cleaned.xlsx”.\n\n\nThis process can be visualized below."
  },
  {
    "objectID": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#converting-treadmill-position-from-volts-to-degrees",
    "href": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#converting-treadmill-position-from-volts-to-degrees",
    "title": "Automated Treadmill Data Cleaning",
    "section": "Converting Treadmill Position from Volts to Degrees",
    "text": "Converting Treadmill Position from Volts to Degrees\nIt might easier to deal with/conceptualize the treadmill position as degrees of a circle instead of volts in the future. That way we can calculate distance over time later using the radius of the circle.\nFor reference, the magnetic encoder that the treadmill is attached to captures position in volts, which can be converted directly into degrees of a circle.\n\n\n\n\n\nLet’s make that conversion now instead of later.\n\n# The highest value for Treadmill Position (in Volts) gets designated as 360 degrees, or the end of the circle\ncircle_360 = treadmill[\"Treadmill Position (V)\"].max() # Set 360 as the max value for Treadmill Position (V) \none_volt = 360 / circle_360 # One volt is therefore (360 / the max value for Treadmill Position (V)) degrees (e.g., if the max was 5 volts, then 360 / 5 = 72 degrees, or 1 volt = 72 degrees)\n\n# Create a new column that is the Volts * how many degrees one volt is equal to\ntreadmill[\"Treadmill Position (degree)\"] = treadmill[\"Treadmill Position (V)\"] * one_volt\ntreadmill\n\n\n\n\n\n\n\n\nTreadmill Position (V)\nCamera On/Off\nTime (sec)\nTreadmill Position (degree)\n\n\n\n\n145\n2.474988\n3.324904\n0.000000\n174.575180\n\n\n147\n2.461392\n3.327091\n0.012003\n173.616208\n\n\n149\n2.472487\n3.317091\n0.024006\n174.398817\n\n\n151\n2.479988\n3.322404\n0.036008\n174.927905\n\n\n153\n2.476550\n3.325373\n0.048010\n174.685407\n\n\n...\n...\n...\n...\n...\n\n\n5071\n1.836623\n3.321466\n29.997960\n129.547662\n\n\n5073\n1.834592\n3.323810\n30.009963\n129.404368\n\n\n5075\n1.848500\n3.335060\n30.021966\n130.385382\n\n\n5077\n1.839905\n3.326779\n30.033968\n129.779137\n\n\n5079\n1.823340\n3.320216\n30.045971\n128.610738\n\n\n\n\n2468 rows × 4 columns\n\n\n\nLooks good. This treadmill file is now fully cleaned."
  },
  {
    "objectID": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#saving-the-cleaned-data",
    "href": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#saving-the-cleaned-data",
    "title": "Automated Treadmill Data Cleaning",
    "section": "Saving the Cleaned Data",
    "text": "Saving the Cleaned Data\nWe will want to save each treadmill file after it is cleaned.\nFor thorough record keeping, let’s create a subfolder within the folder that the treadmill.xlsx files are found within and store the cleaned files there.\n\n# Name the new folder \"Cleaned Treadmill Files\", and place it within the folder that the uncleaned treadmill files will all be kept in\nnew_folder = r\"C:\\Users\\sviea\\Documents\\Portfolio\\Data_Wrangling\\Treadmill_Data_Cleaning\\Treadmill Files Uncleaned\\Cleaned Treadmill Files\"\n\n# Make the new folder\nos.makedirs(new_folder, exist_ok=True)\n\n# Save the cleaned file to this new folder as an excel file\noutput_file = os.path.join(new_folder, \"Cleaned 1.xlsx\")\ntreadmill.to_excel(output_file, index=False)"
  },
  {
    "objectID": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#create-a-function",
    "href": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#create-a-function",
    "title": "Automated Treadmill Data Cleaning",
    "section": "Create a Function",
    "text": "Create a Function\nWe just wrote code to import, clean, and save a single treadmill.xlsx file.\nFor the final product, we need to make a program that walks through every uncleaned treadmill file in a folder and cleans it.\nTo that end, we need to convert the file-cleaning-and-saving steps into a single function, that we can then apply to multiple files en masse.\n\n# Making a function to clean a single treadmill.xlsx file\ndef treadmill_cleaner(file_path, save_location):\n    '''\n    This function cleans a single treadmill.xlsx file\n    And saves it in the save_location folder\n    '''\n    \n    #Import the File\n    col_names = [\"Treadmill Position (V)\", \"Camera On/Off\", \"Time (sec)\"] # Define column names\n    treadmill = pd.read_excel(file_path, names = col_names) # Import treadmill data as a pd df, set column names to col_names\n\n    # Clean the File\n    treadmill = treadmill.dropna() # Drop NaN values\n    treadmill = treadmill[treadmill[\"Camera On/Off\"] &gt; 3] # Slice the treadmill df so it only includes values where the camera was turned on (i.e. value &gt; 3)\n    time_start = treadmill[\"Time (sec)\"].iloc[0] # Set the first Time (sec) value to 0\n    treadmill[\"Time (sec)\"] = treadmill[\"Time (sec)\"] - time_start # Delete all Time (sec) values by the starting time\n    circle_360 = treadmill[\"Treadmill Position (V)\"].max() # Set 360 as the max value for Treadmill Position (V) \n    one_volt = 360 / circle_360 # One volt is therefore (360 / the max value for Treadmill Position (V)) degrees (e.g., if the max was 5 volts, then 360 / 5 = 72 degrees, or 1 volt = 72 degrees)\n    treadmill[\"Treadmill Position (degree)\"] = treadmill[\"Treadmill Position (V)\"] * one_volt\n    \n    # Save the Cleaned File\n    output_file = os.path.join(save_location, filename) # Generates the name of the output file (save location + file_name)\n    base_name, extension = os.path.splitext(output_file) # Separates the file name to be \"file_name\" and \".xlsx\" (modified from ChatGPT)\n    cleaned_path = f\"{base_name}_cleaned{extension}\" # Creates a new file name that is \"file_name_cleaned.xlsx\" (modified from ChatGPT)\n    treadmill.to_excel(cleaned_path, index=False) # Saves the file and appends \"_cleaned\" to the end of it"
  },
  {
    "objectID": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#clean-a-single-treadmill-file",
    "href": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#clean-a-single-treadmill-file",
    "title": "Automated Treadmill Data Cleaning",
    "section": "Clean a Single Treadmill File",
    "text": "Clean a Single Treadmill File\nIf we want to run the program to clean a single file, we can run the code below.\n\n# Change file paths as needed below\nfilename = \"121523_RC1_Pace_1.xlsx\" # Change this to what you want the last part of the file name to be!\nfile_path = r\"C:\\Users\\sviea\\Documents\\Portfolio\\Data_Wrangling\\Treadmill_Data_Cleaning\\Treadmill Files Uncleaned\\121523_RC1_Pace_1.xlsx\" # Change this to the file path of the treadmill file you want to clean\nsave_location = r\"C:\\Users\\sviea\\Documents\\Portfolio\\Data_Wrangling\\Treadmill_Data_Cleaning\\Treadmill Files Uncleaned\\Cleaned Treadmill Files\" #Change this to the name of the folder you want to save in\nos.makedirs(save_location, exist_ok=True)  # Makes the save_location as a new folder, skips if it already exists\n\n# Run the program to clean a single treadmill file\ntreadmill_cleaner(file_path, save_location)"
  },
  {
    "objectID": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#clean-an-entire-folder-containing-raw-treadmill-files",
    "href": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#clean-an-entire-folder-containing-raw-treadmill-files",
    "title": "Automated Treadmill Data Cleaning",
    "section": "Clean an Entire Folder Containing Raw Treadmill Files",
    "text": "Clean an Entire Folder Containing Raw Treadmill Files\nIf we want to clean a folder containing multiple treadmill files, we can run the chunk below.\n\n# This program walks through every file in a designated folder and applies the above treadmill_cleaner() function to each file, saving the cleaned file in the same subfolder\n\n#__Enter the file path to the folder containing treadmill files here!!!!!__\ndirectory = r\"C:\\Users\\sviea\\Documents\\Portfolio\\Data_Wrangling\\Treadmill_Data_Cleaning\\Treadmill Files Uncleaned\" \n\n##### Create the save location as a new folder (if needed)\n# Names the save location as the folder containing treadmill files \n# + \"\\Cleaned Treadmill Files\"\nsave_location = f\"{directory}\" + \"\\Cleaned Treadmill Files\" \n# Makes the save_location as a new folder, skips if it already exists\nos.makedirs(save_location, exist_ok=True)  \nprint(\"Save location is:\", save_location)\n\n##### Walk through every file in the directory and apply the treadmill_cleaner() function\ntry: # Made this a try statement so it does not apply to subfolders\n    for filename in os.listdir(directory):\n        print(\"File name is:\", filename)\n        filepath = os.path.join(directory, filename)\n        print(\"File path is:\", filepath)\n        treadmill_cleaner(filepath, save_location)\nexcept PermissionError:  # Skips subfolders (and anything else really, will throw an error if you have the .xlsx file open!)\n    print(\"File is a folder -  skipping\")\n\n&lt;&gt;:9: SyntaxWarning:\n\ninvalid escape sequence '\\C'\n\n&lt;&gt;:9: SyntaxWarning:\n\ninvalid escape sequence '\\C'\n\nC:\\Users\\sviea\\AppData\\Local\\Temp\\ipykernel_1556\\1169796177.py:9: SyntaxWarning:\n\ninvalid escape sequence '\\C'\n\n\n\nSave location is: C:\\Users\\sviea\\Documents\\Portfolio\\Data_Wrangling\\Treadmill_Data_Cleaning\\Treadmill Files Uncleaned\\Cleaned Treadmill Files\nFile name is: 121523_RC1_Pace_1.xlsx\nFile path is: C:\\Users\\sviea\\Documents\\Portfolio\\Data_Wrangling\\Treadmill_Data_Cleaning\\Treadmill Files Uncleaned\\121523_RC1_Pace_1.xlsx\nFile name is: 121523_RC1_Pace_2.xlsx\nFile path is: C:\\Users\\sviea\\Documents\\Portfolio\\Data_Wrangling\\Treadmill_Data_Cleaning\\Treadmill Files Uncleaned\\121523_RC1_Pace_2.xlsx\nFile name is: 121523_RC1_Pace_3.xlsx\nFile path is: C:\\Users\\sviea\\Documents\\Portfolio\\Data_Wrangling\\Treadmill_Data_Cleaning\\Treadmill Files Uncleaned\\121523_RC1_Pace_3.xlsx\nFile name is: 121523_RC1_Pace_4.xlsx\nFile path is: C:\\Users\\sviea\\Documents\\Portfolio\\Data_Wrangling\\Treadmill_Data_Cleaning\\Treadmill Files Uncleaned\\121523_RC1_Pace_4.xlsx\nFile name is: 121523_RC1_Pace_5.xlsx\nFile path is: C:\\Users\\sviea\\Documents\\Portfolio\\Data_Wrangling\\Treadmill_Data_Cleaning\\Treadmill Files Uncleaned\\121523_RC1_Pace_5.xlsx\nFile name is: 121523_RC1_Pace_6.xlsx\nFile path is: C:\\Users\\sviea\\Documents\\Portfolio\\Data_Wrangling\\Treadmill_Data_Cleaning\\Treadmill Files Uncleaned\\121523_RC1_Pace_6.xlsx\nFile name is: Cleaned Treadmill Files\nFile path is: C:\\Users\\sviea\\Documents\\Portfolio\\Data_Wrangling\\Treadmill_Data_Cleaning\\Treadmill Files Uncleaned\\Cleaned Treadmill Files\nFile is a folder -  skipping\n\n\nWe just cleaned 6 files in a matter of seconds. That would have taken the better part of an hour to do by hand!"
  },
  {
    "objectID": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#checking-the-output",
    "href": "Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html#checking-the-output",
    "title": "Automated Treadmill Data Cleaning",
    "section": "Checking the Output",
    "text": "Checking the Output\nFor good measure, let’s check the output of the first and last file we cleaned.\n\n# Check first file\nfile_1 = pd.read_excel(r\"C:\\Users\\sviea\\Documents\\Portfolio\\Data_Wrangling\\Treadmill_Data_Cleaning\\Treadmill Files Uncleaned\\Cleaned Treadmill Files\\121523_RC1_Pace_1_cleaned.xlsx\")\nfile_1\n\n\n\n\n\n\n\n\nTreadmill Position (V)\nCamera On/Off\nTime (sec)\nTreadmill Position (degree)\n\n\n\n\n0\n2.474988\n3.324904\n0.000000\n174.575180\n\n\n1\n2.461392\n3.327091\n0.012003\n173.616208\n\n\n2\n2.472487\n3.317091\n0.024006\n174.398817\n\n\n3\n2.479988\n3.322404\n0.036008\n174.927905\n\n\n4\n2.476550\n3.325373\n0.048010\n174.685407\n\n\n...\n...\n...\n...\n...\n\n\n2463\n1.836623\n3.321466\n29.997960\n129.547662\n\n\n2464\n1.834592\n3.323810\n30.009963\n129.404368\n\n\n2465\n1.848500\n3.335060\n30.021966\n130.385382\n\n\n2466\n1.839905\n3.326779\n30.033968\n129.779137\n\n\n2467\n1.823340\n3.320216\n30.045971\n128.610738\n\n\n\n\n2468 rows × 4 columns\n\n\n\n\n# Check last file\nfile_6 = pd.read_excel(r\"C:\\Users\\sviea\\Documents\\Portfolio\\Data_Wrangling\\Treadmill_Data_Cleaning\\Treadmill Files Uncleaned\\Cleaned Treadmill Files\\121523_RC1_Pace_6_cleaned.xlsx\")\nfile_6\n\n\n\n\n\n\n\n\nTreadmill Position (V)\nCamera On/Off\nTime (sec)\nTreadmill Position (degree)\n\n\n\n\n0\n1.552993\n3.318966\n0.000000\n109.813950\n\n\n1\n1.547993\n3.324123\n0.012003\n109.460349\n\n\n2\n1.550337\n3.318966\n0.024005\n109.626099\n\n\n3\n1.543148\n3.312560\n0.036008\n109.117798\n\n\n4\n1.544867\n3.318498\n0.048011\n109.239348\n\n\n...\n...\n...\n...\n...\n\n\n4966\n1.637379\n3.326779\n60.020822\n115.780965\n\n\n4967\n1.615189\n3.315998\n60.032824\n114.211861\n\n\n4968\n1.624409\n3.316935\n60.044827\n114.863812\n\n\n4969\n1.625190\n3.327091\n60.056829\n114.919062\n\n\n4970\n1.643161\n3.327248\n60.068832\n116.189816\n\n\n\n\n4971 rows × 4 columns\n\n\n\nLooks great!"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Sean Vieau",
    "section": "",
    "text": "Graduate student in the Masters in Applied Biostatistics program at the Colorado School of Public Health. I have compiled this portfolio to showcase my most significant projects and skills.\nIn my spare time I am an avid dancer, jiu jitsu practitioner, and drummer!"
  },
  {
    "objectID": "Project_1_Regression/Project_1_Regression_SAS/Project_1_Regression_SAS.html",
    "href": "Project_1_Regression/Project_1_Regression_SAS/Project_1_Regression_SAS.html",
    "title": "This is markdown",
    "section": "",
    "text": "# This is code\nprint(\"Hello world\")"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html",
    "href": "Project_2/Project_2_R/Code/Project2.html",
    "title": "Advanced Data Analysis - Project 2",
    "section": "",
    "text": "The aim of the current study is to assess how treatment response differs for HIV+ patients 2 years after initiating Highly Active Antiretroviral Therapy (HAART) based on hard drug usage (such as heroin or cocaine). This study is of particular scientific interest because it is unclear whether the use of hard drugs inhibits the immune system in humans; treatment strategies may differ based on these results. The researchers are interested in comparing subjects who never used hard drugs to current hard drug users (those that use hard drugs at year 2) or previous hard drug users (those who used drugs at year 0 or 1). Outcomes of interest are: viral load (HIV copies in a mL of blood), CD4+ T cell count (a measure of immunologic health), and aggregate physical and quality of life scores from the SF-36.\nThe clinical hypothesis is that, if hard drugs inhibit the immune system in humans, subjects who currently or previously used hard drugs will have higher viral load and lower CD4+ T cell counts than those who never used hard drugs. Additionally, the researchers are interested in knowing if potential differences between the drug use groups can be explained by differences in adherence to the treatment regimen. The researchers are agnostic on how quality of life changes after treatment, since side effects of the treatment are significant.\nThe project description provided by the PI is available below:"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#labeling-categorical-variables",
    "href": "Project_2/Project_2_R/Code/Project2.html#labeling-categorical-variables",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Labeling Categorical Variables",
    "text": "Labeling Categorical Variables\nLet’s factor and label our categorical variables so they are appropriately represented (and not doubles, which will yield incorrect results in models)\n\n# Converting all appropriate variables from doubles to categorical variables\n\ndata$HASHV &lt;- factor(data$HASHV,\n                     levels = c(1, 2),\n                     labels = c(\"No\", \"Yes\"))\n\ndata$HASHF &lt;- factor(data$HASHF,\n                     levels = c(0, 1, 2, 3, 4),\n                     labels = c(\"Never\", \"Daily\", \"Weekly\", \"Monthly\", \"Less Often\"))\n\ndata$income &lt;- factor(data$income,\n                      levels = c(1, 2, 3, 4, 5, 6, 7, 9),\n                      labels = c(\"Less than $10,000\", \"$10,000-$19,999\", \"$20,000-$29,999\", \"$30,000-$39,999\", \"$40,000-$49,999\", \"$50,000-$59,999\", \"$60,000 or more\", \"Do not wish to answer\"))\n\ndata$HBP &lt;- factor(data$HBP,\n                   levels = c(1, 2, 3, 4, 9, -1),\n                   labels = c(\"No\", \"Yes\", \"No, based on data trajectory\", \"Yes, based on data trajectory\", \"Insufficient data, may include reported treatment without diagnosis\", \"Improbable Value\"))\n\ndata$DIAB &lt;- factor(data$DIAB,\n                    levels = c(1, 2, 3, 4, 9),\n                    labels = c(\"No\", \"Yes\", \"No, based on data trajectory\", \"Yes, based on data trajectory\", \"Insufficient data\"))\n                      \ndata$LIV34 &lt;- factor(data$LIV34,\n                     levels = c(1, 2, 9),\n                     labels = c(\"No\", \"Yes\", \"Insufficient Data\"))\n\ndata$KID &lt;- factor(data$KID,\n                   levels = c(1, 2, 3, 4, 9),\n                   labels = c(\"No\", \"Yes\", \"No, based on data trajectory\", \"Yes, based on data trajectory\", \"Insufficient data\"))\n\ndata$FRP &lt;- factor(data$FRP,\n                   levels = c(1,2,9),\n                   labels = c(\"No\", \"Yes\", \"Insufficient Data\"))\n\ndata$FP &lt;- factor(data$FP,\n                  levels = c(1,2,9),\n                  labels = c(\"No\", \"Yes\", \"Insufficient Data\"))\n\ndata$DYSLIP &lt;- factor(data$DYSLIP,\n                      levels = c(1, 2, 3, 4, 9),\n                      labels = c(\"No\", \"Yes\", \"No, based on data trajectory\", \"Yes, based on data trajectory\", \"Insufficient data\"))\n\ndata$SMOKE &lt;- factor(data$SMOKE,\n                     levels = c(1, 2, 3),\n                     labels = c(\"Never Smoked\", \"Former Smoker\", \"Current Smoker\"))\n\ndata$DKGRP &lt;- factor(data$DKGRP,\n                     levels = c(0, 1, 2, 3),\n                     labels = c(\"None\", \"1-3 drinks/week\", \"4-13 drinks/week\", \"&gt;13 drinks/week\"))\n\ndata$HEROPIATE &lt;- factor(data$HEROPIATE,\n                         levels = c(1, 2, -9),\n                         labels = c(\"No\", \"Yes\", \"Not Specified\"))\n\ndata$IDU &lt;- factor(data$IDU,\n                   levels = c(1, 2),\n                   labels = c(\"No\", \"Yes\"))\n\ndata$ADH &lt;- factor(data$ADH,\n                   levels = c(1, 2, 3, 4),\n                   labels = c(\"100%\", \"95-99%\", \"75-94%\", \"&lt;75%\"))\n\ndata$RACE &lt;- factor(data$RACE,\n                    levels = c(1, 2, 3, 4, 5, 6, 7),\n                    labels = c(\"White, non-Hispanic\", \"White, Hispanic\", \"Black, non-Hispanic \", \"Black, Hispanic\",  \"American Indian or Alaskan Native\", \"Asian or Pacific Islander\", \"Other Hispanic\"))\n\ndata$EDUCBAS &lt;- factor(data$EDUCBAS,\n                       levels = c(1, 2, 3, 4, 5, 6, 7),\n                       labels = c(\"8th grade or less \", \"9,10, or 11th grade\", \"12th grade\", \"At least one year college but no degree\", \"Four years college or got degree\", \"Some graduate work\", \"Post-graduate degree\"))\n\ndata$hard_drugs &lt;- factor(data$hard_drugs,\n                          levels = c(0, 1),\n                          labels = c(\"No\", \"Yes\"))\n\n# Create labels for variables to make the names of each variable more professional in outputs\nlabel(data$newid) &lt;- \"ID\"\nlabel(data$AGG_MENT) &lt;- \"Aggregate Mental QOL Score\"\nlabel(data$AGG_PHYS) &lt;- \"Aggregate Physical QOL Score\"\nlabel(data$HASHF) &lt;- \"Hash/Marijuana Use Since Last Visit\"\nlabel(data$HASHV) &lt;- \"Frequency of Hash/Marijuana Use\"\nlabel(data$income) &lt;- \"Income\"\nlabel(data$HBP) &lt;- \"High Blood Pressure\"\nlabel(data$DIAB) &lt;- \"Diabetes\"\nlabel(data$LIV34) &lt;- \"Liver Disease Stage 3/4\"\nlabel(data$KID) &lt;-\"Kidney Disease\"\nlabel(data$FRP) &lt;- \"Frailty Related Phenotype\"\nlabel(data$FP) &lt;- \"Fraily Phenotype\"\nlabel(data$BMI) &lt;- \"BMI\"\nlabel(data$TCHOL) &lt;- \"Total Cholesterol\"\nlabel(data$TRIG) &lt;- \"Triglycerides\"\nlabel(data$LDL) &lt;- \"LDL\"\nlabel(data$DYSLIP) &lt; \"Dyslipidemia\"\nlabel(data$SMOKE) &lt; \"Smoking Status\"\nlabel(data$CESD) &lt;- \"CESD Depression Score\"\nlabel(data$SMOKE) &lt; \"Smoking Status\"\nlabel(data$DKGRP) &lt;- \"Drinking Group\"\nlabel(data$HEROPIATE) &lt;- \"Heroin or Opiate Use Since Last Visit\"\nlabel(data$IDU) &lt;- \"Intravenous Drug Usage Since Last Visit\"\nlabel(data$LEU3N) &lt;- \"CD4+ T Cell Count\"\nlabel(data$VLOAD) &lt;- \"Viral Load\"\nlabel(data$ADH) &lt;- \"Adherence to Treatment Regimen\"\nlabel(data$RACE) &lt;- \"Race\"\nlabel(data$EDUCBAS) &lt;- \"Education at Baseline\"\nlabel(data$hivpos) &lt;- \"HIV Serostatus\"\nlabel(data$age) &lt;- \"Age\"\nlabel(data$ART) &lt;- \"Antiretroviral Therapy\"\nlabel(data$years) &lt;- \"Year of Visit\"\nlabel(data$hard_drugs) &lt;- \"Hard Drug Usage\"\n\nLet’s take another look to check that those variables are no longer doubles.\n\n# Examine data\nglimpse(data)\n\nRows: 3,632\nColumns: 33\n$ newid      &lt;dbl&gt; 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4,…\n$ AGG_MENT   &lt;dbl&gt; 44.90710, 58.20754, 59.65136, 56.80657, 46.34190, 48.71791,…\n$ AGG_PHYS   &lt;dbl&gt; 52.52557, 41.29347, 48.54453, 46.73991, 27.92331, 38.03807,…\n$ HASHV      &lt;fct&gt; No, No, No, No, No, Yes, No, Yes, No, Yes, No, No, Yes, No,…\n$ HASHF      &lt;fct&gt; NA, Less Often, Never, Never, Never, Never, Never, Never, N…\n$ income     &lt;fct&gt; \"$30,000-$39,999\", \"$30,000-$39,999\", \"$30,000-$39,999\", \"$…\n$ BMI        &lt;dbl&gt; 24.71756, 26.06801, 27.16421, 25.71786, 26.66936, 25.96576,…\n$ HBP        &lt;fct&gt; \"No\", \"No\", \"No\", \"No\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", …\n$ DIAB       &lt;fct&gt; \"No\", \"No\", \"No\", \"No\", \"Insufficient data\", \"Insufficient …\n$ LIV34      &lt;fct&gt; No, No, No, No, No, No, No, No, No, No, No, No, No, No, Yes…\n$ KID        &lt;fct&gt; \"No\", \"No\", \"No\", \"No\", \"Insufficient data\", \"Insufficient …\n$ FRP        &lt;fct&gt; No, No, No, No, Yes, No, No, No, No, No, No, No, No, No, No…\n$ FP         &lt;fct&gt; No, No, No, No, Insufficient Data, Insufficient Data, No, N…\n$ TCHOL      &lt;dbl&gt; 133, 131, 180, 171, 125, NA, 134, 105, 141, 153, 170, 170, …\n$ TRIG       &lt;dbl&gt; 176, 107, 233, 139, NA, NA, NA, 104, 162, 127, NA, NA, 82, …\n$ LDL        &lt;dbl&gt; 62, 66, 86, 96, NA, NA, NA, 44, 73, 84, NA, NA, 127, NA, NA…\n$ DYSLIP     &lt;fct&gt; \"Yes\", \"No\", \"Yes\", \"No\", \"Yes\", \"Insufficient data\", \"Yes,…\n$ CESD       &lt;dbl&gt; 14, 2, 1, 18, 20, 18, 18, 21, 23, 17, 18, 22, 23, 14, 1, 1,…\n$ SMOKE      &lt;fct&gt; Current Smoker, Current Smoker, Current Smoker, Current Smo…\n$ DKGRP      &lt;fct&gt; None, &gt;13 drinks/week, None, 1-3 drinks/week, None, &gt;13 dri…\n$ HEROPIATE  &lt;fct&gt; No, No, No, No, No, No, No, No, No, No, No, No, No, No, No,…\n$ IDU        &lt;fct&gt; Yes, No, No, No, Yes, No, No, No, No, No, Yes, Yes, Yes, Ye…\n$ LEU3N      &lt;dbl&gt; 104.1659, 262.0061, 345.4010, 292.3271, 257.8278, 459.4562,…\n$ VLOAD      &lt;dbl&gt; 102013.000000, 27.000000, 60.000000, 9.000000, 8121.000000,…\n$ ADH        &lt;fct&gt; NA, 95-99%, 100%, 100%, NA, 100%, 100%, 100%, 100%, 100%, N…\n$ RACE       &lt;fct&gt; \"White, non-Hispanic\", \"White, non-Hispanic\", \"White, non-H…\n$ EDUCBAS    &lt;fct&gt; \"At least one year college but no degree\", \"At least one ye…\n$ hivpos     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ age        &lt;dbl&gt; 52, 53, 54, 55, 54, 55, 56, 60, 61, 62, 47, 48, 49, 51, 52,…\n$ ART        &lt;dbl&gt; 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1,…\n$ everART    &lt;dbl&gt; 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1,…\n$ years      &lt;dbl&gt; 0, 1, 2, 3, 0, 1, 2, 6, 7, 8, 0, 1, 2, 4, 5, 6, 7, 8, 0, 1,…\n$ hard_drugs &lt;fct&gt; Yes, No, No, No, Yes, No, No, No, No, No, Yes, Yes, Yes, Ye…\n\n\nLooks good."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#filtering-data-set",
    "href": "Project_2/Project_2_R/Code/Project2.html#filtering-data-set",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Filtering Data Set",
    "text": "Filtering Data Set\nNow let’s take a look at the header to get a good feeling for our data.\n\n# Pretty print data header\npretty_print(head(data))\n\n\n\n\nnewid\nAGG_MENT\nAGG_PHYS\nHASHV\nHASHF\nincome\nBMI\nHBP\nDIAB\nLIV34\nKID\nFRP\nFP\nTCHOL\nTRIG\nLDL\nDYSLIP\nCESD\nSMOKE\nDKGRP\nHEROPIATE\nIDU\nLEU3N\nVLOAD\nADH\nRACE\nEDUCBAS\nhivpos\nage\nART\neverART\nyears\nhard_drugs\n\n\n\n\n1\n44.90710\n52.52557\nNo\nNA\n$30,000-$39,999\n24.71756\nNo\nNo\nNo\nNo\nNo\nNo\n133\n176\n62\nYes\n14\nCurrent Smoker\nNone\nNo\nYes\n104.1659\n102013\nNA\nWhite, non-Hispanic\nAt least one year college but no degree\n1\n52\n0\n0\n0\nYes\n\n\n1\n58.20754\n41.29346\nNo\nLess Often\n$30,000-$39,999\n26.06801\nNo\nNo\nNo\nNo\nNo\nNo\n131\n107\n66\nNo\n2\nCurrent Smoker\n&gt;13 drinks/week\nNo\nNo\n262.0061\n27\n95-99%\nWhite, non-Hispanic\nAt least one year college but no degree\n1\n53\n1\n1\n1\nNo\n\n\n1\n59.65136\n48.54453\nNo\nNever\n$30,000-$39,999\n27.16421\nNo\nNo\nNo\nNo\nNo\nNo\n180\n233\n86\nYes\n1\nCurrent Smoker\nNone\nNo\nNo\n345.4010\n60\n100%\nWhite, non-Hispanic\nAt least one year college but no degree\n1\n54\n1\n1\n2\nNo\n\n\n1\n56.80657\n46.73991\nNo\nNever\n$40,000-$49,999\n25.71786\nNo\nNo\nNo\nNo\nNo\nNo\n171\n139\n96\nNo\n18\nCurrent Smoker\n1-3 drinks/week\nNo\nNo\n292.3271\n9\n100%\nWhite, non-Hispanic\nAt least one year college but no degree\n1\n55\n1\n1\n3\nNo\n\n\n2\n46.34190\n27.92331\nNo\nNever\n$10,000-$19,999\n26.66936\nYes\nInsufficient data\nNo\nInsufficient data\nYes\nInsufficient Data\n125\nNA\nNA\nYes\n20\nCurrent Smoker\nNone\nNo\nYes\n257.8278\n8121\nNA\nBlack, non-Hispanic\n9,10, or 11th grade\n1\n54\n0\n0\n0\nYes\n\n\n2\n48.71791\n38.03807\nYes\nNever\nLess than $10,000\n25.96576\nYes\nInsufficient data\nNo\nInsufficient data\nNo\nInsufficient Data\nNA\nNA\nNA\nInsufficient data\n18\nCurrent Smoker\n&gt;13 drinks/week\nNo\nNo\n459.4562\n21\n100%\nBlack, non-Hispanic\n9,10, or 11th grade\n1\n55\n1\n1\n1\nNo\n\n\n\n\n\n\n\nHmm, we have 8 years worth of data points, but the experimenters are only interested in the first 2 years.\nOut of curiosity, let’s look at how many participants they had each year.\n\n# Visualize patient drop off over 8 years of study\nbarplot(table(data$years))\n\n\n\n\n\n\n\n# Check number of patients in each year\npretty_print(table(data$years))\n\n\n\n\nVar1\nFreq\n\n\n\n\n0\n550\n\n\n1\n550\n\n\n2\n550\n\n\n3\n414\n\n\n4\n381\n\n\n5\n338\n\n\n6\n325\n\n\n7\n272\n\n\n8\n252\n\n\n\n\n\n\n\nThis is interesting, we don’t seem to have as drastic a drop off as I expected. The researchers managed to retain all participants for the first 2 years, and 50% by the end of the 8-year study.\nLet’s filter to only include values from the first 2 years, as this is the timeframe the researchers are interested in.\n\n# Filter long form data set to be include only first 2 years\ndata_2 &lt;- data[data$years &lt;= 2,]\n\n# Check how many visits we have in the filtered data set.\ndim(data_2)\n\n[1] 1650   33\n\n\nWe went from 3632 visits in the 8 year data set to 1650 in the 2 year filtered data set.\n\n# Double check if any patients dropped out within the first 2 years\nany(is.na(data_2$years))\n\n[1] FALSE\n\n\nLuckily, no patients dropped out within the first 2 years of the study!"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#transpose-to-wideform",
    "href": "Project_2/Project_2_R/Code/Project2.html#transpose-to-wideform",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Transpose to Wideform",
    "text": "Transpose to Wideform\nWe can also see that the provided data set is in longform. Let’s convert that to wideform.\n\n# Create new wideform data set for first 2 years of study              \ndata_wide_2 &lt;- pivot_wider(data_2, id_cols = newid, names_from = years, values_from = -c(newid, years))\n\nAnd take a look at the header to check that was done correctly.\n\n# Pretty print header of wideform data\npretty_print(head(data_wide_2))\n\n\n\n\nnewid\nAGG_MENT_0\nAGG_MENT_1\nAGG_MENT_2\nAGG_PHYS_0\nAGG_PHYS_1\nAGG_PHYS_2\nHASHV_0\nHASHV_1\nHASHV_2\nHASHF_0\nHASHF_1\nHASHF_2\nincome_0\nincome_1\nincome_2\nBMI_0\nBMI_1\nBMI_2\nHBP_0\nHBP_1\nHBP_2\nDIAB_0\nDIAB_1\nDIAB_2\nLIV34_0\nLIV34_1\nLIV34_2\nKID_0\nKID_1\nKID_2\nFRP_0\nFRP_1\nFRP_2\nFP_0\nFP_1\nFP_2\nTCHOL_0\nTCHOL_1\nTCHOL_2\nTRIG_0\nTRIG_1\nTRIG_2\nLDL_0\nLDL_1\nLDL_2\nDYSLIP_0\nDYSLIP_1\nDYSLIP_2\nCESD_0\nCESD_1\nCESD_2\nSMOKE_0\nSMOKE_1\nSMOKE_2\nDKGRP_0\nDKGRP_1\nDKGRP_2\nHEROPIATE_0\nHEROPIATE_1\nHEROPIATE_2\nIDU_0\nIDU_1\nIDU_2\nLEU3N_0\nLEU3N_1\nLEU3N_2\nVLOAD_0\nVLOAD_1\nVLOAD_2\nADH_0\nADH_1\nADH_2\nRACE_0\nRACE_1\nRACE_2\nEDUCBAS_0\nEDUCBAS_1\nEDUCBAS_2\nhivpos_0\nhivpos_1\nhivpos_2\nage_0\nage_1\nage_2\nART_0\nART_1\nART_2\neverART_0\neverART_1\neverART_2\nhard_drugs_0\nhard_drugs_1\nhard_drugs_2\n\n\n\n\n1\n44.90710\n58.20754\n59.65136\n52.52557\n41.29346\n48.54453\nNo\nNo\nNo\nNA\nLess Often\nNever\n$30,000-$39,999\n$30,000-$39,999\n$30,000-$39,999\n24.71756\n26.06801\n27.16421\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\n133\n131\n180\n176\n107\n233\n62\n66\n86\nYes\nNo\nYes\n14\n2\n1\nCurrent Smoker\nCurrent Smoker\nCurrent Smoker\nNone\n&gt;13 drinks/week\nNone\nNo\nNo\nNo\nYes\nNo\nNo\n104.1659\n262.0061\n345.4010\n102013.000\n27.00000\n60.00000\nNA\n95-99%\n100%\nWhite, non-Hispanic\nWhite, non-Hispanic\nWhite, non-Hispanic\nAt least one year college but no degree\nAt least one year college but no degree\nAt least one year college but no degree\n1\n1\n1\n52\n53\n54\n0\n1\n1\n0\n1\n1\nYes\nNo\nNo\n\n\n2\n46.34190\n48.71791\n45.41483\n27.92331\n38.03807\n37.32204\nNo\nYes\nNo\nNever\nNever\nNever\n$10,000-$19,999\nLess than $10,000\n$10,000-$19,999\n26.66936\n25.96576\n26.96037\nYes\nYes\nYes\nInsufficient data\nInsufficient data\nInsufficient data\nNo\nNo\nNo\nInsufficient data\nInsufficient data\nInsufficient data\nYes\nNo\nNo\nInsufficient Data\nInsufficient Data\nNo\n125\nNA\n134\nNA\nNA\nNA\nNA\nNA\nNA\nYes\nInsufficient data\nYes, based on data trajectory\n20\n18\n18\nCurrent Smoker\nCurrent Smoker\nCurrent Smoker\nNone\n&gt;13 drinks/week\n4-13 drinks/week\nNo\nNo\nNo\nYes\nNo\nNo\n257.8278\n459.4562\n263.0693\n8121.000\n21.00000\n48.00000\nNA\n100%\n100%\nBlack, non-Hispanic\nBlack, non-Hispanic\nBlack, non-Hispanic\n9,10, or 11th grade\n9,10, or 11th grade\n9,10, or 11th grade\n1\n1\n1\n54\n55\n56\n0\n1\n1\n0\n1\n1\nYes\nNo\nNo\n\n\n3\n40.22337\n44.42011\n41.70079\n60.06970\n62.71705\n58.51450\nNo\nNo\nYes\nLess Often\nLess Often\nLess Often\n$50,000-$59,999\n$50,000-$59,999\n$50,000-$59,999\n28.59085\n28.35320\n28.18510\nInsufficient data, may include reported treatment without diagnosis\nInsufficient data, may include reported treatment without diagnosis\nNo\nInsufficient data\nInsufficient data\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\n170\n170\n180\nNA\nNA\n82\nNA\nNA\n127\nYes\nYes\nYes\n18\n22\n23\nFormer Smoker\nFormer Smoker\nFormer Smoker\nNone\nNone\nNone\nNo\nNo\nNo\nYes\nYes\nYes\n563.1223\n488.9100\n405.1816\n4001.556\n2020.00000\n27.50917\nNA\n100%\n100%\nWhite, non-Hispanic\nWhite, non-Hispanic\nWhite, non-Hispanic\nPost-graduate degree\nPost-graduate degree\nPost-graduate degree\n1\n1\n1\n47\n48\n49\n0\n1\n1\n0\n1\n1\nYes\nYes\nYes\n\n\n4\n42.90638\n31.15971\n52.68223\n50.78850\n44.62883\n51.50533\nYes\nNo\nNo\nLess Often\nWeekly\nNever\nLess than $10,000\nLess than $10,000\nNA\n20.36451\n18.21865\n20.28485\nNo\nNo\nNo\nNo\nNo, based on data trajectory\nNo\nNo\nNo\nNo\nInsufficient data\nInsufficient data\nInsufficient data\nNo\nYes\nNo\nNo\nYes\nNo\n214\n197\n251\n97\nNA\n260\n147\nNA\n152\nYes\nYes, based on data trajectory\nYes\n14\n25\n13\nCurrent Smoker\nCurrent Smoker\nCurrent Smoker\n1-3 drinks/week\n4-13 drinks/week\nNone\nYes\nYes\nNo\nNo\nNo\nNo\n110.4218\n159.6297\n179.6409\n740.000\n26.64732\n27.00000\nNA\n75-94%\n95-99%\nWhite, non-Hispanic\nWhite, non-Hispanic\nWhite, non-Hispanic\nFour years college or got degree\nFour years college or got degree\nFour years college or got degree\n1\n1\n1\n44\n45\n46\n0\n1\n1\n0\n1\n1\nYes\nYes\nNo\n\n\n5\n56.42904\n56.21993\n66.50629\n43.75671\n30.47055\n18.82350\nNo\nNA\nYes\nMonthly\nMonthly\nLess Often\n$50,000-$59,999\n$10,000-$19,999\nDo not wish to answer\n22.26986\n24.97865\n20.80193\nNo\nNo\nNo\nInsufficient data\nInsufficient data\nInsufficient data\nNo\nNo\nInsufficient Data\nInsufficient data\nInsufficient data\nInsufficient data\nNo\nNo\nYes\nInsufficient Data\nInsufficient Data\nYes\n196\n204\nNA\n162\n192\nNA\n135\nNA\nNA\nYes\nInsufficient data\nYes, based on data trajectory\n1\n0\n1\nCurrent Smoker\nCurrent Smoker\nCurrent Smoker\nNone\n1-3 drinks/week\n1-3 drinks/week\nNot Specified\nNA\nNo\nYes\nYes\nYes\n252.6634\n92.6634\n59.6219\n62727.039\n30389.00000\n419.50000\nNA\n100%\n100%\nWhite, non-Hispanic\nWhite, non-Hispanic\nWhite, non-Hispanic\nPost-graduate degree\nPost-graduate degree\nPost-graduate degree\n1\n1\n1\n53\n54\n55\n0\n1\n1\n0\n1\n1\nYes\nYes\nYes\n\n\n6\n59.74437\n53.84956\n50.26010\n56.86261\n57.91396\n55.95668\nNo\nNo\nNo\nNA\nNA\nLess Often\n$30,000-$39,999\n$30,000-$39,999\nNA\n23.22166\n23.75318\n22.41001\nNo\nNo\nNo\nInsufficient data\nInsufficient data\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\nNo\n216\n216\n151\nNA\nNA\n125\nNA\nNA\n81\nInsufficient data\nInsufficient data\nNo\n3\n3\n4\nNever Smoked\nNever Smoked\nNever Smoked\n1-3 drinks/week\n1-3 drinks/week\n1-3 drinks/week\nNo\nNo\nNo\nNo\nNo\nYes\n634.1246\n745.6517\n893.4328\n15745.000\n7870.00000\n53.50000\nNA\n95-99%\n95-99%\nWhite, non-Hispanic\nWhite, non-Hispanic\nWhite, non-Hispanic\nSome graduate work\nSome graduate work\nSome graduate work\n1\n1\n1\n36\n37\n38\n0\n1\n1\n0\n1\n1\nNo\nNo\nYes\n\n\n\n\n\n\n\nGood. now we have a long and wide form of the data set for the first two years of the study.\nFinally, let’s just clean that wide data set up a bit to drop repeat measures of variables that are constant over time (race, education at baseline, HIV serostatus, everART)\n\n# Clean up the wide data set a bit by deleting multiple observations across time for constant variables such as race\ndata_wide_2 &lt;- data_wide_2 %&gt;% select(-RACE_1, -RACE_2, -EDUCBAS_1, -EDUCBAS_2, -hivpos_1, - hivpos_2, -everART_1, -everART_2)\n\nNow that our data sets are adequately prepared, we can move on to performing our data checks to ensure fidelity of the data set."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#removing-superfluous-variables",
    "href": "Project_2/Project_2_R/Code/Project2.html#removing-superfluous-variables",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Removing Superfluous Variables",
    "text": "Removing Superfluous Variables\nWe previously determined that LDL, TRIG, DIAB, KID, and DYSLIP had excessive missing values (&gt;40%).\nNow that we have seen that they are not strongly related to the outcome variables, we can be assured that we can safely remove them with no need for imputation.\n\n# Drop variables with excessive missing values from the wideform data set\ndata_2 &lt;- data_2 %&gt;%\n  select(-LDL, -TRIG, -DIAB, -KID, -DYSLIP)\n\nFRP and FP are both precision variables for AGG_PHYS, but highly correlated to each other.\nFP has more missing values (22%) than FRP(~0%), and will thus be dropped.\n\n# Drop FP\ndata_2 &lt;- data_2 %&gt;%\n  select(-FP)\n\nEDUCBASE is highly correlated with income, TCHOL, SMOKE, and RACE.\nincome has 27% missing values and thus will be dropped from further analysis.\nTCHOL has 32% missing values and will thus be dropped.\nSMOKE and RACE will be dropped to avoid issues of multicollinearity, and EDUCBASE used as the covariate of choice.\n\n# Drop income, total cholesterol, smoke, and race\ndata_2 &lt;- data_2 %&gt;%\n  select(-income, -TCHOL, -SMOKE, -RACE)\n\nHard_drugs is highly correlated with HEROPIATE and IDU.\nHard_drugs is our main independent variable of interest and thus we drop HEROPIATE and IDU.\n\n# Drop income, total cholesterol, smoke, and race\ndata_2 &lt;- data_2 %&gt;%\n  select(-HEROPIATE, -IDU)\n\nHBP is lightly correlated with age and BMI. Let’s drop it to avoid multicollinearity.\n\n# Drop high blood pressure.\ndata_2 &lt;- data_2 %&gt;%\n  select(-HBP)"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#correlation-matrix-redux",
    "href": "Project_2/Project_2_R/Code/Project2.html#correlation-matrix-redux",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Correlation Matrix Redux",
    "text": "Correlation Matrix Redux\nLet’s take another look at that correlation matrix now that we have cleaned up our data set to remove variables with excessive missing values and issues of multicollinearity.\n\n# Let's clean our output by making a trimmed dataset excluding extraneous variables\ndata_for_matrix &lt;- select(data_wide_2, AGG_MENT_CHANGE, AGG_PHYS_CHANGE, LEU3N_CHANGE, VLOAD_log_CHANGE, BMI_2, FRP_2, CESD_2, DKGRP_2, ADH_2, ADH_HIGHVSLOW, EDUC_COLLEGE, age_2, hard_drugs_grp)\n\n# We factored our variables at the start. To make a correlation matrix we must reconvert those back to numeric\ndata_for_matrix &lt;- data.frame(lapply(data_for_matrix, function(x) if (is.factor(x)) as.numeric(x) else x))\n\n# Make a correlation matrix with all variables of the trimmed data set\ncorrelation_matrix &lt;- cor(data_for_matrix, use = \"complete.obs\")\n\n# Plot the matrix\ncorrplot(correlation_matrix, method = \"circle\")\n\n\n\n\n\n\n\n\nLooking MUCH better! Here we can see some potentially strong relationships emerge.\n\nCESD as mentioned will be included as a precision variable for AGG_MENT\nFRP as mentioned will be included as a precision variable for AGG_PHYS\nEDUCBASE looks like it will be a predictor for all outcome variables except AGG_MENT\nBMI appears to have a weak correlation with all outcome variables and will likely be included in the final models.\nage also looks weakly correlated to all outcome variables except VLOAD_log\n\nLet’s run some individual regression and assess these relationships more closely.\np-values of &lt; 0.1 will be considered for the final models."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#log-viral-load-change-1",
    "href": "Project_2/Project_2_R/Code/Project2.html#log-viral-load-change-1",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Log Viral Load Change",
    "text": "Log Viral Load Change\n\nFull ModelReduced Model - No InteractionConfoundingVisualizing Main Effects\n\n\nAs determined by interactive variable selection, the variables of interest for a model predicting VLOAD_log_CHANGE are hard_drug_grp, ADH_HIGHVSLOW, and EDUC_COLLEGE.\nThe researchers are interested in if differences in treatment response between the drug use groups can be explained by differences in adherence to the HAART regimen, so we will also include an interaction term between hard drug use group and adherence.\nThus the full model is:\n                                     ADD LATEX MATH SYNTAX HERE.\n                                     \n\nAnalysisModel SelectionInterpretationVisualizing the Interaction\n\n\nLet’s run the regression for the full model.\n\n# Relevel reference group\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel reference group\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform the regression on log viral load change with the full model\nmodel_VLOAD_full1 &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\nlibrary(sjPlot)\n\nInstall package \"strengejacke\" from GitHub (`devtools::install_github(\"strengejacke/strengejacke\")`) to load all sj-packages at once!\n\n# Examine summary\nsummary(model_VLOAD_full1)\n\n\nCall:\nlm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.2508 -1.6120 -0.2134  1.1308  9.2569 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                              -4.9327     0.5241\nhard_drugs_grpPrevious User                               5.8083     1.1857\nhard_drugs_grpCurrent User                                3.4758     1.4138\nADH_HIGHVSLOWHigh Adherence                              -0.7876     0.4898\nEDUC_COLLEGECollege                                      -0.8489     0.2955\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -5.8479     1.2773\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   -2.7430     1.4659\n                                                        t value\n(Intercept)                                              -9.412\nhard_drugs_grpPrevious User                               4.898\nhard_drugs_grpCurrent User                                2.458\nADH_HIGHVSLOWHigh Adherence                              -1.608\nEDUC_COLLEGECollege                                      -2.872\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -4.578\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   -1.871\n                                                                    Pr(&gt;|t|)\n(Intercept)                                             &lt; 0.0000000000000002\nhard_drugs_grpPrevious User                                       0.00000130\nhard_drugs_grpCurrent User                                           0.01428\nADH_HIGHVSLOWHigh Adherence                                          0.10846\nEDUC_COLLEGECollege                                                  0.00424\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence           0.00000589\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence               0.06189\n                                                           \n(Intercept)                                             ***\nhard_drugs_grpPrevious User                             ***\nhard_drugs_grpCurrent User                              *  \nADH_HIGHVSLOWHigh Adherence                                \nEDUC_COLLEGECollege                                     ** \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.661 on 513 degrees of freedom\n  (30 observations deleted due to missingness)\nMultiple R-squared:  0.1001,    Adjusted R-squared:  0.08956 \nF-statistic:  9.51 on 6 and 513 DF,  p-value: 0.0000000006388\n\ntab_model(model_VLOAD_full1)\n\n\n\n\n\n\n\n\n\n\n \nLog Viral Load Change\nScore\n\n\nPredictors\nEstimates\nCI\np\n\n\n(Intercept)\n-4.93\n-5.96 – -3.90\n&lt;0.001\n\n\nhard_drugs_grp: Previous\nUser\n5.81\n3.48 – 8.14\n&lt;0.001\n\n\nhard_drugs_grp: Current\nUser\n3.48\n0.70 – 6.25\n0.014\n\n\nADH_HIGHVSLOW: High\nAdherence\n-0.79\n-1.75 – 0.17\n0.108\n\n\nCollege Status: College\n-0.85\n-1.43 – -0.27\n0.004\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n-5.85\n-8.36 – -3.34\n&lt;0.001\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n-2.74\n-5.62 – 0.14\n0.062\n\n\nObservations\n520\n\n\nR2 / R2 adjusted\n0.100 / 0.090\n\n\n\n\n\n\n\n\n# Print useful model parameters\nmodel_results(model_VLOAD_full1)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-4.9326626\n0.5240675\n-9.412266\n0.0000000\n0.0000000\n-5.9622450\n-3.9030801\n\n\nhard_drugs_grpPrevious User\n5.8083303\n1.1857389\n4.898490\n0.0000013\n0.0000091\n3.4788288\n8.1378317\n\n\nhard_drugs_grpCurrent User\n3.4757907\n1.4138375\n2.458409\n0.0142848\n0.0999936\n0.6981668\n6.2534145\n\n\nADH_HIGHVSLOWHigh Adherence\n-0.7876174\n0.4898289\n-1.607944\n0.1084627\n0.7592392\n-1.7499349\n0.1747001\n\n\nEDUC_COLLEGECollege\n-0.8489132\n0.2955395\n-2.872418\n0.0042421\n0.0296945\n-1.4295299\n-0.2682965\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n-5.8479420\n1.2773135\n-4.578314\n0.0000059\n0.0000412\n-8.3573508\n-3.3385331\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n-2.7429503\n1.4659004\n-1.871171\n0.0618904\n0.4332325\n-5.6228568\n0.1369561\n\n\n\n\n\n\n# Get the VIFs\nvif_values &lt;- vif(model_VLOAD_full1)\n\nthere are higher-order terms (interactions) in this model\nconsider setting type = 'predictor'; see ?vif\n\npretty_print(vif_values)\n\n\n\n\n\nGVIF\nDf\nGVIF^(1/(2*Df))\n\n\n\n\nhard_drugs_grp\n121.062588\n2\n3.317054\n\n\nADH_HIGHVSLOW\n1.307856\n1\n1.143615\n\n\nEDUC_COLLEGE\n1.090681\n1\n1.044357\n\n\nhard_drugs_grp:ADH_HIGHVSLOW\n125.887538\n2\n3.349621\n\n\n\n\n\n\n\nThe overall model is highly significant (p &lt; 0.000001) and we’re getting some interesting significant relationships. It looks like all of our main variables and interaction term are significant. Multicollinearity for this model is not a concern.\nFor low adherence, previous and current drug users have a higher increase in log viral load change over 2 years compared to never hard drug users (p &gt; 0.05).\nFor never drug users, there is no difference in log viral load over 2 years in those with high adherence compared to those with low adherence (p = 0.11).\nLet’s keep going.\nChange the reference category to high adherence, to compare the impact of hard drug use groups for those with high adherence to the treatment regiment.\n\n# Relevel reference group\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform the regression on log viral load change with the full model\nmodel_VLOAD_full2 &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\n# Examine summary\nsummary(model_VLOAD_full2)\n\n\nCall:\nlm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.2508 -1.6120 -0.2134  1.1308  9.2569 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                            -5.72028    0.27445\nhard_drugs_grpPrevious User                            -0.03961    0.45829\nhard_drugs_grpCurrent User                              0.73284    0.38167\nADH_HIGHVSLOWLow Adherence                              0.78762    0.48983\nEDUC_COLLEGECollege                                    -0.84891    0.29554\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  5.84794    1.27731\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   2.74295    1.46590\n                                                       t value\n(Intercept)                                            -20.843\nhard_drugs_grpPrevious User                             -0.086\nhard_drugs_grpCurrent User                               1.920\nADH_HIGHVSLOWLow Adherence                               1.608\nEDUC_COLLEGECollege                                     -2.872\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   4.578\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence    1.871\n                                                                   Pr(&gt;|t|)    \n(Intercept)                                            &lt; 0.0000000000000002 ***\nhard_drugs_grpPrevious User                                         0.93116    \nhard_drugs_grpCurrent User                                          0.05540 .  \nADH_HIGHVSLOWLow Adherence                                          0.10846    \nEDUC_COLLEGECollege                                                 0.00424 ** \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence           0.00000589 ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence               0.06189 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.661 on 513 degrees of freedom\n  (30 observations deleted due to missingness)\nMultiple R-squared:  0.1001,    Adjusted R-squared:  0.08956 \nF-statistic:  9.51 on 6 and 513 DF,  p-value: 0.0000000006388\n\n\n\n# Print useful model parameters\nmodel_results(model_VLOAD_full2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-5.7202799\n0.2744497\n-20.8427262\n0.0000000\n0.0000000\n-6.2594636\n-5.1810963\n\n\nhard_drugs_grpPrevious User\n-0.0396117\n0.4582879\n-0.0864341\n0.9311551\n1.0000000\n-0.9399637\n0.8607403\n\n\nhard_drugs_grpCurrent User\n0.7328404\n0.3816725\n1.9200766\n0.0554024\n0.3878167\n-0.0169930\n1.4826737\n\n\nADH_HIGHVSLOWLow Adherence\n0.7876174\n0.4898289\n1.6079437\n0.1084627\n0.7592392\n-0.1747001\n1.7499349\n\n\nEDUC_COLLEGECollege\n-0.8489132\n0.2955395\n-2.8724184\n0.0042421\n0.0296945\n-1.4295299\n-0.2682965\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence\n5.8479420\n1.2773135\n4.5783138\n0.0000059\n0.0000412\n3.3385331\n8.3573508\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence\n2.7429503\n1.4659004\n1.8711710\n0.0618904\n0.4332325\n-0.1369561\n5.6228568\n\n\n\n\n\n\n\nAt the high adherence levels, there is no difference between previous and current hard drug users and never hard drug users on log viral load change (p &gt; 0.05).\nChange the reference categories to previous users and low adherence to compare the impact of hard drug use groups for those with low adherence to the treatment regiment.\n\n# Relevel reference group\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel reference group\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform the regression on log viral load change with the full model\nmodel_VLOAD_full3 &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\n\n# Examine summary\nsummary(model_VLOAD_full3)\n\n\nCall:\nlm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.2508 -1.6120 -0.2134  1.1308  9.2569 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                              0.8757     1.1260\nhard_drugs_grpNever User                                -5.8083     1.1857\nhard_drugs_grpCurrent User                              -2.3325     1.7242\nADH_HIGHVSLOWHigh Adherence                             -6.6356     1.1785\nEDUC_COLLEGECollege                                     -0.8489     0.2955\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     5.8479     1.2773\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   3.1050     1.8278\n                                                       t value     Pr(&gt;|t|)    \n(Intercept)                                              0.778      0.43710    \nhard_drugs_grpNever User                                -4.898 0.0000012967 ***\nhard_drugs_grpCurrent User                              -1.353      0.17672    \nADH_HIGHVSLOWHigh Adherence                             -5.630 0.0000000297 ***\nEDUC_COLLEGECollege                                     -2.872      0.00424 ** \nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     4.578 0.0000058885 ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   1.699      0.08997 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.661 on 513 degrees of freedom\n  (30 observations deleted due to missingness)\nMultiple R-squared:  0.1001,    Adjusted R-squared:  0.08956 \nF-statistic:  9.51 on 6 and 513 DF,  p-value: 0.0000000006388\n\n# Print useful model parameters\nmodel_results(model_VLOAD_full3)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n0.8756677\n1.1259682\n0.777702\n0.4371032\n1.0000000\n-1.3364083\n3.0877438\n\n\nhard_drugs_grpNever User\n-5.8083303\n1.1857389\n-4.898490\n0.0000013\n0.0000091\n-8.1378317\n-3.4788288\n\n\nhard_drugs_grpCurrent User\n-2.3325396\n1.7242354\n-1.352796\n0.1767166\n1.0000000\n-5.7199709\n1.0548917\n\n\nADH_HIGHVSLOWHigh Adherence\n-6.6355594\n1.1785472\n-5.630287\n0.0000000\n0.0000002\n-8.9509321\n-4.3201866\n\n\nEDUC_COLLEGECollege\n-0.8489132\n0.2955395\n-2.872418\n0.0042421\n0.0296945\n-1.4295299\n-0.2682965\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence\n5.8479420\n1.2773135\n4.578314\n0.0000059\n0.0000412\n3.3385331\n8.3573508\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n3.1049916\n1.8277854\n1.698773\n0.0899684\n0.6297785\n-0.4858737\n6.6958570\n\n\n\n\n\n\n\nAt low adherence, there is a significant difference between previous and current drug users, with current drug users having a higher increase in log viral load over 2 years (p &lt; 0.0001).\nFor previous drug users, those with high adherence had less of an increase in log viral load over 2 years compared to those with low adherence (p &lt; 0.0001).\nChange the reference group to previous drug users and high adherence.\n\n# Relevel reference group\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel reference group\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform the regression on log viral load change with the full model\nmodel_VLOAD_full4 &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\n# Examine summary\nsummary(model_VLOAD_full4)\n\n\nCall:\nlm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.2508 -1.6120 -0.2134  1.1308  9.2569 \n\nCoefficients:\n                                                      Estimate Std. Error\n(Intercept)                                           -5.75989    0.43709\nhard_drugs_grpNever User                               0.03961    0.45829\nhard_drugs_grpCurrent User                             0.77245    0.56988\nADH_HIGHVSLOWLow Adherence                             6.63556    1.17855\nEDUC_COLLEGECollege                                   -0.84891    0.29554\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence   -5.84794    1.27731\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence -3.10499    1.82779\n                                                      t value\n(Intercept)                                           -13.178\nhard_drugs_grpNever User                                0.086\nhard_drugs_grpCurrent User                              1.355\nADH_HIGHVSLOWLow Adherence                              5.630\nEDUC_COLLEGECollege                                    -2.872\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    -4.578\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence  -1.699\n                                                                  Pr(&gt;|t|)    \n(Intercept)                                           &lt; 0.0000000000000002 ***\nhard_drugs_grpNever User                                           0.93116    \nhard_drugs_grpCurrent User                                         0.17587    \nADH_HIGHVSLOWLow Adherence                                    0.0000000297 ***\nEDUC_COLLEGECollege                                                0.00424 ** \nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence           0.0000058885 ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence              0.08997 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.661 on 513 degrees of freedom\n  (30 observations deleted due to missingness)\nMultiple R-squared:  0.1001,    Adjusted R-squared:  0.08956 \nF-statistic:  9.51 on 6 and 513 DF,  p-value: 0.0000000006388\n\n\n\n# Print useful model parameters\nmodel_results(model_VLOAD_full4)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-5.7598916\n0.4370859\n-13.1779394\n0.0000000\n0.0000000\n-6.6185902\n-4.9011931\n\n\nhard_drugs_grpNever User\n0.0396117\n0.4582879\n0.0864341\n0.9311551\n1.0000000\n-0.8607403\n0.9399637\n\n\nhard_drugs_grpCurrent User\n0.7724521\n0.5698803\n1.3554637\n0.1758663\n1.0000000\n-0.3471342\n1.8920383\n\n\nADH_HIGHVSLOWLow Adherence\n6.6355594\n1.1785472\n5.6302871\n0.0000000\n0.0000002\n4.3201866\n8.9509321\n\n\nEDUC_COLLEGECollege\n-0.8489132\n0.2955395\n-2.8724184\n0.0042421\n0.0296945\n-1.4295299\n-0.2682965\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence\n-5.8479420\n1.2773135\n-4.5783138\n0.0000059\n0.0000412\n-8.3573508\n-3.3385331\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence\n-3.1049916\n1.8277854\n-1.6987726\n0.0899684\n0.6297785\n-6.6958570\n0.4858737\n\n\n\n\n\n\n\nAt the high adherence level, there is no difference in log viral load change between current and previous hard drug users (p &gt; 0.05).\nChange the reference categories to current users and low adherence to compare the impact of hard drug use groups for those with low adherence to the treatment regiment.\n\n# Relevel reference group\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel reference group\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform the regression on log viral load change with the full model\nmodel_VLOAD_full5 &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\n# Examine summary\nsummary(model_VLOAD_full5)\n\n\nCall:\nlm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.2508 -1.6120 -0.2134  1.1308  9.2569 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                              -1.4569     1.3389\nhard_drugs_grpPrevious User                               2.3325     1.7242\nhard_drugs_grpNever User                                 -3.4758     1.4138\nADH_HIGHVSLOWHigh Adherence                              -3.5306     1.3823\nEDUC_COLLEGECollege                                      -0.8489     0.2955\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -3.1050     1.8278\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      2.7430     1.4659\n                                                        t value Pr(&gt;|t|)   \n(Intercept)                                              -1.088  0.27704   \nhard_drugs_grpPrevious User                               1.353  0.17672   \nhard_drugs_grpNever User                                 -2.458  0.01428 * \nADH_HIGHVSLOWHigh Adherence                              -2.554  0.01093 * \nEDUC_COLLEGECollege                                      -2.872  0.00424 **\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -1.699  0.08997 . \nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      1.871  0.06189 . \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.661 on 513 degrees of freedom\n  (30 observations deleted due to missingness)\nMultiple R-squared:  0.1001,    Adjusted R-squared:  0.08956 \nF-statistic:  9.51 on 6 and 513 DF,  p-value: 0.0000000006388\n\n\nFor current hard drug users, those with high adherence have a lower increase in log viral load over 2 years compared to those with low adherence (p = 0.011).\nTop of Tabset\n\n\nWe can see that all variables, including EDUC_COLLEGE, are significant, and thus there is no need to compare the full model to reduced models; this is our final model for VLOAD_log_CHANGE\nWe can double check this with a partial F-test comparing the full model with the reduced model without the interaction term\n\n# Perform full model with interaction term\nmodel_log_VLOAD_full &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + EDUC_COLLEGE + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Perform reduced model without interaction term\nmodel_log_VLOAD_red &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\n# Perform F-Test\nanova(model_log_VLOAD_red, model_log_VLOAD_full)\n\nAnalysis of Variance Table\n\nModel 1: VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + EDUC_COLLEGE\nModel 2: VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + EDUC_COLLEGE + \n    hard_drugs_grp * ADH_HIGHVSLOW\n  Res.Df    RSS Df Sum of Sq      F     Pr(&gt;F)    \n1    515 3794.7                                   \n2    513 3633.5  2    161.24 11.382 0.00001456 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nThe p-value is significant (p &lt; 0.0001), indicating that the interaction term adds explanatory power to the model and should be included. Thus we move on with interpreting the interaction.\nTop of Tabset\n\n\n\nOverall Model\nThere were significant differences in change in log viral load based on hard drug usage and adherence to the treatment regiment, while controlling for education at baseline (F~(6, 513)~= 9.51), p &lt; 0.0001).\n\n\nHard Drug Use\nThe relationship between hard drug use and change in log viral load over 2 years depended on adherence to the treatment regiment.\n\nHard Drug Use at Low Adherence\nFor those with low adherence to the treatment regiment, current hard drug users had a change in log viral load that was 3.48 log copies/mL (or change in copies/mL that was 32.32 times) higher than never hard drug users (t = 2.458, p-adjusted = 0.04284, 95% CI: 0.70 to 6.25 log copies/mL, or 2.01 to 519.78 times copies/mL). Additionally, for those with low adherence to the treatment regimen, previous hard drug users had a change in log viral load that was 5.81 log copies/mL (or change in copies/mL that was 333.05 times) greater than never hard drug users (t = 4.90, p-adjusted &lt; 0.0001, 95% CI: 3.48 to 8.14 log copies/mL, or 32.42 to 3421.49 times copies/mL).\nFor those with low adherence to the treatment regiment, the difference between previous and current drug users was not statistically significant (t = -1.35, p-adjusted = 0.177, 95% CI: -5.72 to 1.05 log copies/mL, or 0.0033 to 2.87 times copies/mL).\n\n\nHard Drug use at High Adherence\nFor those with high adherence to the protocol, there was no difference in log viral load between current and never hard drug users (t = 1.920, p-adjusted = 0.388, 95% CI: -0.017 to 1.48 log copies/mL), previous and never hard drug users (t = -0.086, p-adjusted = 1.00, 95% CI: -0.86 to 0.94 log copies/mL), or previous and current hard drug users (t = 1.355, p-adjusted = 1.00, 95% CI: -0.35 to 1.89 log copies/mL).\n\n\n\nAdherence\nThe relationship between adherence to the treatment regiment and change in log viral load over 2 years differed by hard drug use.\n\nAdherence for Current Hard Drug Users\nFor current hard drug users, those with high adherence had a change in log viral load that was 3.53 log copies/mL (or 0.029 times) less than that of those with low adherence (t = -2.554, p-adjusted = 0.0999936, 95% CI: -6.25 to -0.70 log copies/mL, or 0.0019 to 0.50 times). However, this relationship was not statistically significant following Bonferroni correction, likely due to the small number of patients who were hard drug users with low protocol adherence (n = 4). This relationship however does appear to be real based on trends in the data, and we recommend increasing the sample size to discover the true differences.\n\n\nAdherence for Previous Hard Drug Users\nFor previous hard drug users, those with high adherence had a change in log viral load that was 6.64 log copies/mL less (or 0.0013 times) than those with low adherence (t = -5.63, p-adjusted &lt; 0.0001, 95% CI: -8.95 to -4.32 log copies/mL, or 0.00013 to 0.013 times).\n\n\nAdherence for Never Hard Drug Users\nFor never hard drug users, the difference in log viral load between those with high adherence and low adherence was not statistically significant (t = -1.61, p-adusted = 0.759, 95% CI: -1.75 to 0.17 log copies/mL, or 0.17 to 1.19 times).\n\n\n\nAdditional Interaction Comparisons\nThere are additional comparisons we can make in the interaction between hard drug usage and adherence, but they are of little clinical relevance (e.g. current hard drug users with low adherence had a higher viral load compared to never hard drug users with high adherence). Basically, any comparison made between a current or previous hard drug user with low adherence was significant.\n\n\nCollege Education at Baseline\nEducation at baseline is a significant predictor for change in log viral load over 2 years, while controlling for hard drug use and adherence to treatment regiment (t = -2.872, p = 0.00424). On average, those with a college education had an 0.85 log copies/mL (or 2.34 times) greater decrease in log viral load than those without a college education (95% CI:-1.43 to -0.27 log copies/mL).\nTop of Tabset\n\n\n\nThe interaction between hard drug use and adherence group on log viral load can be visualized in the graph below.\n\n# Relevel reference group\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel reference group\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform a regression of the full model predicting log viral load change\nmodel_VLOAD_full &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\nlibrary(interactions)\n\n# Use interactions package to plot interaction\ncat_plot(\n  model_VLOAD_full, \n  pred = hard_drugs_grp, \n  modx = ADH_HIGHVSLOW, \n  geom = \"line\", \n  colors = \"Pastel2\",\n  x.label = \"Hard Drugs Group\",\n  y.label = \"Predicted Log Viral Load Change\"\n)\n\n\n\n\n\n\n\n\nThis very clearly illustrates the relationships we saw in our model.\nWe can see the relationship between adherence and change in log viral load based on hard drug use: for previous and current hard drug users, those with high adherence had a reduced viral load compared to those with low adherence.\nSimilarly, we can see the relationship between hard drug use and change in log viral load based on adherence: For those with low adherence, previous and current drug users had a higher viral load compared to those with high adherence.\nInterestingly, viral load did not seem to differ for never users based on adherence, suggesting that the ART treatment is most important for those with current or previous hard drug use history.\nImportantly however, this plot is not replicated exactly when I recreate it in ggplot2.\n\n# Filter out NA values\ndata_no_na &lt;- data_wide_2 %&gt;% filter(!is.na(ADH_HIGHVSLOW))\n\n# Summarize the data (using mean as an example)\ndata_summary &lt;- data_no_na %&gt;%\n  group_by(hard_drugs_grp, ADH_HIGHVSLOW) %&gt;%\n  summarize(mean_VLOAD_log_CHANGE = mean(VLOAD_log_CHANGE, na.rm = TRUE))\n\n`summarise()` has grouped output by 'hard_drugs_grp'. You can override using\nthe `.groups` argument.\n\n# Create the plot with lines\nggplot(data_no_na, aes(x = hard_drugs_grp, y = VLOAD_log_CHANGE, fill = ADH_HIGHVSLOW)) +\n  geom_boxplot(alpha = 0.5) +\n  scale_fill_brewer(palette = \"Pastel2\") +\n  labs(title = \"Interaction between Hard Drugs and Adherence on Log Viral Load Change\",\n       x = \"Hard Drugs Group\",\n       y = \"Log Viral Load Change\") +\n  guides(fill = guide_legend(title = \"Adherence Group\")) +\n   theme_minimal() \n\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nWe can see that the boxplot for low adherence previous users (n = 4), and low adherence hard drug users (n = 6) are either really tiny or really large, respectively. This makes sense, because the sample size for both of those categories is so small.\n\n# Create table of hard drugs group by adherence group\npretty_print(table(data_wide_2$hard_drugs_grp, data_wide_2$ADH_HIGHVSLOW))\n\n\n\n\n\nLow Adherence\nHigh Adherence\n\n\n\n\nNever User\n33\n399\n\n\nCurrent User\n4\n56\n\n\nPrevious User\n6\n40\n\n\n\n\n\n\n\nAnd let’s examine how close those 4 values all are to each other.\n\ndata_wide_2 %&gt;%\n  filter(hard_drugs_grp == \"Current User\" & ADH_HIGHVSLOW == \"Low Adherence\") %&gt;%\n  select(newid, VLOAD_log_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW)\n\n# A tibble: 4 × 4\n  newid VLOAD_log_CHANGE hard_drugs_grp ADH_HIGHVSLOW\n  &lt;dbl&gt;            &lt;dbl&gt; &lt;fct&gt;          &lt;fct&gt;        \n1    11             1.21 Current User   Low Adherence\n2    15            -4.96 Current User   Low Adherence\n3   319             1.21 Current User   Low Adherence\n4   356            -4.99 Current User   Low Adherence\n\n\n\ndata_wide_2 %&gt;%\n  filter(hard_drugs_grp == \"Previous User\" & ADH_HIGHVSLOW == \"Low Adherence\") %&gt;%\n  select(newid, VLOAD_log_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW)\n\n# A tibble: 6 × 4\n  newid VLOAD_log_CHANGE hard_drugs_grp ADH_HIGHVSLOW\n  &lt;dbl&gt;            &lt;dbl&gt; &lt;fct&gt;          &lt;fct&gt;        \n1    20           0.0114 Previous User  Low Adherence\n2    36           0.0330 Previous User  Low Adherence\n3    52           0.0335 Previous User  Low Adherence\n4   425           0.0123 Previous User  Low Adherence\n5   504           0.0349 Previous User  Low Adherence\n6   547           0.0354 Previous User  Low Adherence\n\n\nThe values for current users with low adherence have low variance, explaining the tiny boxplot, and the values for previous users with low adherence have high variance, explaining the larger boxplot.\nSo I guess that’s just a testament to the fact that you can’t rely on packages!\n\n\n\n\n\n\nNote\n\n\n\nThis is a very important limitation that will need to be addressed in the discussion!!\nWhile we see this interaction between hard drug use and adherence on the outcome variables in the data, more data must be collected to get a minimum of 30 patients per group and the analyses re-run to confirm these relationships hold!!\n\n\nTop of Tabset\n\n\n\n\n\n\nAnalysisInterpretationComparisons\n\n\nUnderstanding the limitations of an interaction model with only n=4 or n=6 in some categories, we chose to also run the model without the interaction term to acquire the main effects of hard drug use group and adherence on log viral load change, while controlling for baseline education.\n\n# Relevel reference group\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Perform a regression on log viral load change without interaction term\nmodel_VLOAD_red1 &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\n# Examine summary\nsummary(model_VLOAD_red1)\n\n\nCall:\nlm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    EDUC_COLLEGE, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.7941 -1.7418 -0.2149  1.2043  9.3073 \n\nCoefficients:\n                            Estimate Std. Error t value             Pr(&gt;|t|)\n(Intercept)                  -4.0871     0.4910  -8.324 0.000000000000000771\nhard_drugs_grpCurrent User    0.9170     0.3755   2.442               0.0149\nhard_drugs_grpPrevious User   0.7190     0.4336   1.658               0.0978\nADH_HIGHVSLOWHigh Adherence  -1.8429     0.4377  -4.211 0.000030041916341915\nEDUC_COLLEGECollege          -0.6897     0.2970  -2.322               0.0206\n                               \n(Intercept)                 ***\nhard_drugs_grpCurrent User  *  \nhard_drugs_grpPrevious User .  \nADH_HIGHVSLOWHigh Adherence ***\nEDUC_COLLEGECollege         *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.714 on 515 degrees of freedom\n  (30 observations deleted due to missingness)\nMultiple R-squared:  0.06016,   Adjusted R-squared:  0.05286 \nF-statistic: 8.241 on 4 and 515 DF,  p-value: 0.000001901\n\n\n\n# Print useful model parameters\nmodel_results(model_VLOAD_red1)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-4.0870510\n0.4910084\n-8.323790\n0.0000000\n0.0000000\n-5.0516769\n-3.1224251\n\n\nhard_drugs_grpCurrent User\n0.9169947\n0.3754605\n2.442320\n0.0149284\n0.0746420\n0.1793722\n1.6546172\n\n\nhard_drugs_grpPrevious User\n0.7190166\n0.4335575\n1.658411\n0.0978434\n0.4892169\n-0.1327422\n1.5707754\n\n\nADH_HIGHVSLOWHigh Adherence\n-1.8428916\n0.4376635\n-4.210750\n0.0000300\n0.0001502\n-2.7027170\n-0.9830663\n\n\nEDUC_COLLEGECollege\n-0.6896592\n0.2969844\n-2.322207\n0.0206108\n0.1030539\n-1.2731090\n-0.1062094\n\n\n\n\n\n\n\n\n# Relevel reference group\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Perform a regression on log viral load change without interaction term\nmodel_VLOAD_red2 &lt;- lm(VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)\n\n# Examine summary\nsummary(model_VLOAD_red2)\n\n\nCall:\nlm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    EDUC_COLLEGE, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.7941 -1.7418 -0.2149  1.2043  9.3073 \n\nCoefficients:\n                            Estimate Std. Error t value      Pr(&gt;|t|)    \n(Intercept)                  -3.3680     0.5718  -5.890 0.00000000697 ***\nhard_drugs_grpNever User     -0.7190     0.4336  -1.658        0.0978 .  \nhard_drugs_grpCurrent User    0.1980     0.5451   0.363        0.7166    \nADH_HIGHVSLOWHigh Adherence  -1.8429     0.4377  -4.211 0.00003004192 ***\nEDUC_COLLEGECollege          -0.6897     0.2970  -2.322        0.0206 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.714 on 515 degrees of freedom\n  (30 observations deleted due to missingness)\nMultiple R-squared:  0.06016,   Adjusted R-squared:  0.05286 \nF-statistic: 8.241 on 4 and 515 DF,  p-value: 0.000001901\n\n\n\n# Print useful model parameters\nmodel_results(model_VLOAD_red2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-3.3680344\n0.5718018\n-5.8902135\n0.0000000\n0.0000000\n-4.4913853\n-2.2446835\n\n\nhard_drugs_grpNever User\n-0.7190166\n0.4335575\n-1.6584112\n0.0978434\n0.4892169\n-1.5707754\n0.1327422\n\n\nhard_drugs_grpCurrent User\n0.1979781\n0.5451391\n0.3631698\n0.7166270\n1.0000000\n-0.8729918\n1.2689479\n\n\nADH_HIGHVSLOWHigh Adherence\n-1.8428916\n0.4376635\n-4.2107503\n0.0000300\n0.0001502\n-2.7027170\n-0.9830663\n\n\nEDUC_COLLEGECollege\n-0.6896592\n0.2969844\n-2.3222073\n0.0206108\n0.1030539\n-1.2731090\n-0.1062094\n\n\n\n\n\n\n\nThe overall model is significant (F(~4, 515)~= 8.241, p &lt; 0.0001).\nTop of Tabset\n\n\n\nHard Drug Use\nHard drug use is a significant predictor of log viral load change, while controlling for adherence to the treatment regiment and college education. Specifically, current hard drug users had a change in log viral load that was 0.92 log copies/mL (or 2.50 times) greater than never hard drug users (t = 2.442, p-adjusted = 0.0447, 95% CI: 0.18 to 1.65 log copies/mL, or 1.20 to 5.23 times). There was no difference between previous and current hard drug users in change in log viral load over 2 years (t = 0.363, p-adjusted = 1.00, 95% CI: -0.87 to 1.27 log copies/mL, or 0.42 to 4.81 times).\n\n\nAdherence\nAdherence to the treatment regiment is a significant predictor of change in log viral load, while controlling for hard drug usage and college education (t = -4.21, p &lt; 0.0001). Specifically, those with high adherence to the protocol had an average change in log viral load that was 1.84 log copies/mL (or 0.16 times) less than those with low adherence to the protocol.\n\n\nCollege Education at Baseline\nFinally, college education is a significant predictor of log viral load change, while controlling for hard drug usage and adherence to the treatment regiment (t = -2.32, p = 0.0206). On average, those with a college education had a change in log viral load that was 0.69 log copies/mL (or 1.99 times) less than those without a college education (95% CI: -2.70 to -0.98 log copies/mL, or 0.067 to 0.37 times).\nTop of Tabset\n\n\n\nThe reduced model without the interaction has an adjusted R-squared of 0.0529, compared to the full model with the interaction term (R^2-adjusted = 0.090).\nTherefore, dropping the interaction term causes us to lose explanation of 3.71% of the variance in log viral load change, but is also more statistically sound since we no longer have small sample size issues.\nTop of Tabset\n\n\n\n\n\nUnder the classical definition of a confounder, a variable Z is a confounder if:\n\n\nIt is associated with outcome Y\n\n\nIt is associated with PEV X\n\n\nIt is not on the causal pathway (not a mediator)\n\n\nWe know that ADH_HIGHVSLOW is a predictor of VLOAD_log_CHANGE.\nTo assess if ADH_HIGHVSLOW is associated with hard drug use group, we can run a Fisher’s test\n\n# Create a contingency table\ncontingency_table &lt;- table(data_wide_2$hard_drugs_grp, data_wide_2$ADH_HIGHVSLOW)\n\n# We have to run Fisher's Exact test since we have fewer than 5 observations in some categories\nfisher_test &lt;- fisher.test(contingency_table)\n\nfisher_test\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  contingency_table\np-value = 0.4168\nalternative hypothesis: two.sided\n\n\n\n# Create a contingency table\ncontingency_table &lt;- table(data_wide_2$hard_drugs_grp, data_wide_2$EDUC_COLLEGE)\n\n# We have to run Fisher's Exact test since we have fewer than 5 observations in some categories\nfisher_test &lt;- fisher.test(contingency_table)\n\nThey are not associated.\nHowever, it is not necessary for this associaton to be statistically significant for there to be important confounding present.\nWhen we ran drug_use_grp by itself as a predictor on log viral load, the overall model was significant, but after correcting for multiple pairwise comparisons, none of the between-group comparisons was significant (p &gt; 0.05).\nHowever, after including ADH_HIGHVSLOW in the model, the current vs never drug use comparison is significant, even after performing a Bonferroni correction (p-adjusted = 0.0447). In the model without ADH, this same comparison was p-adjusted = 0.1377.\nThus, ADH_HIGHVSLOW is associated with the outcome variable, and changes the relationship between the PEV and outcome variable in a meaningful way when included in the model (changes it from not significant to significant), meeting the definition of a confounder under the classical definition. However, the beta coefficient of the PEV does not change by &gt; 20%, not satisfying the operational definition of a confounder.\nAdherence to the treatment regiment is therefore a maverick variable!\nTop of Tabset\n\n\nHere we will create some simple plots to help with visualizing the main effects of hard drug use and adherence on log viral load change.\n\n# Create boxplots of log viral load change by hard drug use group\nggplot(data_wide_2, aes(x = hard_drugs_grp, y = VLOAD_log_CHANGE, fill = hard_drugs_grp)) +\n  geom_boxplot(alpha = 0.5) +\n  theme_minimal() +\n  scale_fill_brewer(palette=\"Pastel2\") +\n  labs(title = \"Boxplot of Log Viral Load Change by Hard Drug Use Group\",\n       x = \"Hard Drug Use Group\",\n       y = \"Log Viral Load Change\") +\n  guides(fill = guide_legend(title = \"Hard Drug Use Group\"))\n\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nWe can see that current and previous drug users had less of a decrease in log viral load over 2 years compared to never hard drug users.\n\n# Create boxplots of log viral load change by adherence group\nggplot(data_no_na, aes(x = ADH_HIGHVSLOW, y = VLOAD_log_CHANGE, fill = ADH_HIGHVSLOW)) +\n  geom_boxplot(alpha = 0.5) +\n  theme_minimal() +\n  scale_fill_brewer(palette=\"Pastel2\") +\n  labs(title = \"Boxplot of Log Viral Load Change by Adherence at Year 2\",\n       x = \"Adherence at year 2\",\n       y = \"Log Viral Load Change\") +\n  guides(fill = guide_legend(title = \"Adherence Group\"))\n\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nAnd here we can see those with high adherence had a higher decrease in log viral load over 2 years compared to those with low adherence.\n\n\n\n:::"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#cd4-t-cell-count-change-1",
    "href": "Project_2/Project_2_R/Code/Project2.html#cd4-t-cell-count-change-1",
    "title": "Advanced Data Analysis - Project 2",
    "section": "CD4+ T Cell Count Change",
    "text": "CD4+ T Cell Count Change\nThe second outcome variable of interest was change in CD4+ T Cell Count over the first 2 years of the study.\n\nFull ModelReduced Model - No Interaction\n\n\n\nModel SelectionAnalysisInterpretationVisualizing the Interaction\n\n\nThe candidate variables for inclusion in our model predicting LEU3N_CHANGE were hard_drugs_grp, ADH_HIGHLOW, BMI_2, FRP_2, and EDUC_COLLEGE.\nThe researchers are interested in if differences in treatment response between the drug use groups can be explained by differences in adherence to the HAART regimen, so we will also include an interaction term between hard drug use group and adherence.\nWe begin by examining the full model with all these variables included.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group, include adherence as confounder, and BMI, frailty related phenotype, and college education as precision variables.\nmodel_LEU3N_full1 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + BMI_2 + FRP_2 + EDUC_COLLEGE + CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Exmamine the summary\nsummary(model_LEU3N_full1)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    BMI_2 + FRP_2 + EDUC_COLLEGE + CESD_2 + hard_drugs_grp * \n    ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-665.80 -119.44   -3.02  110.80 1080.47 \n\nCoefficients: (1 not defined because of singularities)\n                                                         Estimate Std. Error\n(Intercept)                                              -46.7866    63.8333\nhard_drugs_grpPrevious User                              -92.1062    31.5556\nhard_drugs_grpCurrent User                              -161.2223   132.3190\nADH_HIGHVSLOWHigh Adherence                               78.9814    35.0133\nBMI_2                                                      6.0075     2.1384\nFRP_2Yes                                                -101.6289    36.3579\nEDUC_COLLEGECollege                                       28.7527    21.5453\nCESD_2                                                    -1.0786     0.8141\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence        NA         NA\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    49.4909   134.8433\n                                                        t value Pr(&gt;|t|)   \n(Intercept)                                              -0.733  0.46397   \nhard_drugs_grpPrevious User                              -2.919  0.00369 **\nhard_drugs_grpCurrent User                               -1.218  0.22370   \nADH_HIGHVSLOWHigh Adherence                               2.256  0.02457 * \nBMI_2                                                     2.809  0.00518 **\nFRP_2Yes                                                 -2.795  0.00541 **\nEDUC_COLLEGECollege                                       1.335  0.18271   \nCESD_2                                                   -1.325  0.18588   \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence      NA       NA   \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    0.367  0.71377   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 180.3 on 448 degrees of freedom\n  (93 observations deleted due to missingness)\nMultiple R-squared:  0.1193,    Adjusted R-squared:  0.1036 \nF-statistic: 7.587 on 8 and 448 DF,  p-value: 0.000000001577\n\n\nWe get an NA for the interaction term. This is likely because we dropped the n=6 patients that were previous hard drug users with low adherence, making the interaction impossible to make. Indeed we can see we only have 7, 453 degrees of freedom.\nBMI is significant, but has 10% missing values. Let’s try running the regression without it so we can examine that interaction term, which is the main research question. (it’s also correlated to college education, so we can kind of capture it with that variable).\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group, include adherence as confounder, and BMI, frailty related phenotype, and college education as precision variables.\nmodel_LEU3N_red1 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + EDUC_COLLEGE + CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Exmamine the summary\nsummary(model_LEU3N_red1)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + EDUC_COLLEGE + CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, \n    data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-697.61 -112.73   -1.31  106.13 1073.99 \n\nCoefficients:\n                                                         Estimate Std. Error\n(Intercept)                                              -30.8189    92.4188\nhard_drugs_grpNever User                                 126.1630    96.3440\nhard_drugs_grpPrevious User                              355.9657   119.3430\nADH_HIGHVSLOWHigh Adherence                              104.4788    94.2502\nFRP_2Yes                                                -110.1432    35.5533\nEDUC_COLLEGECollege                                       25.0343    20.1854\nCESD_2                                                    -1.0187     0.7723\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     -17.0631    99.8903\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence -333.1581   126.6465\n                                                        t value Pr(&gt;|t|)   \n(Intercept)                                              -0.333  0.73892   \nhard_drugs_grpNever User                                  1.310  0.19096   \nhard_drugs_grpPrevious User                               2.983  0.00299 **\nADH_HIGHVSLOWHigh Adherence                               1.109  0.26816   \nFRP_2Yes                                                 -3.098  0.00206 **\nEDUC_COLLEGECollege                                       1.240  0.21547   \nCESD_2                                                   -1.319  0.18776   \nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     -0.171  0.86443   \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -2.631  0.00878 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 181.3 on 506 degrees of freedom\n  (35 observations deleted due to missingness)\nMultiple R-squared:  0.09847,   Adjusted R-squared:  0.08422 \nF-statistic: 6.908 on 8 and 506 DF,  p-value: 0.000000012\n\n\n\nBackwards Elimination\nWe will perform model selection using backwards elimination and BIC to select the most parsimonious model.\nA delta BIC of &gt;2 indicates a difference in model performance.\n\n# Perform backward elimination regression selection based on BIC \nols_step_backward_sbc(model_LEU3N_red1, include = c(\"hard_drugs_grp\", \"ADH_HIGHVSLOW\"))\n\n\n                                Stepwise Summary                                \n------------------------------------------------------------------------------\nStep    Variable          AIC         SBC         SBIC        R2       Adj. R2 \n------------------------------------------------------------------------------\n 0      Full Model      6828.740    6871.181    5380.046    0.09847    0.08422 \n 1      EDUC_COLLEGE    6828.303    6866.500    5355.906    0.09573    0.08324 \n 2      CESD_2          6828.406    6862.359    5356.186    0.09203    0.08130 \n------------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                           Model Summary                            \n-------------------------------------------------------------------\nR                         0.303       RMSE                 180.377 \nR-Squared                 0.092       MSE                32984.102 \nAdj. R-Squared            0.081       Coef. Var            114.193 \nPred R-Squared            0.076       AIC                 6828.406 \nMAE                     136.282       SBC                 6862.359 \n-------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                 ANOVA                                   \n------------------------------------------------------------------------\n                    Sum of                                              \n                   Squares         DF    Mean Square      F        Sig. \n------------------------------------------------------------------------\nRegression     1698306.434          6     283051.072    8.581    0.0000 \nResidual      16755923.716        508      32984.102                    \nTotal         18454230.150        514                                   \n------------------------------------------------------------------------\n\n                                                           Parameter Estimates                                                            \n-----------------------------------------------------------------------------------------------------------------------------------------\n                                                  model        Beta    Std. Error    Std. Beta      t        Sig        lower      upper \n-----------------------------------------------------------------------------------------------------------------------------------------\n                                            (Intercept)     -36.638        90.808                 -0.403    0.687    -215.043    141.767 \n                               hard_drugs_grpNever User     136.867        96.322        0.292     1.421    0.156     -52.373    326.106 \n                            hard_drugs_grpPrevious User     341.997       117.232        0.515     2.917    0.004     111.678    572.317 \n                            ADH_HIGHVSLOWHigh Adherence     116.056        94.071        0.168     1.234    0.218     -68.761    300.873 \n                                               FRP_2Yes    -113.844        35.435       -0.136    -3.213    0.001    -183.462    -44.226 \n   hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     -25.037        99.815       -0.059    -0.251    0.802    -221.138    171.064 \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence    -330.080       123.130       -0.467    -2.681    0.008    -571.988    -88.173 \n-----------------------------------------------------------------------------------------------------------------------------------------\n\n\nAs predicted, the most parsimonious model is with CESD_2 and EDUC_COLLEGE removed, and only including FRP_2 as a precision variable.\nTop of Tabset\n\n\n\nLet’s investigate the key relationships in the final model for LEU3N_CHANGE as determined through backwards selection.\nFirst let’s look at the impact of hard drug use on CD4+ T Cell change, at low adherence.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination\nmodel_LEU3N_final1 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_LEU3N_final1)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-700.74 -111.21   -1.67  112.23 1077.98 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                               107.46      31.59\nhard_drugs_grpCurrent User                               -144.10      96.02\nhard_drugs_grpPrevious User                               197.90      80.49\nADH_HIGHVSLOWHigh Adherence                                83.09      32.92\nFRP_2Yes                                                 -113.63      35.38\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     32.94      99.51\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -297.13      85.95\n                                                        t value Pr(&gt;|t|)    \n(Intercept)                                               3.402 0.000721 ***\nhard_drugs_grpCurrent User                               -1.501 0.134038    \nhard_drugs_grpPrevious User                               2.459 0.014277 *  \nADH_HIGHVSLOWHigh Adherence                               2.524 0.011895 *  \nFRP_2Yes                                                 -3.212 0.001402 ** \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    0.331 0.740764    \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -3.457 0.000592 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 181.3 on 512 degrees of freedom\n  (31 observations deleted due to missingness)\nMultiple R-squared:  0.08984,   Adjusted R-squared:  0.07917 \nF-statistic: 8.423 on 6 and 512 DF,  p-value: 0.000000009913\n\n\n\n# Print useful model parameters\nmodel_results(model_LEU3N_final1)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n107.46049\n31.58675\n3.4020752\n0.0007211\n0.0050476\n45.40491\n169.51607\n\n\nhard_drugs_grpCurrent User\n-144.09848\n96.01798\n-1.5007447\n0.1340380\n0.9382660\n-332.73618\n44.53922\n\n\nhard_drugs_grpPrevious User\n197.89868\n80.49146\n2.4586294\n0.0142768\n0.0999374\n39.76450\n356.03287\n\n\nADH_HIGHVSLOWHigh Adherence\n83.09406\n32.91813\n2.5242642\n0.0118953\n0.0832670\n18.42283\n147.76529\n\n\nFRP_2Yes\n-113.62595\n35.37733\n-3.2118295\n0.0014019\n0.0098130\n-183.12853\n-44.12336\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n32.93895\n99.50721\n0.3310208\n0.7407642\n1.0000000\n-162.55372\n228.43162\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n-297.12895\n85.95111\n-3.4569531\n0.0005918\n0.0041424\n-465.98920\n-128.26871\n\n\n\n\n\n\n\nThe overall model is highly significant (F(6,512)= 8.42, p &lt; 0.00001).\nAt low adherence, previous hard drug users have a higher CD4+ T Cell count than never hard drug users (p-adjusted = 0.043), but current hard drugs users did not differ from never drug users (p-adjusted = 0.40).\nAdditionally, for never hard drug users, those with high adherence have a higher CD4+ T Cell count than those with low adherence (p = 0.011895)\nNow let’s compare hard drug usage for those with high adherence.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination\nmodel_LEU3N_final2 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_LEU3N_final2)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-700.74 -111.21   -1.67  112.23 1077.98 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                              190.56       9.47\nhard_drugs_grpCurrent User                              -111.16      26.04\nhard_drugs_grpPrevious User                              -99.23      30.14\nADH_HIGHVSLOWLow Adherence                               -83.09      32.92\nFRP_2Yes                                                -113.63      35.38\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence    -32.94      99.51\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   297.13      85.95\n                                                       t value\n(Intercept)                                             20.123\nhard_drugs_grpCurrent User                              -4.269\nhard_drugs_grpPrevious User                             -3.292\nADH_HIGHVSLOWLow Adherence                              -2.524\nFRP_2Yes                                                -3.212\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   -0.331\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   3.457\n                                                                   Pr(&gt;|t|)    \n(Intercept)                                            &lt; 0.0000000000000002 ***\nhard_drugs_grpCurrent User                                        0.0000234 ***\nhard_drugs_grpPrevious User                                        0.001064 ** \nADH_HIGHVSLOWLow Adherence                                         0.011895 *  \nFRP_2Yes                                                           0.001402 ** \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence              0.740764    \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence             0.000592 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 181.3 on 512 degrees of freedom\n  (31 observations deleted due to missingness)\nMultiple R-squared:  0.08984,   Adjusted R-squared:  0.07917 \nF-statistic: 8.423 on 6 and 512 DF,  p-value: 0.000000009913\n\n\n\n# Print useful model parameters\nmodel_results(model_LEU3N_final2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n190.55455\n9.469605\n20.1227563\n0.0000000\n0.0000000\n171.9505\n209.15861\n\n\nhard_drugs_grpCurrent User\n-111.15953\n26.036468\n-4.2693782\n0.0000234\n0.0001636\n-162.3110\n-60.00807\n\n\nhard_drugs_grpPrevious User\n-99.23027\n30.144942\n-3.2917718\n0.0010643\n0.0074500\n-158.4533\n-40.00727\n\n\nADH_HIGHVSLOWLow Adherence\n-83.09406\n32.918132\n-2.5242642\n0.0118953\n0.0832670\n-147.7653\n-18.42283\n\n\nFRP_2Yes\n-113.62595\n35.377328\n-3.2118295\n0.0014019\n0.0098130\n-183.1285\n-44.12336\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence\n-32.93895\n99.507208\n-0.3310208\n0.7407642\n1.0000000\n-228.4316\n162.55372\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence\n297.12895\n85.951110\n3.4569531\n0.0005918\n0.0041424\n128.2687\n465.98920\n\n\n\n\n\n\n\nFor those with high adherence, previous hard drug users had a lower CD4+ T Cell count (p-adjusted = 0.0032), and current hard drug users had a lower CD4+ T Cell (p-adjusted &lt; 0.0001) count compared to never hard users.\nNow we make the same comparisons with previous hard drug users as the baseline.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination\nmodel_LEU3N_final2 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_LEU3N_final2)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-700.74 -111.21   -1.67  112.23 1077.98 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                              305.36      74.03\nhard_drugs_grpNever User                                -197.90      80.49\nhard_drugs_grpCurrent User                              -342.00     117.06\nADH_HIGHVSLOWHigh Adherence                             -214.03      79.41\nFRP_2Yes                                                -113.63      35.38\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     297.13      85.95\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   330.07     122.95\n                                                       t value  Pr(&gt;|t|)    \n(Intercept)                                              4.125 0.0000433 ***\nhard_drugs_grpNever User                                -2.459  0.014277 *  \nhard_drugs_grpCurrent User                              -2.922  0.003636 ** \nADH_HIGHVSLOWHigh Adherence                             -2.695  0.007266 ** \nFRP_2Yes                                                -3.212  0.001402 ** \nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     3.457  0.000592 ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   2.685  0.007497 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 181.3 on 512 degrees of freedom\n  (31 observations deleted due to missingness)\nMultiple R-squared:  0.08984,   Adjusted R-squared:  0.07917 \nF-statistic: 8.423 on 6 and 512 DF,  p-value: 0.000000009913\n\n\n\n# Print useful model parameters\nmodel_results(model_LEU3N_final2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n305.3592\n74.03481\n4.124535\n0.0000433\n0.0003034\n159.90978\n450.80856\n\n\nhard_drugs_grpNever User\n-197.8987\n80.49146\n-2.458629\n0.0142768\n0.0999374\n-356.03287\n-39.76450\n\n\nhard_drugs_grpCurrent User\n-341.9972\n117.05931\n-2.921572\n0.0036365\n0.0254554\n-571.97284\n-112.02148\n\n\nADH_HIGHVSLOWHigh Adherence\n-214.0349\n79.41319\n-2.695206\n0.0072658\n0.0508607\n-370.05069\n-58.01909\n\n\nFRP_2Yes\n-113.6259\n35.37733\n-3.211829\n0.0014019\n0.0098130\n-183.12853\n-44.12336\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence\n297.1290\n85.95111\n3.456953\n0.0005918\n0.0041424\n128.26871\n465.98920\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n330.0679\n122.94881\n2.684596\n0.0074971\n0.0524799\n88.52168\n571.61413\n\n\n\n\n\n\n\nAt low adherence, current hard drug users had a CD4+ T Cell count compared to previous hard drug users (p-adjusted = 0.011).\nAdditionally, for previous hard drug users, those with high adherence had a greater decrease in CD4+ T Cell count compared to those with low adherence (p = 0.0073).\nNow let’s change the reference level to compare high adherence previous vs current drug users.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination\nmodel_LEU3N_final3 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_LEU3N_final3)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-700.74 -111.21   -1.67  112.23 1077.98 \n\nCoefficients:\n                                                      Estimate Std. Error\n(Intercept)                                              91.32      28.73\nhard_drugs_grpNever User                                 99.23      30.14\nhard_drugs_grpCurrent User                              -11.93      37.60\nADH_HIGHVSLOWLow Adherence                              214.03      79.41\nFRP_2Yes                                               -113.63      35.38\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    -297.13      85.95\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence  -330.07     122.95\n                                                      t value Pr(&gt;|t|)    \n(Intercept)                                             3.179 0.001568 ** \nhard_drugs_grpNever User                                3.292 0.001064 ** \nhard_drugs_grpCurrent User                             -0.317 0.751150    \nADH_HIGHVSLOWLow Adherence                              2.695 0.007266 ** \nFRP_2Yes                                               -3.212 0.001402 ** \nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    -3.457 0.000592 ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence  -2.685 0.007497 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 181.3 on 512 degrees of freedom\n  (31 observations deleted due to missingness)\nMultiple R-squared:  0.08984,   Adjusted R-squared:  0.07917 \nF-statistic: 8.423 on 6 and 512 DF,  p-value: 0.000000009913\n\n\n\n# Print useful model parameters\nmodel_results(model_LEU3N_final3)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n91.32428\n28.72807\n3.1789217\n0.0015677\n0.0109736\n34.88488\n147.76367\n\n\nhard_drugs_grpNever User\n99.23027\n30.14494\n3.2917718\n0.0010643\n0.0074500\n40.00727\n158.45327\n\n\nhard_drugs_grpCurrent User\n-11.92926\n37.59689\n-0.3172937\n0.7511501\n1.0000000\n-85.79241\n61.93390\n\n\nADH_HIGHVSLOWLow Adherence\n214.03489\n79.41319\n2.6952058\n0.0072658\n0.0508607\n58.01909\n370.05069\n\n\nFRP_2Yes\n-113.62595\n35.37733\n-3.2118295\n0.0014019\n0.0098130\n-183.12853\n-44.12336\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence\n-297.12895\n85.95111\n-3.4569531\n0.0005918\n0.0041424\n-465.98920\n-128.26871\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence\n-330.06790\n122.94881\n-2.6845962\n0.0074971\n0.0524799\n-571.61413\n-88.52168\n\n\n\n\n\n\n\nFor those with high adherence, previous vs current hard drug users did not differ in CD4+ T Cell Count (p-adjusted= 1.00).\nFinally let’s compare the impact of adherence for hard drug users.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination\nmodel_LEU3N_final4 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_LEU3N_final4)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-700.74 -111.21   -1.67  112.23 1077.98 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                               -36.64      90.67\nhard_drugs_grpPrevious User                               342.00     117.06\nhard_drugs_grpNever User                                  144.10      96.02\nADH_HIGHVSLOWHigh Adherence                               116.03      93.93\nFRP_2Yes                                                 -113.63      35.38\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -330.07     122.95\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      -32.94      99.51\n                                                        t value Pr(&gt;|t|)   \n(Intercept)                                              -0.404  0.68633   \nhard_drugs_grpPrevious User                               2.922  0.00364 **\nhard_drugs_grpNever User                                  1.501  0.13404   \nADH_HIGHVSLOWHigh Adherence                               1.235  0.21729   \nFRP_2Yes                                                 -3.212  0.00140 **\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -2.685  0.00750 **\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     -0.331  0.74076   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 181.3 on 512 degrees of freedom\n  (31 observations deleted due to missingness)\nMultiple R-squared:  0.08984,   Adjusted R-squared:  0.07917 \nF-statistic: 8.423 on 6 and 512 DF,  p-value: 0.000000009913\n\n\n\n# Print useful model parameters\nmodel_results(model_LEU3N_final4)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-36.63799\n90.67376\n-0.4040639\n0.6863344\n1.0000000\n-214.77639\n141.50040\n\n\nhard_drugs_grpPrevious User\n341.99716\n117.05931\n2.9215715\n0.0036365\n0.0254554\n112.02148\n571.97284\n\n\nhard_drugs_grpNever User\n144.09848\n96.01798\n1.5007447\n0.1340380\n0.9382660\n-44.53922\n332.73618\n\n\nADH_HIGHVSLOWHigh Adherence\n116.03301\n93.93276\n1.2352773\n0.2172938\n1.0000000\n-68.50805\n300.57408\n\n\nFRP_2Yes\n-113.62595\n35.37733\n-3.2118295\n0.0014019\n0.0098130\n-183.12853\n-44.12336\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n-330.06790\n122.94881\n-2.6845962\n0.0074971\n0.0524799\n-571.61413\n-88.52168\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence\n-32.93895\n99.50721\n-0.3310208\n0.7407642\n1.0000000\n-228.43162\n162.55372\n\n\n\n\n\n\n\nFor current hard drug users, those with high adherence did not differ significantly compared to those with low adherence (p = 0.22)\nFRP_2 was a significant predictor for LEU3N_CHANGE, while controlling for hard drug use and adherence to the treatment regiment (t = -3.21, p = 0.0014). On average, those with a Frailty Related Phenotype had a decrease in CD4+ T cells that was 113.63 cells greater than those without a Frailty Related Phenotype (95% CI: 44.12 to 183.13 cells).\nTop of Tabset\n\n\n\nOverall Model\nThere were significant differences in change in CD4+ T Cell count over 2 years based on hard drug usage and adherence to the treatment regiment, while controlling for Frailty Related Phenotype (F(6,512) = 8.42, p &lt; 0.00001).\n\nHard Drug Use\nThe relationship between hard drug use and change in CD4+ T Cell count over 2 years depended on adherence to the treatment regiment.\n\nHard Drug Use at Low Adherence\nFor those with low adherence to the treatment regiment, previous hard drug users had on average a 197.90 cells greater increase in CD4+ T Cell count compared to never hard drug users (t = 2.46, p-adjusted = 0.043, 95%: 39.77 to 356.03). Current hard drug users did not differ from never hard drug users (t = -1.50, p-adjusted = 0.40, 95% CI: -332.74 to 44.54). Additionally, current hard drug users had on average a -342.00 cells greater decrease in CD4+ T Cell count compared to previous hard drug users (t = -2.922, p-adjusted = 0.011, 95% CI: -571.97 to -112.02).\n\n\nHard Drug Use at High Adherence\nFor those with high adherence to the treatment regiment, previous hard drug users had on average a 99.23 cells greater decrease (t = -3.29, p-adjusted = 0.0032, 95% CI: -158.4533 to -40.00727), and current hard drug users had on average a 111.16 cells greater decrease (t = -4.27, p-adjusted &lt; 0.0001, 95% CI: -162.31 to -60.00) compared to never hard drug users. in CD4+ T cell count compared never hard drug users. Current hard drug users did not differ from previous hard drug users on change in CD4+ T Cell count over 2 years (t = -0.32, p-adjusted= 1.00, 95% CI: -85.79 to 61.93).\n\n\n\n\nAdherence\nThe relationship between adherence to the treatment regiment and change in CD4+ T Cell count over 2 years differed by hard drug use.\n\nAdherence for Current Hard Drug Users\nFor current hard drug users, those with high adherence did not differ significantly in average change in CD4+ T Cells over two years compared to those with low adherence (t = 1.24, p-adjusted = 0.22, 95% CI: -68.51 to 300.57).\n\n\n\nAdherence for Previous Hard Drug Users\nFor previous hard drug users, those with high adherence had on average a 214.03 cells greater decrease in CD4+ T Cell count compared to those with low adherence (t = -2.70, p = 0.0073, 95% CI: -370.05 to -58.020).\n\n\nAdherence for Never Hard Drug Users\nFor never drug users, those with high adherence had on average a 83.09 cells greater decrease in CD4+ T Cell count compared to those with low adherence (t = 2.52, p = 0.0119, 95% CI: 18.42283 147.76529).\n\n\nAdditional Interaction Comparisons\nThere are additional comparisons we can make in the interaction between hard drug usage and adherence, but they are of little clinical relevance (e.g. comparing current hard drug users with low adherence to never hard drug users with high adherence). ### Frailty Related Phenotype\nFrailty Related Phenotype was a significant predictor for change in CD4+ T Cell count over 2 years, while controlling for hard drug use and adherence to the treatment regiment (t = -3.21, p = 0.0014). On average, those with a Frailty Related Phenotype had a 113.63 cells greater decrease in CD4+ T Cell count than those without a Frailty Related Phenotype (95% CI: 44.12 to 183.13 cells).\nTop of Tabset\n\n\n\nThe below plot is useful in interpreting the interaction\n\n# Use interactions package to plot interaction\ncat_plot(\n  model_LEU3N_final1, \n  pred = hard_drugs_grp, \n  modx = ADH_HIGHVSLOW, \n  geom = \"line\", \n  colors = \"Pastel2\",\n  x.label = \"Hard Drugs Group\",\n  y.label = \"Predicted CD4+ T Cell Count Change\")\n\n\n\n\n\n\n\n# Filter out NA values\ndata_no_na &lt;- data_wide_2 %&gt;% filter(!is.na(ADH_HIGHVSLOW))\n\n# Create the plot with lines\nggplot(data_no_na, aes(x = hard_drugs_grp, y = LEU3N_CHANGE, fill = ADH_HIGHVSLOW)) +\n  geom_boxplot(alpha = 0.5) +\n  scale_fill_brewer(palette = \"Pastel2\") +\n  labs(title = \"Interaction between Hard Drugs and Adherence on LEU3N Change\",\n       x = \"Hard Drugs Group\",\n       y = \"LEU3N Change\") +\n  guides(fill = guide_legend(title = \"Adherence Group\")) +\n   theme_minimal() \n\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nHere we can see the key relationships in our model.\nFor current hard drug users, those with high adherence did not differ from those with low adherence. This may be an artifact of the small number of current hard drug users with low adherence, however (n = 6).\nFor previous hard drug users, those with high adherence had a smaller increase in CD4+ T Cell count compared to those with low adherence. This is a counter-inuitive finding and may be an artifact of the small number of previous hard drug users with low adherence, however (n=4). It may be of interest to the clinicians however, and we therefore report it here.\nFor never hard drug users, those with high adherence had a greater increase in CD4+ T Cell count compared to those with low adherence.\nAt low adherence, previous hard drug users had greater increase in CD4+ T Cell count compared to never hard drug users, and also when compared to current hard drug users. Current hard drugs users did not differ crom never hard drug users in change in CD4+ T Cell count at low adherence.\nAt high adherence, never drug users had a greater increase in CD4+ T cell count compared to previous and current hard drug users. Current hard drug users did not differ from previous hard drug users at high adherence.\nTop of Tabset\n\n\n\n\n\n\nAnalysisInterpretationVisualizing Main Effects\n\n\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination\nmodel_LEU3N_final_noX1 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2, data = data_wide_2)\n\n# Examine the summary\nsummary(model_LEU3N_final_noX1)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-697.88 -115.61   -3.14  114.98 1080.85 \n\nCoefficients:\n                            Estimate Std. Error t value    Pr(&gt;|t|)    \n(Intercept)                   140.88      28.36   4.967 0.000000927 ***\nhard_drugs_grpCurrent User   -112.84      25.38  -4.446 0.000010724 ***\nhard_drugs_grpPrevious User   -62.31      28.51  -2.185     0.02932 *  \nADH_HIGHVSLOWHigh Adherence    46.81      29.24   1.601     0.11000    \nFRP_2Yes                     -114.33      35.72  -3.201     0.00145 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 183.2 on 514 degrees of freedom\n  (31 observations deleted due to missingness)\nMultiple R-squared:  0.06752,   Adjusted R-squared:  0.06026 \nF-statistic: 9.305 on 4 and 514 DF,  p-value: 0.000000289\n\n\n\n# Examine the summary\nmodel_results(model_LEU3N_final_noX1)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n140.8774\n28.36272\n4.966993\n0.0000009\n0.0000046\n85.15631\n196.598539\n\n\nhard_drugs_grpCurrent User\n-112.8387\n25.37954\n-4.446049\n0.0000107\n0.0000536\n-162.69908\n-62.978288\n\n\nhard_drugs_grpPrevious User\n-62.3112\n28.51439\n-2.185255\n0.0293209\n0.1466044\n-118.33027\n-6.292117\n\n\nADH_HIGHVSLOWHigh Adherence\n46.8124\n29.24046\n1.600946\n0.1100033\n0.5500164\n-10.63312\n104.257925\n\n\nFRP_2Yes\n-114.3343\n35.72007\n-3.200841\n0.0014550\n0.0072749\n-184.50955\n-44.158969\n\n\n\n\n\n\n\nChange the reference level to previous users and re-run the model\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination\nmodel_LEU3N_final_noX2 &lt;- lm(LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2, data = data_wide_2)\n\n# Examine the summary\nsummary(model_LEU3N_final_noX2)\n\n\nCall:\nlm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-697.88 -115.61   -3.14  114.98 1080.85 \n\nCoefficients:\n                            Estimate Std. Error t value Pr(&gt;|t|)   \n(Intercept)                    78.57      37.09   2.118  0.03462 * \nhard_drugs_grpNever User       62.31      28.51   2.185  0.02932 * \nhard_drugs_grpCurrent User    -50.53      36.00  -1.403  0.16110   \nADH_HIGHVSLOWHigh Adherence    46.81      29.24   1.601  0.11000   \nFRP_2Yes                     -114.33      35.72  -3.201  0.00145 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 183.2 on 514 degrees of freedom\n  (31 observations deleted due to missingness)\nMultiple R-squared:  0.06752,   Adjusted R-squared:  0.06026 \nF-statistic: 9.305 on 4 and 514 DF,  p-value: 0.000000289\n\n\n\n# Examine the summary\nmodel_results(model_LEU3N_final_noX2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n78.56623\n37.08694\n2.118434\n0.0346175\n0.1730874\n5.705608\n151.42685\n\n\nhard_drugs_grpNever User\n62.31120\n28.51439\n2.185255\n0.0293209\n0.1466044\n6.292117\n118.33027\n\n\nhard_drugs_grpCurrent User\n-50.52749\n36.00333\n-1.403412\n0.1610979\n0.8054896\n-121.259266\n20.20429\n\n\nADH_HIGHVSLOWHigh Adherence\n46.81240\n29.24046\n1.600946\n0.1100033\n0.5500164\n-10.633119\n104.25793\n\n\nFRP_2Yes\n-114.33426\n35.72007\n-3.200841\n0.0014550\n0.0072749\n-184.509547\n-44.15897\n\n\n\n\n\n\n\n\n\n\nOverall Model\nThe overall model is significant (F~(4, 514)~ = 9.31, p &lt; .0001).\n\n\nHard Drug Use\nHard drug use is a significant predictor of change in CD4+ T Cell count over 2 years.\nCurrent hard drug users had an average change in CD4+ T Cell count that was 112.84 cells lower than never drug users, while controlling for adherence to treatment regiment and Frailty Related Phenotype (p-adjusted &lt; 0.0001, 95% CI: -162.70 to -62.98).\nPrevious hard drug users did not differ from never hard drugs users (p-adjusted = 0.088, 95% CI:-118.33 to -6.29), or current hard drug users (p-adjusted = 0.483, 95% CI: -121.26 to 20.20).\n\n\nAdherence\nAdherence was not a significant predictor for change in CD4+ T Cell count over 2 years, after controlling for hard drug use and Frailty Related Phenotype (t = 1.60, p = 0.110).\n\n\nFrailty Related Phenotype\nFrailty related phenotype is a significant predictor for change in CD4+ T Cell count over 2 years, while controlling for hard drug use and adherence to the treatment regiment (t = -3.20, p = 0.00145). On average, those with a frailty related phenotype had a change in CD4+ T Cell count that was 114.33 cells lower than those without a frailty related phenotype (95% CI: -184.51 to -44.16).\nTop of Tabset\n\n\n\n\nHard Drug Use\nHere we will create some simple plots to help with visualizing the main effects of hard drug use and adherence on change in CD4+ T Cell count.\n\n# Relevel to change the reference cateory to Never User\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Create boxplots of CD4+ T Cell count change by hard drug use group\nggplot(data_wide_2, aes(x = hard_drugs_grp, y = LEU3N_CHANGE, fill = hard_drugs_grp)) +\n  geom_boxplot(alpha = 0.5) +\n  theme_minimal() +\n  scale_fill_brewer(palette=\"Pastel2\") +\n  labs(title = \"Boxplot of CD4+ T Cell Count Change by Hard Drug Use Group\",\n       x = \"Hard Drug Use Group\",\n       y = \"CD4+ T Cell Count Change\") +\n  guides(fill = guide_legend(title = \"Hard Drug Use Group\"))\n\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nCurrent hard drug users had less of an increase in CD4+ T Cells over 2 years compared to never hard drug users. All other between-group comparisons were not significant.\n\n\nAdherence\n\n# Create boxplots of CD4+ T Cell count change by adherence group\nggplot(data_no_na, aes(x = ADH_HIGHVSLOW, y = LEU3N_CHANGE, fill = ADH_HIGHVSLOW)) +\n  geom_boxplot(alpha = 0.5) +\n  theme_minimal() +\n  scale_fill_brewer(palette = \"Pastel2\") +\n  labs(title = \"Boxplot of CD4+ T Cell Count Change by Adherence at Year 2\",\n       x = \"Adherence Level\",\n       y = \"CD4+ T Cell Count Change\") +\n  guides(fill = guide_legend(title = \"Adherence Group\"))\n\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nChange in CD4+ T Cell count did not differ based on adherence.\n\n\nFrailty Related Phenotype\n\n# Filter out NA values\ndata_no_na &lt;- data_wide_2 %&gt;% filter(!is.na(FRP_2))\n\n# Create boxplots of CD4+ T Cell count change by frailty related phenotype at year 2\nggplot(data_no_na, aes(x = FRP_2, y = LEU3N_CHANGE, fill = FRP_2)) +\n  geom_boxplot(alpha = 0.5) +\n  theme_minimal() +\n  scale_fill_brewer(palette = \"Pastel2\") +\n  labs(title = \"Boxplot of CD4+ T Cell Count Change by Frailty Related Phenotype\",\n       x = \"Frailty Related Phenotype\",\n       y = \"CD4+ T Cell Count Change\") +\n  guides(fill = guide_legend(title = \"Frailty Related Phenotype\"))\n\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nThose with a Frailty Related Phenotype had less of an increase in CD4+ T Cell count compared to those without."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#mental-qol-change",
    "href": "Project_2/Project_2_R/Code/Project2.html#mental-qol-change",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Mental QOL Change",
    "text": "Mental QOL Change\nThe candidate variables for mental QOL change as determined by interactive variable selection are hard_drug_grp, ADH_HIGHLOW, CESD_2.\n\nModel ExplorationModel 1 - Main Research QuestionModel 2 - Depression Interaction TermConclusionBonus - Predicting Depression\n\n\n\nAnalysesDepression as a ConfounderIncluding Depression Interaction Term\n\n\nLet’s begin by running the full model as determined by interactive model selection.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_full1 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_full1)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.537  -6.126  -1.540   5.582  38.662 \n\nCoefficients:\n                                                         Estimate Std. Error\n(Intercept)                                               3.42934    2.16906\nhard_drugs_grpPrevious User                              -6.80279    5.39588\nhard_drugs_grpCurrent User                                9.20460    6.18696\nADH_HIGHVSLOWHigh Adherence                               2.68386    2.14723\nCESD_2                                                   -0.30407    0.04914\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  10.70651    5.68836\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -10.79007    6.40420\n                                                        t value      Pr(&gt;|t|)\n(Intercept)                                               1.581        0.1145\nhard_drugs_grpPrevious User                              -1.261        0.2080\nhard_drugs_grpCurrent User                                1.488        0.1374\nADH_HIGHVSLOWHigh Adherence                               1.250        0.2119\nCESD_2                                                   -6.188 0.00000000123\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   1.882        0.0604\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   -1.685        0.0926\n                                                           \n(Intercept)                                                \nhard_drugs_grpPrevious User                                \nhard_drugs_grpCurrent User                                 \nADH_HIGHVSLOWHigh Adherence                                \nCESD_2                                                  ***\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence .  \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.66 on 521 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 \nF-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878\n\n\nCompare hard drug use groups at high adherence\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_full2 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_full2)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.537  -6.126  -1.540   5.582  38.662 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                              6.11320    0.81275\nhard_drugs_grpPrevious User                              3.90372    1.94422\nhard_drugs_grpCurrent User                              -1.58547    1.68651\nADH_HIGHVSLOWLow Adherence                              -2.68386    2.14723\nCESD_2                                                  -0.30407    0.04914\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence -10.70651    5.68836\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   10.79007    6.40420\n                                                       t value\n(Intercept)                                              7.522\nhard_drugs_grpPrevious User                              2.008\nhard_drugs_grpCurrent User                              -0.940\nADH_HIGHVSLOWLow Adherence                              -1.250\nCESD_2                                                  -6.188\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -1.882\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence    1.685\n                                                                Pr(&gt;|t|)    \n(Intercept)                                            0.000000000000239 ***\nhard_drugs_grpPrevious User                                       0.0452 *  \nhard_drugs_grpCurrent User                                        0.3476    \nADH_HIGHVSLOWLow Adherence                                        0.2119    \nCESD_2                                                 0.000000001234665 ***\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence            0.0604 .  \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence             0.0926 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.66 on 521 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 \nF-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878\n\n\nCompare hard drug use groups at low adherence\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_full3 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_full3)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.537  -6.126  -1.540   5.582  38.662 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                             -3.37346    5.22804\nhard_drugs_grpNever User                                 6.80279    5.39588\nhard_drugs_grpCurrent User                              16.00739    7.63391\nADH_HIGHVSLOWHigh Adherence                             13.39037    5.29906\nCESD_2                                                  -0.30407    0.04914\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence   -10.70651    5.68836\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence -21.49658    8.01958\n                                                       t value      Pr(&gt;|t|)\n(Intercept)                                             -0.645       0.51904\nhard_drugs_grpNever User                                 1.261       0.20797\nhard_drugs_grpCurrent User                               2.097       0.03649\nADH_HIGHVSLOWHigh Adherence                              2.527       0.01180\nCESD_2                                                  -6.188 0.00000000123\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    -1.882       0.06037\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -2.681       0.00758\n                                                          \n(Intercept)                                               \nhard_drugs_grpNever User                                  \nhard_drugs_grpCurrent User                             *  \nADH_HIGHVSLOWHigh Adherence                            *  \nCESD_2                                                 ***\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence   .  \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.66 on 521 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 \nF-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878\n\n\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_full4 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_full4)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.537  -6.126  -1.540   5.582  38.662 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                            10.01691    1.98635\nhard_drugs_grpNever User                               -3.90372    1.94422\nhard_drugs_grpCurrent User                             -5.48919    2.41509\nADH_HIGHVSLOWLow Adherence                            -13.39037    5.29906\nCESD_2                                                 -0.30407    0.04914\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    10.70651    5.68836\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence  21.49658    8.01958\n                                                      t value      Pr(&gt;|t|)    \n(Intercept)                                             5.043 0.00000063408 ***\nhard_drugs_grpNever User                               -2.008       0.04517 *  \nhard_drugs_grpCurrent User                             -2.273       0.02344 *  \nADH_HIGHVSLOWLow Adherence                             -2.527       0.01180 *  \nCESD_2                                                 -6.188 0.00000000123 ***\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence     1.882       0.06037 .  \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   2.681       0.00758 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.66 on 521 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 \nF-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878\n\n\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_full5 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_full5)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.537  -6.126  -1.540   5.582  38.662 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                              4.52773    1.76048\nhard_drugs_grpPrevious User                              5.48919    2.41509\nhard_drugs_grpNever User                                 1.58547    1.68651\nADH_HIGHVSLOWLow Adherence                               8.10621    6.03476\nCESD_2                                                  -0.30407    0.04914\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence -21.49658    8.01958\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    -10.79007    6.40420\n                                                       t value      Pr(&gt;|t|)\n(Intercept)                                              2.572       0.01039\nhard_drugs_grpPrevious User                              2.273       0.02344\nhard_drugs_grpNever User                                 0.940       0.34761\nADH_HIGHVSLOWLow Adherence                               1.343       0.17978\nCESD_2                                                  -6.188 0.00000000123\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -2.681       0.00758\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence     -1.685       0.09262\n                                                          \n(Intercept)                                            *  \nhard_drugs_grpPrevious User                            *  \nhard_drugs_grpNever User                                  \nADH_HIGHVSLOWLow Adherence                                \nCESD_2                                                 ***\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence ** \nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.66 on 521 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 \nF-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878\n\n\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_full6 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_full6)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.537  -6.126  -1.540   5.582  38.662 \n\nCoefficients:\n                                                         Estimate Std. Error\n(Intercept)                                              12.63393    5.89652\nhard_drugs_grpPrevious User                             -16.00739    7.63391\nhard_drugs_grpNever User                                 -9.20460    6.18696\nADH_HIGHVSLOWHigh Adherence                              -8.10621    6.03476\nCESD_2                                                   -0.30407    0.04914\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  21.49658    8.01958\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     10.79007    6.40420\n                                                        t value      Pr(&gt;|t|)\n(Intercept)                                               2.143       0.03261\nhard_drugs_grpPrevious User                              -2.097       0.03649\nhard_drugs_grpNever User                                 -1.488       0.13742\nADH_HIGHVSLOWHigh Adherence                              -1.343       0.17978\nCESD_2                                                   -6.188 0.00000000123\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   2.681       0.00758\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      1.685       0.09262\n                                                           \n(Intercept)                                             *  \nhard_drugs_grpPrevious User                             *  \nhard_drugs_grpNever User                                   \nADH_HIGHVSLOWHigh Adherence                                \nCESD_2                                                  ***\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence ** \nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.66 on 521 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 \nF-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878\n\n\nInterestingly, we have lost a lot of the significant relationships we were seeing before with our main predictors of hard drug use and adherence.\nIt seems that the main driver of this model, and best predictor of change in mental QOL score is depression score.\nWithin adherence levels, none of the hard drug use groups differed from each other on QOL (p-adjusted &gt; 0.05).\nThe only significant difference in mental QOL change is for previous drug users. For previous drug users, those with low adherence have a mental QOL change that is on average 13.39 points lower than those with high adherence (p= 0.0118). Depending on how we handle multiple pairwise comparisons, this may not be significant!\nSomething fishy is going on here…\nLet’s examine this in a simplified model with no interactions.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_simple &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_simple)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.274  -6.421  -1.574   5.343  39.297 \n\nCoefficients:\n                            Estimate Std. Error t value        Pr(&gt;|t|)    \n(Intercept)                  6.17713    2.64623   2.334           0.020 *  \nhard_drugs_grpCurrent User  -3.44081    2.30106  -1.495           0.135    \nhard_drugs_grpNever User    -2.70142    1.85281  -1.458           0.145    \nADH_HIGHVSLOWHigh Adherence  2.94279    1.90898   1.542           0.124    \nCESD_2                      -0.32881    0.04803  -6.845 0.0000000000214 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.72 on 523 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.09648,   Adjusted R-squared:  0.08957 \nF-statistic: 13.96 on 4 and 523 DF,  p-value: 0.00000000007883\n\n\nIndeed, we can see that, when including depression in the model, hard drug use and adherence are no longer significant predictors of change in mental QOL!\nThis suggests that depression score is either a mediator, a moderator, or a confounder for the relationship between hard drug use and adherence on mental QOL.\nLet’s explore.\nTop of Tabset\n\n\n\nConfounder is related to PEV\nWe saw earlier that hard drug use was a significant predictor for depression. Specifically:\nHard drug use is a significant predictor of depression score (F~(2, 542)~= 14.31). On average, current hard drug users had depression scores that were 5.23 points higher than never hard drug users (p &lt; 0.0001), and previous hard drug users had depression scores that were 7.29 points higher than those who never used hard drugs (p &lt; 0.0001).\nThus, depression meets criteria 1 of the classical definition for a confounder: It is related to the PEV.\n\n\nConfounder is related to the Outcome Measure\nWe also saw in the interactive variable selection that depression was significantly related change in mental QOL change.\nThus depression meets criteria 2 of the classical definition for a confounder: it is related to the main outcome.\n\n\nConfounder is not a Mediator\nIt is possible that depression is on the causal pathway for mental QOL (hard drug use -&gt; depression -&gt; mental QOL), but it is likewise possible that mental QOL is on the causal pathway for depression (hard drug use -&gt; mental QOL -&gt; depression). Thus we cannot conclude that depression is a mediator.\n\n\nConfounder Meaningfully Changes the Relationship of PEV on Outcome\nWe also saw that including depression in the model changed hard drug use from being significant to not significant. Thus depression score changes the relationship between the PEV and outcome measure in a very meaningful way.\nI therefore feel justified in exploring depression as a confounder, and analyzing whether an interaction term between hard drug use group and depression will add explanatory power to our model.\nTop of Tabset\n\n\n\nLet’s run a new full model, with the included interaction term between hard drug use group and depression. In essence we are running a three way interaction. It will need to be emphasized in the discussion that this was exploratory data analysis.\n\n# Relevel to change to the reference group\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_newfull &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW + hard_drugs_grp*CESD_2, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_newfull)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW + hard_drugs_grp * \n    CESD_2, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-33.459  -6.016  -1.375   5.512  37.513 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                              9.51665    6.16622\nhard_drugs_grpPrevious User                             30.31096   10.51019\nhard_drugs_grpNever User                                -7.17735    6.52016\nADH_HIGHVSLOWHigh Adherence                             -7.87736    5.82799\nCESD_2                                                  -0.13089    0.14003\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence -7.15661    8.97026\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    10.75016    6.18586\nhard_drugs_grpPrevious User:CESD_2                      -1.15503    0.21476\nhard_drugs_grpNever User:CESD_2                         -0.09391    0.14973\n                                                        t value    Pr(&gt;|t|)    \n(Intercept)                                               1.543     0.12336    \nhard_drugs_grpPrevious User                               2.884     0.00409 ** \nhard_drugs_grpNever User                                 -1.101     0.27150    \nADH_HIGHVSLOWHigh Adherence                              -1.352     0.17708    \nCESD_2                                                   -0.935     0.35038    \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -0.798     0.42534    \nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      1.738     0.08283 .  \nhard_drugs_grpPrevious User:CESD_2                       -5.378 0.000000114 ***\nhard_drugs_grpNever User:CESD_2                          -0.627     0.53083    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.26 on 519 degrees of freedom\n  (22 observations deleted due to missingness)\nMultiple R-squared:  0.1729,    Adjusted R-squared:  0.1601 \nF-statistic: 13.56 on 8 and 519 DF,  p-value: &lt; 0.00000000000000022\n\n\nWe get a highly significant p-value for the interaction between hard drug use group and depression (p &lt; 0.0001)\nOur adjusted R-squared also shot up from 0.090 to 0.16. We’re on to something here.\nLet’s run backwards model selection and examine the BIC to see if we need to include the hard drug use * depression interaction score.\n\nBackwards Elimination\nWe are going to force inclusion of our main variables of interest, hard_drugs_grp and ADH_HIGHVSLOW, and the interaction between them, since those were the main questions the researchers posed.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_newfull &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW +  CESD_2 + hard_drugs_grp*ADH_HIGHVSLOW + hard_drugs_grp*CESD_2, data = data_wide_2)\n\n# Perform backward elimination regression selection based on BIC \nols_step_backward_sbc(model_MENT_newfull, include = c(\"hard_drugs_grp\", \"ADH_HIGHVSLOW\", \"hard_drugs_grp:ADH_HIGHVSLOW\"))\n\n[1] \"No variables have been removed from the model.\"\n\n\nNo variable was removed from the model, indicating that the interaction between hard drug use group and depression adds significant explanatory power and should be included in the model.\nThis puts us in a tricky position, it is clear that there is a relationship between hard drug use and mental quality of life, and that this differs based on both adherence and depression. However we don’t necessarily have the sample size to run a three-way interaction.\n\n\nNext Steps\nThus, we will proceed in two ways from here, and run separate models for:\n\n\nDoes the relationship between hard drug use and mental QOL differ based on adherence (irrespective of depression)?\n\n\nDoes the relationship between hard drug use and mental QOL differ based on depression (irrespective of adherence)?\n\n\nRemoving the confounder of depression in model 1 allows us to answer the main research question for this project. Model 2) will be presented as an exploratory data analysis and allows us to explore how depression is related to hard drug use, and how that is affecting our main model.\nTop of Tabset\n\n\n\n\n\n\nThis is the model predicting AGG_MENT_CHANGE, including only hard_drugs_grp and ADH_HIGHVSLOW, and their interaction term.\nThis addresses the main research question of how mental QOL is impacted by ART, based on hard drug use and adherence to the treatment regimen.\n\nAnalysisInterpretationVisualizing the Interaction\n\n\nLet’s run the regression as specified.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_main1 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW+ hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_main1)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-37.392  -5.850  -0.839   5.089  38.498 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                              -0.8003     2.0950\nhard_drugs_grpCurrent User                                7.9610     6.3718\nhard_drugs_grpPrevious User                             -15.9522     5.3413\nADH_HIGHVSLOWHigh Adherence                               3.4343     2.1812\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -11.1387     6.5996\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  18.7589     5.7025\n                                                        t value Pr(&gt;|t|)   \n(Intercept)                                              -0.382  0.70261   \nhard_drugs_grpCurrent User                                1.249  0.21207   \nhard_drugs_grpPrevious User                              -2.987  0.00295 **\nADH_HIGHVSLOWHigh Adherence                               1.574  0.11598   \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   -1.688  0.09204 . \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.290  0.00107 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.03 on 526 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.04347,   Adjusted R-squared:  0.03438 \nF-statistic: 4.781 on 5 and 526 DF,  p-value: 0.0002777\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_main1)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-0.8003171\n2.095019\n-0.3820094\n0.7026087\n1.0000000\n-4.9159498\n3.315316\n\n\nhard_drugs_grpCurrent User\n7.9609869\n6.371753\n1.2494186\n0.2120677\n1.0000000\n-4.5562212\n20.478195\n\n\nhard_drugs_grpPrevious User\n-15.9522320\n5.341272\n-2.9865976\n0.0029525\n0.0177150\n-26.4450776\n-5.459386\n\n\nADH_HIGHVSLOWHigh Adherence\n3.4342726\n2.181205\n1.5744837\n0.1159769\n0.6958614\n-0.8506712\n7.719216\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n-11.1386718\n6.599562\n-1.6877895\n0.0920444\n0.5522667\n-24.1034081\n1.826064\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n18.7589336\n5.702522\n3.2895855\n0.0010705\n0.0064233\n7.5564192\n29.961448\n\n\n\n\n\n\n# Get the VIFs\nvif_values &lt;- vif(model_MENT_main1)\n\nthere are higher-order terms (interactions) in this model\nconsider setting type = 'predictor'; see ?vif\n\npretty_print(vif_values)\n\n\n\n\n\nGVIF\nDf\nGVIF^(1/(2*Df))\n\n\n\n\nhard_drugs_grp\n119.991456\n2\n3.309692\n\n\nADH_HIGHVSLOW\n1.298281\n1\n1.139422\n\n\nhard_drugs_grp:ADH_HIGHVSLOW\n121.957959\n2\n3.323170\n\n\n\n\n\n\n\nThe overall model is significant (F(5,526) = 4.78, p = 0.000278, and we are getting significant interactions.\nAt the same time, this is a weaker model than when we included depression. Our R-adjusted is now 0.034, meaning we now only explain 3.4% of the variance in mental QOL (compared to 16% in the full model).\nAt low adherence, the previous group has a greater decrease in mental QOL compared to never users.\nFor never users, there is no difference in mental QOL based on high or low adherence (t = 1.5744837, p-adjusted = 0.116, 95% CI: -0.85 to 7.72).\nChange the reference group to compare drug use group at high adherence\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_main2 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW+ hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_main2)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-37.392  -5.850  -0.839   5.089  38.498 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                              2.6340     0.6071\nhard_drugs_grpCurrent User                              -3.1777     1.7190\nhard_drugs_grpPrevious User                              2.8067     1.9974\nADH_HIGHVSLOWLow Adherence                              -3.4343     2.1812\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   11.1387     6.5996\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence -18.7589     5.7025\n                                                       t value  Pr(&gt;|t|)    \n(Intercept)                                              4.339 0.0000172 ***\nhard_drugs_grpCurrent User                              -1.849   0.06508 .  \nhard_drugs_grpPrevious User                              1.405   0.16056    \nADH_HIGHVSLOWLow Adherence                              -1.574   0.11598    \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence    1.688   0.09204 .  \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -3.290   0.00107 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.03 on 526 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.04347,   Adjusted R-squared:  0.03438 \nF-statistic: 4.781 on 5 and 526 DF,  p-value: 0.0002777\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_main2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n2.633955\n0.607084\n4.338700\n0.0000172\n0.0001031\n1.441349\n3.8265623\n\n\nhard_drugs_grpCurrent User\n-3.177685\n1.719008\n-1.848557\n0.0650828\n0.3904967\n-6.554649\n0.1992793\n\n\nhard_drugs_grpPrevious User\n2.806702\n1.997389\n1.405185\n0.1605566\n0.9633394\n-1.117138\n6.7305412\n\n\nADH_HIGHVSLOWLow Adherence\n-3.434273\n2.181205\n-1.574484\n0.1159769\n0.6958614\n-7.719216\n0.8506712\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence\n11.138672\n6.599562\n1.687790\n0.0920444\n0.5522667\n-1.826064\n24.1034081\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence\n-18.758934\n5.702522\n-3.289585\n0.0010705\n0.0064233\n-29.961448\n-7.5564192\n\n\n\n\n\n\n\nAt high adherence, there is no difference in mental QOL between previous and never hard drug users (t = 1.41, p-adjusted = 0.48, 95% CI: -1.12 to 6.73), or between current and never hard drug users (t = -1.85, p-adjusted = 0.195, 95% CI: -6.55 to 0.20).\nChange reference level to compare previous hard drug users at low adherence.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_main3 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW+ hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_main3)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-37.392  -5.850  -0.839   5.089  38.498 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                             -16.753      4.913\nhard_drugs_grpNever User                                 15.952      5.341\nhard_drugs_grpCurrent User                               23.913      7.769\nADH_HIGHVSLOWHigh Adherence                              22.193      5.269\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    -18.759      5.703\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -29.898      8.158\n                                                       t value  Pr(&gt;|t|)    \n(Intercept)                                             -3.410  0.000700 ***\nhard_drugs_grpNever User                                 2.987  0.002953 ** \nhard_drugs_grpCurrent User                               3.078  0.002191 ** \nADH_HIGHVSLOWHigh Adherence                              4.212 0.0000298 ***\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    -3.290  0.001071 ** \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -3.665  0.000273 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.03 on 526 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.04347,   Adjusted R-squared:  0.03438 \nF-statistic: 4.781 on 5 and 526 DF,  p-value: 0.0002777\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_main3)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-16.75255\n4.913256\n-3.409663\n0.0007004\n0.0042022\n-26.404563\n-7.100535\n\n\nhard_drugs_grpNever User\n15.95223\n5.341272\n2.986598\n0.0029525\n0.0177150\n5.459386\n26.445078\n\n\nhard_drugs_grpCurrent User\n23.91322\n7.768540\n3.078213\n0.0021911\n0.0131465\n8.652045\n39.174393\n\n\nADH_HIGHVSLOWHigh Adherence\n22.19321\n5.268880\n4.212130\n0.0000298\n0.0001786\n11.842574\n32.543838\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence\n-18.75893\n5.702522\n-3.289585\n0.0010705\n0.0064233\n-29.961448\n-7.556419\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n-29.89761\n8.158288\n-3.664691\n0.0002728\n0.0016365\n-45.924434\n-13.870777\n\n\n\n\n\n\n\nHere we can see that all our p-values are now very low (all have at least 2 decimal places). This gives me confidence that this is a meaningful and strong model. All the most important comparisons are with previous drug users at low adherence!\nAt low adherence, current hard drug users have a higher mental QOL (p-adjusted = 0.00657), and never hard drug users have a higher mental QOL (p-adjusted = 0.00886) compared to previous hard drug users.\nAdditionally, for previous hard drug users, those with high adherence had a higher increase in mental QOL compared to those with low adherence (p &lt; 0.0001).\nChange reference category to compare high adherence previous hard drug users.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_main4 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_main4)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-37.392  -5.850  -0.839   5.089  38.498 \n\nCoefficients:\n                                                      Estimate Std. Error\n(Intercept)                                              5.441      1.903\nhard_drugs_grpNever User                                -2.807      1.997\nhard_drugs_grpCurrent User                              -5.984      2.491\nADH_HIGHVSLOWLow Adherence                             -22.193      5.269\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence     18.759      5.703\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   29.898      8.158\n                                                      t value  Pr(&gt;|t|)    \n(Intercept)                                             2.859  0.004416 ** \nhard_drugs_grpNever User                               -1.405  0.160557    \nhard_drugs_grpCurrent User                             -2.402  0.016654 *  \nADH_HIGHVSLOWLow Adherence                             -4.212 0.0000298 ***\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence     3.290  0.001071 ** \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   3.665  0.000273 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.03 on 526 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.04347,   Adjusted R-squared:  0.03438 \nF-statistic: 4.781 on 5 and 526 DF,  p-value: 0.0002777\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_main4)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n5.440657\n1.902896\n2.859146\n0.0044164\n0.0264985\n1.702448\n9.178866\n\n\nhard_drugs_grpNever User\n-2.806702\n1.997389\n-1.405185\n0.1605566\n0.9633394\n-6.730541\n1.117138\n\n\nhard_drugs_grpCurrent User\n-5.984387\n2.491476\n-2.401945\n0.0166539\n0.0999236\n-10.878851\n-1.089922\n\n\nADH_HIGHVSLOWLow Adherence\n-22.193206\n5.268880\n-4.212130\n0.0000298\n0.0001786\n-32.543838\n-11.842574\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence\n18.758934\n5.702522\n3.289585\n0.0010705\n0.0064233\n7.556419\n29.961448\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence\n29.897605\n8.158288\n3.664691\n0.0002728\n0.0016365\n13.870777\n45.924434\n\n\n\n\n\n\n\nAt high adherence, there is a borderline significant difference between previous and current drug users (p-adjusted = 0.050). Considering the small sample size in both categories, this could become a non significant difference with a larger N.\nChange the reference level to compare current hard drug users\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp &lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_main5 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_main5)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-37.392  -5.850  -0.839   5.089  38.498 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                                7.161      6.017\nhard_drugs_grpPrevious User                              -23.913      7.769\nhard_drugs_grpNever User                                  -7.961      6.372\nADH_HIGHVSLOWHigh Adherence                               -7.704      6.229\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   29.898      8.158\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      11.139      6.600\n                                                        t value Pr(&gt;|t|)    \n(Intercept)                                               1.190 0.234592    \nhard_drugs_grpPrevious User                              -3.078 0.002191 ** \nhard_drugs_grpNever User                                 -1.249 0.212068    \nADH_HIGHVSLOWHigh Adherence                              -1.237 0.216668    \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.665 0.000273 ***\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      1.688 0.092044 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.03 on 526 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.04347,   Adjusted R-squared:  0.03438 \nF-statistic: 4.781 on 5 and 526 DF,  p-value: 0.0002777\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_main5)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n7.160670\n6.017485\n1.189977\n0.2345922\n1.0000000\n-4.660585\n18.981925\n\n\nhard_drugs_grpPrevious User\n-23.913219\n7.768540\n-3.078213\n0.0021911\n0.0131465\n-39.174393\n-8.652045\n\n\nhard_drugs_grpNever User\n-7.960987\n6.371753\n-1.249419\n0.2120677\n1.0000000\n-20.478195\n4.556221\n\n\nADH_HIGHVSLOWHigh Adherence\n-7.704399\n6.228689\n-1.236922\n0.2166682\n1.0000000\n-19.940561\n4.531762\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n29.897605\n8.158288\n3.664691\n0.0002728\n0.0016365\n13.870777\n45.924434\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence\n11.138672\n6.599562\n1.687790\n0.0920444\n0.5522667\n-1.826064\n24.103408\n\n\n\n\n\n\n\nFor current hard drug users, there was no difference in mental QOL based on adherence (t = -1.24, p = 0.227, 95% CI: -19.94 to 4.53).\nTop of Tabset\n\n\n\nOverall model\nThere were significant differences in change mental QOL over 2 years based on hard drug usage and adherence to the treatment regiment (F(5,526) = 4.78, p = 0.000278).\n\n\nHard Drug Use\nThe relationship between hard drug use and change in mental QOL over 2 years depended on adherence to the treatment regiment.\n\nHard Drug Use at Low Adherence\nFor those with low adherence to the treatment regiment, previous hard drug users had a 15.95 point decrease in mental QOL compared to never hard drug users (t = -2.99, p-adjusted = 0.00886, 95% CI: -26.46 to -5.50), and a 23.91 point decrease compared to current hard drug users (t = 3.078, p-adjusted = 0.00657, 95% CI: 8.65 to 39.17). There was no difference in mental QOL between current and never hard drug users at low adherence (t = 1.25, p-adjusted = 0.636, 95% CI: -4.56 to 20.48).\n\n\nHard Drug use at High Adherence\nFor those with low adherence to the treatment regiment, there was no difference in mental QOL between previous and never hard drug users (t = 1.41, p-adjusted = 0.48, 95% CI: -1.12 to 6.73), or between current and never hard drug users (t = -1.85, p-adjusted = 0.195, 95% CI: -6.55 to 0.20). The difference in mental QOL for current and previous users was borderline significant (t= -2.40, p-adjusted = 0.050, 95% CI: -10.88 to -1.09), and with a larger sample size may become non-significant.\n\n\n\nAdherence\nThe relationship between adherence to the treatment regiment and change in mental QOL over 2 years differed by hard drug use.\n\nAdherence for Current Hard Drug Users\nFor current hard drug users,there was no difference in mental QOL change over 2 years based on adherence (t = -1.24, p = 0.227, 95% CI: -19.94 to 4.53).\n\n\nAdherence for Previous Hard Drug Users\nFor previous hard drug users, there was a statistically significant difference in change in mental QOL over 2 years based on adherence (t = 4.21, p-adjusted = 0.000536). On average, previous hard drug users with high adherence had a 22.19 point increase in mental QOL over 2 years compared to those with low adherence (95% CI: 11.84 to 32.54).\n\n\nAdherence for Never Hard Drug Users\nFor never hard drug users, there was no difference in change in mental QOL over 2 years based on high or low adherence (t = 1.5744837, p-adjusted = 0.116, 95% CI: -0.85 to 7.72).\nTop of Tabset\n\n\n\n\nThe below plot is useful in interpreting the interaction\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Use interactions package to plot interaction\ncat_plot(\n  model_MENT_main1, \n  pred = hard_drugs_grp, \n  modx = ADH_HIGHVSLOW, \n  geom = \"line\", \n  colors = \"Pastel2\",\n  x.label = \"Hard Drugs Group\",\n  y.label = \"Predicted Mental QOL Change\")\n\n\n\n\n\n\n\n\nHere we see the main interaction finding: for previous users, those with low adherence had a decrease in mental QOL over 2 years compared to those with high adherence who had an slight increase.\nAdditionally, for those with low adherence, previous hard drug users had a decrease in mental QOL over 2 years compared to current hard drug users and never hard drug users.\nWe interpret this to mean that previous hard drug users (those in either their first or second year of sobriety) are struggling to deal with withdrawals, addiction, or the adverse effects of the treatment. While current users are in the midst of using hard drugs as a coping mechanism, and thus are protected from the negative impact of the treatment on mental QOL.\nThus, previous hard drug users are a vulnerable population, and high adherence to the treatment regiment might buffer them against the adverse effects of the HAART treatment.\nTop of Tabset\n\n\n\n\n\nThis is the model predicting AGG_MENT_CHANGE, including only hard_drugs_grp and CESD_2, and their interaction term.\nThis addresses the confounding of depression on the relationship between hard drug use and change in mental QOL.\n\nAnalysisInterpretationVisualizing the Interaction\n\n\nCompare slopes for never users.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_sub1 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + CESD_2 + hard_drugs_grp*CESD_2, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_sub1)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + CESD_2 + hard_drugs_grp * \n    CESD_2, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-34.141  -6.071  -1.545   5.758  37.779 \n\nCoefficients:\n                                   Estimate Std. Error t value       Pr(&gt;|t|)\n(Intercept)                         5.10534    0.81668   6.251 0.000000000836\nhard_drugs_grpCurrent User         -3.04165    2.90324  -1.048          0.295\nhard_drugs_grpPrevious User        16.97744    2.91062   5.833 0.000000009463\nCESD_2                             -0.23480    0.05313  -4.419 0.000011998960\nhard_drugs_grpCurrent User:CESD_2   0.10992    0.15093   0.728          0.467\nhard_drugs_grpPrevious User:CESD_2 -0.80296    0.13010  -6.172 0.000000001341\n                                      \n(Intercept)                        ***\nhard_drugs_grpCurrent User            \nhard_drugs_grpPrevious User        ***\nCESD_2                             ***\nhard_drugs_grpCurrent User:CESD_2     \nhard_drugs_grpPrevious User:CESD_2 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.36 on 532 degrees of freedom\n  (12 observations deleted due to missingness)\nMultiple R-squared:  0.1571,    Adjusted R-squared:  0.1492 \nF-statistic: 19.84 on 5 and 532 DF,  p-value: &lt; 0.00000000000000022\n\n# Get the VIFs\nvif_values &lt;- vif(model_MENT_sub1)\n\nthere are higher-order terms (interactions) in this model\nconsider setting type = 'predictor'; see ?vif\n\npretty_print(vif_values)\n\n\n\n\n\nGVIF\nDf\nGVIF^(1/(2*Df))\n\n\n\n\nhard_drugs_grp\n9.440857\n2\n1.752883\n\n\nCESD_2\n1.416421\n1\n1.190135\n\n\nhard_drugs_grp:CESD_2\n11.642359\n2\n1.847184\n\n\n\n\n\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_sub1)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n5.1053388\n0.8166797\n6.2513354\n0.0000000\n0.0000000\n3.5010261\n6.7096514\n\n\nhard_drugs_grpCurrent User\n-3.0416518\n2.9032412\n-1.0476745\n0.2952643\n1.0000000\n-8.7448750\n2.6615715\n\n\nhard_drugs_grpPrevious User\n16.9774420\n2.9106247\n5.8329203\n0.0000000\n0.0000001\n11.2597144\n22.6951696\n\n\nCESD_2\n-0.2347979\n0.0531285\n-4.4194338\n0.0000120\n0.0000720\n-0.3391653\n-0.1304305\n\n\nhard_drugs_grpCurrent User:CESD_2\n0.1099198\n0.1509341\n0.7282635\n0.4667728\n1.0000000\n-0.1865801\n0.4064197\n\n\nhard_drugs_grpPrevious User:CESD_2\n-0.8029584\n0.1301049\n-6.1716247\n0.0000000\n0.0000000\n-1.0585407\n-0.5473761\n\n\n\n\n\n\n\nThe overall model is highly significant (F~(5, 532)~ = 19.84, p &lt; 0.0001, adjusted R-squared = 0.149).\nFor never hard drug users, there was a significant relationship between depression and mental QOL (t = -4.42, p &lt; 0.0001). Specifically, for never hard drug users, a 1 point increase in depression score was associated with 0.23 point decrease in mental QOL (95% CI: -0.34 to -0.13).\nCurrent hard drug users did not differ significantly from never hard drug users while controlling for the other variables in the model (t = -1.05, p-adjusted = 0.89, 95% CI: -8.74 to 2.66). Previous hard drug users had on average a 16.98 higher increase in mental QOL compared to never hard drug users (at low depression scores?) (t = 2.91062, p-adjusted &lt; 0.0001.\nThe slope for depression on mental QOL did not differ between current and never hard drug users (t = 0.73, p-adjusted = 1.00, 95% CI: -0.19 to 0.41). However, the slope for depression on mental QOL did differ between previous and never hard drug users (t = -6.17, p-adjusted &lt; 0.0001). For each point increase in depression, the mental QOL score for previous hard drug users decreases an additional 0.80 points compared to never hard drug users (95% CI: -1.06 to -0.55).\nPrevious hard drug users have an increase of approximately 16.98 units in mental QOL, holding all other variables constant. This difference is statistically significant, suggesting that prior hard drug use is associated with a considerably higher outcome measure in this model. (It’s significant because we’re not account for the interaction with this estimate.)\nCompare slopes for previous users.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_sub2 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + CESD_2 + hard_drugs_grp*CESD_2, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_sub2)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + CESD_2 + hard_drugs_grp * \n    CESD_2, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-34.141  -6.071  -1.545   5.758  37.779 \n\nCoefficients:\n                                  Estimate Std. Error t value\n(Intercept)                        22.0828     2.7937   7.904\nhard_drugs_grpNever User          -16.9774     2.9106  -5.833\nhard_drugs_grpCurrent User        -20.0191     3.9455  -5.074\nCESD_2                             -1.0378     0.1188  -8.738\nhard_drugs_grpNever User:CESD_2     0.8030     0.1301   6.172\nhard_drugs_grpCurrent User:CESD_2   0.9129     0.1846   4.946\n                                              Pr(&gt;|t|)    \n(Intercept)                         0.0000000000000156 ***\nhard_drugs_grpNever User            0.0000000094634100 ***\nhard_drugs_grpCurrent User          0.0000005392622284 ***\nCESD_2                            &lt; 0.0000000000000002 ***\nhard_drugs_grpNever User:CESD_2     0.0000000013409353 ***\nhard_drugs_grpCurrent User:CESD_2   0.0000010165357517 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.36 on 532 degrees of freedom\n  (12 observations deleted due to missingness)\nMultiple R-squared:  0.1571,    Adjusted R-squared:  0.1492 \nF-statistic: 19.84 on 5 and 532 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_sub2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n22.0827808\n2.7937019\n7.904487\n0.0000000\n0.0000000\n16.5947401\n27.5708214\n\n\nhard_drugs_grpNever User\n-16.9774420\n2.9106247\n-5.832920\n0.0000000\n0.0000001\n-22.6951696\n-11.2597144\n\n\nhard_drugs_grpCurrent User\n-20.0190937\n3.9454549\n-5.073963\n0.0000005\n0.0000032\n-27.7696761\n-12.2685114\n\n\nCESD_2\n-1.0377563\n0.1187629\n-8.738048\n0.0000000\n0.0000000\n-1.2710581\n-0.8044544\n\n\nhard_drugs_grpNever User:CESD_2\n0.8029584\n0.1301049\n6.171625\n0.0000000\n0.0000000\n0.5473761\n1.0585407\n\n\nhard_drugs_grpCurrent User:CESD_2\n0.9128781\n0.1845619\n4.946190\n0.0000010\n0.0000061\n0.5503186\n1.2754377\n\n\n\n\n\n\n\nFor previous hard drug users, there was a significant relationship between depression and mental QOL (t = -8.74, p &lt; 0.0001). Specifically, for previous hard drug users, a 1 point increase in depression score was associated with a 1.04 point decrease in mental QOL (95% CI: -1.27 to -0.80). That is nearly 5 times more of a decrease compared to never users!\nCompare slopes for current users.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_sub3 &lt;- lm(AGG_MENT_CHANGE ~ hard_drugs_grp + CESD_2 + hard_drugs_grp*CESD_2, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_sub3)\n\n\nCall:\nlm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + CESD_2 + hard_drugs_grp * \n    CESD_2, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-34.141  -6.071  -1.545   5.758  37.779 \n\nCoefficients:\n                                   Estimate Std. Error t value    Pr(&gt;|t|)    \n(Intercept)                          2.0637     2.7860   0.741       0.459    \nhard_drugs_grpPrevious User         20.0191     3.9455   5.074 0.000000539 ***\nhard_drugs_grpNever User             3.0417     2.9032   1.048       0.295    \nCESD_2                              -0.1249     0.1413  -0.884       0.377    \nhard_drugs_grpPrevious User:CESD_2  -0.9129     0.1846  -4.946 0.000001017 ***\nhard_drugs_grpNever User:CESD_2     -0.1099     0.1509  -0.728       0.467    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.36 on 532 degrees of freedom\n  (12 observations deleted due to missingness)\nMultiple R-squared:  0.1571,    Adjusted R-squared:  0.1492 \nF-statistic: 19.84 on 5 and 532 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Print useful model parameters\nmodel_results(model_MENT_sub3)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n2.0636870\n2.7860086\n0.7407325\n0.4591825\n1.0000000\n-3.4092406\n7.5366146\n\n\nhard_drugs_grpPrevious User\n20.0190937\n3.9454549\n5.0739634\n0.0000005\n0.0000032\n12.2685114\n27.7696761\n\n\nhard_drugs_grpNever User\n3.0416518\n2.9032412\n1.0476745\n0.2952643\n1.0000000\n-2.6615715\n8.7448750\n\n\nCESD_2\n-0.1248781\n0.1412744\n-0.8839402\n0.3771278\n1.0000000\n-0.4024022\n0.1526460\n\n\nhard_drugs_grpPrevious User:CESD_2\n-0.9128781\n0.1845619\n-4.9461896\n0.0000010\n0.0000061\n-1.2754377\n-0.5503186\n\n\nhard_drugs_grpNever User:CESD_2\n-0.1099198\n0.1509341\n-0.7282635\n0.4667728\n1.0000000\n-0.4064197\n0.1865801\n\n\n\n\n\n\n\nFor current users, the relationship between depression and mental QOL is not significant (t = 0.88, p = 0.377, 95% CI: -0.40 to 0.15).\nThe slope for depression on mental QOL depended on hard drug use (t = -4.946, p-adjusted &lt; 0.0001). For each point increase in depression, the mental QOL score for previous hard drug users decreased by an additional 0.91 points compared to current hard drug users (95%: -1.28 to -0.55).\nTop of Tabset\n\n\n\nOverall Model\nThe overall model is highly significant (F~(5, 532)~ = 19.84, p &lt; 0.0001, adjusted R-squared = 0.149).\nThe relationship between depression and mental QOL depended on hard drug use.\n\n\nDepression Slopes within Hard Drug Use Group\n\nDepression for Current Hard Drug Users\nFor current hard drug users, the relationship between depression and mental QOL is not significant (t = 0.88, p = 0.377, 95% CI: -0.40 to 0.15).\n\n\nDepression for Previous Hard Drug Users\nFor previous hard drug users, there was a significant relationship between depression and mental QOL (t = -8.74, p &lt; 0.0001). Specifically, a 1 point increase in depression score was associated with a 1.04 point decrease in mental QOL for previous hard drug users (95% CI: -1.27 to -0.80). That is nearly 5 times more of a decrease compared to never users!\n\n\nDepression for Never Hard Drug Users\nFor never hard drug users, there was a significant relationship between depression and mental QOL (t = -4.42, p &lt; 0.0001). Specifically, a 1 point increase in depression score was associated with 0.23 point decrease in mental QOL for never hard drug users (95% CI: -0.34 to -0.13).\n\n\n\nDepression Slopes between Hard Drug use Group\nThe slopes for the relationship between depression and QOL differed based on hard drug use.\nFor each point increase in depression, the mental QOL score for previous hard drug users decreased an additional 0.80 points compared to never hard drug users (t = -6.17, p-adjusted &lt; 0.0001, 95% CI: -1.06 to -0.55).\nAdditionally, for each point increase in depression, the mental QOL score for previous hard drug users decreased by an additional 0.91 points compared to current hard drug users (t = -4.946, p-adjusted &lt; 0.0001, 95%: -1.28 to -0.55).\nThe slope for depression on mental QOL did not differ between current and never hard drug users (t = 0.73, p-adjusted = 1.00, 95% CI: -0.19 to 0.41).\nTop of Tabset\n\n\n\nThe plot below is helpful in interpreting the interaction between hard drug use and depression on mental QOL.\n\n# Create a scatterplot of mental QOLchange by depression score, colored by hard drug use group.\nggplot(data_wide_2, aes(x = CESD_2, y = AGG_MENT_CHANGE, color = hard_drugs_grp)) + \n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  theme_minimal() +\n  labs(title = \"Mental QOL Change by Depression at 2 years, Colored by Hard Drug Use Group\",\n       y = \"Mental QOL Change\",\n       x = \"Depression Score\") + \n  scale_fill_brewer(palette = \"Pastel2\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\nWarning: Removed 12 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n\n\nWarning: Removed 12 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nHere we can see the key relationships found in the model.\nThere is a negative relationship between depression and mental QOL scores at each level of drug usage. However, this relationship is much stronger for previous hard drug users, where every 1 point increase in depression scores is associated with an almost 5x greater decrease in mental QOL score over 2 years (~1 point for previous users compared to ~0.2 points for current and never user).\nAnd most importantly the slopes differed significantly by hard drug use group, with previous hard drug users having an additional 0.8 or 0.9 greater decrease in mental QOL score compared to never and current hard drug users, respectively.\nThus, we used this relationship as further evidence that previous hard drug users are a vulnerable group. They are susceptible to losses in mental QOL if they have low adherence to the treatment regiment, and depression has a greater impact on the mental QOL of previous hard drug users compared to current and never hard drug users.\nTop of Tabset\n\n\n\n\n\nWe found a dual interaction where the impact of hard drug use on mental QOL depended on both adherence to the treatment regimen and depression.\nFor adherence, those with previous hard drug use had a decrease in mental QOL if and only if they had low adherence to the treatment regiment.\nFor depression, previous hard drug users had a larger decrease in mental QOL compared to never and current hard drug users.\nThus, we used both of these relationships as strong evidence that previous hard drug users are a vulnerable population. They are susceptible to losses in mental QOL if they have low adherence to the treatment regiment, and depression has a greater impact on their mental QOL compared to current and never hard drug users.\nThis finding has great clinical relevance for the treatment of HIV in hard drug users. Specifically, extra efforts should be made to help previous hard drug users in two ways: One, adherence appears to serve as a buffer for previous hard drug users in the relationship between hard drug use and mental QOL. Efforts to increase adherence should therefore be made to help patients receive this ameliorative effect. Two, previous hard drug users do not have the coping mechanism of heroin or opiates available to them to buffer against the impact of adverse effects from ART, and thus extra aid perhaps in the form of increased therapy should be provided to these patients to provide them with alternate coping strategies.\nTop of Tabset\n\n\nJust for completion’s sake, we can run a regression predicting depression score based on the interaction between hard drug use and adherence.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on mental QOL change by hard drugs group, full model\nmodel_MENT_full1 &lt;- lm(CESD_2 ~ hard_drugs_grp + ADH_HIGHVSLOW+ hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_MENT_full1)\n\n\nCall:\nlm(formula = CESD_2 ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp * \n    ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-15.679  -8.508  -2.508   6.492  38.492 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                               13.750      1.848\nhard_drugs_grpCurrent User                                 4.250      5.544\nhard_drugs_grpPrevious User                               30.250      4.651\nADH_HIGHVSLOWHigh Adherence                               -2.242      1.921\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     0.921      5.742\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -26.708      4.964\n                                                        t value\n(Intercept)                                               7.440\nhard_drugs_grpCurrent User                                0.767\nhard_drugs_grpPrevious User                               6.504\nADH_HIGHVSLOWHigh Adherence                              -1.167\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    0.160\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -5.380\n                                                                 Pr(&gt;|t|)    \n(Intercept)                                             0.000000000000411 ***\nhard_drugs_grpCurrent User                                          0.444    \nhard_drugs_grpPrevious User                             0.000000000181686 ***\nADH_HIGHVSLOWHigh Adherence                                         0.244    \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence              0.873    \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence 0.000000111914533 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.45 on 528 degrees of freedom\n  (16 observations deleted due to missingness)\nMultiple R-squared:  0.1175,    Adjusted R-squared:  0.1091 \nF-statistic: 14.06 on 5 and 528 DF,  p-value: 0.0000000000006409\n\n\n\n# Use interactions package to plot interaction\ncat_plot(model_MENT_full1, pred = hard_drugs_grp, modx = ADH_HIGHVSLOW, geom = \"line\", colors = \"Pastel2\")\n\n\n\n\n\n\n\n\nThe interaction is significant, and we can see that previous hard drug users with low adherence had higher depression scores at year 2, and that those with high adherance were buffered from this effect.\nThe fact that depression and mental QOL both have this relationship, and are similar constructs, lends credence to the likelihood that this is a real relationship, and a strong one at that."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#Phys",
    "href": "Project_2/Project_2_R/Code/Project2.html#Phys",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Physical QOL Score",
    "text": "Physical QOL Score\nThe fourth outcome variable of interest was change physcal QOL over the first 2 years of the study.\n\nFull Model\n\n\n\nModel SelectionAnalysisInterpretationVisualizing the Interaction\n\n\nThe candidate variables for inclusion in our model predicting AGG_PHYS_CHANGE were hard_drugs_grp, ADH_HIGHVSLOW, FRP_2, CESD_2, BMI, and DKGRP_2\nWe will remove BMI based on the missing values issue identified in the mental QOL model.\nLet’s run the full model including all those variables and the interaction between hard drug use group and adherence high vs low.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on Physical QOL change\nmodel_PHYS_full1 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + CESD_2 + DKGRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the model\nsummary(model_PHYS_full1)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + CESD_2 + DKGRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, \n    data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.215  -3.939   0.013   3.673  31.134 \n\nCoefficients:\n                                                          Estimate Std. Error\n(Intercept)                                              -4.584386   1.612457\nhard_drugs_grpCurrent User                              -10.266222   4.130948\nhard_drugs_grpPrevious User                             -11.067396   3.633010\nADH_HIGHVSLOWHigh Adherence                               3.209555   1.451052\nFRP_2Yes                                                -12.656122   1.481490\nCESD_2                                                    0.007245   0.033055\nDKGRP_21-3 drinks/week                                    0.651656   0.906606\nDKGRP_24-13 drinks/week                                   2.333646   1.035604\nDKGRP_2&gt;13 drinks/week                                   -0.398119   1.636008\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    6.472409   4.284786\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  12.329569   3.847471\n                                                        t value\n(Intercept)                                              -2.843\nhard_drugs_grpCurrent User                               -2.485\nhard_drugs_grpPrevious User                              -3.046\nADH_HIGHVSLOWHigh Adherence                               2.212\nFRP_2Yes                                                 -8.543\nCESD_2                                                    0.219\nDKGRP_21-3 drinks/week                                    0.719\nDKGRP_24-13 drinks/week                                   2.253\nDKGRP_2&gt;13 drinks/week                                   -0.243\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    1.511\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.205\n                                                                    Pr(&gt;|t|)\n(Intercept)                                                          0.00465\nhard_drugs_grpCurrent User                                           0.01327\nhard_drugs_grpPrevious User                                          0.00244\nADH_HIGHVSLOWHigh Adherence                                          0.02742\nFRP_2Yes                                                &lt; 0.0000000000000002\nCESD_2                                                               0.82659\nDKGRP_21-3 drinks/week                                               0.47260\nDKGRP_24-13 drinks/week                                              0.02466\nDKGRP_2&gt;13 drinks/week                                               0.80783\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence               0.13152\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence              0.00144\n                                                           \n(Intercept)                                             ** \nhard_drugs_grpCurrent User                              *  \nhard_drugs_grpPrevious User                             ** \nADH_HIGHVSLOWHigh Adherence                             *  \nFRP_2Yes                                                ***\nCESD_2                                                     \nDKGRP_21-3 drinks/week                                     \nDKGRP_24-13 drinks/week                                 *  \nDKGRP_2&gt;13 drinks/week                                     \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.757 on 510 degrees of freedom\n  (29 observations deleted due to missingness)\nMultiple R-squared:  0.2022,    Adjusted R-squared:  0.1865 \nF-statistic: 12.92 on 10 and 510 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Get the VIFs\nvif_values &lt;- vif(model_PHYS_full1)\n\nthere are higher-order terms (interactions) in this model\nconsider setting type = 'predictor'; see ?vif\n\npretty_print(vif_values)\n\n\n\n\n\nGVIF\nDf\nGVIF^(1/(2*Df))\n\n\n\n\nhard_drugs_grp\n125.173912\n2\n3.344864\n\n\nADH_HIGHVSLOW\n1.321733\n1\n1.149667\n\n\nFRP_2\n1.031224\n1\n1.015492\n\n\nCESD_2\n1.157182\n1\n1.075724\n\n\nDKGRP_2\n1.052687\n3\n1.008594\n\n\nhard_drugs_grp:ADH_HIGHVSLOW\n124.834338\n2\n3.342593\n\n\n\n\n\n\n\nThe overall model is highly significant (F(10,510) = 12.92, p &lt; 0.0001, Adjusted R-squared = 0.187).\nWe have some nice significant covariates, but it looks like FRP_2 is the main driver for this model.\nWe might have another double interaction situation like we did for the mental QOL model. Let’s create an interaction term between hard_drugs_grp and FRP_2 and run it through backwards elimination to select our final model based on BIC.\n\nBackwards Elimination\nWe will perform model selection using backwards elimination and BIC to select the most parsimonious model.\nA delta BIC of &gt;2 indicates a difference in model performance.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on physical QOL change\nmodel_PHYS_full1 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + CESD_2 + DKGRP_2 + hard_drugs_grp*ADH_HIGHVSLOW + hard_drugs_grp*FRP_2, data = data_wide_2)\n\n# Perform backward elimination regression selection based on BIC \nols_step_backward_sbc(model_PHYS_full1, include = c(\"hard_drugs_grp\", \"ADH_HIGHVSLOW\", \"hard_drugs_grp:ADH_HIGHVSLOW\"))\n\n\n                                    Stepwise Summary                                    \n--------------------------------------------------------------------------------------\nStep    Variable                  AIC         SBC         SBIC        R2       Adj. R2 \n--------------------------------------------------------------------------------------\n 0      Full Model              3622.820    3682.401    2164.416    0.21322    0.19463 \n 1      DKGRP_2                 3623.753    3670.567    2159.814    0.20268    0.18864 \n 2      CESD_2                  3621.873    3664.430    2147.887    0.20250    0.19004 \n 3      hard_drugs_grp:FRP_2    3625.025    3659.071    2143.951    0.19147    0.18204 \n--------------------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                         Model Summary                           \n----------------------------------------------------------------\nR                       0.438       RMSE                  7.726 \nR-Squared               0.191       MSE                  60.507 \nAdj. R-Squared          0.182       Coef. Var          -408.677 \nPred R-Squared          0.174       AIC                3625.025 \nMAE                     5.577       SBC                3659.071 \n----------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                ANOVA                                  \n----------------------------------------------------------------------\n                 Sum of                                               \n                Squares         DF    Mean Square      F         Sig. \n----------------------------------------------------------------------\nRegression     7365.193          6       1227.532    20.287    0.0000 \nResidual      31100.658        514         60.507                     \nTotal         38465.851        520                                    \n----------------------------------------------------------------------\n\n                                                         Parameter Estimates                                                           \n--------------------------------------------------------------------------------------------------------------------------------------\n                                                  model       Beta    Std. Error    Std. Beta      t        Sig       lower     upper \n--------------------------------------------------------------------------------------------------------------------------------------\n                                            (Intercept)     -3.611         1.398                 -2.583    0.010     -6.357    -0.864 \n                             hard_drugs_grpCurrent User     -9.617         4.133       -0.352    -2.327    0.020    -17.736    -1.497 \n                            hard_drugs_grpPrevious User    -10.860         3.470       -0.351    -3.130    0.002    -17.676    -4.043 \n                            ADH_HIGHVSLOWHigh Adherence      3.202         1.452        0.100     2.205    0.028      0.349     6.055 \n                                               FRP_2Yes    -12.737         1.468       -0.345    -8.674    0.000    -15.622    -9.852 \n hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence      5.711         4.286        0.203     1.332    0.183     -2.710    14.132 \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence     12.158         3.713        0.368     3.274    0.001      4.863    19.453 \n--------------------------------------------------------------------------------------------------------------------------------------\n\n\nThe final model selected for AGG_PHYS_CHANGE includes the PEVs of hard_drugs_grp and ADH_HIGHVSLOW and their interaction term, and FRP_2 as a precision variable. Luckily we only have to interpret one interaction for this model!\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on Physical QOL change\nmodel_PHYS_full1 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + CESD_2 + DKGRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the model\nsummary(model_PHYS_full1)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + CESD_2 + DKGRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, \n    data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.215  -3.939   0.013   3.673  31.134 \n\nCoefficients:\n                                                          Estimate Std. Error\n(Intercept)                                              -4.584386   1.612457\nhard_drugs_grpCurrent User                              -10.266222   4.130948\nhard_drugs_grpPrevious User                             -11.067396   3.633010\nADH_HIGHVSLOWHigh Adherence                               3.209555   1.451052\nFRP_2Yes                                                -12.656122   1.481490\nCESD_2                                                    0.007245   0.033055\nDKGRP_21-3 drinks/week                                    0.651656   0.906606\nDKGRP_24-13 drinks/week                                   2.333646   1.035604\nDKGRP_2&gt;13 drinks/week                                   -0.398119   1.636008\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    6.472409   4.284786\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  12.329569   3.847471\n                                                        t value\n(Intercept)                                              -2.843\nhard_drugs_grpCurrent User                               -2.485\nhard_drugs_grpPrevious User                              -3.046\nADH_HIGHVSLOWHigh Adherence                               2.212\nFRP_2Yes                                                 -8.543\nCESD_2                                                    0.219\nDKGRP_21-3 drinks/week                                    0.719\nDKGRP_24-13 drinks/week                                   2.253\nDKGRP_2&gt;13 drinks/week                                   -0.243\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    1.511\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.205\n                                                                    Pr(&gt;|t|)\n(Intercept)                                                          0.00465\nhard_drugs_grpCurrent User                                           0.01327\nhard_drugs_grpPrevious User                                          0.00244\nADH_HIGHVSLOWHigh Adherence                                          0.02742\nFRP_2Yes                                                &lt; 0.0000000000000002\nCESD_2                                                               0.82659\nDKGRP_21-3 drinks/week                                               0.47260\nDKGRP_24-13 drinks/week                                              0.02466\nDKGRP_2&gt;13 drinks/week                                               0.80783\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence               0.13152\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence              0.00144\n                                                           \n(Intercept)                                             ** \nhard_drugs_grpCurrent User                              *  \nhard_drugs_grpPrevious User                             ** \nADH_HIGHVSLOWHigh Adherence                             *  \nFRP_2Yes                                                ***\nCESD_2                                                     \nDKGRP_21-3 drinks/week                                     \nDKGRP_24-13 drinks/week                                 *  \nDKGRP_2&gt;13 drinks/week                                     \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.757 on 510 degrees of freedom\n  (29 observations deleted due to missingness)\nMultiple R-squared:  0.2022,    Adjusted R-squared:  0.1865 \nF-statistic: 12.92 on 10 and 510 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on Physical QOL change by hard drugs group, full model\nmodel_PHYS_full &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Exmamine the summary\nsummary(model_PHYS_full)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-36.596  -3.832   0.574   4.155  33.175 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                               -3.964      1.443\nhard_drugs_grpCurrent User                                -9.263      4.389\nhard_drugs_grpPrevious User                              -10.506      3.679\nADH_HIGHVSLOWHigh Adherence                                2.890      1.503\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     4.642      4.546\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   11.967      3.928\n                                                        t value Pr(&gt;|t|)   \n(Intercept)                                              -2.747  0.00622 **\nhard_drugs_grpCurrent User                               -2.110  0.03529 * \nhard_drugs_grpPrevious User                              -2.856  0.00447 **\nADH_HIGHVSLOWHigh Adherence                               1.923  0.05498 . \nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    1.021  0.30771   \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.046  0.00243 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.29 on 526 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.07391,   Adjusted R-squared:  0.06511 \nF-statistic: 8.396 on 5 and 526 DF,  p-value: 0.0000001181\n\n# Use interactions package to plot interaction\ncat_plot(model_PHYS_full, pred = hard_drugs_grp, modx = ADH_HIGHVSLOW, geom = \"line\", colors = \"Pastel2\")\n\n\n\n\n\n\n\n\nTop of Tabset\n\n\n\nLet’s investigate the key relationships in the final model for AGG_PHYS_CHANGE as determined through backwards selection.\nFirst let’s look at the impact of hard drug use on physical QOL at low adherence.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on phys QOL\nmodel_PHYS_final1 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_PHYS_final1)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-33.074  -4.227  -0.026   3.800  32.493 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                               -3.578      1.351\nhard_drugs_grpCurrent User                                -9.650      4.106\nhard_drugs_grpPrevious User                              -10.893      3.442\nADH_HIGHVSLOWHigh Adherence                                3.185      1.406\nFRP_2Yes                                                 -12.756      1.463\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     5.713      4.255\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   12.309      3.675\n                                                        t value\n(Intercept)                                              -2.648\nhard_drugs_grpCurrent User                               -2.350\nhard_drugs_grpPrevious User                              -3.164\nADH_HIGHVSLOWHigh Adherence                               2.265\nFRP_2Yes                                                 -8.719\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    1.343\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.349\n                                                                    Pr(&gt;|t|)\n(Intercept)                                                         0.008328\nhard_drugs_grpCurrent User                                          0.019144\nhard_drugs_grpPrevious User                                         0.001644\nADH_HIGHVSLOWHigh Adherence                                         0.023912\nFRP_2Yes                                                &lt; 0.0000000000000002\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence              0.179911\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence             0.000868\n                                                           \n(Intercept)                                             ** \nhard_drugs_grpCurrent User                              *  \nhard_drugs_grpPrevious User                             ** \nADH_HIGHVSLOWHigh Adherence                             *  \nFRP_2Yes                                                ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.756 on 525 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.1911,    Adjusted R-squared:  0.1818 \nF-statistic: 20.67 on 6 and 525 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Print useful model parameters\nmodel_results(model_PHYS_final1)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-3.577634\n1.350818\n-2.648494\n0.0083285\n0.0582993\n-6.2313069\n-0.9239609\n\n\nhard_drugs_grpCurrent User\n-9.649910\n4.106380\n-2.349980\n0.0191437\n0.1340061\n-17.7168637\n-1.5829561\n\n\nhard_drugs_grpPrevious User\n-10.892966\n3.442355\n-3.164394\n0.0016441\n0.0115089\n-17.6554473\n-4.1304844\n\n\nADH_HIGHVSLOWHigh Adherence\n3.184855\n1.406039\n2.265126\n0.0239116\n0.1673814\n0.4227021\n5.9470082\n\n\nFRP_2Yes\n-12.755668\n1.462953\n-8.719122\n0.0000000\n0.0000000\n-15.6296286\n-9.8817067\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n5.713316\n4.254723\n1.342817\n0.1799114\n1.0000000\n-2.6450571\n14.0716887\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n12.309256\n3.675079\n3.349385\n0.0008681\n0.0060767\n5.0895895\n19.5289225\n\n\n\n\n\n\n\nThe overall model is highly significant (F~(6, 525)~ = 20.67, p &lt; 0.0001, adjusted R-squared = 0.1818).\nAt low adherence, previous hard drug users had on average a 10.89 point decrease in physical QOL compared to never hard drug users (t = -3.16, p-adjusted = 0.00493, 95% CI: -17.66 to -4.13). Current hard drug users did not differ significantly from never hard drug users at low adherence (t = -2.35, p-adjusted =0.0574, 95% CI: -17.72 to -1.58), although with a larger sample size that could become significant.\nFor never hard drug users, those with high adherence had a 3.19 point increase in physical QOL compared to those with low adherence (t = 2.27, p = 0.0239).\nCompare hard drug use groups at high adherence\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Never User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on phys QOL\nmodel_PHYS_final2 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_PHYS_final2)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-33.074  -4.227  -0.026   3.800  32.493 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                             -0.3928     0.3990\nhard_drugs_grpCurrent User                              -3.9366     1.1106\nhard_drugs_grpPrevious User                              1.4163     1.2872\nADH_HIGHVSLOWLow Adherence                              -3.1849     1.4060\nFRP_2Yes                                               -12.7557     1.4630\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   -5.7133     4.2547\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence -12.3093     3.6751\n                                                       t value\n(Intercept)                                             -0.985\nhard_drugs_grpCurrent User                              -3.545\nhard_drugs_grpPrevious User                              1.100\nADH_HIGHVSLOWLow Adherence                              -2.265\nFRP_2Yes                                                -8.719\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   -1.343\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -3.349\n                                                                   Pr(&gt;|t|)    \n(Intercept)                                                        0.325315    \nhard_drugs_grpCurrent User                                         0.000428 ***\nhard_drugs_grpPrevious User                                        0.271705    \nADH_HIGHVSLOWLow Adherence                                         0.023912 *  \nFRP_2Yes                                               &lt; 0.0000000000000002 ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence              0.179911    \nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence             0.000868 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.756 on 525 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.1911,    Adjusted R-squared:  0.1818 \nF-statistic: 20.67 on 6 and 525 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Print useful model parameters\nmodel_results(model_PHYS_final2)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-0.3927788\n0.3989561\n-0.9845163\n0.3253152\n1.0000000\n-1.176525\n0.3909676\n\n\nhard_drugs_grpCurrent User\n-3.9365941\n1.1105611\n-3.5446893\n0.0004282\n0.0029973\n-6.118283\n-1.7549047\n\n\nhard_drugs_grpPrevious User\n1.4162901\n1.2871848\n1.1003005\n0.2717054\n1.0000000\n-1.112375\n3.9449554\n\n\nADH_HIGHVSLOWLow Adherence\n-3.1848551\n1.4060388\n-2.2651261\n0.0239116\n0.1673814\n-5.947008\n-0.4227021\n\n\nFRP_2Yes\n-12.7556677\n1.4629531\n-8.7191225\n0.0000000\n0.0000000\n-15.629629\n-9.8817067\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence\n-5.7133158\n4.2547230\n-1.3428173\n0.1799114\n1.0000000\n-14.071689\n2.6450571\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence\n-12.3092560\n3.6750790\n-3.3493854\n0.0008681\n0.0060767\n-19.528923\n-5.0895895\n\n\n\n\n\n\n\nAt high adherence, current hard drug users had on average a 3.94 point decrease in physical QOL compared to never hard drug users (t = -3.545, p-adjusted = 0.00128, 95% CI: -6.12 to -1.75). Additionally, previous hard drug users did not differ significantly from never hard drug users at high adherence (t = 1.100, p-adjusted = 0.815, 95% CI: -1.11 to 3.94).\nChange reference level to compare previous users\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Previous User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on phys QOL\nmodel_PHYS_final3 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_PHYS_final3)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-33.074  -4.227  -0.026   3.800  32.493 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                             -14.471      3.166\nhard_drugs_grpNever User                                 10.893      3.442\nhard_drugs_grpCurrent User                                1.243      5.006\nADH_HIGHVSLOWHigh Adherence                              15.494      3.396\nFRP_2Yes                                                -12.756      1.463\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    -12.309      3.675\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   -6.596      5.258\n                                                       t value\n(Intercept)                                             -4.570\nhard_drugs_grpNever User                                 3.164\nhard_drugs_grpCurrent User                               0.248\nADH_HIGHVSLOWHigh Adherence                              4.562\nFRP_2Yes                                                -8.719\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    -3.349\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -1.254\n                                                                   Pr(&gt;|t|)    \n(Intercept)                                                      0.00000608 ***\nhard_drugs_grpNever User                                           0.001644 ** \nhard_drugs_grpCurrent User                                         0.804000    \nADH_HIGHVSLOWHigh Adherence                                      0.00000631 ***\nFRP_2Yes                                               &lt; 0.0000000000000002 ***\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence               0.000868 ***\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence             0.210242    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.756 on 525 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.1911,    Adjusted R-squared:  0.1818 \nF-statistic: 20.67 on 6 and 525 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Print useful model parameters\nmodel_results(model_PHYS_final3)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-14.470600\n3.166243\n-4.5702741\n0.0000061\n0.0000426\n-20.690662\n-8.250537\n\n\nhard_drugs_grpNever User\n10.892966\n3.442355\n3.1643937\n0.0016441\n0.0115089\n4.130484\n17.655447\n\n\nhard_drugs_grpCurrent User\n1.243056\n5.006270\n0.2482998\n0.8039995\n1.0000000\n-8.591726\n11.077838\n\n\nADH_HIGHVSLOWHigh Adherence\n15.494111\n3.396206\n4.5621830\n0.0000063\n0.0000442\n8.822290\n22.165933\n\n\nFRP_2Yes\n-12.755668\n1.462953\n-8.7191225\n0.0000000\n0.0000000\n-15.629629\n-9.881707\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence\n-12.309256\n3.675079\n-3.3493854\n0.0008681\n0.0060767\n-19.528923\n-5.089589\n\n\nhard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence\n-6.595940\n5.258100\n-1.2544342\n0.2102424\n1.0000000\n-16.925439\n3.733559\n\n\n\n\n\n\n\nAt low adherence, previous hard drug users did not differ significantly on change in physical QOL compared to current hard drug users (t = 0.25, p-adjusted = 1.00, 95% CI: -8.59 to 11.08).\nFor previous hard drug users, those with high adherence to the treatment regiment had on average a 15.49 point increase in physical QOL compared to those with low adherence (t = 4.56, p-adjusted &lt; 0.0001, 95% CI: 8.82 to 22.17).\nChange the reference level to current hard drug users.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"Low Adherence\")\n\n# Perform regression on phys QOL\nmodel_PHYS_final4 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_PHYS_final4)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-33.074  -4.227  -0.026   3.800  32.493 \n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                              -13.228      3.878\nhard_drugs_grpPrevious User                               -1.243      5.006\nhard_drugs_grpNever User                                   9.650      4.106\nADH_HIGHVSLOWHigh Adherence                                8.898      4.017\nFRP_2Yes                                                 -12.756      1.463\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence    6.596      5.258\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      -5.713      4.255\n                                                        t value\n(Intercept)                                              -3.411\nhard_drugs_grpPrevious User                              -0.248\nhard_drugs_grpNever User                                  2.350\nADH_HIGHVSLOWHigh Adherence                               2.215\nFRP_2Yes                                                 -8.719\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   1.254\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     -1.343\n                                                                    Pr(&gt;|t|)\n(Intercept)                                                         0.000697\nhard_drugs_grpPrevious User                                         0.804000\nhard_drugs_grpNever User                                            0.019144\nADH_HIGHVSLOWHigh Adherence                                         0.027180\nFRP_2Yes                                                &lt; 0.0000000000000002\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence             0.210242\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence                0.179911\n                                                           \n(Intercept)                                             ***\nhard_drugs_grpPrevious User                                \nhard_drugs_grpNever User                                *  \nADH_HIGHVSLOWHigh Adherence                             *  \nFRP_2Yes                                                ***\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence    \nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence       \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.756 on 525 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.1911,    Adjusted R-squared:  0.1818 \nF-statistic: 20.67 on 6 and 525 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Print useful model parameters\nmodel_results(model_PHYS_final4)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-13.227544\n3.877840\n-3.4110595\n0.0006970\n0.0048787\n-20.845533\n-5.609554\n\n\nhard_drugs_grpPrevious User\n-1.243056\n5.006270\n-0.2482998\n0.8039995\n1.0000000\n-11.077838\n8.591726\n\n\nhard_drugs_grpNever User\n9.649910\n4.106380\n2.3499799\n0.0191437\n0.1340061\n1.582956\n17.716864\n\n\nADH_HIGHVSLOWHigh Adherence\n8.898171\n4.017005\n2.2151255\n0.0271799\n0.1902593\n1.006793\n16.789549\n\n\nFRP_2Yes\n-12.755668\n1.462953\n-8.7191225\n0.0000000\n0.0000000\n-15.629629\n-9.881707\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence\n6.595940\n5.258100\n1.2544342\n0.2102424\n1.0000000\n-3.733559\n16.925439\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence\n-5.713316\n4.254723\n-1.3428173\n0.1799114\n1.0000000\n-14.071689\n2.645057\n\n\n\n\n\n\n\nFor current hard drug users, those with high adherence had on average an 8.90 point increase in physical QOL compared to those with low adherence (t = 2.22, p = 0.027, 95% CI: 1.00 to 16.79).\nChange reference level to high adherence to compare last group.\n\n# Relevel to change to the reference group to never user\ndata_wide_2$hard_drugs_grp&lt;- relevel(data_wide_2$hard_drugs_grp, ref = \"Current User\")\n\n# Relevel to change to the reference group to never user\ndata_wide_2$ADH_HIGHVSLOW &lt;- relevel(data_wide_2$ADH_HIGHVSLOW, ref = \"High Adherence\")\n\n# Perform regression on phys QOL\nmodel_PHYS_final5 &lt;- lm(AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + FRP_2 + hard_drugs_grp*ADH_HIGHVSLOW, data = data_wide_2)\n\n# Examine the summary\nsummary(model_PHYS_final5)\n\n\nCall:\nlm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + \n    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-33.074  -4.227  -0.026   3.800  32.493 \n\nCoefficients:\n                                                       Estimate Std. Error\n(Intercept)                                              -4.329      1.048\nhard_drugs_grpPrevious User                               5.353      1.608\nhard_drugs_grpNever User                                  3.937      1.111\nADH_HIGHVSLOWLow Adherence                               -8.898      4.017\nFRP_2Yes                                                -12.756      1.463\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   -6.596      5.258\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence       5.713      4.255\n                                                       t value\n(Intercept)                                             -4.130\nhard_drugs_grpPrevious User                              3.329\nhard_drugs_grpNever User                                 3.545\nADH_HIGHVSLOWLow Adherence                              -2.215\nFRP_2Yes                                                -8.719\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -1.254\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence      1.343\n                                                                   Pr(&gt;|t|)    \n(Intercept)                                                       0.0000421 ***\nhard_drugs_grpPrevious User                                        0.000931 ***\nhard_drugs_grpNever User                                           0.000428 ***\nADH_HIGHVSLOWLow Adherence                                         0.027180 *  \nFRP_2Yes                                               &lt; 0.0000000000000002 ***\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence             0.210242    \nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence                0.179911    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.756 on 525 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.1911,    Adjusted R-squared:  0.1818 \nF-statistic: 20.67 on 6 and 525 DF,  p-value: &lt; 0.00000000000000022\n\n\n\n# Print useful model parameters\nmodel_results(model_PHYS_final5)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\np_adjusted\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n-4.329373\n1.048183\n-4.130362\n0.0000421\n0.0002950\n-6.388520\n-2.270226\n\n\nhard_drugs_grpPrevious User\n5.352884\n1.607753\n3.329419\n0.0009314\n0.0065198\n2.194464\n8.511304\n\n\nhard_drugs_grpNever User\n3.936594\n1.110561\n3.544689\n0.0004282\n0.0029973\n1.754905\n6.118283\n\n\nADH_HIGHVSLOWLow Adherence\n-8.898171\n4.017005\n-2.215126\n0.0271799\n0.1902593\n-16.789549\n-1.006793\n\n\nFRP_2Yes\n-12.755668\n1.462953\n-8.719122\n0.0000000\n0.0000000\n-15.629629\n-9.881707\n\n\nhard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence\n-6.595940\n5.258100\n-1.254434\n0.2102424\n1.0000000\n-16.925439\n3.733559\n\n\nhard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence\n5.713316\n4.254723\n1.342817\n0.1799114\n1.0000000\n-2.645057\n14.071689\n\n\n\n\n\n\n\nAt high adherence, current hard drug users had on average a change in physical QOL that was 5.35 points less than previous hard drug users (t = 3.33, p-adjusted = 0.00279, 95% CI: 2.19 to 8.51).\nTop of Tabset\n\n\n\nOverall Model\nThere were significant differences in change in physical QOL over 2 years based on hard drug usage and adherence to the treatment regiment, while controlling for Frailty Related Phenotype (F~(6, 525)~ = 20.67, p &lt; 0.0001, adjusted R-squared = 0.1818).\n\nHard Drug Use\nThe relationship between hard drug use and change in physical QOL over 2 years depended on adherence to the treatment regiment.\n\n\nHard Drug Use at Low Adherence\nAt low adherence, previous hard drug users had on average a 10.89 point decrease in physical QOL compared to never hard drug users (t = -3.16, p-adjusted = 0.00493, 95% CI: -17.66 to -4.13), but did not differ significantly on change in physical QOL compared to current hard drug users (t = 0.25, p-adjusted = 1.00, 95% CI: -8.59 to 11.08). . Current hard drug users did not differ significantly from never hard drug users at low adherence (t = -2.35, p-adjusted =0.0574, 95% CI: -17.72 to -1.58), although with a larger sample size that could become significant.\n\n\nHard Drug Use at High Adherence\nAt high adherence, current hard drug users had on average a 3.94 point decrease in physical QOL compared to never hard drug users (t = -3.545, p-adjusted = 0.00128, 95% CI: -6.12 to -1.75), and 5.35 points decrease compared to previous hard drug users (t = 3.33, p-adjusted = 0.00279, 95% CI: 2.19 to 8.51). Additionally, previous hard drug users did not differ significantly from never hard drug users at high adherence (t = 1.100, p-adjusted = 0.815, 95% CI: -1.11 to 3.94).\n\n\n\nAdherence\nThe relationship between adherence and change in physical QOL over 2 years depended on hard drug use.\n\nAdherence for Current Hard Drug Users\nFor current hard drug users, those with high adherence had on average an 8.90 point increase in physical QOL compared to those with low adherence (t = 2.22, p = 0.027, 95% CI: 1.00 to 16.79).\n\n\nAdherence for Previous Hard Drug Users\nFor previous hard drug users, those with high adherence to the treatment regiment had on average a 15.49 point increase in physical QOL compared to those with low adherence (t = 4.56, p-adjusted &lt; 0.0001, 95% CI: 8.82 to 22.17).\n\n\nAdherence for Never Hard Drug Users\nFor never hard drug users, those with high adherence had a 3.19 point increase in physical QOL compared to those with low adherence (t = 2.27, p = 0.0239).\n\n\n\nFrailty Related Phenotype\nFrailty related phenotype was a significant predictor of change in physical QOL over 2 years (t = -8.72, p &lt; 0.0001). On average, those with a frailty related phenotype had a 12.76 decrease in physical QOL compared to those without a frailty related phenotype (95% CI: -15.63 to -9.88).\nTop of Tabset\n\n\n\nThe below plot is useful in interpreting the interaction.\n\n# Use interactions package to plot interaction\ncat_plot(\n  model_PHYS_final1, \n  pred = hard_drugs_grp, \n  modx = ADH_HIGHVSLOW, \n  geom = \"line\", \n  colors = \"Pastel2\",\n  x.label = \"Hard Drugs Group\",\n  y.label = \"Predicted Physical QOL Change\")\n\n\n\n\n\n\n\n\nFor those with low adherence, previous users had a greater decrease in physical QOL compared to never users. The difference between current and never hard drug users at low adherence is borderline significant, and may be so with a larger sample size.\nFor those with high adherence, the current hard drug use group had a greater decrease in physical QOL compared to both never and previous hard drug users.\nAnd most importantly, for previous hard drug users, those with low adherence had a decrease in physical QOL when compared to those with high adherence.\nWe take this as further evidence that previous hard drug users are at a vulnerable population. High adherence serves as a buffer and could protect patients that have quit heroin or opiates within the past 2 years.\nAdditionally, we have evidence that even at high adherence, current hard drug users have worse overall physical QOL."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#log-viral-load-1",
    "href": "Project_2/Project_2_R/Code/Project2.html#log-viral-load-1",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Log Viral Load",
    "text": "Log Viral Load\n\nLinearityIndependenceNormalityEqual Variances (Homoscedasticity)Residuals Centered Around ZeroSummary\n\n\nSince the mains IVs are categorical, we do not need to evaluate linearity.\nTop of Tabset\n\n\nIndependence can be assessed in part by the study design and how the data was collected. Based on the information provided by the PI, I will assume subjects are independent from each other.\nAdditionally, we can examine a scatter plot of the model’s residuals against any time point variable (such as ID).\n\ndata_VLOAD &lt;- data_wide_2 %&gt;%\n  dplyr::select(newid, VLOAD_log_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW, EDUC_COLLEGE) %&gt;%\n  filter(\n    !is.na(newid) & \n    !is.na(VLOAD_log_CHANGE) &\n    !is.na(hard_drugs_grp) & \n    !is.na(ADH_HIGHVSLOW) & \n    !is.na(EDUC_COLLEGE) \n  )\n\n# Create a scatterplot of jackknife residuals vs ID to assess independence \nggplot(data_VLOAD, aes(x = newid, y = jackknife_residuals_VLOAD)) + \n  geom_point() +\n  geom_hline(yintercept = 0) +\n  labs(title = \"Scatterplot of Jackknife Residuals vs ID for Log Viral Load\",\n       x = \"ID\",\n       y = \"Jackknife Residuals\")\n\n\n\n\n\n\n\n\nWe may have some non-independence as seen by the further spread above 0.\nTop of Tabset\n\n\nHere we will asses that, for any fixed value of X, Y has a normal distribution. We will do this using Q-Q plots and histograms of the residuals.\n\n# Make the Q-Q plots using the jackknife residuals\nqqnorm(jackknife_residuals_VLOAD, main = \"Q-Q plots of Jackknife Residuals for Log Viral Load\")\nqqline(jackknife_residuals_VLOAD, col = \"black\")\n\n\n\n\n\n\n\n# Create histogram of jackknife residuals\nhist(jackknife_residuals_VLOAD, main = \"Histogram of Jackknife Residuals\",\n     breaks = 24,\n     xlab = \"Jackknife Residuals\",\n     col = \"lightblue\",\n     border = \"black\")\n\n\n\n\n\n\n\n\nWe can also include the Shapiro-Wilk test of normality, which provides a p-value and allows us to numerically establish that the assumption of normality is met. If the p-value is &lt; 0.05 you conclude that the assumption of normality is not met.\n\nshapiro.test(jackknife_residuals_VLOAD)\n\n\n    Shapiro-Wilk normality test\n\ndata:  jackknife_residuals_VLOAD\nW = 0.97025, p-value = 0.000000008927\n\n\nWe have some non-normality as seen by the higher end of the Q-Q Plot.\nLooking at the histograms, the pattern is slightly bimodal, and may have some outliers at the high range.\nWe also fail Shapiro-Wilk’s test, indicating non-normality.\nTop of Tabset\n\n\nTo assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_VLOAD, aes(x = hard_drugs_grp, y = jackknife_residuals_VLOAD)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Hard Drug Use for Log Viral Load\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_VLOAD, aes(x = ADH_HIGHVSLOW, y = jackknife_residuals_VLOAD)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Adherence for Log Viral Load\",\n       x = \"Adherence\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n\nIt appears that our hard drug use groups have unequal variances.\nAdditionally, while it is not recommended to perform a statistical test to assess for equality of variances (because formal tests of equality of variance are not very powerful), we can still do this using Bartlett’s test. The null hypothesis of the Bartlett test is that the variances are equal. Thus failing to reject the null (p &gt; 0.05) indicates that the data are consistent with the equal variance assumption.\n\n# Perform Bartlett's test to check for homogeneity of variances\nbartlett.test(VLOAD_log_CHANGE ~ hard_drugs_grp, data = data_VLOAD)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  VLOAD_log_CHANGE by hard_drugs_grp\nBartlett's K-squared = 23.563, df = 2, p-value = 0.000007644\n\n\nWe also do not meet the assumption for equality of variances (p &lt; 0.05).\nThis is likely because our patients were not randomly assigned into these groups!\nTop of Tabset\n\n\nTo start, we can simply check that the mean of our residuals is close to 0.\n\n# Generate the mean of the jackknife residuals. Should be close to 0.\nmean(jackknife_residuals_VLOAD)\n\n[1] 0.0004681325\n\n# Generate vectors containing the fitted values vs jackknife residuals so we can plot them \nfitted_values_VLOAD &lt;- fitted(model_VLOAD_full1)\n\nggplot(data_VLOAD, aes(x = fitted_values_VLOAD, y = jackknife_residuals_VLOAD)) + \n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nWe definitely have outliers present.\nThe mean is close to 0.\nA more sophisticated approach is to plot the fitted values vs jackknife residuals. We can then compare the trend between groups to see if they are random. The fitted line should gravitate around 0 with no obvious trends.\nTop of Tabset\n\n\nTop of Tabset"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#cd4-t-cell-count-3",
    "href": "Project_2/Project_2_R/Code/Project2.html#cd4-t-cell-count-3",
    "title": "Advanced Data Analysis - Project 2",
    "section": "CD4+ T Cell Count",
    "text": "CD4+ T Cell Count\n\nLinearityIndependenceNormalityEqual Variances (Homoscedasticity)Residuals Centered Around ZeroSummary\n\n\nWe do not need to assess linearity since our main PEVs are categorical.\nTop of Tabset\n\n\nIndependence can be assessed in part by the study design and how the data was collected. Based on the information provided by the PI, I will assume subjects are independent from each other.\nAdditionally, we can examine a scatter plot of the model’s residuals against any time point variable (such as ID).\n\n# Filter to create same data set as in the final analysis\ndata_LEU3N &lt;- data_wide_2 %&gt;%\n  dplyr::select(newid, LEU3N_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW, FRP_2) %&gt;%\n  filter(\n    !is.na(newid) & \n    !is.na(LEU3N_CHANGE) &\n    !is.na(hard_drugs_grp) & \n    !is.na(ADH_HIGHVSLOW) & \n    !is.na(FRP_2) \n  )\n\n# Create a scatterplot of jackknife residuals vs ID to assess independence \nggplot(data_LEU3N, aes(x = newid, y = jackknife_residuals_LEU3N)) + \n  geom_point() +\n  geom_hline(yintercept = 0) +\n  labs(title = \"Scatterplot of Jackknife Residuals vs ID for CD4+ T Cells\",\n       x = \"ID\",\n       y = \"Jackknife Residuals\")\n\n\n\n\n\n\n\n\nLooks like we have 4 outlier points beyound 3 residuals from 0, but otherwise looking good.\nTop of Tabset\n\n\nHere we will asses that, for any fixed value of X, Y has a normal distribution. We will do this using Q-Q plots and histograms of the residuals.\n\n# Make the Q-Q plots using the jackknife residuals\nqqnorm(jackknife_residuals_LEU3N, main = \"Q-Q plots of Jackknife Residuals for Log Viral Load\")\nqqline(jackknife_residuals_LEU3N, col = \"black\")\n\n\n\n\n\n\n\n# Create histogram of jackknife residuals\nhist(jackknife_residuals_LEU3N, main = \"Histogram of Jackknife Residuals\",\n     breaks = 24,\n     xlab = \"Jackknife Residuals\",\n     col = \"lightblue\",\n     border = \"black\")\n\n\n\n\n\n\n\n\nWe look very normal here, sans some obvious outliers.\n\nshapiro.test(jackknife_residuals_LEU3N)\n\n\n    Shapiro-Wilk normality test\n\ndata:  jackknife_residuals_LEU3N\nW = 0.97052, p-value = 0.00000001042\n\n\nWe have non-normality, but that is due to outliers.\nTop of Tabset\n\n\nTo assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_LEU3N, aes(x = hard_drugs_grp, y = jackknife_residuals_LEU3N)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Hard Drug Use for CD4+ T Cell Count Change\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_LEU3N, aes(x = ADH_HIGHVSLOW, y = jackknife_residuals_LEU3N)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Adherence for CD4+ T Cell Count Change\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n\n\n# Perform Bartlett's test to check for homogeneity of variances\nbartlett.test(LEU3N_CHANGE ~ hard_drugs_grp, data = data_LEU3N)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  LEU3N_CHANGE by hard_drugs_grp\nBartlett's K-squared = 5.8811, df = 2, p-value = 0.05284\n\n\nWe can actually conclude that we have equality of variances! This will look even better once we get rid of outliers.\nTop of Tabset\n\n\nto start, we can simply check that the mean of our residuals is close to 0.\n\n# Generate the mean of the jackknife residuals. Should be close to 0.\nmean(jackknife_residuals_LEU3N)\n\n[1] 0.0004433429\n\n# Generate vectors containing the fitted values vs jackknife residuals so we can plot them \nfitted_values_LEU3N &lt;- fitted(model_LEU3N_final1)\n\nggplot(data_LEU3N, aes(x = fitted_values_LEU3N, y = jackknife_residuals_LEU3N)) + \n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nThe mean is close to 0. The residuals look centered around 0 excepting the outliers.\nTop of Tabset\n\n\nTop of Tabset"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#mental-quality-of-life",
    "href": "Project_2/Project_2_R/Code/Project2.html#mental-quality-of-life",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Mental Quality of Life",
    "text": "Mental Quality of Life\n\nLinearityIndependenceNormalityEqual Variances (Homoscedasticity)Residuals Centered Around ZeroSummary\n\n\nWe do not need to assess linearity since our main PEVs are categorical.\nTop of Tabset\n\n\nIndependence can be assessed in part by the study design and how the data was collected. Based on the information provided by the PI, I will assume subjects are independent from each other.\nAdditionally, we can examine a scatter plot of the model’s residuals against any time point variable (such as ID).\n\n# Filter to create same data set as in the final analysis\ndata_MENT_main &lt;- data_wide_2 %&gt;%\n  dplyr::select(newid, AGG_MENT_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW) %&gt;%\n  filter(\n    !is.na(newid) & \n    !is.na(AGG_MENT_CHANGE) &\n    !is.na(hard_drugs_grp) & \n    !is.na(ADH_HIGHVSLOW) \n  )\n\n# Create a scatterplot of jackknife residuals vs ID to assess independence \nggplot(data_MENT_main, aes(x = newid, y = jackknife_residuals_MENT_main)) + \n  geom_point() +\n  geom_hline(yintercept = 0) +\n  labs(title = \"Scatterplot of Jackknife Residuals vs ID for Mental QOL Change\",\n       x = \"ID\",\n       y = \"Jackknife Residuals\")\n\n\n\n\n\n\n\n\nNo clear pattern, we meet the assumption of independence.\nTop of Tabset\n\n\nHere we will asses that, for any fixed value of X, Y has a normal distribution. We will do this using Q-Q plots and histograms of the residuals.\n\n# Make the Q-Q plots using the jackknife residuals\nqqnorm(jackknife_residuals_MENT_main, main = \"Q-Q plots of Jackknife Residuals for Mental QOL Change\")\nqqline(jackknife_residuals_MENT_main, col = \"black\")\n\n\n\n\n\n\n\n# Create histogram of jackknife residuals\nhist(jackknife_residuals_MENT_main, main = \"Histogram of Jackknife Residuals\",\n     breaks = 24,\n     xlab = \"Jackknife Residuals\",\n     col = \"lightblue\",\n     border = \"black\")\n\n\n\n\n\n\n\n\n\nshapiro.test(jackknife_residuals_MENT_main)\n\n\n    Shapiro-Wilk normality test\n\ndata:  jackknife_residuals_MENT_main\nW = 0.96193, p-value = 0.0000000001675\n\n\nWe have non-normality. It does not look like outliers are driving this.\nTop of Tabset\n\n\nTo assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_MENT_main, aes(x = hard_drugs_grp, y = jackknife_residuals_MENT_main)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Hard Drug Use for Mental QOL Change\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_MENT_main, aes(x = ADH_HIGHVSLOW, y = jackknife_residuals_MENT_main)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Adherence for Mental QOL Change\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n\n\n# Perform Bartlett's test to check for homogeneity of variances\nbartlett.test(AGG_MENT_CHANGE ~ hard_drugs_grp, data = data_MENT_main)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  AGG_MENT_CHANGE by hard_drugs_grp\nBartlett's K-squared = 19.522, df = 2, p-value = 0.00005765\n\n\nThe test is significant, and we conclude we do not have homogeneity of variances.\nTop of Tabset\n\n\n\n# Generate the mean of the jackknife residuals. Should be close to 0.\nmean(jackknife_residuals_MENT_main)\n\n[1] 0.0001715436\n\n# Generate vectors containing the fitted values vs jackknife residuals so we can plot them \nfitted_values_MENT_main &lt;- fitted(model_MENT_main1)\n\nggplot(data_MENT_main, aes(x = fitted_values_MENT_main, y = jackknife_residuals_MENT_main)) + \n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nOur residuals look centered around 0, sans a few outlier points.\nTop of Tabset\n\n\nWe have non-normality and non homogeneity of variances.\nTop of Tabset"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#physical-quality-of-life",
    "href": "Project_2/Project_2_R/Code/Project2.html#physical-quality-of-life",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Physical Quality of Life",
    "text": "Physical Quality of Life\n\nLinearityIndependenceNormalityEqual Variances (Homoscedasticity)Residuals Centered Around ZeroSummaryResiduals Centered Around ZeroSummary\n\n\nWe do not need to assess linearity since our main PEVs are categorical.\nTop of Tabset\n\n\nIndependence can be assessed in part by the study design and how the data was collected. Based on the information provided by the PI, I will assume subjects are independent from each other.\nAdditionally, we can examine a scatter plot of the model’s residuals against any time point variable (such as ID).\n\n# Filter to create same data set as in the final analysis\ndata_PHYS &lt;- data_wide_2 %&gt;%\n  dplyr::select(newid, AGG_PHYS_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW, FRP_2) %&gt;%\n  filter(\n    !is.na(newid) & \n    !is.na(AGG_PHYS_CHANGE) &\n    !is.na(hard_drugs_grp) & \n    !is.na(ADH_HIGHVSLOW) &\n    !is.na(FRP_2)\n  )\n\n# Create a scatterplot of jackknife residuals vs ID to assess independence \nggplot(data_PHYS, aes(x = newid, y = jackknife_residuals_PHYS)) + \n  geom_point() +\n  geom_hline(yintercept = 0) +\n  labs(title = \"Scatterplot of Jackknife Residuals vs ID for Physical QOL Change\",\n       x = \"ID\",\n       y = \"Jackknife Residuals\")\n\n\n\n\n\n\n\n\nIndependence looks pretty good.\nTop of Tabset\n\n\nHere we will asses that, for any fixed value of X, Y has a normal distribution. We will do this using Q-Q plots and histograms of the residuals.\n\n# Make the Q-Q plots using the jackknife residuals\nqqnorm(jackknife_residuals_PHYS, main = \"Q-Q plots of Jackknife Residuals for Mental QOL Change\")\nqqline(jackknife_residuals_PHYS, col = \"black\")\n\n\n\n\n\n\n\n# Create histogram of jackknife residuals\nhist(jackknife_residuals_PHYS, main = \"Histogram of Jackknife Residuals\",\n     breaks = 24,\n     xlab = \"Jackknife Residuals\",\n     col = \"lightblue\",\n     border = \"black\")\n\n\n\n\n\n\n\nshapiro.test(jackknife_residuals_PHYS)\n\n\n    Shapiro-Wilk normality test\n\ndata:  jackknife_residuals_PHYS\nW = 0.9682, p-value = 0.000000002488\n\n\nPhysical QOL looks mostly normal. There may be 1 outier at the upper and lower bound.\nShapiro Wilk’s does say we fail normality however.\nTop of Tabset\n\n\nTo assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_PHYS, aes(x = hard_drugs_grp, y = jackknife_residuals_PHYS)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Hard Drug Use for Physical QOL Change\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n# Perform Bartlett's test to check for homogeneity of variances\nbartlett.test(AGG_PHYS_CHANGE ~ hard_drugs_grp, data = data_PHYS)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  AGG_PHYS_CHANGE by hard_drugs_grp\nBartlett's K-squared = 4.2398, df = 2, p-value = 0.12\n\n\nWe do have homogeneity of variances for physical QOL.\nTop of Tabset\n\n\n\n# Generate the mean of the jackknife residuals. Should be close to 0.\nmean(jackknife_residuals_PHYS)\n\n[1] 0.0002469251\n\n# Generate vectors containing the fitted values vs jackknife residuals so we can plot them \nfitted_values_PHYS &lt;- fitted(model_PHYS_final1)\n\nggplot(data_PHYS, aes(x = fitted_values_PHYS, y = jackknife_residuals_PHYS)) + \n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nTop of Tabset\n\n\nThe assumptions for CD4+ T cell count are almost met. Likely once removing those 4 or so outliers they would be perfect.\nTop of Tabset\nTo assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_PHYS, aes(x = hard_drugs_grp, y = jackknife_residuals_PHYS)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Hard Drug Use for Physical QOL Change\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n\n\n# Make the residual scatterplot using the jackknife residuals\nggplot(data_PHYS, aes(x = ADH_HIGHVSLOW, y = jackknife_residuals_PHYS)) +\n  geom_boxplot() + \n  labs(title = \"Jackknife Residuals vs Adherence for Physical QOL Change\",\n       x = \"Hard Drug Use Group\",\n       y = \"JackKnife Residuals\")\n\n\n\n\n\n\n\n\n\n# Perform Bartlett's test to check for homogeneity of variances\nbartlett.test(AGG_PHYS_CHANGE ~ hard_drugs_grp, data = data_PHYS)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  AGG_PHYS_CHANGE by hard_drugs_grp\nBartlett's K-squared = 4.2398, df = 2, p-value = 0.12\n\n\nWe do have homogeneity of variances.\n\n\n\n# Generate the mean of the jackknife residuals. Should be close to 0.\nmean(jackknife_residuals_PHYS)\n\n[1] 0.0002469251\n\n# Generate vectors containing the fitted values vs jackknife residuals so we can plot them \nfitted_values_PHYS &lt;- fitted(model_PHYS_final1)\n\nggplot(data_PHYS, aes(x = fitted_values_PHYS, y = jackknife_residuals_PHYS)) + \n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nThe residuals appear centered around zero, for the most part.\n\n\nWe do not meet the assumption of normality for physical QOL."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#mental-qol",
    "href": "Project_2/Project_2_R/Code/Project2.html#mental-qol",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Mental QOL",
    "text": "Mental QOL\n\n# Get rid of that value of 1 for adherence at baseline for patient 426\ndata$ADH[data$years == 0] &lt;- NA\n\n# Get means for each year\nsummary_data &lt;- data %&gt;%\n  group_by(ADH, years) %&gt;%\n  summarize(Average_QOL = mean(AGG_MENT, na.rm = TRUE))\n\n`summarise()` has grouped output by 'ADH'. You can override using the `.groups`\nargument.\n\n# Create plot\np &lt;- ggplot(summary_data, aes(x = years, y = Average_QOL, color = ADH)) +\n  geom_line(size = 1) +   # Line plot\n  geom_point(size = 2) +  # Add points for clarity\n  labs(title = \"Average Mental QOL Score by Adherence Group Over 8 Years\",\n       x = \"Year\",\n       y = \"Average Mental QOL Score\",\n       color = \"Adherence Group\") +\n  theme_minimal() +       # Clean theme\n  scale_color_brewer(palette = \"Pastel2\")  # Nice color palette for groups\n\nggplotly(p)\n\n\n\n\n\nSuccess! This is very interesting. It appears that the 100% adherence group has the highest average mental QOL score across the 8 year study, followed by the 95-99% group, followed by the &lt;75% group and followed by (with some variation) the &lt;75% and 75-94% groups."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#physical-qol",
    "href": "Project_2/Project_2_R/Code/Project2.html#physical-qol",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Physical QOL",
    "text": "Physical QOL\nLet’s do the same thing but for AGG_PHYS.\n\n# Get means for each year\nsummary_data &lt;- data %&gt;%\n  group_by(ADH, years) %&gt;%\n  summarize(Average_QOL = mean(AGG_PHYS, na.rm = TRUE))\n\n`summarise()` has grouped output by 'ADH'. You can override using the `.groups`\nargument.\n\n# Create plot\nggplot(summary_data, aes(x = years, y = Average_QOL, color = ADH)) +\n  geom_line(size = 1) +   # Line plot\n  geom_point(size = 2) +  # Add points for clarity\n  labs(title = \"Average Physical QOL Score by Adherence Group Over 8 Years\",\n       x = \"Year\",\n       y = \"Average Physical QOL Score\",\n       color = \"Adherence Group\") +\n  theme_minimal() +       # Clean theme\n  scale_color_brewer(palette = \"Pastel2\")  # Nice color palette for groups\n\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_line()`).\n\n\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nWe see a similiar relationship here, though there’s more variation. For some reason that &lt;75% group likes to spike in their QOL at year 7. Interesting."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#log-viral-load-3",
    "href": "Project_2/Project_2_R/Code/Project2.html#log-viral-load-3",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Log Viral Load",
    "text": "Log Viral Load\n\n# Get means for each year\nsummary_data &lt;- data %&gt;%\n  group_by(ADH, years) %&gt;%\n  summarize(Average_LEU3N = mean(LEU3N, na.rm = TRUE))\n\n`summarise()` has grouped output by 'ADH'. You can override using the `.groups`\nargument.\n\n# Create plot\np &lt;- ggplot(summary_data, aes(x = years, y = Average_LEU3N, color = ADH)) +\n  geom_line(size = 1) +   # Line plot\n  geom_point(size = 2) +  # Add points for clarity\n  labs(title = \"Average LEU3N  by Adherence Group Over 8 Years\",\n       x = \"Year\",\n       y = \"Average LEU3N\",\n       color = \"Adherence Group\") +\n  theme_minimal() +       # Clean theme\n  scale_color_brewer(palette = \"Pastel2\")  # Nice color palette for groups\n\nggplotly(p)"
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#cd4-t-cell-count-5",
    "href": "Project_2/Project_2_R/Code/Project2.html#cd4-t-cell-count-5",
    "title": "Advanced Data Analysis - Project 2",
    "section": "CD4+ T Cell Count",
    "text": "CD4+ T Cell Count\n\n# Create log vload variable for original 8 year data set.\ndata$VLOAD_log &lt;- log(data$VLOAD)\n\n# Get means for each year\nsummary_data &lt;- data %&gt;%\n  group_by(ADH, years) %&gt;%\n  summarize(Average_VLOAD_log = mean(VLOAD_log, na.rm = TRUE))\n\n`summarise()` has grouped output by 'ADH'. You can override using the `.groups`\nargument.\n\n# Create plot\np &lt;- ggplot(summary_data, aes(x = years, y = Average_VLOAD_log, color = ADH)) +\n  geom_line(size = 1) +   # Line plot\n  geom_point(size = 2) +  # Add points for clarity\n  labs(title = \"Average VLOAD log by Adherence Group Over 8 Years\",\n       x = \"Year\",\n       y = \"Average VLOAD log\",\n       color = \"Adherence Group\") +\n  theme_minimal() +       # Clean theme\n  scale_color_brewer(palette = \"Pastel2\")  # Nice color palette for groups\n\nggplotly(p)\n\n\n\n\n\nThat’s very interesting. The groups with the highest vload log had the least adherence. There is an inverse relationship here.\nThis is strong evidence that the treatment is efficacious and the ADH should be considered as a confounder.\nOhhhhh, that’s super cool. So there is an inverse relationship between LEU3N and VLOAD_log, such that spikes in one should be dips in the other. We can see that in this data set! It appears that for the adherence group of &lt;75%, they had viral load spikes at years 5 and 7, which correspond with leukocyte dips at years 5 and 7! They weren’t adhering to the protocol, which resulted in them getting infected (?) more and having more of the virus present compared to the other groups."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#comparing-high-vs-low-adherence-groups",
    "href": "Project_2/Project_2_R/Code/Project2.html#comparing-high-vs-low-adherence-groups",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Comparing High Vs Low Adherence Groups",
    "text": "Comparing High Vs Low Adherence Groups\n\ndata$ADH_HIGHLOW &lt;- ifelse(data$ADH == \"&lt;75%\" | data$ADH == \"75-94%\", 0, 1)\n\ndata$ADH_HIGHLOW &lt;- factor(data$ADH_HIGHLOW,\n                           levels = c(0,1),\n                           labels = c(\"Low Adherence\", \"High Adherence\"))\n\n#### tRY WITH HIGH LOW ADH\n# Create log vload variable for original 8 year data set.\ndata$VLOAD_log &lt;- log(data$VLOAD)\n\n# Get means for each year\nsummary_data &lt;- data %&gt;%\n  group_by(ADH_HIGHLOW, years) %&gt;%\n  summarize(Average_VLOAD_log = mean(VLOAD_log, na.rm = TRUE))\n\n`summarise()` has grouped output by 'ADH_HIGHLOW'. You can override using the\n`.groups` argument.\n\n# Create plot\np &lt;- ggplot(summary_data, aes(x = years, y = Average_VLOAD_log, color = ADH_HIGHLOW)) +\n  geom_line(size = 1) +   # Line plot\n  geom_point(size = 2) +  # Add points for clarity\n  labs(title = \"Average VLOAD log by Adherence Group Over 8 Years\",\n       x = \"Year\",\n       y = \"Average VLOAD log\",\n       color = \"Adherence Group\") +\n  theme_minimal() +       # Clean theme\n  scale_color_brewer(palette = \"Pastel2\")  # Nice color palette for groups\n\nggplotly(p)\n\n\n\n\n\nHigh adherence patients have lower viral load then low adherence\nSame for leu3n\n\n#### tRY WITH HIGH LOW ADH\n\n# Get means for each year\nsummary_data &lt;- data %&gt;%\n  group_by(ADH_HIGHLOW, years) %&gt;%\n  summarize(Average_LEU3N = mean(LEU3N, na.rm = TRUE))\n\n`summarise()` has grouped output by 'ADH_HIGHLOW'. You can override using the\n`.groups` argument.\n\n# Create plot\np &lt;- ggplot(summary_data, aes(x = years, y = Average_LEU3N, color = ADH_HIGHLOW)) +\n  geom_line(size = 1) +   # Line plot\n  geom_point(size = 2) +  # Add points for clarity\n  labs(title = \"Average LEU3N by Adherence Group Over 8 Years\",\n       x = \"Year\",\n       y = \"Average LEU3N\",\n       color = \"Adherence Group\") +\n  theme_minimal() +       # Clean theme\n  scale_color_brewer(palette = \"Pastel2\")  # Nice color palette for groups\n\nggplotly(p)\n\n\n\n\n\nHigh adherence users have higher CD4+ T Cells, for the most part."
  },
  {
    "objectID": "Project_2/Project_2_R/Code/Project2.html#other-literature",
    "href": "Project_2/Project_2_R/Code/Project2.html#other-literature",
    "title": "Advanced Data Analysis - Project 2",
    "section": "Other literature",
    "text": "Other literature\nhttps://pmc.ncbi.nlm.nih.gov/articles/PMC9234842/\nThis one shows that poor adherence is related to anxiety and depression, leading credence to why I want to examine the impact of hard drugs and adherence while controlling for depression."
  }
]