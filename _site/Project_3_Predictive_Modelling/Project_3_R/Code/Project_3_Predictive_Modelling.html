<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sean Vieau">
<meta name="dcterms.date" content="2024-10-30">

<title>Predictive Modelling – Sean Vieau Portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../../site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="../../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Sean Vieau Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-advanced-data-analyses-(rsas" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Advanced Data Analyses (R/SAS)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-advanced-data-analyses-(rsas">    
        <li>
    <a class="dropdown-item" href="../../../Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html">
 <span class="dropdown-text">Regression (R)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../Project_1_Regression/Project_1_Regression_SAS/Project_1_Regression_SAS.html">
 <span class="dropdown-text">Regression (SAS)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../Project_2/Project_2_R/Code/Project2.html">
 <span class="dropdown-text">MLR With Confounding and Interaction (R)</span></a>
  </li>  
        <li class="dropdown-header">MLR With Confounding and Interaction (SAS)</li>
        <li>
    <a class="dropdown-item" href="../../../Project_2/Project_2_R/Code/Project2LMM.html">
 <span class="dropdown-text">Linear Mixed Model (R)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../Project_2/Project_2_SAS/Code/Linear_Mixed_Modxbcel_SAS.qmd">
 <span class="dropdown-text">Linear Mixed Model (SAS)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../Project_3_Predictive_Modelling/Project_3_R/Code/Project_3_Predictive_Modelling.html">
 <span class="dropdown-text">Predictive Modelling (R)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../Project_3_Predictive_Modelling/Project_3_SAS/Code/Project_3_Predictive_Modelling_SAS.html">
 <span class="dropdown-text">Predictive Modelling (SAS)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html"> 
<span class="menu-text">Data Wrangling (Python)</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data-management-(sas" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Data Management (SAS)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-data-management-(sas">    
        <li>
    <a class="dropdown-item" href="../../../Data_Management_(SAS)/Project_1/Project_1_Importing.html">
 <span class="dropdown-text">Project 1 - Importing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../Data_Management_(SAS)/Project_3/Project3.html">
 <span class="dropdown-text">Project 3 - Data Set Creation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../Data_Management_(SAS)/Project_5/Project_5_Report_and_Analysis.html">
 <span class="dropdown-text">Project 5 - Report and Analysis</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-statistical-consulting-(r" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Statistical Consulting (R)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-statistical-consulting-(r">    
        <li>
    <a class="dropdown-item" href="../../../Statistical_Consulting/Vieau_Project_01/Code/Megan_Watson_Project.html">
 <span class="dropdown-text">Scope of Work and Negative Binomial Regression (R)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data-viz-(r" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Data Viz (R)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-data-viz-(r">    
        <li>
    <a class="dropdown-item" href="../../../Data_Visualization/Cancer_Animations/Gapminder_Cancer_Animations.html">
 <span class="dropdown-text">Animated Plots (R)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../Statistical_Consulting/Opioid_Epidemic/GeoSpatial_Opioid_Epidemic.html">
 <span class="dropdown-text">Geospatial Analysis (R)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../Resume/Publications_and_Presentations.html"> 
<span class="menu-text">Publications/Presentations</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#clinical-hypotheses" id="toc-clinical-hypotheses" class="nav-link" data-scroll-target="#clinical-hypotheses">Clinical Hypotheses</a></li>
  </ul></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">Background</a>
  <ul class="collapse">
  <li><a href="#gabor-transform" id="toc-gabor-transform" class="nav-link" data-scroll-target="#gabor-transform">Gabor Transform</a></li>
  <li><a href="#gray-level-co-occurrence-matrix" id="toc-gray-level-co-occurrence-matrix" class="nav-link" data-scroll-target="#gray-level-co-occurrence-matrix">Gray Level Co-Occurrence Matrix</a></li>
  <li><a href="#local-binary-pattern" id="toc-local-binary-pattern" class="nav-link" data-scroll-target="#local-binary-pattern">Local Binary Pattern</a></li>
  </ul></li>
  <li><a href="#method" id="toc-method" class="nav-link" data-scroll-target="#method">Method</a>
  <ul class="collapse">
  <li><a href="#study-design" id="toc-study-design" class="nav-link" data-scroll-target="#study-design">Study Design</a>
  <ul class="collapse">
  <li><a href="#statistical-hypotheses" id="toc-statistical-hypotheses" class="nav-link" data-scroll-target="#statistical-hypotheses">Statistical Hypotheses</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a></li>
  <li><a href="#missingness" id="toc-missingness" class="nav-link" data-scroll-target="#missingness">Missingness</a></li>
  <li><a href="#data-split" id="toc-data-split" class="nav-link" data-scroll-target="#data-split">Data Split</a></li>
  <li><a href="#Outcomes_Uni" id="toc-Outcomes_Uni" class="nav-link" data-scroll-target="#Outcomes_Uni">Outcome Variables</a>
  <ul class="collapse">
  <li><a href="#summary-2" id="toc-summary-2" class="nav-link" data-scroll-target="#summary-2">Summary</a></li>
  </ul></li>
  <li><a href="#Features_Uni" id="toc-Features_Uni" class="nav-link" data-scroll-target="#Features_Uni">Feature Engineering I</a>
  <ul class="collapse">
  <li><a href="#correlation-matrix-i" id="toc-correlation-matrix-i" class="nav-link" data-scroll-target="#correlation-matrix-i">Correlation Matrix I</a></li>
  <li><a href="#Corr_One" id="toc-Corr_One" class="nav-link" data-scroll-target="#Corr_One">Main Observations</a></li>
  <li><a href="#summary-18" id="toc-summary-18" class="nav-link" data-scroll-target="#summary-18">Summary</a></li>
  </ul></li>
  <li><a href="#feature-engineering-ii" id="toc-feature-engineering-ii" class="nav-link" data-scroll-target="#feature-engineering-ii">Feature Engineering II</a>
  <ul class="collapse">
  <li><a href="#averages-and-interaction-terms" id="toc-averages-and-interaction-terms" class="nav-link" data-scroll-target="#averages-and-interaction-terms">Averages and Interaction Terms</a></li>
  <li><a href="#correlation-matrix-ii" id="toc-correlation-matrix-ii" class="nav-link" data-scroll-target="#correlation-matrix-ii">Correlation Matrix II</a></li>
  <li><a href="#Corr_Two" id="toc-Corr_Two" class="nav-link" data-scroll-target="#Corr_Two">Main Observations</a>
  <ul class="collapse">
  <li><a href="#summary-19" id="toc-summary-19" class="nav-link" data-scroll-target="#summary-19">Summary</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#feature-engineering-iii" id="toc-feature-engineering-iii" class="nav-link" data-scroll-target="#feature-engineering-iii">Feature Engineering III</a>
  <ul class="collapse">
  <li><a href="#quadratic-terms" id="toc-quadratic-terms" class="nav-link" data-scroll-target="#quadratic-terms">Quadratic Terms</a></li>
  <li><a href="#correlation-matrix-iii" id="toc-correlation-matrix-iii" class="nav-link" data-scroll-target="#correlation-matrix-iii">Correlation Matrix III</a></li>
  <li><a href="#Corr_Three" id="toc-Corr_Three" class="nav-link" data-scroll-target="#Corr_Three">Main Observations</a>
  <ul class="collapse">
  <li><a href="#summary-20" id="toc-summary-20" class="nav-link" data-scroll-target="#summary-20">Summary</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#feature-scaling" id="toc-feature-scaling" class="nav-link" data-scroll-target="#feature-scaling">Feature Scaling</a>
  <ul class="collapse">
  <li><a href="#perform-scaling" id="toc-perform-scaling" class="nav-link" data-scroll-target="#perform-scaling">Perform Scaling</a></li>
  </ul></li>
  <li><a href="#task-one-linear-regression" id="toc-task-one-linear-regression" class="nav-link" data-scroll-target="#task-one-linear-regression">Task One: Linear Regression</a>
  <ul class="collapse">
  <li><a href="#cost-function" id="toc-cost-function" class="nav-link" data-scroll-target="#cost-function">Cost Function</a></li>
  <li><a href="#1A" id="toc-1A" class="nav-link" data-scroll-target="#1A">Model 1A: Baseline Kidney Volume</a></li>
  <li><a href="#1B" id="toc-1B" class="nav-link" data-scroll-target="#1B">Model 1B: MRI Features</a></li>
  <li><a href="#1C" id="toc-1C" class="nav-link" data-scroll-target="#1C">Model 1C: Baseline Kidney Volume and TXTI2</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison">Model Comparison</a>
  <ul class="collapse">
  <li><a href="#final-average-rmse" id="toc-final-average-rmse" class="nav-link" data-scroll-target="#final-average-rmse">Final Average RMSE</a></li>
  <li><a href="#compare-model-performance" id="toc-compare-model-performance" class="nav-link" data-scroll-target="#compare-model-performance">Compare Model Performance</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  <li><a href="#task-two-logistic-regression" id="toc-task-two-logistic-regression" class="nav-link" data-scroll-target="#task-two-logistic-regression">Task Two: Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#2A" id="toc-2A" class="nav-link" data-scroll-target="#2A">Model 2A</a>
  <ul class="collapse">
  <li><a href="#baseline-kidney-volume-1" id="toc-baseline-kidney-volume-1" class="nav-link" data-scroll-target="#baseline-kidney-volume-1">Baseline Kidney Volume</a></li>
  </ul></li>
  <li><a href="#2B" id="toc-2B" class="nav-link" data-scroll-target="#2B">Model 2B: MRI Image Features</a></li>
  <li><a href="#2C" id="toc-2C" class="nav-link" data-scroll-target="#2C">Model 2C: Baseline Kidney Volume and MRI Image Features</a></li>
  <li><a href="#model-comparison-1" id="toc-model-comparison-1" class="nav-link" data-scroll-target="#model-comparison-1">Model Comparison</a></li>
  <li><a href="#results-1" id="toc-results-1" class="nav-link" data-scroll-target="#results-1">Results</a></li>
  <li><a href="#summary-27" id="toc-summary-27" class="nav-link" data-scroll-target="#summary-27">Summary</a></li>
  </ul></li>
  <li><a href="#results-2" id="toc-results-2" class="nav-link" data-scroll-target="#results-2">Results</a>
  <ul class="collapse">
  <li><a href="#roc-curves" id="toc-roc-curves" class="nav-link" data-scroll-target="#roc-curves">ROC Curves</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Predictive Modelling</h1>
<p class="subtitle lead">Advanced Data Analysis - Project 3</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sean Vieau </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 30, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The aim of the current study is to investigate whether MRI image features extracted from baseline kidney images can enhance the prediction of disease progression in young Autosomal Dominant Polycystic Kidney Disease (ADPKD) patients. This study is important because recent literature has demonstrated the inclusion of MRI image features improves the prognostic accuracy of models in adults, but this has not yet been demonstrated in children. Improving prediction models could greatly assist in diagnosing and predicting kidney disease outcomes in children, which is more challenging than in adults and could lead to improved treatment.</p>
<div style="text-align: center;">
<p><img src="../../../Project_3_Predictive_Modelling/Project_3_R/Media/Project_Description.png" style="width:80%;"></p>
</div>
<section id="task-one" class="level4">
<h4 class="anchored" data-anchor-id="task-one">Task One</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../..\Project_3_Predictive_Modelling/Project_3_R/Media/Task_One.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</section>
<section id="task-two" class="level4">
<h4 class="anchored" data-anchor-id="task-two">Task Two</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../..\Project_3_Predictive_Modelling/Project_3_R/Media/Task_Two.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</section>
<section id="clinical-hypotheses" class="level3">
<h3 class="anchored" data-anchor-id="clinical-hypotheses">Clinical Hypotheses</h3>
<p>The two clinical hypotheses for this study are that including MRI image features will improve model performance compared to using baseline kidney volume alone in models predicting</p>
<ol type="1">
<li><p>Percentage change of total kidney volume growth</p></li>
<li><p>Classification of a patient as having fast or slow progression of the disease.</p></li>
</ol>
</section>
</section>
<section id="background" class="level1">
<h1>Background</h1>
<p>Here we will review background information on the methodology and variables provided in this data set.</p>
<section id="gabor-transform" class="level2">
<h2 class="anchored" data-anchor-id="gabor-transform">Gabor Transform</h2>
<section id="what-is-it" class="level4">
<h4 class="anchored" data-anchor-id="what-is-it">What is it</h4>
<p>The Gabor Transform, named after Dennis Gabor, is a powerful technique for analyzing the <u><strong>texture</strong></u> of MRI images. By convolving the image with a Gabor filter, it becomes possible to discriminate between features based on intensity differences. This allows the target region and background to be differentiated if they possess distinct features, as they will exhibit different intensity levels. Moreover, the Gabor Transform has tunable parameters, such as the frequency of the sinusoidal wave, which can be adjusted to extract specific textures from the images. Higher frequencies are ideal for capturing fine textures, while lower frequencies are better suited for coarse textures.</p>
</section>
<section id="how-it-works" class="level4">
<h4 class="anchored" data-anchor-id="how-it-works">How it Works</h4>
<p>The Gabor Filter first applies a Gaussian Envelope to focus on a small region of the image. It then applies a sinusoidal wave that oscillates at a specific frequency and captures the variation in intensities at that frequency and orientation within that region.</p>
</section>
<section id="example-of-gabor-transform" class="level4">
<h4 class="anchored" data-anchor-id="example-of-gabor-transform">Example of Gabor Transform</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-573562689.png" class="img-fluid figure-img"></p>
<figcaption>Example of applying a Gaussian, then Gabor, and Laplacian Filter (GGL) for differentiation between two different textures (+’s vs L’s) (<a href="https://link.springer.com/article/10.1007/BF00204594">2</a>).</figcaption>
</figure>
</div>
</section>
<section id="image-features-provided-by-the-gabor-transform" class="level4">
<h4 class="anchored" data-anchor-id="image-features-provided-by-the-gabor-transform">Image Features Provided by the Gabor Transform</h4>
<p>In general, Gabor functions can easily extract features of:</p>
<ul>
<li><p>Spatial Frequency (e.g.&nbsp;how often pixel intensity changes in a given area)</p></li>
<li><p>Density (e.g.&nbsp;concentration of features within a certain area)</p></li>
<li><p>Orientation (e.g.&nbsp;Textures or edges at 0°, 45°, 90°, 135°)</p></li>
<li><p>Phase (e.g.&nbsp;alignment/distance of features)</p></li>
<li><p>Energy (e.g.&nbsp;overall intensity)</p></li>
</ul>
<p>Sources: <a href="https://link.springer.com/article/10.1007/s11042-020-09635-6">1</a>, <a href="https://link.springer.com/article/10.1007/BF00204594">2</a></p>
</section>
</section>
<section id="gray-level-co-occurrence-matrix" class="level2">
<h2 class="anchored" data-anchor-id="gray-level-co-occurrence-matrix">Gray Level Co-Occurrence Matrix</h2>
<section id="what-is-it-1" class="level4">
<h4 class="anchored" data-anchor-id="what-is-it-1">What is it</h4>
<p>The Gray Level Co-Occurrence Matrix (GLCM) is another powerful tool for extracting <strong>texture</strong> features from an MRI image. GLCM works under the assumption that the textural information in an image is contained in the “average” spatial relationship that the gray tones in the image have to each other. For example, when a small patch of the picture has little variation of features, the dominant property is tone; When a small patch of a picture has high variation, the dominant property is texture (<a href="https://ieeexplore.ieee.org/document/4309314">3</a>).</p>
</section>
<section id="how-it-works-1" class="level4">
<h4 class="anchored" data-anchor-id="how-it-works-1">How it Works</h4>
<p>GLCM examines the spatial relationship between pairs of pixels in an image and calculates how often pairs of pixel values occur at a specified distance and orientation. It does this by computing a set of gray-tone spacial-dependence matrices for various angular relationships and distances between neighboring resolution cell pairs on the image (<a href="https://ieeexplore.ieee.org/document/4309314">3</a>).</p>
</section>
<section id="example-of-glcm" class="level4">
<h4 class="anchored" data-anchor-id="example-of-glcm">Example of GLCM</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-759848695.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Example of textural features extracted from two different land-use category images (<a href="https://ieeexplore.ieee.org/document/4309314">3</a>).</figcaption>
</figure>
</div>
</section>
<section id="image-features-provided-by-glcm" class="level4">
<h4 class="anchored" data-anchor-id="image-features-provided-by-glcm">Image Features Provided by GLCM</h4>
<p>In general, GLCM provides information on the following features:</p>
<ul>
<li><p>Homogeneity</p></li>
<li><p>Linear Structure</p></li>
<li><p>Contrast</p></li>
<li><p>Number and Nature of Boundaries</p></li>
<li><p>Complexity of the Image</p></li>
</ul>
</section>
</section>
<section id="local-binary-pattern" class="level2">
<h2 class="anchored" data-anchor-id="local-binary-pattern">Local Binary Pattern</h2>
<section id="what-is-it-2" class="level4">
<h4 class="anchored" data-anchor-id="what-is-it-2">What is it</h4>
<p>The Local Binary Pattern (LBP) is a third powerful method for extracting <u><strong>texture</strong></u> features from an image. An important and fundamental property of texture is how uniform the patterns are, and LBP captures this by detecting these uniform patterns in circular neighborhoods at any rotation and spatial resolution. LBP is rotation invariant, meaning it does not matter what rotation the image is at; it will always extract very similar features) (<a href="https://ieeexplore.ieee.org/document/1017623">4</a>).</p>
</section>
<section id="how-it-works-2" class="level4">
<h4 class="anchored" data-anchor-id="how-it-works-2">How it Works</h4>
<p>LBP works by comparing the intensity of a central pixel with its neighboring pixels and encoding this relationship into a binary pattern. For each neighbor, if it’s intensity is greater or equal to the central pixel, it gets assigned a 1 (otherwise a 0). The binary values of all neighbors are then concatenated to form a binary number, and this number is converted into a decimal that represent the LBP for the central pixel (<a href="https://ieeexplore.ieee.org/document/1017623">4</a>).</p>
</section>
<section id="example-of-lbp" class="level4">
<h4 class="anchored" data-anchor-id="example-of-lbp">Example of LBP</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-3679699747.png" class="img-fluid figure-img"></p>
<figcaption>Example of the 36 unique comparisons that can be made between neighboring pixels (<a href="https://ieeexplore.ieee.org/document/1017623">4</a>).</figcaption>
</figure>
</div>
</section>
<section id="code-information" class="level4">
<h4 class="anchored" data-anchor-id="code-information">Code Information</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../..\Project_3_Predictive_Modelling/Project_3_R/Media/Code_Information.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</section>
<section id="image-features-provided-by-the-lbp" class="level4">
<h4 class="anchored" data-anchor-id="image-features-provided-by-the-lbp">Image Features Provided by the LBP</h4>
<p>In general, the LBP provides image features on:</p>
<ul>
<li><p>Uniformity</p></li>
<li><p>Local Contrast</p></li>
<li><p>Texture Description</p></li>
<li><p>Spatial Patterns</p></li>
<li><p>Gray Level Distribution</p></li>
</ul>
</section>
</section>
</section>
<section id="method" class="level1">
<h1>Method</h1>
<section id="study-design" class="level2">
<h2 class="anchored" data-anchor-id="study-design">Study Design</h2>
<p>The investigators recruited 71 young patients with ADPKD and collected MRI data at baseline and after 3 years. Additionally, the height corrected kidney volume for each patient was collected at baseline and 3 years by a physician, and the percentage change calculated. Patients were classified as having slow or fast progression of the disease based on this percentage change. Image features were extracted from the baseline MRI images including 2 image features on kidney geometric information, 5 features based on Gabor transform, 2 features based on gray level co-occurrence matrix, 5 features based on image textures, and 5 features based on local binary pattern.</p>
<section id="statistical-hypotheses" class="level3">
<h3 class="anchored" data-anchor-id="statistical-hypotheses">Statistical Hypotheses</h3>
<ol type="1">
<li><p>A <strong>linear regression model</strong> predicting <strong>percentage change of total kidney volume growth</strong> including MRI image features and baseline kidney volume will have better performance than a model with baseline kidney volume alone, as determined by specificity, sensitivity, PPV, &nbsp;NPV, &nbsp;accuracy, and AUC.</p></li>
<li><p>A <strong>logistic regression model</strong> predicting <strong>classification of disease progression as slow or fast</strong> including MRI image features and baseline kidney volume will have better performance than a model with baseline kidney volume alone, as determined by specificity, sensitivity, PPV, &nbsp;NPV, &nbsp;accuracy, and AUC.</p></li>
</ol>
</section>
</section>
</section>
<section id="data-preparation" class="level1">
<h1>Data Preparation</h1>
<section id="load-packages" class="level4">
<h4 class="anchored" data-anchor-id="load-packages">Load Packages</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly) <span class="co"># Used for interactive plots</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co"># Used for pretty printing (kable_styling)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges) <span class="co"># Used for plotting distributions</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar) <span class="co"># Used to visualize missingness</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co"># Used to chain ggplots together</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra) <span class="co"># Used to plot ggplots side by side</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot) <span class="co"># Used for correlation matrix</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># Used for K-fold cross validation and machine learning</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bestNormalize) <span class="co"># Used to find best transformation</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(olsrr) <span class="co"># used for backwards elimination model.</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car) <span class="co"># Used for influenceplot function</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2) <span class="co"># Used for melting data for multi ROC plotting</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-.csv" class="level4">
<h4 class="anchored" data-anchor-id="read-.csv">Read .CSV</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"C:/Users/sviea/Documents/Portfolio/Project_3_Predictive_Modelling/Project_3_R/Raw_Data/Project3_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 71 Columns: 24
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (24): Subject ID, geom1, geom2, gabor1, gabor2, gabor3, gabor4, gabor5, ...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
</section>
<section id="examine-data-set" class="level4">
<h4 class="anchored" data-anchor-id="examine-data-set">Examine Data Set</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Subject ID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">geom1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">geom2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">glcm1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">glcm2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tkvht_base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tkvht_visit2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">progression</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tkvht_change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.071923</td>
<td style="text-align: right;">1.149019</td>
<td style="text-align: right;">-0.0292053</td>
<td style="text-align: right;">-0.0798071</td>
<td style="text-align: right;">0.0023308</td>
<td style="text-align: right;">0.0008529</td>
<td style="text-align: right;">0.0063692</td>
<td style="text-align: right;">405.57142</td>
<td style="text-align: right;">164488.179</td>
<td style="text-align: right;">-4.401442</td>
<td style="text-align: right;">-12.085150</td>
<td style="text-align: right;">53.192089</td>
<td style="text-align: right;">19.372693</td>
<td style="text-align: right;">146.050849</td>
<td style="text-align: right;">-0.5211817</td>
<td style="text-align: right;">0.0812259</td>
<td style="text-align: right;">-0.0423335</td>
<td style="text-align: right;">0.2716304</td>
<td style="text-align: right;">0.0065977</td>
<td style="text-align: right;">435</td>
<td style="text-align: right;">585</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11.44</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">54.031476</td>
<td style="text-align: right;">2919.400411</td>
<td style="text-align: right;">-0.0499853</td>
<td style="text-align: right;">-0.1266310</td>
<td style="text-align: right;">0.0063297</td>
<td style="text-align: right;">0.0024985</td>
<td style="text-align: right;">0.0160354</td>
<td style="text-align: right;">-580.93865</td>
<td style="text-align: right;">337489.719</td>
<td style="text-align: right;">3.595325</td>
<td style="text-align: right;">-1.991768</td>
<td style="text-align: right;">-7.161054</td>
<td style="text-align: right;">12.926362</td>
<td style="text-align: right;">3.967141</td>
<td style="text-align: right;">-0.5572404</td>
<td style="text-align: right;">-0.4665611</td>
<td style="text-align: right;">0.2599867</td>
<td style="text-align: right;">0.3105169</td>
<td style="text-align: right;">0.2176792</td>
<td style="text-align: right;">555</td>
<td style="text-align: right;">595</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2.42</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">-32.024389</td>
<td style="text-align: right;">1025.561486</td>
<td style="text-align: right;">-0.0152715</td>
<td style="text-align: right;">0.0424398</td>
<td style="text-align: right;">-0.0006481</td>
<td style="text-align: right;">0.0002332</td>
<td style="text-align: right;">0.0018011</td>
<td style="text-align: right;">-1037.25839</td>
<td style="text-align: right;">1075904.968</td>
<td style="text-align: right;">25.367336</td>
<td style="text-align: right;">-5.308749</td>
<td style="text-align: right;">-134.668822</td>
<td style="text-align: right;">643.501717</td>
<td style="text-align: right;">28.182818</td>
<td style="text-align: right;">-0.2515471</td>
<td style="text-align: right;">0.6778935</td>
<td style="text-align: right;">-0.1705221</td>
<td style="text-align: right;">0.0632760</td>
<td style="text-align: right;">0.4595395</td>
<td style="text-align: right;">191</td>
<td style="text-align: right;">249</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10.08</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">-42.832485</td>
<td style="text-align: right;">1834.621814</td>
<td style="text-align: right;">-0.0153948</td>
<td style="text-align: right;">0.0435459</td>
<td style="text-align: right;">-0.0006704</td>
<td style="text-align: right;">0.0002370</td>
<td style="text-align: right;">0.0018962</td>
<td style="text-align: right;">-1018.07892</td>
<td style="text-align: right;">1036484.679</td>
<td style="text-align: right;">25.518531</td>
<td style="text-align: right;">-5.561043</td>
<td style="text-align: right;">-141.909649</td>
<td style="text-align: right;">651.195432</td>
<td style="text-align: right;">30.925199</td>
<td style="text-align: right;">-0.2463696</td>
<td style="text-align: right;">0.6684585</td>
<td style="text-align: right;">-0.1646879</td>
<td style="text-align: right;">0.0606980</td>
<td style="text-align: right;">0.4468368</td>
<td style="text-align: right;">334</td>
<td style="text-align: right;">498</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16.47</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">-10.637344</td>
<td style="text-align: right;">113.153096</td>
<td style="text-align: right;">0.1630437</td>
<td style="text-align: right;">0.0797533</td>
<td style="text-align: right;">0.0130033</td>
<td style="text-align: right;">0.0265832</td>
<td style="text-align: right;">0.0063606</td>
<td style="text-align: right;">64.64083</td>
<td style="text-align: right;">4178.437</td>
<td style="text-align: right;">2.446875</td>
<td style="text-align: right;">-6.297954</td>
<td style="text-align: right;">-15.410304</td>
<td style="text-align: right;">5.987195</td>
<td style="text-align: right;">39.664227</td>
<td style="text-align: right;">-0.5663138</td>
<td style="text-align: right;">0.2676994</td>
<td style="text-align: right;">-0.1516019</td>
<td style="text-align: right;">0.3207114</td>
<td style="text-align: right;">0.0716630</td>
<td style="text-align: right;">263</td>
<td style="text-align: right;">311</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6.14</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">71.079477</td>
<td style="text-align: right;">5052.292049</td>
<td style="text-align: right;">-0.0824492</td>
<td style="text-align: right;">-0.1101542</td>
<td style="text-align: right;">0.0090821</td>
<td style="text-align: right;">0.0067979</td>
<td style="text-align: right;">0.0121340</td>
<td style="text-align: right;">-1459.90430</td>
<td style="text-align: right;">2131320.550</td>
<td style="text-align: right;">2.432428</td>
<td style="text-align: right;">-6.506258</td>
<td style="text-align: right;">-15.826002</td>
<td style="text-align: right;">5.916703</td>
<td style="text-align: right;">42.331398</td>
<td style="text-align: right;">-1.1999136</td>
<td style="text-align: right;">-0.1108972</td>
<td style="text-align: right;">0.1330671</td>
<td style="text-align: right;">1.4397927</td>
<td style="text-align: right;">0.0122982</td>
<td style="text-align: right;">609</td>
<td style="text-align: right;">793</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10.09</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check data types</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 71
Columns: 24
$ `Subject ID` &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17…
$ geom1        &lt;dbl&gt; 1.071923, 54.031476, -32.024389, -42.832485, -10.637344, …
$ geom2        &lt;dbl&gt; 1.149019, 2919.400411, 1025.561486, 1834.621814, 113.1530…
$ gabor1       &lt;dbl&gt; -0.029205293, -0.049985252, -0.015271484, -0.015394838, 0…
$ gabor2       &lt;dbl&gt; -0.079807149, -0.126631032, 0.042439800, 0.043545875, 0.0…
$ gabor3       &lt;dbl&gt; 0.002330791, 0.006329684, -0.000648119, -0.000670382, 0.0…
$ gabor4       &lt;dbl&gt; 0.000852949, 0.002498525, 0.000233218, 0.000237001, 0.026…
$ gabor5       &lt;dbl&gt; 0.006369181, 0.016035418, 0.001801137, 0.001896243, 0.006…
$ glcm1        &lt;dbl&gt; 405.57142, -580.93865, -1037.25839, -1018.07892, 64.64083…
$ glcm2        &lt;dbl&gt; 164488.179, 337489.719, 1075904.968, 1036484.679, 4178.43…
$ txti1        &lt;dbl&gt; -4.4014422, 3.5953250, 25.3673356, 25.5185311, 2.4468746,…
$ txti2        &lt;dbl&gt; -12.0851499, -1.9917682, -5.3087492, -5.5610430, -6.29795…
$ txti3        &lt;dbl&gt; 53.192089, -7.161054, -134.668822, -141.909649, -15.41030…
$ txti4        &lt;dbl&gt; 19.3726934, 12.9263620, 643.5017174, 651.1954318, 5.98719…
$ txti5        &lt;dbl&gt; 146.0508494, 3.9671407, 28.1828179, 30.9251993, 39.664226…
$ lbp1         &lt;dbl&gt; -0.52118174, -0.55724044, -0.25154711, -0.24636960, -0.56…
$ lbp2         &lt;dbl&gt; 0.08122595, -0.46656106, 0.67789345, 0.66845853, 0.267699…
$ lbp3         &lt;dbl&gt; -0.042333481, 0.259986692, -0.170522142, -0.164687860, -0…
$ lbp4         &lt;dbl&gt; 0.271630410, 0.310516908, 0.063275951, 0.060697979, 0.320…
$ lbp5         &lt;dbl&gt; 0.006597654, 0.217679225, 0.459539531, 0.446836807, 0.071…
$ tkvht_base   &lt;dbl&gt; 435, 555, 191, 334, 263, 609, 149, 580, 338, 288, 281, 57…
$ tkvht_visit2 &lt;dbl&gt; 585, 595, 249, 498, 311, 793, 198, 657, 362, 306, 266, 95…
$ progression  &lt;dbl&gt; 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, …
$ tkvht_change &lt;dbl&gt; 11.44, 2.42, 10.08, 16.47, 6.14, 10.09, 10.91, 4.40, 2.30…</code></pre>
</div>
</div>
</section>
<section id="create-factors" class="level4">
<h4 class="anchored" data-anchor-id="create-factors">Create Factors</h4>
<p>Everything is appropriately coded as a double.</p>
<p>Let’s just convert <code>progression</code> into a factor that contains the levels for “slow” or “fast and we’re good to go. We will also rename some variables for convenience.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert progression into a factor</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">progression =</span> <span class="fu">factor</span>(progression,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Slow"</span>, <span class="st">"Fast"</span>)))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename Subject ID and kidney volume variables so they are easier to access</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Subject_ID =</span> <span class="st">`</span><span class="at">Subject ID</span><span class="st">`</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">kidvol_base =</span> tkvht_base,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">kidvol_visit2 =</span> tkvht_visit2,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">kidvol_change =</span> tkvht_change) </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Double check data types</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 71
Columns: 24
$ Subject_ID    &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1…
$ geom1         &lt;dbl&gt; 1.071923, 54.031476, -32.024389, -42.832485, -10.637344,…
$ geom2         &lt;dbl&gt; 1.149019, 2919.400411, 1025.561486, 1834.621814, 113.153…
$ gabor1        &lt;dbl&gt; -0.029205293, -0.049985252, -0.015271484, -0.015394838, …
$ gabor2        &lt;dbl&gt; -0.079807149, -0.126631032, 0.042439800, 0.043545875, 0.…
$ gabor3        &lt;dbl&gt; 0.002330791, 0.006329684, -0.000648119, -0.000670382, 0.…
$ gabor4        &lt;dbl&gt; 0.000852949, 0.002498525, 0.000233218, 0.000237001, 0.02…
$ gabor5        &lt;dbl&gt; 0.006369181, 0.016035418, 0.001801137, 0.001896243, 0.00…
$ glcm1         &lt;dbl&gt; 405.57142, -580.93865, -1037.25839, -1018.07892, 64.6408…
$ glcm2         &lt;dbl&gt; 164488.179, 337489.719, 1075904.968, 1036484.679, 4178.4…
$ txti1         &lt;dbl&gt; -4.4014422, 3.5953250, 25.3673356, 25.5185311, 2.4468746…
$ txti2         &lt;dbl&gt; -12.0851499, -1.9917682, -5.3087492, -5.5610430, -6.2979…
$ txti3         &lt;dbl&gt; 53.192089, -7.161054, -134.668822, -141.909649, -15.4103…
$ txti4         &lt;dbl&gt; 19.3726934, 12.9263620, 643.5017174, 651.1954318, 5.9871…
$ txti5         &lt;dbl&gt; 146.0508494, 3.9671407, 28.1828179, 30.9251993, 39.66422…
$ lbp1          &lt;dbl&gt; -0.52118174, -0.55724044, -0.25154711, -0.24636960, -0.5…
$ lbp2          &lt;dbl&gt; 0.08122595, -0.46656106, 0.67789345, 0.66845853, 0.26769…
$ lbp3          &lt;dbl&gt; -0.042333481, 0.259986692, -0.170522142, -0.164687860, -…
$ lbp4          &lt;dbl&gt; 0.271630410, 0.310516908, 0.063275951, 0.060697979, 0.32…
$ lbp5          &lt;dbl&gt; 0.006597654, 0.217679225, 0.459539531, 0.446836807, 0.07…
$ kidvol_base   &lt;dbl&gt; 435, 555, 191, 334, 263, 609, 149, 580, 338, 288, 281, 5…
$ kidvol_visit2 &lt;dbl&gt; 585, 595, 249, 498, 311, 793, 198, 657, 362, 306, 266, 9…
$ progression   &lt;fct&gt; Fast, Slow, Fast, Fast, Slow, Fast, Fast, Slow, Slow, Sl…
$ kidvol_change &lt;dbl&gt; 11.44, 2.42, 10.08, 16.47, 6.14, 10.09, 10.91, 4.40, 2.3…</code></pre>
</div>
</div>
</section>
<section id="summary" class="level4">
<h4 class="anchored" data-anchor-id="summary">Summary</h4>
<p>Our data set consists of:</p>
<ul>
<li>71 patients</li>
<li>19 MRI image features</li>
<li>4 kidney volume variables</li>
</ul>
</section>
</section>
<section id="missingness" class="level1">
<h1>Missingness</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine missingness</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine missingness percents</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We have 0 missing values!</p>
</section>
<section id="data-split" class="level1">
<h1>Data Split</h1>
<section id="background-1" class="level4">
<h4 class="anchored" data-anchor-id="background-1">Background</h4>
<p>We have an N of 71, which is notably small.</p>
<p>In order to increase the power of the study, we will perform a 5-fold cross validation. Thus, all patients will be in both the training and validation sets, providing a comprehensive evaluation.</p>
<p><img src="images/clipboard-802573844.png" class="img-fluid"></p>
</section>
<section id="perform-the-split" class="level4">
<h4 class="anchored" data-anchor-id="perform-the-split">Perform the Split</h4>
<p>To begin with, we will divide our data set into 5 even folds.</p>
<p>First we randomly shuffle the data so it is not organized by Subject ID</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Shuffle the rows</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fu">nrow</span>(data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we create 5-folds of our data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create labels for Folds1-5</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fold_number =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Fold1"</span>, <span class="st">"Fold2"</span>, <span class="st">"Fold3"</span>, <span class="st">"Fold4"</span>, <span class="st">"Fold5"</span>), <span class="at">length.out =</span> <span class="fu">n</span>())) <span class="ot">-&gt;</span> data</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="do">#### Create separate data frames for each fold</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Fold 1</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fold_number <span class="sc">!=</span> <span class="st">"Fold1"</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>data1_test <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fold_number <span class="sc">==</span> <span class="st">"Fold1"</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create fold 2</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>data2_train <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fold_number <span class="sc">!=</span> <span class="st">"Fold2"</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>data2_test <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fold_number <span class="sc">==</span> <span class="st">"Fold2"</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create fold 3</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>data3_train <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fold_number <span class="sc">!=</span> <span class="st">"Fold3"</span>)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>data3_test <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fold_number <span class="sc">==</span> <span class="st">"Fold3"</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create fold 4</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>data4_train <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fold_number <span class="sc">!=</span> <span class="st">"Fold4"</span>)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>data4_test <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fold_number <span class="sc">==</span> <span class="st">"Fold4"</span>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Create fold 5</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>data5_train <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fold_number <span class="sc">!=</span> <span class="st">"Fold5"</span>)</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>data5_test <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fold_number <span class="sc">==</span> <span class="st">"Fold5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And examine <code>Fold1</code> and ensure the dimensions check out.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check dimensions of Fold1</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data1_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56 25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check dimensions of Fold1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data1_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15 25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for any overlapping patients</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">inner_join</span>(data1_train, data1_test, <span class="at">by =</span> <span class="st">"Subject_ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 49
# ℹ 49 variables: Subject_ID &lt;dbl&gt;, geom1.x &lt;dbl&gt;, geom2.x &lt;dbl&gt;,
#   gabor1.x &lt;dbl&gt;, gabor2.x &lt;dbl&gt;, gabor3.x &lt;dbl&gt;, gabor4.x &lt;dbl&gt;,
#   gabor5.x &lt;dbl&gt;, glcm1.x &lt;dbl&gt;, glcm2.x &lt;dbl&gt;, txti1.x &lt;dbl&gt;, txti2.x &lt;dbl&gt;,
#   txti3.x &lt;dbl&gt;, txti4.x &lt;dbl&gt;, txti5.x &lt;dbl&gt;, lbp1.x &lt;dbl&gt;, lbp2.x &lt;dbl&gt;,
#   lbp3.x &lt;dbl&gt;, lbp4.x &lt;dbl&gt;, lbp5.x &lt;dbl&gt;, kidvol_base.x &lt;dbl&gt;,
#   kidvol_visit2.x &lt;dbl&gt;, progression.x &lt;fct&gt;, kidvol_change.x &lt;dbl&gt;,
#   fold_number.x &lt;chr&gt;, geom1.y &lt;dbl&gt;, geom2.y &lt;dbl&gt;, gabor1.y &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>We have 56 patients in the fold 1 training set, and 15 in the test set, with no overlapping IDs. Perfect!</p>
</section>
</section>
<section id="Outcomes_Uni" class="level1">
<h1>Outcome Variables</h1>
<p>Examining the distributions of the entire data set before splitting can cause subtle biases. For example, transformations or decisions based on the entire data set might inadvertently incorporate patterns from the test data into the training process!</p>
<p>We essentially want to mimic real world situations, where we would not know the distributions of our test set prior to analysis.</p>
<p>Thus, we will perform the initial examination of the distribution of our variables, using <code>Fold1_train</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Kidney Volume</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Disease Progression</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<section id="baseline-kidney-volume" class="level4">
<h4 class="anchored" data-anchor-id="baseline-kidney-volume">Baseline Kidney Volume</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize baseline kidney volume</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> kidvol_base)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram for Baseline Kidney Volume"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Baseline Kidney Volume"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## QQ Plot</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">sample =</span> kidvol_base)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram for Baseline Kidney Volume"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Baseline Kidney Volume"</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Kidney volume at baseline appears to be logarithmic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize baseline kidney volume</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(kidvol_base))) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram forLog Baseline Kidney Volume"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Baseline Kidney Volume"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QQ Plot</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">log</span>(kidvol_base))) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram for Log Baseline Kidney Volume"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Baseline Kidney Volume"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create variable</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">kidvol_base_log =</span> <span class="fu">log</span>(kidvol_base))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>kidvol_base</code> is normally distributed approximately, after log transform and this variable will be used going forward.</p>
</section>
<section id="percent-change-in-kidney-volume" class="level4">
<h4 class="anchored" data-anchor-id="percent-change-in-kidney-volume">Percent Change in Kidney Volume</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>hist_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> kidvol_change)) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Kidney Volume Change"</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Kidney Volume Change (%)"</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>qq_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">sample =</span> kidvol_change)) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of Kidney Volume Change"</span>)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side by side</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(hist_plot, qq_plot, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><code>kidvol_change</code> is not quite normally distributed.</p>
<section id="log-transform" class="level5">
<h5 class="anchored" data-anchor-id="log-transform">Log Transform</h5>
<p>Let’s check if a logarithmic or sqrt transformation will be better.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize R package to select the best transformation</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>BNObject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data1_train<span class="sc">$</span>kidvol_change)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>BNObject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 56 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.406
 - Center+scale: 2.0927
 - Double Reversed Log_b(x+a): 2.7753
 - Exp(x): 7.088
 - Log_b(x+a): 1.4253
 - orderNorm (ORQ): 1.3587
 - sqrt(x + a): 1.4447
 - Yeo-Johnson: 1.6673
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
orderNorm Transformation with 56 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
-1.750  3.805  7.405 13.590 38.190 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>hist_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(kidvol_change))) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Log Kidney Volume Change"</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Kidney Volume Change (%)"</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>qq_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">log</span>(kidvol_change))) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of Log Kidney Volume Change"</span>)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side by side</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(hist_plot, qq_plot, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in log(kidvol_change): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in log(kidvol_change): NaNs produced
Warning in log(kidvol_change): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_qq()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_qq_line()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="square-root-transform" class="level5">
<h5 class="anchored" data-anchor-id="square-root-transform">Square Root Transform</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>hist_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">sqrt</span>(kidvol_change))) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Sqrt Kidney Volume Change"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Kidney Volume Change (%)"</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>qq_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">sqrt</span>(kidvol_change))) <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of Sqrt Kidney Volume Chage"</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side by side</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(hist_plot, qq_plot, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(kidvol_change): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(kidvol_change): NaNs produced
Warning in sqrt(kidvol_change): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_qq()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_qq_line()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The log transform appears the best for us.</p>
<p>However, after checking with the professor, it is very rare in machine learning that we engineer the outcome variable at all.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create log change in kidney volume</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">kidvol_change_log =</span> <span class="fu">log</span>(kidvol_change))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `kidvol_change_log = log(kidvol_change)`.
Caused by warning in `log()`:
! NaNs produced</code></pre>
</div>
</div>
</section>
</section>
<section id="outliers" class="level4">
<h4 class="anchored" data-anchor-id="outliers">Outliers</h4>
<p>It also appears that we have two outlier values. Let’s assess using boxplots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate IQR and identify outliers</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>IQR_val <span class="ot">&lt;-</span> <span class="fu">IQR</span>(data1_train<span class="sc">$</span>kidvol_change)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data1_train<span class="sc">$</span>kidvol_change, <span class="fl">0.25</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data1_train<span class="sc">$</span>kidvol_change, <span class="fl">0.75</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>lower_bound <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> (<span class="fl">1.5</span><span class="sc">*</span>IQR_val)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>upper_bound <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> (<span class="fl">1.5</span><span class="sc">*</span>IQR_val)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplot and flag outliers</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> kidvol_change)) <span class="sc">+</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(kidvol_change <span class="sc">&lt;</span> lower_bound <span class="sc">|</span> kidvol_change <span class="sc">&gt;</span> upper_bound, Subject_ID, <span class="st">""</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Kidney Volume Change"</span>,</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Kidney Volume Change"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Patients 37 and 51 are flagging as potential outliers. Let’s examine them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine outlier patients</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="sc">|&gt;</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(kidvol_change)) <span class="sc">|&gt;</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pretty_print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Subject_ID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">geom1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">geom2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">glcm1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">glcm2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">kidvol_base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">kidvol_visit2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">progression</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">kidvol_change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">fold_number</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">kidvol_base_log</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">kidvol_change_log</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">37</td>
<td style="text-align: right;">-3.860771</td>
<td style="text-align: right;">14.90555</td>
<td style="text-align: right;">0.2621932</td>
<td style="text-align: right;">-0.1983384</td>
<td style="text-align: right;">-0.0520030</td>
<td style="text-align: right;">0.0687453</td>
<td style="text-align: right;">0.0393381</td>
<td style="text-align: right;">871.6238</td>
<td style="text-align: right;">759728.00</td>
<td style="text-align: right;">-14.722587</td>
<td style="text-align: right;">-1.969424</td>
<td style="text-align: right;">28.99502</td>
<td style="text-align: right;">216.75458</td>
<td style="text-align: right;">3.878631</td>
<td style="text-align: right;">-0.0557547</td>
<td style="text-align: right;">0.0722141</td>
<td style="text-align: right;">-0.0040263</td>
<td style="text-align: right;">0.0031086</td>
<td style="text-align: right;">0.0052149</td>
<td style="text-align: right;">173</td>
<td style="text-align: right;">372</td>
<td style="text-align: left;">Fast</td>
<td style="text-align: right;">38.19</td>
<td style="text-align: left;">Fold3</td>
<td style="text-align: right;">5.153292</td>
<td style="text-align: right;">3.642574</td>
</tr>
<tr class="even">
<td style="text-align: right;">51</td>
<td style="text-align: right;">-43.393038</td>
<td style="text-align: right;">1882.95573</td>
<td style="text-align: right;">0.0047377</td>
<td style="text-align: right;">0.0544573</td>
<td style="text-align: right;">0.0002580</td>
<td style="text-align: right;">0.0000224</td>
<td style="text-align: right;">0.0029656</td>
<td style="text-align: right;">2454.8065</td>
<td style="text-align: right;">6026075.10</td>
<td style="text-align: right;">-14.671508</td>
<td style="text-align: right;">-9.355575</td>
<td style="text-align: right;">137.26039</td>
<td style="text-align: right;">215.25315</td>
<td style="text-align: right;">87.526780</td>
<td style="text-align: right;">0.1577583</td>
<td style="text-align: right;">0.1676594</td>
<td style="text-align: right;">0.0264497</td>
<td style="text-align: right;">0.0248877</td>
<td style="text-align: right;">0.0281097</td>
<td style="text-align: right;">185</td>
<td style="text-align: right;">387</td>
<td style="text-align: left;">Fast</td>
<td style="text-align: right;">36.28</td>
<td style="text-align: left;">Fold2</td>
<td style="text-align: right;">5.220356</td>
<td style="text-align: right;">3.591267</td>
</tr>
<tr class="odd">
<td style="text-align: right;">52</td>
<td style="text-align: right;">77.054904</td>
<td style="text-align: right;">5937.45816</td>
<td style="text-align: right;">0.4598489</td>
<td style="text-align: right;">0.1556082</td>
<td style="text-align: right;">0.0715563</td>
<td style="text-align: right;">0.2114611</td>
<td style="text-align: right;">0.0242139</td>
<td style="text-align: right;">-638.4451</td>
<td style="text-align: right;">407612.16</td>
<td style="text-align: right;">20.267845</td>
<td style="text-align: right;">9.686888</td>
<td style="text-align: right;">196.33234</td>
<td style="text-align: right;">410.78554</td>
<td style="text-align: right;">93.835797</td>
<td style="text-align: right;">9.7525713</td>
<td style="text-align: right;">1.1625327</td>
<td style="text-align: right;">11.3376835</td>
<td style="text-align: right;">95.1126464</td>
<td style="text-align: right;">1.3514824</td>
<td style="text-align: right;">358</td>
<td style="text-align: right;">640</td>
<td style="text-align: left;">Fast</td>
<td style="text-align: right;">26.18</td>
<td style="text-align: left;">Fold4</td>
<td style="text-align: right;">5.880533</td>
<td style="text-align: right;">3.264996</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td style="text-align: right;">-53.668735</td>
<td style="text-align: right;">2880.33311</td>
<td style="text-align: right;">0.0179566</td>
<td style="text-align: right;">0.0169461</td>
<td style="text-align: right;">0.0003043</td>
<td style="text-align: right;">0.0003224</td>
<td style="text-align: right;">0.0002872</td>
<td style="text-align: right;">-1045.7503</td>
<td style="text-align: right;">1093593.77</td>
<td style="text-align: right;">22.599974</td>
<td style="text-align: right;">6.944927</td>
<td style="text-align: right;">156.95517</td>
<td style="text-align: right;">510.75882</td>
<td style="text-align: right;">48.232014</td>
<td style="text-align: right;">1.2350248</td>
<td style="text-align: right;">-0.0196489</td>
<td style="text-align: right;">-0.0242669</td>
<td style="text-align: right;">1.5252862</td>
<td style="text-align: right;">0.0003861</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">218</td>
<td style="text-align: left;">Fast</td>
<td style="text-align: right;">25.19</td>
<td style="text-align: left;">Fold4</td>
<td style="text-align: right;">4.820282</td>
<td style="text-align: right;">3.226447</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: right;">39.713073</td>
<td style="text-align: right;">1577.12814</td>
<td style="text-align: right;">0.0171863</td>
<td style="text-align: right;">-0.0625420</td>
<td style="text-align: right;">-0.0010749</td>
<td style="text-align: right;">0.0002954</td>
<td style="text-align: right;">0.0039115</td>
<td style="text-align: right;">-232.4497</td>
<td style="text-align: right;">54032.86</td>
<td style="text-align: right;">4.756968</td>
<td style="text-align: right;">-5.052123</td>
<td style="text-align: right;">-24.03279</td>
<td style="text-align: right;">22.62874</td>
<td style="text-align: right;">25.523950</td>
<td style="text-align: right;">-0.4746998</td>
<td style="text-align: right;">-0.2096379</td>
<td style="text-align: right;">0.0995151</td>
<td style="text-align: right;">0.2253399</td>
<td style="text-align: right;">0.0439481</td>
<td style="text-align: right;">571</td>
<td style="text-align: right;">955</td>
<td style="text-align: left;">Fast</td>
<td style="text-align: right;">22.43</td>
<td style="text-align: left;">Fold2</td>
<td style="text-align: right;">6.347389</td>
<td style="text-align: right;">3.110399</td>
</tr>
<tr class="even">
<td style="text-align: right;">27</td>
<td style="text-align: right;">19.823006</td>
<td style="text-align: right;">392.95157</td>
<td style="text-align: right;">0.1110084</td>
<td style="text-align: right;">-0.2023359</td>
<td style="text-align: right;">-0.0224610</td>
<td style="text-align: right;">0.0123229</td>
<td style="text-align: right;">0.0409398</td>
<td style="text-align: right;">1260.9953</td>
<td style="text-align: right;">1590109.19</td>
<td style="text-align: right;">-23.601456</td>
<td style="text-align: right;">-10.709026</td>
<td style="text-align: right;">252.74861</td>
<td style="text-align: right;">557.02874</td>
<td style="text-align: right;">114.683237</td>
<td style="text-align: right;">-1.4239375</td>
<td style="text-align: right;">0.5109157</td>
<td style="text-align: right;">-0.7275121</td>
<td style="text-align: right;">2.0275981</td>
<td style="text-align: right;">0.2610349</td>
<td style="text-align: right;">553</td>
<td style="text-align: right;">829</td>
<td style="text-align: left;">Fast</td>
<td style="text-align: right;">16.62</td>
<td style="text-align: left;">Fold4</td>
<td style="text-align: right;">6.315358</td>
<td style="text-align: right;">2.810607</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Interesting, it looks like these patients also have high values for certain MRI image features, such as GLCM 1 and 2. Additionally, they do not have the highest visit 2 kidney volumes, they simply increases in size the most.</p>
</section>
<section id="summary-1" class="level3">
<h3 class="anchored" data-anchor-id="summary-1">Summary</h3>
<section id="transformation" class="level5">
<h5 class="anchored" data-anchor-id="transformation">Transformation</h5>
<p>It appears that a log transform of <code>kidvol_base</code> gives us an approximately normal distribution, and this will be the value used for this covariate going forward.</p>
</section>
<section id="outliers-1" class="level5">
<h5 class="anchored" data-anchor-id="outliers-1">Outliers</h5>
<p>While patients 37 and 51 are potential outliers on <code>kidvol_change</code>, these are NOT erroneous values. On the contrary, they are backed up by similar high values on other measurements such as <code>glcm2</code>, but are not universally high on all MRI image features. In other words, these appear to be very realistic values.</p>
<p>In summary, all values are derived from authentic biological data. They will be examined using the jackknife residuals to assess for leverage and influence, but we are motivated to retain them in the analysis.</p>
<p><a href="#Outcomes_Uni">Top of Tabset</a></p>
</section>
</section>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create bar plot</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> progression, <span class="at">fill =</span> progression)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">45</span>) <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Count of Slow vs Fast Disease Progression"</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Disease Progression"</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Progression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Table</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data1_train<span class="sc">$</span>progression) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Slow Fast 
  28   28 </code></pre>
</div>
</div>
<p>We have an equal amount of patients that had slow vs fast disease progression.</p>
<p><a href="#Outcomes_Uni">Top of Tabset</a></p>
</div>
</div>
</div>
<section id="summary-2" class="level2">
<h2 class="anchored" data-anchor-id="summary-2">Summary</h2>
<section id="kidney-volume-change" class="level4">
<h4 class="anchored" data-anchor-id="kidney-volume-change">Kidney Volume Change</h4>
<p><code>kidvol_change</code> is approximately normally distributed following a log transform, with 2 potential outliers we will keep an eye on.</p>
</section>
<section id="slow-vs-fast-disease-progression" class="level4">
<h4 class="anchored" data-anchor-id="slow-vs-fast-disease-progression">Slow vs Fast Disease Progression</h4>
<p>We have an even count between patients who had slow vs fast disease progression.</p>
</section>
</section>
</section>
<section id="Features_Uni" class="level1">
<h1>Feature Engineering I</h1>
<p>An assumption for a linear regression is that there is a linear relationship between the predictor and the outcome variable.</p>
<p>Thus for the initial step, we will examine the distribution of our variables and create a quadratic term or take the log for each variable as necessary.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Geometry</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Gabor</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">GLCM</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">TXTI</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" role="tab" aria-controls="tabset-6-5" aria-selected="false">LBP</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-6" role="tab" aria-controls="tabset-6-6" aria-selected="false">Feature Engineering Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Geom1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Geom2</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>hist_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> geom1)) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Geom1"</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Geom1"</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>qq_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">sample =</span> geom1)) <span class="sc">+</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of Geom1"</span>)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side by side</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(hist_plot, qq_plot, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>There is 1 patient with a drastically lower value than everyone else. Let’s examine.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to most negative geom1 value</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="sc">|&gt;</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(geom1) <span class="sc">|&gt;</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Subject_ID, geom1, geom2) <span class="sc">|&gt;</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span> </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pretty_print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Subject_ID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">geom1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">geom2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">48</td>
<td style="text-align: right;">-124.26679</td>
<td style="text-align: right;">15442.236</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">-59.49517</td>
<td style="text-align: right;">3539.675</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td style="text-align: right;">-53.66873</td>
<td style="text-align: right;">2880.333</td>
</tr>
<tr class="even">
<td style="text-align: right;">66</td>
<td style="text-align: right;">-53.22180</td>
<td style="text-align: right;">2832.560</td>
</tr>
<tr class="odd">
<td style="text-align: right;">69</td>
<td style="text-align: right;">-46.48719</td>
<td style="text-align: right;">2161.059</td>
</tr>
<tr class="even">
<td style="text-align: right;">51</td>
<td style="text-align: right;">-43.39304</td>
<td style="text-align: right;">1882.956</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Patient 48 appears to be an outlier on <code>geom1</code>.</p>
<section id="perform-yeo-johnson-transformation" class="level4">
<h4 class="anchored" data-anchor-id="perform-yeo-johnson-transformation">Perform Yeo Johnson Transformation</h4>
<p>Since we have negatie we have to perform the yeo johnson transformation or we will lose observations as <code>NA</code> values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize R package to select the best transformation</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>BNObject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data1_train<span class="sc">$</span>geom1)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>BNObject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 56 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 3.3087
 - Center+scale: 1.9827
 - Double Reversed Log_b(x+a): 2.4733
 - Exp(x): 4.596
 - Log_b(x+a): 1.396
 - orderNorm (ORQ): 1.5187
 - sqrt(x + a): 1.65
 - Yeo-Johnson: 1.78
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
Standardized Log_b(x + a) Transformation with 56 nonmissing obs.:
 Relevant statistics:
 - a = 124.2678 
 - b = 10 
 - mean (before standardization) = 1.998683 
 - sd (before standardization) = 0.6974149 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>hist_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">yeojohnson</span>(geom1)<span class="sc">$</span>x.t)) <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Yeo Johnson Geom1"</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Log Geom1"</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>qq_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">yeojohnson</span>(geom1)<span class="sc">$</span>x.t)) <span class="sc">+</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of Yeo Johnson Geom1"</span>)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side by side</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(hist_plot, qq_plot, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform transform</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geom1_yeo =</span> <span class="fu">yeojohnson</span>(geom1)<span class="sc">$</span>x.t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>geom</code> is more normally distributed after a Yeo Johnson transform.</p>
</section>
<section id="summary-3" class="level4">
<h4 class="anchored" data-anchor-id="summary-3">Summary</h4>
<p><code>geom1</code> is normally distributed following a Yeo Johnson transform. There is potentially one outlier on the negative side, but this seemed to not be a factor after transforming.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>hist_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> geom2)) <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">300</span>) <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Geom2"</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Geom2"</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>qq_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">sample =</span> geom2)) <span class="sc">+</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of Geom2"</span>)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side by side</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(hist_plot, qq_plot, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><code>geom2</code> appears to be logarithmic. Let’s adjust.</p>
<section id="square-root-transformation" class="level4">
<h4 class="anchored" data-anchor-id="square-root-transformation">Square Root Transformation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new variable</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">geom2_sqrt =</span> <span class="fu">sqrt</span>(geom2),</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">geom2_log =</span> <span class="fu">log</span>(geom2)) </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>hist_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> geom2_sqrt)) <span class="sc">+</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Geom2_sqrt"</span>,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Geom2_sqrt"</span>,</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>qq_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">sample =</span> geom2_sqrt)) <span class="sc">+</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of Geom2_sqrt"</span>)</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side by side</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(hist_plot, qq_plot, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Sqrt kind of makes it better, but not quite.</p>
</section>
<section id="log-transformation" class="level4">
<h4 class="anchored" data-anchor-id="log-transformation">Log Transformation</h4>
<p>Let’s examine the log.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>hist_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(geom2))) <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Geom2 log"</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Geom2 log"</span>,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>qq_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">log</span>(geom2))) <span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of Geom2 log"</span>)</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side by side</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(hist_plot, qq_plot, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="yeo-johnson-transform" class="level4">
<h4 class="anchored" data-anchor-id="yeo-johnson-transform">Yeo Johnson Transform</h4>
<p>A Yeo Johnson transformation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize R package to select the best transformation</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>BNObject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data1_train<span class="sc">$</span>geom2)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>BNObject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 56 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.7313
 - Box-Cox: 1.8647
 - Center+scale: 3.9007
 - Double Reversed Log_b(x+a): 4.1427
 - Log_b(x+a): 1.7467
 - orderNorm (ORQ): 1.7467
 - sqrt(x + a): 2.2773
 - Yeo-Johnson: 1.7813
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
Standardized asinh(x) Transformation with 56 nonmissing obs.:
 Relevant statistics:
 - mean (before standardization) = 7.243183 
 - sd (before standardization) = 2.168931 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>hist_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">yeojohnson</span>(geom2)<span class="sc">$</span>x.t)) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Geom2 Yeo"</span>,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Geom2 Yeo"</span>,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>qq_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">yeojohnson</span>(geom2)<span class="sc">$</span>x.t)) <span class="sc">+</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of Geom2 Yeo"</span>)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side by side</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(hist_plot, qq_plot, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the variable</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geom2_yeo =</span> <span class="fu">yeojohnson</span>(geom2)<span class="sc">$</span>x.t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I think log or yeo is our best bet here.</p>
</section>
<section id="summary-4" class="level4">
<h4 class="anchored" data-anchor-id="summary-4">Summary</h4>
<p>While there is no transformation that makes <code>geom2</code> normally distributed, log or yeojohnson transformation may help and will be considered. Let’s select Yeo Johnson as it looks slightly better.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Gabor1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Gabor2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Gabor3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Gabor4</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">Gabor5</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>hist_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> gabor1)) <span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Gabor1"</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Gabor2"</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>qq_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">sample =</span> gabor1)) <span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of Gabor1"</span>)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side by side</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(hist_plot, qq_plot, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><code>gabor1</code> is normally distributed.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make plots</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"gabor2"</span>, <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation idioms with `aes()`.
ℹ See also `vignette("ggplot2-in-packages")` for more information.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><code>gabor2</code> appears approximately normally distributed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize R package to select the best transformation</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>BNObject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data1_train<span class="sc">$</span>gabor2)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>BNObject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 56 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.402
 - Center+scale: 1.402
 - Double Reversed Log_b(x+a): 1.1913
 - Exp(x): 1.2947
 - Log_b(x+a): 2.104
 - orderNorm (ORQ): 1.616
 - sqrt(x + a): 1.5867
 - Yeo-Johnson: 1.502
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
Standardized double reversed Log_b(x + a) Transformation with 56 nonmissing obs.:
 Relevant statistics:
 - a = 
 - b = 10 
 - max(x) = 0.3151444 ; min(x) = -0.2533082 
 - mean (before standardization) = 0.2727949 
 - sd (before standardization) = 0.1871679 </code></pre>
</div>
</div>
<p>It looks like a yeo johnson transformation will be most appropriate here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gabor2_yeo =</span> <span class="fu">yeojohnson</span>(gabor2)<span class="sc">$</span>x.t)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"gabor2_yeo"</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A yeo johnson transformation <em>slightly</em> improves the normality of <code>gabor2</code>.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make plots</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"gabor3"</span>, <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><a href="#Features_Uni">Top of Tabset</a></p>
<p><code>gabor3</code> appears approximately normally distributed, with some potential outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize R package to select the best transformation</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>BNObject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data1_train<span class="sc">$</span>gabor3)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>BNObject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 56 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.6907
 - Center+scale: 1.6907
 - Double Reversed Log_b(x+a): 1.4893
 - Exp(x): 1.6907
 - Log_b(x+a): 1.744
 - orderNorm (ORQ): 1.6227
 - sqrt(x + a): 1.5147
 - Yeo-Johnson: 1.7907
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
Standardized double reversed Log_b(x + a) Transformation with 56 nonmissing obs.:
 Relevant statistics:
 - a = 
 - b = 10 
 - max(x) = 0.08391221 ; min(x) = -0.0643589 
 - mean (before standardization) = 0.2611926 
 - sd (before standardization) = 0.1237591 </code></pre>
</div>
</div>
<p>Transformations don’t seem to help much here. We want the values to be closest to 1 to indicate more normality.</p>
<section id="summary-5" class="level4">
<h4 class="anchored" data-anchor-id="summary-5">Summary</h4>
<p>Transformation doesn’t seem to help much with <code>gabor3</code>.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make plots</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"gabor4"</span>, <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><code>gabor4</code> may be exponential.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gabor4_log =</span> <span class="fu">log</span>(gabor4))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"gabor4_log"</span>, <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><code>gabor4_log</code> appears to be normally distributed.</p>
<section id="summary-6" class="level4">
<h4 class="anchored" data-anchor-id="summary-6">Summary</h4>
<p>The log transform of <code>gabor4</code> made it approximately normal.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make plots</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"gabor5"</span>, <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><code>gabor5</code> looks logarithmic potentially.</p>
<section id="log-transform-1" class="level4">
<h4 class="anchored" data-anchor-id="log-transform-1">Log Transform</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize R package to select the best transformation</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>BNObject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data1_train<span class="sc">$</span>gabor5)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>BNObject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 56 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.8227
 - Box-Cox: 1.274
 - Center+scale: 1.8227
 - Double Reversed Log_b(x+a): 2.138
 - Exp(x): 1.8227
 - Log_b(x+a): 1.4367
 - orderNorm (ORQ): 1.3267
 - sqrt(x + a): 1.3587
 - Yeo-Johnson: 1.742
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
Standardized Box Cox Transformation with 56 nonmissing obs.:
 Estimated statistics:
 - lambda = 0.2934285 
 - mean (before standardization) = -2.58858 
 - sd (before standardization) = 0.3299984 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create log term</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gabor5_log =</span> <span class="fu">log</span>(gabor5))</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"gabor5_log"</span>, <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That’s kind of better.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate IQR and identify outliers</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>IQR_val <span class="ot">&lt;-</span> <span class="fu">IQR</span>(data1_train<span class="sc">$</span>gabor5_log)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data1_train<span class="sc">$</span>gabor5_log, <span class="fl">0.25</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data1_train<span class="sc">$</span>gabor5_log, <span class="fl">0.75</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>lower_bound <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> (<span class="fl">1.5</span><span class="sc">*</span>IQR_val)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>upper_bound <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> (<span class="fl">1.5</span><span class="sc">*</span>IQR_val)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplot and flag outliers</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> gabor5_log)) <span class="sc">+</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(gabor5_log <span class="sc">&lt;</span> lower_bound <span class="sc">|</span> gabor5_log <span class="sc">&gt;</span> upper_bound, Subject_ID, <span class="st">""</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Gabor5"</span>,</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Gabor5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-7" class="level4">
<h4 class="anchored" data-anchor-id="summary-7">Summary</h4>
<p><code>gabor5</code> is not normally distributed, and no transform seems to help much. It may be dropped from consideration.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</div>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="panel_tabset">
<section id="glcm1" class="level2">
<h2 class="anchored" data-anchor-id="glcm1">GLCM1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make plots</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"glcm1"</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><code>glcm1</code> is approximately normally distributed.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
<section id="glcm2" class="level2">
<h2 class="anchored" data-anchor-id="glcm2">GLCM2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make plots</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"glcm2"</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><code>glcm2</code> may be logarithmic.</p>
<section id="log-transform-2" class="level4">
<h4 class="anchored" data-anchor-id="log-transform-2">Log Transform</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create log variable</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">glcm2_log =</span> <span class="fu">log</span>(glcm2))</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make plots</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"glcm2_log"</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize R package to select the best transformation</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>BNObject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data1_train<span class="sc">$</span>glcm2)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>BNObject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 56 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.5713
 - Box-Cox: 1.4393
 - Center+scale: 2.778
 - Double Reversed Log_b(x+a): 3.388
 - Log_b(x+a): 1.5713
 - orderNorm (ORQ): 1.7147
 - sqrt(x + a): 1.6827
 - Yeo-Johnson: 1.4393
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
Standardized Box Cox Transformation with 56 nonmissing obs.:
 Estimated statistics:
 - lambda = 0.245653 
 - mean (before standardization) = 105.7341 
 - sd (before standardization) = 37.69292 </code></pre>
</div>
</div>
<p>It appears that this is the best transformation we will get.</p>
</section>
<section id="summary-8" class="level4">
<h4 class="anchored" data-anchor-id="summary-8">Summary</h4>
<p>The best transformation for <code>glcm2</code> is a log transform.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</section>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">TXT1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">TXTI2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">TXTI3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">TXTI4</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">TXTI5</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make plots</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"txti1"</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<section id="summary-9" class="level4">
<h4 class="anchored" data-anchor-id="summary-9">Summary</h4>
<p><code>txti1</code> appears normally distributed</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make plots</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"txti2"</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<section id="summary-10" class="level4">
<h4 class="anchored" data-anchor-id="summary-10">Summary</h4>
<p><code>txti2</code> appears normally distributed.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make plots</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"txti3"</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<section id="summary-11" class="level4">
<h4 class="anchored" data-anchor-id="summary-11">Summary</h4>
<p><code>txti3</code> appears normally distributed.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make plots</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"txti4"</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><code>txti4</code> may be logarithmic.</p>
<section id="log-transform-3" class="level4">
<h4 class="anchored" data-anchor-id="log-transform-3">Log Transform</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">txti4_log =</span> <span class="fu">log</span>(txti4))</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make plots</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"txti4_log"</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>That’s better, still not perfect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize R package to select the best transformation</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>BNObject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data1_train<span class="sc">$</span>txti4)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>BNObject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 56 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.8187
 - Box-Cox: 1.57
 - Center+scale: 2.6113
 - Double Reversed Log_b(x+a): 3.1647
 - Log_b(x+a): 1.8187
 - orderNorm (ORQ): 1.574
 - sqrt(x + a): 1.442
 - Yeo-Johnson: 1.62
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
Standardized sqrt(x + a) Transformation with 56 nonmissing obs.:
 Relevant statistics:
 - a = 0 
 - mean (before standardization) = 13.72864 
 - sd (before standardization) = 9.201842 </code></pre>
</div>
</div>
<p>Log is better than sqrt so we will use log.</p>
</section>
<section id="summary-12" class="level4">
<h4 class="anchored" data-anchor-id="summary-12">Summary</h4>
<p>The best transformation for <code>txtxi4</code> is log, though it is still not perfect.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"txti5"</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>May be logarithmic.</p>
<section id="log-transform-4" class="level4">
<h4 class="anchored" data-anchor-id="log-transform-4">Log Transform</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">txti5_log =</span> <span class="fu">log</span>(txti5))</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| # Make plots</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"txti5_log"</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>That looks better. Mostly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize R package to select the best transformation</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>BNObject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data1_train<span class="sc">$</span>txti5)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>BNObject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 56 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.4227
 - Box-Cox: 1.2587
 - Center+scale: 2.5847
 - Double Reversed Log_b(x+a): 2.79
 - Exp(x): 4.2093
 - Log_b(x+a): 1.4727
 - orderNorm (ORQ): 1.624
 - sqrt(x + a): 1.52
 - Yeo-Johnson: 1.242
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
Standardized Yeo-Johnson Transformation with 56 nonmissing obs.:
 Estimated statistics:
 - lambda = 0.09721794 
 - mean (before standardization) = 3.760793 
 - sd (before standardization) = 1.937912 </code></pre>
</div>
</div>
<p>Log performs better than sqrt, that’s as good as we can get.</p>
</section>
<section id="summary-13" class="level4">
<h4 class="anchored" data-anchor-id="summary-13">Summary</h4>
<p>The best transformation for <code>txti5</code> is logarithmic.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</div>
</div>
</div>
</div>
<div id="tabset-6-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-5-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">LBP1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">LBP2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">LBP3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">LBP4</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">LBP5</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"lbp1"</span>, <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Looks normally distributed with 1 outlier.</p>
<section id="remove-outlier" class="level4">
<h4 class="anchored" data-anchor-id="remove-outlier">Remove Outlier</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine LBP outlier</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="sc">|&gt;</span> </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(lbp3)) <span class="sc">|&gt;</span> </span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Subject_ID, lbp1, lbp2, lbp3, lbp4, lbp5) <span class="sc">|&gt;</span> </span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span> </span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pretty_print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Subject_ID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">52</td>
<td style="text-align: right;">9.7525713</td>
<td style="text-align: right;">1.1625327</td>
<td style="text-align: right;">11.3376835</td>
<td style="text-align: right;">95.1126464</td>
<td style="text-align: right;">1.3514824</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">-1.0859087</td>
<td style="text-align: right;">-0.8250696</td>
<td style="text-align: right;">0.8959503</td>
<td style="text-align: right;">1.1791977</td>
<td style="text-align: right;">0.6807399</td>
</tr>
<tr class="odd">
<td style="text-align: right;">61</td>
<td style="text-align: right;">-1.2967552</td>
<td style="text-align: right;">-0.6707632</td>
<td style="text-align: right;">0.8698157</td>
<td style="text-align: right;">1.6815740</td>
<td style="text-align: right;">0.4499233</td>
</tr>
<tr class="even">
<td style="text-align: right;">28</td>
<td style="text-align: right;">-0.5774531</td>
<td style="text-align: right;">-0.8531963</td>
<td style="text-align: right;">0.4926809</td>
<td style="text-align: right;">0.3334521</td>
<td style="text-align: right;">0.7279439</td>
</tr>
<tr class="odd">
<td style="text-align: right;">40</td>
<td style="text-align: right;">-0.5010965</td>
<td style="text-align: right;">-0.8251542</td>
<td style="text-align: right;">0.4134818</td>
<td style="text-align: right;">0.2510977</td>
<td style="text-align: right;">0.6808794</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.3763026</td>
<td style="text-align: right;">0.7299012</td>
<td style="text-align: right;">0.2746638</td>
<td style="text-align: right;">0.1416037</td>
<td style="text-align: right;">0.5327558</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Patient 52 is a CLEAR outlier (lbp3 = 11, no othe patients have an lbp3 over 1).</p>
<p>We remove them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove outlier patient</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Subject_ID <span class="sc">==</span> <span class="dv">52</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="remake-plots" class="level4">
<h4 class="anchored" data-anchor-id="remake-plots">Remake Plots</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"lbp1"</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>That’s close to normal, let’s check if it could be better.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize R package to select the best transformation</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>BNObject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data1_train<span class="sc">$</span>lbp1)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>BNObject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 55 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.4007
 - Center+scale: 1.5273
 - Double Reversed Log_b(x+a): 2.018
 - Exp(x): 2.1807
 - Log_b(x+a): 2.1373
 - orderNorm (ORQ): 1.3633
 - sqrt(x + a): 1.6867
 - Yeo-Johnson: 1.594
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
orderNorm Transformation with 55 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
-1.784 -0.562 -0.246  0.023  1.363 </code></pre>
</div>
</div>
</section>
<section id="yeo-johnson-transform-1" class="level4">
<h4 class="anchored" data-anchor-id="yeo-johnson-transform-1">Yeo Johnson Transform</h4>
<p>It seems a yeo transformation will be the best (since we have negatives and a log and sqrt transformation will cause NA values)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform transform</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lbp1_yeo =</span> <span class="fu">yeojohnson</span>(lbp1)<span class="sc">$</span>x.t)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co">#| # Make plots</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"lbp1_yeo"</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>It’s slightly better, but not by much.</p>
</section>
<section id="summary-14" class="level4">
<h4 class="anchored" data-anchor-id="summary-14">Summary</h4>
<p>A yeo johnson transformation helps a little bit.</p>
<p>We will choose to not transform this variable.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note: Patient 52 is a clear outlier and possibly erroneous value on the <code>lbp</code> features. Ensure to remove it from all data sets!</p>
</div>
</div>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"lbp2"</span>, <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>We appear to have a different outlier for <code>lbp2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine outlier</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="sc">|&gt;</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(lbp2)) <span class="sc">|&gt;</span> </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Subject_ID, lbp1, lbp2, lbp3, lbp4, lbp5) <span class="sc">|&gt;</span> </span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span> </span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pretty_print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Subject_ID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">48</td>
<td style="text-align: right;">-0.1337633</td>
<td style="text-align: right;">3.0589420</td>
<td style="text-align: right;">-0.4091741</td>
<td style="text-align: right;">0.0178926</td>
<td style="text-align: right;">9.3571262</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">-1.7843187</td>
<td style="text-align: right;">1.0797790</td>
<td style="text-align: right;">-1.9266699</td>
<td style="text-align: right;">3.1837934</td>
<td style="text-align: right;">1.1659227</td>
</tr>
<tr class="odd">
<td style="text-align: right;">30</td>
<td style="text-align: right;">-0.8565558</td>
<td style="text-align: right;">1.0250395</td>
<td style="text-align: right;">-0.8780035</td>
<td style="text-align: right;">0.7336879</td>
<td style="text-align: right;">1.0507059</td>
</tr>
<tr class="even">
<td style="text-align: right;">66</td>
<td style="text-align: right;">-0.0191984</td>
<td style="text-align: right;">0.9612270</td>
<td style="text-align: right;">-0.0184540</td>
<td style="text-align: right;">0.0003686</td>
<td style="text-align: right;">0.9239573</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.3763026</td>
<td style="text-align: right;">0.7299012</td>
<td style="text-align: right;">0.2746638</td>
<td style="text-align: right;">0.1416037</td>
<td style="text-align: right;">0.5327558</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">-0.2515471</td>
<td style="text-align: right;">0.6778935</td>
<td style="text-align: right;">-0.1705221</td>
<td style="text-align: right;">0.0632760</td>
<td style="text-align: right;">0.4595395</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Patient 48 is an outlier on <code>lbp2</code> (lbp2 = 3, all other patients are essentially below 1).</p>
<p>We remove them</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove outlier</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Subject_ID <span class="sc">==</span> <span class="dv">48</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="remake-plots-1" class="level4">
<h4 class="anchored" data-anchor-id="remake-plots-1">Remake Plots</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"lbp2"</span>, <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section" class="level4">
<h4 class="anchored" data-anchor-id="section"></h4>
<p><code>lbp2</code> is normally distributed</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"lbp3"</span>, <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Doesn’t look too good.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize R package to select the best transformation</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>BNObject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data1_train<span class="sc">$</span>lbp3)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>BNObject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 54 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 2.3647
 - Center+scale: 2.5773
 - Double Reversed Log_b(x+a): 2.5847
 - Exp(x): 2.3413
 - Log_b(x+a): 2.93
 - orderNorm (ORQ): 1.34
 - sqrt(x + a): 2.532
 - Yeo-Johnson: 2.6347
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
orderNorm Transformation with 54 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
-1.927 -0.173 -0.025  0.061  0.896 </code></pre>
</div>
</div>
<p>None of the transformations help much here.</p>
<section id="summary-15" class="level4">
<h4 class="anchored" data-anchor-id="summary-15">Summary</h4>
<p><code>lbp3</code> is not normally distributed and no transformations help. We keep the original unmodified values.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"lbp4"</span>, <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><code>lbp4</code> appears logarithmic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create log variable</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lbp4_log =</span> <span class="fu">log</span>(lbp4))</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co">#| # Make plots</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"lbp4_log"</span>, <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Looks better.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize R package to select the best transformation</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>BNObject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data1_train<span class="sc">$</span>lbp4)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>BNObject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 54 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 2.7933
 - Box-Cox: 1.4373
 - Center+scale: 3.0213
 - Double Reversed Log_b(x+a): 3.4987
 - Exp(x): 4.196
 - Log_b(x+a): 1.5973
 - orderNorm (ORQ): 1.7753
 - sqrt(x + a): 1.7087
 - Yeo-Johnson: 1.7753
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
Standardized Box Cox Transformation with 54 nonmissing obs.:
 Estimated statistics:
 - lambda = 0.1878715 
 - mean (before standardization) = -1.381953 
 - sd (before standardization) = 1.378322 </code></pre>
</div>
</div>
<p>The log transform also provides the best performance here.</p>
<section id="summary-16" class="level4">
<h4 class="anchored" data-anchor-id="summary-16">Summary</h4>
<p>The log transform provides the best distribution for <code>lbp4</code></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note: Patient 48 is a clear outlier and possibly erroneous value on the <code>lbp2</code> feature. Ensure to remove it from all data sets!</p>
</div>
</div>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"lbp5"</span>, <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><code>lbp5</code> looks logarithmic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create log variable</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lbp5_log =</span> <span class="fu">log</span>(lbp5))</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co">#| # Make plots</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="fu">distr_plots</span>(data1_train, <span class="st">"lbp5_log"</span>, <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create variable</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lbp5_log =</span> <span class="fu">log</span>(lbp5))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize R package to select the best transformation</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>BNObject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data1_train<span class="sc">$</span>lbp5)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>BNObject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 54 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 2.6007
 - Box-Cox: 1.568
 - Center+scale: 2.5867
 - Double Reversed Log_b(x+a): 3.0687
 - Exp(x): 3.346
 - Log_b(x+a): 1.6487
 - orderNorm (ORQ): 1.8627
 - sqrt(x + a): 1.9
 - Yeo-Johnson: 2.0653
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
Standardized Box Cox Transformation with 54 nonmissing obs.:
 Estimated statistics:
 - lambda = 0.1567344 
 - mean (before standardization) = -1.795011 
 - sd (before standardization) = 1.298534 </code></pre>
</div>
</div>
<p>Looks better, and we confirm that the log transform performs the best.</p>
<section id="summary-17" class="level4">
<h4 class="anchored" data-anchor-id="summary-17">Summary</h4>
<p>Log transform is the best for <code>lbp5</code>.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</section>
</div>
</div>
</div>
</div>
<div id="tabset-6-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-6-tab">
<p>We determined that the following variables were approximately normally distributed after performing the transformations below: - <code>kidvol_base_log</code> - <code>kidvol_change_log</code> (this will be considered, but likely not used) - <code>geom1_yeo</code> - <code>geom2_yeo</code> - <code>gabor2_yeo</code> - <code>gabor4_log</code> - <code>glcm2_log</code> - <code>txti4_log</code> - <code>txti5_log</code> - <code>lbp4_log</code> - <code>lbp5_log</code></p>
<p>These variables will be used for all comparisons moving forward to ensure we meet the assumption of linearity for a linear regression model.</p>
<p><code>gabor5</code> is not normal even after transforming.</p>
<p>We also eliminated 2 outlier/possible erroneous values in the form of patients, <code>48</code> and <code>52</code>.</p>
<p><a href="#Features_Uni">Top of Tabset</a></p>
</div>
</div>
</div>
<section id="correlation-matrix-i" class="level2">
<h2 class="anchored" data-anchor-id="correlation-matrix-i">Correlation Matrix I</h2>
<p>To assess for the best engineering of features and select the most promising covariates for this predictive model, I will create the following correlation matrices.</p>
<ul>
<li>With unaltered features &amp; engineered features</li>
<li>With averages and interactions to aggregate features from the same class</li>
<li>With squared features</li>
</ul>
<p>This process should uncover hidden relationships between features that are not immediately obvious (such as a squared feature being a significant predictor, but not in its original form).</p>
<p>This first matrix will contain the unaltered features in their original form, as well as the engineered features as determined by examination of distributions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Control matrix for better output</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>matrix_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"kidvol_base"</span>, <span class="st">"kidvol_change"</span>, <span class="st">"kidvol_change_log"</span>, <span class="st">"progression"</span>, <span class="st">"geom1"</span>, <span class="st">"geom1_yeo"</span>, <span class="st">"geom2"</span>, <span class="st">"geom2_yeo"</span>, <span class="st">"gabor1"</span>, <span class="st">"gabor2"</span>, <span class="st">"gabor2_yeo"</span>, <span class="st">"gabor3"</span>, <span class="st">"gabor4"</span>, <span class="st">"gabor4_log"</span>, <span class="st">"gabor5"</span>, <span class="st">"glcm1"</span>, <span class="st">"glcm2"</span>, <span class="st">"glcm2_log"</span>, <span class="st">"txti1"</span>, <span class="st">"txti2"</span>, <span class="st">"txti3"</span>, <span class="st">"txti4"</span>, <span class="st">"txti4_log"</span>, <span class="st">"txti5"</span>, <span class="st">"txti5_log"</span>, <span class="st">"lbp1"</span>, <span class="st">"lbp2"</span>, <span class="st">"lbp3"</span>, <span class="st">"lbp4"</span>, <span class="st">"lbp4_log"</span>, <span class="st">"lbp5"</span>, <span class="st">"lbp5_log"</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean the output by making a trimmed dataset excluding extaneous variables</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>data_for_matrix <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(matrix_order)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using an external vector in selections was deprecated in tidyselect 1.1.0.
ℹ Please use `all_of()` or `any_of()` instead.
  # Was:
  data %&gt;% select(matrix_order)

  # Now:
  data %&gt;% select(all_of(matrix_order))

See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We factored our variables at the start. To make a correlation matrix we must reconvert those back to numeric</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>data_for_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(data_for_matrix, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.factor</span>(x)) <span class="fu">as.numeric</span>(x) <span class="cf">else</span> x))</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a correlation matrix with all variables of the trimmed data set</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_for_matrix, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot correlation matrix</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(correlation_matrix, <span class="at">method =</span> <span class="st">"color"</span>, <span class="at">addCoef.col =</span> <span class="st">"black"</span>, <span class="at">number.cex =</span> <span class="fl">0.4</span>, <span class="at">insig =</span> <span class="st">"blank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>From this plot we can see a few relationships between our original and transformed features.</p>
</section>
<section id="Corr_One" class="level2">
<h2 class="anchored" data-anchor-id="Corr_One">Main Observations</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Geometry</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Gabor Transform</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Gray Level Co-Occurence Matrix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">Txti</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-5" role="tab" aria-controls="tabset-7-5" aria-selected="false">Local Binary Pattern</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p><code>geom1</code> (r = -0.17) and <code>geom2_yeo</code> (r = -0.15) have about equal correlation with <code>kidvol_change</code></p>
<p><a href="#Corr_One">Top of Tabset</a></p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>None of the original or transformed <code>gabor</code> features are correlated to change in <code>kidvol_change_log</code>.</p>
<p>Interestingly, <code>gabor3</code> appears to have a strong correlation to the untransformed <code>kidvol_change</code>, but not with <code>kidvol_change_log</code>. Let’s assess.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> gabor3, <span class="at">y =</span> kidvol_change)) <span class="sc">+</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Kidney Volume by Gabor3"</span>,</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Gabor3"</span>,</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change in Kidney Volume (%)"</span>) <span class="sc">+</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This appears to be driven entirely by that outlier patient on the far left.</p>
<p>We previously determined that patients 37 and 51 were outliers on the boxplots on <code>kidvol_change</code>.</p>
<p>Let’s assess how this relationship changes after removing them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove outlier patients on kidvol change</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>data_out_rem <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Subject_ID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">37</span>,<span class="dv">51</span>))</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_out_rem, <span class="fu">aes</span>(<span class="at">x =</span> gabor3, <span class="at">y =</span> kidvol_change)) <span class="sc">+</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Kidney Volume by Gabor3"</span>,</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Gabor3"</span>,</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change in Kidney Volume (%)"</span>) <span class="sc">+</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The relationship now looks appropriately linear when these outlier patients are removed.</p>
<p>We can also see that taking the log of the change in kidney volume reduces the influence of these outliers and makes the correlation non significant</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> gabor3, <span class="at">y =</span> kidvol_change_log)) <span class="sc">+</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Log Kidney Volume by Gabor3"</span>,</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Gabor3"</span>,</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change in Log Kidney Volume (%)"</span>) <span class="sc">+</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note: Patients 37 and 51 may be outliers and will need to be assessed using leverage and influence after the final model is fit!</p>
</div>
</div>
<p><a href="#Corr_One">Top of Tabset</a></p>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>None of the MRI features from the gray level co-occurence matrix were strongly correlated with <code>kidvol_change</code>.</p>
<p><a href="#Corr_One">Top of Tabset</a></p>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<p><code>txti2</code> is a strong predictor of change in <code>kidvol</code> regardless if whether <code>kidvol</code> is transformed or not.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> txti2, <span class="at">y =</span> kidvol_change)) <span class="sc">+</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Log Kidney Volume by Txti2"</span>,</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Txti2"</span>,</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change in Log Kidney Volume (%)"</span>) <span class="sc">+</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>txti2</code> is a strong predictor of change in kidney volume!</p>
<p><a href="#Corr_One">Top of Tabset</a></p>
</div>
<div id="tabset-7-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-5-tab">
<section id="lbp2-1" class="level4">
<h4 class="anchored" data-anchor-id="lbp2-1">Lbp2</h4>
<p><code>lbp2</code> is weakly correlated to change in kidney volume.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> lbp2, <span class="at">y =</span> kidvol_change)) <span class="sc">+</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Log Kidney Volume by lbp2"</span>,</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"lbp2"</span>,</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change in Log Kidney Volume (%)"</span>) <span class="sc">+</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(kidvol_change <span class="sc">~</span> lbp2, <span class="at">data =</span> data1_train)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = kidvol_change ~ lbp2, data = data1_train)

Residuals:
    Min      1Q  Median      3Q     Max 
-11.584  -5.786  -1.331   2.369  28.519 

Coefficients:
            Estimate Std. Error t value         Pr(&gt;|t|)    
(Intercept)    9.502      1.085   8.754 0.00000000000837 ***
lbp2           2.343      1.945   1.205            0.234    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.926 on 52 degrees of freedom
Multiple R-squared:  0.02716,   Adjusted R-squared:  0.008455 
F-statistic: 1.452 on 1 and 52 DF,  p-value: 0.2337</code></pre>
</div>
</div>
</section>
<section id="lbp4-1" class="level4">
<h4 class="anchored" data-anchor-id="lbp4-1">Lbp4</h4>
<p><code>lbp4</code> after log transforming is weakly associated with change in kidney volume, but not strong enough to be significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> lbp4_log, <span class="at">y =</span> kidvol_change)) <span class="sc">+</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Log Kidney Volume by Lbp4"</span>,</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Log Lbp4"</span>,</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change in Kidney Volume (%)"</span>) <span class="sc">+</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lbp-log" class="level4">
<h4 class="anchored" data-anchor-id="lbp-log">Lbp Log</h4>
<p><code>lbp5_log</code> is strongly correlated to change in kidney volume.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> lbp5_log, <span class="at">y =</span> kidvol_change)) <span class="sc">+</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Log Kidney Volume by Log Lbp5"</span>,</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Log Lbp5"</span>,</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change in Log Kidney Volume (%)"</span>) <span class="sc">+</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We have a pretty strong negative relationship here, looks like it is slightly driven by those two outlier patients.</p>
<p><a href="#Corr_One">Top of Tabset</a></p>
</section>
</div>
</div>
</div>
</section>
<section id="summary-18" class="level2">
<h2 class="anchored" data-anchor-id="summary-18">Summary</h2>
<p>The features that are most promising as covariates at this point are:</p>
<ul>
<li><code>geom2_yeo</code></li>
<li><code>gabor3</code></li>
<li><code>txt12</code></li>
<li><code>lbp5_log</code></li>
</ul>
</section>
</section>
<section id="feature-engineering-ii" class="level1">
<h1>Feature Engineering II</h1>
<section id="averages-and-interaction-terms" class="level2">
<h2 class="anchored" data-anchor-id="averages-and-interaction-terms">Averages and Interaction Terms</h2>
<p>We saw in the correlation matrix that both <code>geom1</code> and <code>geom2</code> had pretty even correlations with change in kidney volume.</p>
<p>In the interest of discovering underlying patterns (and minimizing the number of features we have, since we have a limit of 5 based on our sample size), I will attempt to collapse these two variables by</p>
<ul>
<li>Taking their average</li>
<li>Taking their interaction term</li>
</ul>
<p>I will also do the same for <code>lbp2</code>, and <code>lbp5_log</code>, which were correlated with the outcome.</p>
<section id="create-average-and-interaction-terms" class="level4">
<h4 class="anchored" data-anchor-id="create-average-and-interaction-terms">Create Average and Interaction Terms</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create average and interaction terms</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geom_avg =</span> (geom1_yeo <span class="sc">+</span> geom2_yeo)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">geom_int =</span> geom1_yeo<span class="sc">*</span>geom2_yeo,</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">lbp_avg  =</span> (lbp2 <span class="sc">+</span> lbp5_log),</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">lbp_int  =</span> lbp2<span class="sc">*</span>lbp5_log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="correlation-matrix-ii" class="level2">
<h2 class="anchored" data-anchor-id="correlation-matrix-ii">Correlation Matrix II</h2>
<p>Now we can rerun the correlation matrix and examine how those relationships changed</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Control matrix for better output</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>matrix_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"kidvol_base"</span>, <span class="st">"kidvol_change"</span>, <span class="st">"kidvol_change_log"</span>, <span class="st">"progression"</span>, <span class="st">"geom1"</span>, <span class="st">"geom1_yeo"</span>, <span class="st">"geom2"</span>, <span class="st">"geom2_yeo"</span>, <span class="st">"geom_avg"</span>, <span class="st">"geom_int"</span>, <span class="st">"lbp1"</span>, <span class="st">"lbp2"</span>, <span class="st">"lbp3"</span>, <span class="st">"lbp4"</span>, <span class="st">"lbp4_log"</span>, <span class="st">"lbp5"</span>, <span class="st">"lbp5_log"</span>, <span class="st">"lbp_avg"</span>, <span class="st">"lbp_int"</span>)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean the output by making a trimmed dataset excluding extaneous variables</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>data_for_matrix <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(matrix_order)</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We factored our variables at the start. To make a correlation matrix we must reconvert those back to numeric</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>data_for_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(data_for_matrix, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.factor</span>(x)) <span class="fu">as.numeric</span>(x) <span class="cf">else</span> x))</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a correlation matrix with all variables of the trimmed data set</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_for_matrix, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot correlation matrix</span></span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(correlation_matrix, <span class="at">method =</span> <span class="st">"color"</span>, <span class="at">addCoef.col =</span> <span class="st">"black"</span>, <span class="at">number.cex =</span> <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="Corr_Two" class="level2">
<h2 class="anchored" data-anchor-id="Corr_Two">Main Observations</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Geometry</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Local Binary Pattern</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p><code>geom_avg</code> (r = 0.20) has a higher correlation coefficient than <code>geom1_yeo</code> and <code>geom2_yeo</code> alone, and will thus be used as an aggregate covariate to capture the geometry of the MRIs going forward.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1_train, <span class="fu">aes</span>(<span class="at">x =</span> geom_avg, <span class="at">y =</span> kidvol_change)) <span class="sc">+</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Kidney Volume by geom_avg"</span>,</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"geom_avg"</span>,</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change in Kidney Volume (%)"</span>) <span class="sc">+</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Notably, this could be driven by those two outliers as mentioned previously.</p>
<p><a href="#Corr_Two">Top of Tabset</a></p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>The average and interaction terms do not perform better than <code>lbp5_log</code> alone.</p>
<p><a href="#Corr_Two">Top of Tabset</a></p>
</div>
</div>
</div>
<section id="summary-19" class="level3">
<h3 class="anchored" data-anchor-id="summary-19">Summary</h3>
<p><code>geom_avg</code> increases the r by 0.03 over the individual non-combined features, and will be chosen as a candidate covariate.</p>
<p><code>lbp_avg</code> does not perform better than <code>lbp5_log</code> alone, and thus <code>lbp5_log</code> will be chosen as a candidate covariate in the final model.</p>
</section>
</section>
</section>
<section id="feature-engineering-iii" class="level1">
<h1>Feature Engineering III</h1>
<section id="quadratic-terms" class="level2">
<h2 class="anchored" data-anchor-id="quadratic-terms">Quadratic Terms</h2>
<p>Finally, we will consider quadratic terms for each feature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create function to square specified columns and rename the new variables</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>square_selected_variables <span class="ot">&lt;-</span> <span class="cf">function</span>(df, columns) {</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(columns), <span class="sc">~</span> .<span class="sc">^</span><span class="dv">2</span>, <span class="at">.names =</span> <span class="st">"{.col}_square"</span>))</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose columns to get squared</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>columns <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(geom1, geom1_yeo, geom2, geom2_yeo, geom_avg, geom_int, gabor1, gabor2, gabor2_yeo, gabor3, gabor4, gabor4_log, gabor5, glcm1, glcm2, glcm2_log, txti1, txti2, txti3, txti4, txti4_log, txti5, txti5_log, lbp1, lbp2, lbp3, lbp4, lbp4_log, lbp5, lbp5_log, lbp_avg, lbp_int) <span class="sc">|&gt;</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>()</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Square selected variables</span></span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>data_square <span class="ot">&lt;-</span> <span class="fu">square_selected_variables</span>(data1_train, columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="correlation-matrix-iii" class="level2">
<h2 class="anchored" data-anchor-id="correlation-matrix-iii">Correlation Matrix III</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Control matrix for better output</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>matrix_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"kidvol_base"</span>, <span class="st">"kidvol_change"</span>, <span class="st">"kidvol_change_log"</span>, <span class="st">"progression"</span>, <span class="st">"geom1_square"</span>, <span class="st">"geom1_yeo_square"</span>, <span class="st">"geom2_square"</span>, <span class="st">"geom2_yeo_square"</span>, <span class="st">"geom_avg_square"</span>, <span class="st">"geom_int_square"</span>, <span class="st">"gabor1_square"</span>, <span class="st">"gabor2_square"</span>, <span class="st">"gabor2_yeo_square"</span>, <span class="st">"gabor3_square"</span>, <span class="st">"gabor4_square"</span>, <span class="st">"gabor4_log_square"</span>, <span class="st">"gabor5_square"</span>, <span class="st">"glcm1_square"</span>, <span class="st">"glcm2_square"</span>, <span class="st">"glcm2_log_square"</span>, <span class="st">"txti1_square"</span>, <span class="st">"txti2_square"</span>, <span class="st">"txti3_square"</span>, <span class="st">"txti4_square"</span>, <span class="st">"txti4_log_square"</span>, <span class="st">"txti5_square"</span>, <span class="st">"txti5_log_square"</span>, <span class="st">"lbp1_square"</span>, <span class="st">"lbp2_square"</span>, <span class="st">"lbp3_square"</span>, <span class="st">"lbp4_square"</span>, <span class="st">"lbp4_log_square"</span>, <span class="st">"lbp5_square"</span>, <span class="st">"lbp5_log_square"</span>, <span class="st">"lbp_avg_square"</span>, <span class="st">"lbp_int_square"</span>)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean the output by making a trimmed dataset excluding extraneous variables</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>data_for_matrix2 <span class="ot">&lt;-</span> data_square <span class="sc">|&gt;</span> </span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(matrix_order)</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We factored our variables at the start. To make a correlation matrix we must reconvert those back to numeric</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>data_for_matrix2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(data_for_matrix2, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.factor</span>(x)) <span class="fu">as.numeric</span>(x) <span class="cf">else</span> x))</span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a correlation matrix with all variables of the trimmed data set</span></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_for_matrix2, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot correlation matrix</span></span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(correlation_matrix, <span class="at">method =</span> <span class="st">"color"</span>, <span class="at">addCoef.col =</span> <span class="st">"black"</span>, <span class="at">number.cex =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="Corr_Three" class="level2">
<h2 class="anchored" data-anchor-id="Corr_Three">Main Observations</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Gabor Transform</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Gray Level Co-Occurence Matrix</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<section id="gabor3-1" class="level4">
<h4 class="anchored" data-anchor-id="gabor3-1">Gabor3</h4>
<p>The correlation coefficient for <code>gabor3_square</code> is higher than <code>gabor3</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_square, <span class="fu">aes</span>(<span class="at">x =</span> gabor3_square, <span class="at">y =</span> kidvol_change)) <span class="sc">+</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s compare if we remove those outliers</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_out_rem, <span class="fu">aes</span>(<span class="at">x =</span> gabor3<span class="sc">**</span><span class="dv">2</span>, <span class="at">y =</span> kidvol_change)) <span class="sc">+</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This appears to be driven by that outlier patient.</p>
<p><a href="#Corr_Three">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p><code>glcm2_square</code> has a strong correlation (r = 0.31). Let’s examine.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_square, <span class="fu">aes</span>(<span class="at">x =</span> glcm2_square, <span class="at">y =</span> kidvol_change)) <span class="sc">+</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the model</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(kidvol_change <span class="sc">~</span> glcm2<span class="sc">**</span><span class="dv">2</span>, <span class="at">data =</span> data1_train)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = kidvol_change ~ glcm2^2, data = data1_train)

Residuals:
    Min      1Q  Median      3Q     Max 
-11.657  -5.766  -1.591   3.782  29.290 

Coefficients:
                Estimate   Std. Error t value    Pr(&gt;|t|)    
(Intercept) 7.8715892217 1.4117081716   5.576 0.000000892 ***
glcm2       0.0000013538 0.0000008435   1.605       0.115    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.844 on 52 degrees of freedom
Multiple R-squared:  0.0472,    Adjusted R-squared:  0.02888 
F-statistic: 2.576 on 1 and 52 DF,  p-value: 0.1146</code></pre>
</div>
</div>
<p>This could be driven by the outlier, but we will include <code>glcm2_square</code> as a covariate during model selection.</p>
<p><a href="#Corr_Three">Top of Tabset</a></p>
</div>
</div>
</div>
<section id="summary-20" class="level3">
<h3 class="anchored" data-anchor-id="summary-20">Summary</h3>
<p><code>GLCM2_square</code> will be considered as a potential covariate during model selection.</p>
</section>
</section>
</section>
<section id="feature-scaling" class="level1">
<h1>Feature Scaling</h1>
<p>Before we perform our regression, we must standardize our variables to place them all on the same scale so that they contribute equally to the model.</p>
<p>This also makes it easier for the gradient descent process to converge faster and more efficiently.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-243237117.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-2354431195.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<section id="perform-scaling" class="level2">
<h2 class="anchored" data-anchor-id="perform-scaling">Perform Scaling</h2>
<p>We will perform z norm scaling using <code>caret</code>, which will appropriately scale the test set of each fold using the mean and standard deviation of each respective training set.</p>
</section>
</section>
<section id="task-one-linear-regression" class="level1">
<h1>Task One: Linear Regression</h1>
<p><a href="http://zevross.com/blog/2017/09/19/predictive-modeling-and-machine-learning-in-r-with-the-caret-package/">This website</a> was used for coding guidance for the linear regression model.</p>
<section id="cost-function" class="level2">
<h2 class="anchored" data-anchor-id="cost-function">Cost Function</h2>
<p>The cost function in a linear regression is Root Mean Square Error (RMSE):</p>
<p><span class="math display">\[ \text{RMSE} = \sqrt{\frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2} \]</span></p>
<p>Where y is the actual change in outcome variable and y-hat is the predicted change, and n is the number of observations.</p>
<section id="mapping-function" class="level4">
<h4 class="anchored" data-anchor-id="mapping-function">Mapping Function</h4>
<p>In the case of linear regression, the mapping function is essentially each beta in the model.</p>
</section>
<section id="goal" class="level4">
<h4 class="anchored" data-anchor-id="goal">Goal</h4>
<p>The goal is to select a mapping function that minimizes the cost function and thereby produces the best predictions for the outcome variable.</p>
<p>We will be using the <code>caret</code> package to perform model training using 5-fold cross validation and Ordinary Least Squares (OLS). Another option is to perform gradient descent.</p>
</section>
</section>
<section id="1A" class="level2">
<h2 class="anchored" data-anchor-id="1A">Model 1A: Baseline Kidney Volume</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>To answer the researcher’s first question for Task 1, we will perform a predictive model that uses the baseline height-corrected total kidney volume to predict percent change in kidney volume.</p>
<p><span class="math display">\[ Kidney Volume Change = 𝛽_0 + 𝛽_1*Log Kidney Volume Baseline + e \]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up a 5-fold cross validation</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>tc <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the linear regression using 5-fold CV</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>model1a <span class="ot">&lt;-</span> <span class="fu">train</span>(kidvol_change <span class="sc">~</span> <span class="fu">log</span>(kidvol_base), </span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> data, </span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl =</span> tc)</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Get RMSE</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>model1a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression 

71 samples
 1 predictor

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 56, 56, 58, 58, 56 
Resampling results:

  RMSE      Rsquared    MAE     
  8.096326  0.05257111  6.192124

Tuning parameter 'intercept' was held constant at a value of TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get model coefficients</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = .outcome ~ ., data = dat)

Residuals:
    Min      1Q  Median      3Q     Max 
-16.166  -5.741  -1.240   3.758  27.000 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)          26.582     11.698   2.272   0.0262 *
`log(kidvol_base)`   -2.987      2.028  -1.473   0.1453  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.176 on 69 degrees of freedom
Multiple R-squared:  0.03049,   Adjusted R-squared:  0.01644 
F-statistic:  2.17 on 1 and 69 DF,  p-value: 0.1453</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine RSME and R Squared of each fold</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(model1a<span class="sc">$</span>resample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">RMSE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Rsquared</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MAE</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Resample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">9.164071</td>
<td style="text-align: right;">0.1296555</td>
<td style="text-align: right;">6.966941</td>
<td style="text-align: left;">Fold1</td>
</tr>
<tr class="even">
<td style="text-align: right;">8.938726</td>
<td style="text-align: right;">0.1208880</td>
<td style="text-align: right;">6.144274</td>
<td style="text-align: left;">Fold2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9.002214</td>
<td style="text-align: right;">0.0078560</td>
<td style="text-align: right;">7.279776</td>
<td style="text-align: left;">Fold3</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.777802</td>
<td style="text-align: right;">0.0009846</td>
<td style="text-align: right;">5.651400</td>
<td style="text-align: left;">Fold4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.598816</td>
<td style="text-align: right;">0.0034716</td>
<td style="text-align: right;">4.918228</td>
<td style="text-align: left;">Fold5</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The model has an RMSE of 8.10.</p>
<p><a href="#1A">Top of Tabset</a></p>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<section id="actual-vs-predicted-values" class="level4">
<h4 class="anchored" data-anchor-id="actual-vs-predicted-values">Actual vs Predicted Values</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save predicted values to data set</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions1a <span class="ot">&lt;-</span> <span class="fu">predict</span>(model1a, <span class="at">newdata =</span> data)</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize predicted vs actual values</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> kidvol_change, <span class="at">y =</span> predictions1a)) <span class="sc">+</span></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted vs Actual Values for Baseline Kidney Volume"</span>,</span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Actual Values"</span>,</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In a well performing model, the dots are close to a straight line (the blue dashed line), which would indicate perfect overlap between predicted and actual values.</p>
</section>
<section id="residuals" class="level4">
<h4 class="anchored" data-anchor-id="residuals">Residuals</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the residuals</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>residuals1a <span class="ot">&lt;-</span> data<span class="sc">$</span>kidvol_change <span class="sc">-</span> data<span class="sc">$</span>predictions1a</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> predictions1a, <span class="at">y =</span> residuals1a)) <span class="sc">+</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuals for Baseline Kidney Volume"</span>,</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Predicted Values"</span>,</span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There’s some pretty large differences in the predictions here, with some patients having predicted values that are 15% off or greater!</p>
</section>
<section id="qq-plot" class="level4">
<h4 class="anchored" data-anchor-id="qq-plot">QQ Plot</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot QQ Plot</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">sample =</span> residuals1a)) <span class="sc">+</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of Model 1A"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The QQ plot is almost normal, but not quite.</p>
</section>
<section id="histogram-of-residuals" class="level4">
<h4 class="anchored" data-anchor-id="histogram-of-residuals">Histogram of Residuals</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of residuals</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> residuals1a)) <span class="sc">+</span> </span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Residuals for Model 1A"</span>, </span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Residuals"</span>, </span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The residuals are almost normally distributed, but not quite.</p>
<p><a href="#1A">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<p>the RMSE of the model including <code>kidvol_base</code> alone is 8.11</p>
<p>The model does not perform too well, when looking at the plots of the predicted vs actual values.</p>
<p>The assumption of normality is almost, but not quite, met.</p>
<p><a href="#1A">Top of Tabset</a></p>
</div>
</div>
</div>
</section>
<section id="1B" class="level2">
<h2 class="anchored" data-anchor-id="1B">Model 1B: MRI Features</h2>
<p>To answer the researcher’s second question for Task 1, we will run a predictive model that uses only MRI image features to predict percent change in kidney volume at year 3.</p>
<p><span class="math display">\[ Kidney Volume Change = 𝛽_0 + 𝛽_1*Txti2 + e \]</span></p>
<section id="model-selection" class="level4">
<h4 class="anchored">Model Selection</h4>
<p>Model selection will be performed on Fold 1 to avoid data snooping on the test set.</p>
<p>The potential scaled covariates for our final model after feature engineering and interactive variable selection are:</p>
<ul>
<li><code>geom_avg</code></li>
<li><code>gabor3</code></li>
<li><code>txti2</code></li>
<li><code>lbp5_log</code></li>
<li><code>glcm2_square</code></li>
</ul>
<p>We will perform model selection using backwards elimination and BIC.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Backwards Elimination I</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Analysis I</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">Visualization I</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-4" role="tab" aria-controls="tabset-11-4" aria-selected="false">Leverage and Influence</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-5" role="tab" aria-controls="tabset-11-5" aria-selected="false">Backwards Elimination II</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-6" role="tab" aria-controls="tabset-11-6" aria-selected="false">Analysis II</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-7" role="tab" aria-controls="tabset-11-7" aria-selected="false">Visualization II</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-8" role="tab" aria-controls="tabset-11-8" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create variables</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geom_avg_scale =</span> <span class="fu">scale</span>((geom1_yeo<span class="sc">+</span>geom2_yeo)<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">gabor3_scale =</span> <span class="fu">scale</span>(gabor3),</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">txti2_scale =</span> <span class="fu">scale</span>(txti2),</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">lbp5_log_scale =</span> <span class="fu">scale</span>(<span class="fu">log</span>(lbp5)),</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">glcm2_square_scale =</span> <span class="fu">scale</span>(glcm2<span class="sc">**</span><span class="dv">2</span>))</span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a><span class="co"># First build the model with all variables</span></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>model1b <span class="ot">&lt;-</span> <span class="fu">lm</span>(kidvol_change <span class="sc">~</span> geom_avg_scale <span class="sc">+</span> gabor3_scale <span class="sc">+</span> txti2_scale <span class="sc">+</span> lbp5_log_scale <span class="sc">+</span> glcm2_square_scale, <span class="at">data =</span> data1_train)</span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = kidvol_change ~ geom_avg_scale + gabor3_scale + 
    txti2_scale + lbp5_log_scale + glcm2_square_scale, data = data1_train)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.458  -4.477  -1.072   2.927  18.913 

Coefficients:
                   Estimate Std. Error t value         Pr(&gt;|t|)    
(Intercept)          9.3544     0.9681   9.662 0.00000000000077 ***
geom_avg_scale      -0.5476     1.0569  -0.518           0.6067    
gabor3_scale        -1.8407     1.0054  -1.831           0.0733 .  
txti2_scale         -2.0236     1.0275  -1.970           0.0547 .  
lbp5_log_scale      -1.0410     1.0918  -0.953           0.3451    
glcm2_square_scale   1.9041     1.0320   1.845           0.0712 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.114 on 48 degrees of freedom
Multiple R-squared:  0.2765,    Adjusted R-squared:  0.2011 
F-statistic: 3.668 on 5 and 48 DF,  p-value: 0.006844</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform backward elimination </span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_backward_sbc</span>(model1b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                               Stepwise Summary                                
-----------------------------------------------------------------------------
Step    Variable            AIC        SBC       SBIC        R2       Adj. R2 
-----------------------------------------------------------------------------
 0      Full Model        372.792    386.715    221.016    0.27647    0.20110 
 1      geom_avg_scale    371.093    383.027    218.848    0.27242    0.21303 
 2      lbp5_log_scale    370.716    380.661    218.098    0.25023    0.20524 
-----------------------------------------------------------------------------

Final Model Output 
------------------

                         Model Summary                           
----------------------------------------------------------------
R                        0.500       RMSE                 6.828 
R-Squared                0.250       MSE                 46.621 
Adj. R-Squared           0.205       Coef. Var           75.855 
Pred R-Squared          -0.235       AIC                370.716 
MAE                      5.016       SBC                380.661 
----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                               ANOVA                                
-------------------------------------------------------------------
                Sum of                                             
               Squares        DF    Mean Square      F        Sig. 
-------------------------------------------------------------------
Regression     840.194         3        280.065    5.562    0.0023 
Residual      2517.532        50         50.351                    
Total         3357.727        53                                   
-------------------------------------------------------------------

                                      Parameter Estimates                                       
-----------------------------------------------------------------------------------------------
             model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
-----------------------------------------------------------------------------------------------
       (Intercept)     9.354         0.966                  9.688    0.000     7.415    11.294 
      gabor3_scale    -2.114         0.981       -0.266    -2.155    0.036    -4.084    -0.143 
       txti2_scale    -2.200         1.016       -0.276    -2.165    0.035    -4.240    -0.159 
glcm2_square_scale     2.076         1.018        0.261     2.040    0.047     0.032     4.121 
-----------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<p><code>geom_avg</code> and <code>lbp5_log</code> are removed based on BIC. AIC prefers the model with <code>lbp5_log</code></p>
<p>However, we must note that we suspect patients 37 and 51 to be outliers on total kidney volume change, and we saw previously that the correlations for <code>gabor3</code> and <code>glcm2_square</code> may be being driven by these outlier patients.</p>
<p><a href="#1B">Top of Tabset</a></p>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<section id="perform-5-fold-cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="perform-5-fold-cross-validation">Perform 5-Fold Cross Validation</h3>
<p>The final model selected via backwards elimination includes <code>gabor3</code>, <code>txti2</code>, and <code>glcm2_square</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create variables for original data set</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gabor3_scale =</span> <span class="fu">scale</span>(gabor3),</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">txti2_scale =</span> <span class="fu">scale</span>(txti2),</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">glcm2_square =</span> glcm2<span class="sc">**</span><span class="dv">2</span>,</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">glcm2_square_scale =</span> <span class="fu">scale</span>(glcm2<span class="sc">**</span><span class="dv">2</span>),</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">lbp5_log_scale =</span> <span class="fu">scale</span>(<span class="fu">log</span>(lbp5)),</span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">geom_avg_scale =</span> <span class="fu">scale</span>(geom1<span class="sc">+</span>geom2)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the linear regression using 5-fold CV</span></span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>model1b <span class="ot">&lt;-</span> <span class="fu">train</span>(kidvol_change <span class="sc">~</span> gabor3 <span class="sc">+</span> txti2 <span class="sc">+</span> glcm2_square, </span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> data, </span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl =</span> tc,</span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">preProc =</span> <span class="st">"scale"</span>)</span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Get RMSE</span></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a>model1b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression 

71 samples
 3 predictor

Pre-processing: scaled (3) 
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 56, 56, 58, 58, 56 
Resampling results:

  RMSE      Rsquared   MAE     
  9.032055  0.1690167  6.528863

Tuning parameter 'intercept' was held constant at a value of TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get model coefficients</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = .outcome ~ ., data = dat)

Residuals:
    Min      1Q  Median      3Q     Max 
-16.630  -4.574  -1.414   3.490  28.925 

Coefficients:
             Estimate Std. Error t value          Pr(&gt;|t|)    
(Intercept)    9.0641     1.0337   8.768 0.000000000000996 ***
gabor3         0.1500     0.9800   0.153            0.8788    
txti2         -2.2213     0.9844  -2.256            0.0273 *  
glcm2_square   0.8494     0.9690   0.877            0.3838    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.049 on 67 degrees of freedom
Multiple R-squared:  0.08767,   Adjusted R-squared:  0.04681 
F-statistic: 2.146 on 3 and 67 DF,  p-value: 0.1026</code></pre>
</div>
</div>
<p>The RMSE is 9.03, worse than the model with <code>kidvol_base</code> alone.</p>
<p><a href="#1B">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<section id="actual-vs-predicted-values-1" class="level4">
<h4 class="anchored" data-anchor-id="actual-vs-predicted-values-1">Actual vs Predicted Values</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save predicted valuest to data set</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions1b <span class="ot">&lt;-</span> <span class="fu">predict</span>(model1b, <span class="at">newdata =</span> data)</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize predicted vs actual values</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> kidvol_change, <span class="at">y =</span> predictions1b)) <span class="sc">+</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted vs Actual Values for MRI Features"</span>,</span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Actual Values"</span>,</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="residuals-1" class="level4">
<h4 class="anchored" data-anchor-id="residuals-1">Residuals</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the residuals</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>residuals1b <span class="ot">&lt;-</span> data<span class="sc">$</span>kidvol_change <span class="sc">-</span> data<span class="sc">$</span>predictions1b</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> predictions1a, <span class="at">y =</span> residuals1b)) <span class="sc">+</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuals for MRI Features"</span>,</span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Predicted Values"</span>,</span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Our residuals are comparable in this model compared to modela 1A using <code>kidvol_base</code> alone. Some It appears that more residuals are closer to 0, but some predictions are as large as 30% off!</p>
</section>
<section id="qq-plot-1" class="level4">
<h4 class="anchored" data-anchor-id="qq-plot-1">QQ Plot</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot QQ Plot</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">sample =</span> residuals1b)) <span class="sc">+</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of Model 1B"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="histogram-of-residuals-1" class="level4">
<h4 class="anchored" data-anchor-id="histogram-of-residuals-1">Histogram of Residuals</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of residuals</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> residuals1b)) <span class="sc">+</span> </span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Residuals for Model 1B"</span>, </span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Residuals"</span>, </span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><a href="#1B">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-11-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-4-tab">
<p>The cutoff for leverage (hat-value) is 2(p+1)/n, where p is the number of variables in the model, or 2(3+1)/71 = 0.112.</p>
<p>The cut off for Cook’s D &gt; 1.0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract model</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>model1b_ext <span class="ot">&lt;-</span> model1b<span class="sc">$</span>finalModel</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>influence_measures <span class="ot">&lt;-</span> <span class="fu">influencePlot</span>(model1b_ext, <span class="at">main =</span> <span class="st">"Influence Plot"</span>,</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">sub =</span> <span class="st">"Circle size is proportional to Cook's Distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get row numbers of outliers</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>influence_measures</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      StudRes       Hat     CookD
X2   3.205536 0.3120826 1.0236809
X8   4.481013 0.1736179 0.8208826
X9   3.131995 0.3212338 1.0257341
X35 -1.208289 0.4497401 0.2962813</code></pre>
</div>
</div>
<p>We have four clear outliers that are points of high leverage and influence.</p>
<p>Let’s identify them</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify outlier patients</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> data[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">35</span>),]</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print</span></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(outliers))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Subject_ID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">geom1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">geom2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">glcm1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">glcm2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">kidvol_base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">kidvol_visit2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">progression</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">kidvol_change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">fold_number</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">predictions1a</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">residuals1a</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gabor3_scale</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">txti2_scale</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">glcm2_square</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">glcm2_square_scale</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lbp5_log_scale</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">geom_avg_scale</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">predictions1b</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">residuals1b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">51</td>
<td style="text-align: right;">-43.393038</td>
<td style="text-align: right;">1882.95573</td>
<td style="text-align: right;">0.0047377</td>
<td style="text-align: right;">0.0544573</td>
<td style="text-align: right;">0.0002580</td>
<td style="text-align: right;">0.0000224</td>
<td style="text-align: right;">0.0029656</td>
<td style="text-align: right;">2454.8065</td>
<td style="text-align: right;">6026075.1</td>
<td style="text-align: right;">-14.67151</td>
<td style="text-align: right;">-9.355575</td>
<td style="text-align: right;">137.26039</td>
<td style="text-align: right;">215.2532</td>
<td style="text-align: right;">87.526780</td>
<td style="text-align: right;">0.1577583</td>
<td style="text-align: right;">0.1676594</td>
<td style="text-align: right;">0.0264497</td>
<td style="text-align: right;">0.0248877</td>
<td style="text-align: right;">0.0281097</td>
<td style="text-align: right;">185</td>
<td style="text-align: right;">387</td>
<td style="text-align: left;">Fast</td>
<td style="text-align: right;">36.28</td>
<td style="text-align: left;">Fold2</td>
<td style="text-align: right;">10.989456</td>
<td style="text-align: right;">25.290543</td>
<td style="text-align: right;">0.01648347</td>
<td style="text-align: right;">-1.3536710</td>
<td style="text-align: right;">36313581159049</td>
<td style="text-align: right;">4.4785466</td>
<td style="text-align: right;">-0.4385074</td>
<td style="text-align: right;">-0.06753985</td>
<td style="text-align: right;">16.224288</td>
<td style="text-align: right;">20.055712</td>
</tr>
<tr class="even">
<td style="text-align: right;">37</td>
<td style="text-align: right;">-3.860771</td>
<td style="text-align: right;">14.90555</td>
<td style="text-align: right;">0.2621932</td>
<td style="text-align: right;">-0.1983384</td>
<td style="text-align: right;">-0.0520030</td>
<td style="text-align: right;">0.0687453</td>
<td style="text-align: right;">0.0393381</td>
<td style="text-align: right;">871.6238</td>
<td style="text-align: right;">759728.0</td>
<td style="text-align: right;">-14.72259</td>
<td style="text-align: right;">-1.969424</td>
<td style="text-align: right;">28.99502</td>
<td style="text-align: right;">216.7546</td>
<td style="text-align: right;">3.878631</td>
<td style="text-align: right;">-0.0557547</td>
<td style="text-align: right;">0.0722141</td>
<td style="text-align: right;">-0.0040263</td>
<td style="text-align: right;">0.0031086</td>
<td style="text-align: right;">0.0052149</td>
<td style="text-align: right;">173</td>
<td style="text-align: right;">372</td>
<td style="text-align: left;">Fast</td>
<td style="text-align: right;">38.19</td>
<td style="text-align: left;">Fold3</td>
<td style="text-align: right;">11.189771</td>
<td style="text-align: right;">27.000229</td>
<td style="text-align: right;">-3.32238849</td>
<td style="text-align: right;">-0.2849587</td>
<td style="text-align: right;">577186627450</td>
<td style="text-align: right;">-0.3302081</td>
<td style="text-align: right;">-1.1025159</td>
<td style="text-align: right;">-0.22901595</td>
<td style="text-align: right;">9.264656</td>
<td style="text-align: right;">28.925344</td>
</tr>
<tr class="odd">
<td style="text-align: right;">52</td>
<td style="text-align: right;">77.054904</td>
<td style="text-align: right;">5937.45816</td>
<td style="text-align: right;">0.4598489</td>
<td style="text-align: right;">0.1556082</td>
<td style="text-align: right;">0.0715563</td>
<td style="text-align: right;">0.2114611</td>
<td style="text-align: right;">0.0242139</td>
<td style="text-align: right;">-638.4451</td>
<td style="text-align: right;">407612.2</td>
<td style="text-align: right;">20.26785</td>
<td style="text-align: right;">9.686888</td>
<td style="text-align: right;">196.33234</td>
<td style="text-align: right;">410.7855</td>
<td style="text-align: right;">93.835797</td>
<td style="text-align: right;">9.7525713</td>
<td style="text-align: right;">1.1625327</td>
<td style="text-align: right;">11.3376835</td>
<td style="text-align: right;">95.1126464</td>
<td style="text-align: right;">1.3514824</td>
<td style="text-align: right;">358</td>
<td style="text-align: right;">640</td>
<td style="text-align: left;">Fast</td>
<td style="text-align: right;">26.18</td>
<td style="text-align: left;">Fold4</td>
<td style="text-align: right;">9.017566</td>
<td style="text-align: right;">17.162434</td>
<td style="text-align: right;">4.57161897</td>
<td style="text-align: right;">1.4016092</td>
<td style="text-align: right;">166147673143</td>
<td style="text-align: right;">-0.3855183</td>
<td style="text-align: right;">1.0880277</td>
<td style="text-align: right;">0.30114927</td>
<td style="text-align: right;">6.655437</td>
<td style="text-align: right;">19.524563</td>
</tr>
<tr class="even">
<td style="text-align: right;">48</td>
<td style="text-align: right;">-124.266792</td>
<td style="text-align: right;">15442.23561</td>
<td style="text-align: right;">-0.1630575</td>
<td style="text-align: right;">0.0017660</td>
<td style="text-align: right;">-0.0002880</td>
<td style="text-align: right;">0.0265878</td>
<td style="text-align: right;">0.0000031</td>
<td style="text-align: right;">2545.1960</td>
<td style="text-align: right;">6478022.6</td>
<td style="text-align: right;">6.41584</td>
<td style="text-align: right;">7.649503</td>
<td style="text-align: right;">49.07799</td>
<td style="text-align: right;">41.1630</td>
<td style="text-align: right;">58.514902</td>
<td style="text-align: right;">-0.1337633</td>
<td style="text-align: right;">3.0589420</td>
<td style="text-align: right;">-0.4091741</td>
<td style="text-align: right;">0.0178926</td>
<td style="text-align: right;">9.3571262</td>
<td style="text-align: right;">290</td>
<td style="text-align: right;">327</td>
<td style="text-align: left;">Slow</td>
<td style="text-align: right;">4.21</td>
<td style="text-align: left;">Fold5</td>
<td style="text-align: right;">9.646765</td>
<td style="text-align: right;">-5.436765</td>
<td style="text-align: right;">-0.01839687</td>
<td style="text-align: right;">1.1068172</td>
<td style="text-align: right;">41964776184221</td>
<td style="text-align: right;">5.2389818</td>
<td style="text-align: right;">1.8507097</td>
<td style="text-align: right;">1.12273578</td>
<td style="text-align: right;">11.399413</td>
<td style="text-align: right;">-7.189413</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>As predicted, patients <code>37</code> and <code>52</code> are points of high leverage and influence.</p>
<p>Also <a href="#Features_Uni">as identified before</a>, patients <code>48</code> and <code>52</code> are points of high leverage and influence, which can be denoted by their absurdly high values for <code>lbp1</code> and <code>lbp2</code>.</p>
<p>Since we previously identified that certain correlations such as with <code>gabor3</code> and <code>glcm2_square</code> were being driven by these outlier patients, we will re-run model selection again using backwards elimination, with these patients removed.</p>
<p><a href="#1B">Top of Tabset</a></p>
</div>
<div id="tabset-11-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-5-tab">
<section id="remove-outliers-and-re-run-variable-selection" class="level4">
<h4 class="anchored" data-anchor-id="remove-outliers-and-re-run-variable-selection">Remove Outliers and Re-Run Variable Selection</h4>
<p>We will perform backwards elimination again with outlier patients removed.</p>
<p>We can expect <code>gabor3</code> and <code>glcm2_square</code> to be removed since their correlations were driven by these outliers, as identified in earlier plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove outlier patients from data set</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Subject_ID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">37</span>, <span class="dv">48</span>, <span class="dv">51</span>, <span class="dv">52</span>))</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create model</span></span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>model1b2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(kidvol_change <span class="sc">~</span> geom_avg_scale <span class="sc">+</span> gabor3_scale <span class="sc">+</span> txti2_scale <span class="sc">+</span> lbp5_log_scale <span class="sc">+</span> glcm2_square_scale, <span class="at">data =</span> data1_train)</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Model Summary</span></span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1b2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = kidvol_change ~ geom_avg_scale + gabor3_scale + 
    txti2_scale + lbp5_log_scale + glcm2_square_scale, data = data1_train)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.3899 -3.2977 -0.9786  2.4046 15.9736 

Coefficients:
                   Estimate Std. Error t value           Pr(&gt;|t|)    
(Intercept)          8.1922     0.7809  10.491 0.0000000000000867 ***
geom_avg_scale      -0.1844     0.8252  -0.223            0.82416    
gabor3_scale         0.9018     0.9673   0.932            0.35609    
txti2_scale         -2.1787     0.8004  -2.722            0.00913 ** 
lbp5_log_scale      -0.9964     0.8565  -1.163            0.25073    
glcm2_square_scale  -1.2907     1.1787  -1.095            0.27918    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.538 on 46 degrees of freedom
Multiple R-squared:  0.1898,    Adjusted R-squared:  0.1017 
F-statistic: 2.155 on 5 and 46 DF,  p-value: 0.07558</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform backward elimination </span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_forward_sbc</span>(model1b2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                              Stepwise Summary                              
--------------------------------------------------------------------------
Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
--------------------------------------------------------------------------
 0      Base Model     334.154    338.056    186.402    0.00000    0.00000 
 1      txti2_scale    328.649    334.503    181.305    0.13439    0.11708 
--------------------------------------------------------------------------

Final Model Output 
------------------

                         Model Summary                          
---------------------------------------------------------------
R                       0.367       RMSE                 5.384 
R-Squared               0.134       MSE                 28.989 
Adj. R-Squared          0.117       Coef. Var           66.297 
Pred R-Squared          0.067       AIC                328.649 
MAE                     4.093       SBC                334.503 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                               ANOVA                                
-------------------------------------------------------------------
                Sum of                                             
               Squares        DF    Mean Square      F        Sig. 
-------------------------------------------------------------------
Regression     234.037         1        234.037    7.763    0.0075 
Residual      1507.420        50         30.148                    
Total         1741.457        51                                   
-------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)     8.344         0.762                 10.954    0.000     6.814     9.874 
txti2_scale    -2.136         0.767       -0.367    -2.786    0.008    -3.677    -0.596 
----------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<p>As predicted, when excluding these outlier patients, <code>gabor3</code> and <code>glcm2_square</code> are no longer significant.</p>
<p>The only selected now using BIC is <code>txti2</code>!</p>
<p>Let’s perform 5-fold CV again using this model.</p>
<p><a href="#1B">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-11-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-6-tab">
<section id="remove-outliers" class="level4">
<h4 class="anchored" data-anchor-id="remove-outliers">Remove Outliers</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove outlier patients from data set</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Subject_ID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">37</span>, <span class="dv">48</span>, <span class="dv">51</span>, <span class="dv">52</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="perform-regression-with-5-fold-cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="perform-regression-with-5-fold-cross-validation">Perform Regression with 5-Fold Cross Validation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up a 5-fold cross validation</span></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>tc <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>)</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the linear regression using 5-fold CV</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>model1b2 <span class="ot">&lt;-</span> <span class="fu">train</span>(kidvol_change <span class="sc">~</span> txti2, </span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> data, </span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl =</span> tc,</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">preProc =</span> <span class="st">"scale"</span>)</span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get RMSE</span></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a>model1b2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression 

67 samples
 1 predictor

Pre-processing: scaled (1) 
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 54, 55, 53, 55, 51 
Resampling results:

  RMSE      Rsquared  MAE    
  6.153724  0.171239  4.68434

Tuning parameter 'intercept' was held constant at a value of TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get model coefficients</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1b2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = .outcome ~ ., data = dat)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.6726  -3.5604  -0.5467   3.0722  18.8813 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)   8.3805     0.7661  10.939 0.000000000000000222 ***
txti2        -2.0443     0.7718  -2.649               0.0101 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.27 on 65 degrees of freedom
Multiple R-squared:  0.09742,   Adjusted R-squared:  0.08353 
F-statistic: 7.016 on 1 and 65 DF,  p-value: 0.01013</code></pre>
</div>
</div>
<p>The RMSE is now 6.15, drastically lower than with <code>kidvol_base_log</code> alone (but we need to rerun that model without outliers).</p>
<p>This model predicts 17.0% of the variance in <code>kidvol_change</code>.</p>
<p><a href="#1B">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-11-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-7-tab">
<section id="actual-vs-predicted-values-2" class="level4">
<h4 class="anchored" data-anchor-id="actual-vs-predicted-values-2">Actual vs Predicted Values</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save predicted valuest to data set</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions1b2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model1b2, <span class="at">newdata =</span> data)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize predicted vs actual values</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> kidvol_change, <span class="at">y =</span> predictions1b2)) <span class="sc">+</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted vs Actual Values for TXTI2"</span>,</span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Actual Values"</span>,</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The predicted models are still not that close to the actual values.</p>
</section>
<section id="residuals-2" class="level4">
<h4 class="anchored" data-anchor-id="residuals-2">Residuals</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the residuals</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>residuals1b2 <span class="ot">&lt;-</span> data<span class="sc">$</span>kidvol_change <span class="sc">-</span> data<span class="sc">$</span>predictions1b2</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot residuals</span></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> predictions1b2, <span class="at">y =</span> residuals1b2)) <span class="sc">+</span></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuals for TXTI2"</span>,</span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Predicted Values"</span>,</span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The residuals still look pretty large.</p>
</section>
<section id="qq-plot-2" class="level4">
<h4 class="anchored" data-anchor-id="qq-plot-2">QQ Plot</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot QQ Plot</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">sample =</span> residuals1b2)) <span class="sc">+</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of TXTI2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="histogram-of-residuals-2" class="level4">
<h4 class="anchored" data-anchor-id="histogram-of-residuals-2">Histogram of Residuals</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of residuals</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> residuals1b2)) <span class="sc">+</span> </span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Residuals for TXTI2"</span>, </span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Residuals"</span>, </span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The residuals are now approximately normally distributed, and would be more so with a larger sample size.</p>
</section>
<section id="leverage-and-influence-1" class="level3">
<h3 class="anchored" data-anchor-id="leverage-and-influence-1">Leverage and Influence</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract model</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>model1b2_ext <span class="ot">&lt;-</span> model1b2<span class="sc">$</span>finalModel</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>influence_measures <span class="ot">&lt;-</span> <span class="fu">influencePlot</span>(model1b2_ext, <span class="at">main =</span> <span class="st">"Influence Plot"</span>,</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">sub =</span> <span class="st">"Circle size is proportional to Cook's Distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get row numbers of outliers</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>influence_measures</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       StudRes        Hat       CookD
X5   2.7790166 0.01496267 0.053157442
X27 -0.5734689 0.10123968 0.018715616
X35 -1.7314354 0.05744408 0.088628443
X53  0.2718257 0.13375256 0.005786868
X60  3.2804634 0.03089234 0.149126512</code></pre>
</div>
</div>
<p>We no longer have outliers in this model as assessed by cutoffs using leverage and influence.</p>
<p><a href="#1B">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-11-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-8-tab">
<p>In this step we discovered that patiens 37, 48, 51, and 52 were outliers with high leverage and influence in our model.</p>
<p>After removing them, only <code>txti2</code> was selected as an MRI image feature predicting change in kidney volume.</p>
<p>The RMSE for model 1B after removing outliers was 6.15</p>
</div>
</div>
</div>
</section>
</section>
<section id="1C" class="level2">
<h2 class="anchored" data-anchor-id="1C">Model 1C: Baseline Kidney Volume and TXTI2</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>To answer the researcher’s third question, we will run a predictive model that uses the baseline height-corrected total kidney volume AND MRI image features to predict percent change in kidney volume.</p>
<p><span class="math display">\[ Kidney Volume Change = 𝛽_0 + 𝛽_{1}*Baseline Kidney Volume + 𝛽_{2}*Txti2 +  e \]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the linear regression using 5-fold CV</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>model1c <span class="ot">&lt;-</span> <span class="fu">train</span>(kidvol_change <span class="sc">~</span> <span class="fu">log</span>(kidvol_base) <span class="sc">+</span> txti2, </span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> data, </span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl =</span> tc,</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">preProc =</span> <span class="st">"scale"</span>,</span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">"RMSE"</span>)</span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get RMSE</span></span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a>model1c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression 

67 samples
 2 predictor

Pre-processing: scaled (2) 
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 54, 55, 53, 55, 51 
Resampling results:

  RMSE      Rsquared   MAE     
  6.140875  0.2383243  4.643702

Tuning parameter 'intercept' was held constant at a value of TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get model coefficients</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = .outcome ~ ., data = dat)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3316  -3.5730  -0.3356   3.2914  17.0199 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)         21.2149     9.3480   2.269  0.02662 * 
`log(kidvol_base)`  -1.0820     0.7855  -1.378  0.17315   
txti2               -2.2803     0.7855  -2.903  0.00506 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.228 on 64 degrees of freedom
Multiple R-squared:  0.1234,    Adjusted R-squared:  0.09601 
F-statistic: 4.505 on 2 and 64 DF,  p-value: 0.01477</code></pre>
</div>
</div>
<p>The RMSE for the combined model is 6.14, about the same as the model using just <code>txti2</code> alone.</p>
<p><a href="#1C">Top of Tabset</a></p>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<section id="actual-vs-predicted" class="level4">
<h4 class="anchored" data-anchor-id="actual-vs-predicted">Actual Vs Predicted</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save predicted valuest to data set</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions1c <span class="ot">&lt;-</span> <span class="fu">predict</span>(model1c, <span class="at">newdata =</span> data)</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize predicted vs actual values</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> kidvol_change, <span class="at">y =</span> predictions1c)) <span class="sc">+</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted vs Actual Values for Baseline Kidney Volumne and TXTI2"</span>,</span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Actual Values"</span>,</span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The model still does not have the best prediction.</p>
</section>
<section id="residuals-3" class="level4">
<h4 class="anchored" data-anchor-id="residuals-3">Residuals</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the residuals</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>residuals1c <span class="ot">&lt;-</span> data<span class="sc">$</span>kidvol_change <span class="sc">-</span> data<span class="sc">$</span>predictions1c</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot residuals</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> predictions1c, <span class="at">y =</span> residuals1c)) <span class="sc">+</span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuals for Baseline Kidney Volume and TXTI2"</span>,</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Predicted Values"</span>,</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The residuals are slightly better than the model with <code>kidvol_base</code> alone.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot QQ Plot</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">sample =</span> residuals1c)) <span class="sc">+</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of Baseline Kidney Volume and  TXTI2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is the best QQ plot we have had so far.</p>
</section>
<section id="histogram-of-residuals-3" class="level4">
<h4 class="anchored" data-anchor-id="histogram-of-residuals-3">Histogram of Residuals</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of residuals</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> residuals1c)) <span class="sc">+</span> </span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Residuals for Baseline Kidney Volume and TXTI2"</span>, </span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Residuals"</span>, </span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="leverage-and-influence-2" class="level4">
<h4 class="anchored" data-anchor-id="leverage-and-influence-2">Leverage and Influence</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract model</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>model1c_ext <span class="ot">&lt;-</span> model1c<span class="sc">$</span>finalModel</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>influence_measures <span class="ot">&lt;-</span> <span class="fu">influencePlot</span>(model1c_ext, <span class="at">main =</span> <span class="st">"Influence Plot"</span>,</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">sub =</span> <span class="st">"Circle size is proportional to Cook's Distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get row numbers of outliers</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>influence_measures</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      StudRes        Hat       CookD
X2  0.7595324 0.12618822 0.027954583
X5  2.8250641 0.01514097 0.036876777
X29 2.3152733 0.04010315 0.069889503
X53 0.2032994 0.13606032 0.002202691
X60 3.0216117 0.07797505 0.228366413</code></pre>
</div>
</div>
<p>There are no outliers (some edge cases but we will retain them)</p>
</section>
<section id="plot-final-model" class="level4">
<h4 class="anchored" data-anchor-id="plot-final-model">Plot Final Model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot final model</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(kidvol_base), <span class="at">y =</span> kidvol_change)) <span class="sc">+</span></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model 1C: Baseline Kidney Volume and Txti2"</span>,</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Baseline Kidney Volume (log)"</span>,</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change in Kidney Volume (%)"</span>) <span class="sc">+</span></span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This plot shows that generally, the larger your kidney volume at baseline, the less of an increase there was in size over 3 years.</p>
<p><a href="#1C">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<p>The RMSE for model 1C is 6.14, this is similar performance to model 1B.</p>
<p>Model 1C meets the assumptions of a linear regression (normality) the best.</p>
<p><a href="#1C">Top of Tabset</a></p>
</div>
</div>
</div>
</section>
<section id="model-comparison" class="level2">
<h2 class="anchored" data-anchor-id="model-comparison">Model Comparison</h2>
<p>Here we will compare how models 1A, 1B, and 1C performed.</p>
<p>Note: We removed outliers over the course of our model inspection. Thus we will re-run each analysis to get the true RMSE for each model.</p>
<section id="model-1a" class="level4">
<h4 class="anchored" data-anchor-id="model-1a">Model 1A</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="do">##### Model 1A</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the linear regression using 5-fold CV</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>model1a <span class="ot">&lt;-</span> <span class="fu">train</span>(kidvol_change <span class="sc">~</span> <span class="fu">log</span>(kidvol_base), </span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> data, </span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl =</span> tc)</span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get RMSE</span></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>model1a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression 

67 samples
 1 predictor

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 54, 55, 53, 55, 51 
Resampling results:

  RMSE      Rsquared    MAE     
  6.519605  0.04277987  5.194627

Tuning parameter 'intercept' was held constant at a value of TRUE</code></pre>
</div>
</div>
</section>
<section id="model-1b" class="level4">
<h4 class="anchored" data-anchor-id="model-1b">Model 1B</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="do">##### Model 1B</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the linear regression using 5-fold CV</span></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>model1b2 <span class="ot">&lt;-</span> <span class="fu">train</span>(kidvol_change <span class="sc">~</span> txti2, </span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> data, </span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl =</span> tc,</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">preProc =</span> <span class="st">"scale"</span>)</span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Get RMSE</span></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a>model1b2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression 

67 samples
 1 predictor

Pre-processing: scaled (1) 
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 54, 55, 53, 55, 51 
Resampling results:

  RMSE      Rsquared  MAE    
  6.153724  0.171239  4.68434

Tuning parameter 'intercept' was held constant at a value of TRUE</code></pre>
</div>
</div>
</section>
<section id="model-1c" class="level4">
<h4 class="anchored" data-anchor-id="model-1c">Model 1C</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the linear regression using 5-fold CV</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>model1c <span class="ot">&lt;-</span> <span class="fu">train</span>(kidvol_change <span class="sc">~</span> <span class="fu">log</span>(kidvol_base) <span class="sc">+</span> txti2_scale, </span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> data, </span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl =</span> tc)</span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get RMSE</span></span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>model1c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression 

67 samples
 2 predictor

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 54, 55, 53, 55, 51 
Resampling results:

  RMSE      Rsquared   MAE     
  6.140875  0.2383243  4.643702

Tuning parameter 'intercept' was held constant at a value of TRUE</code></pre>
</div>
</div>
</section>
<section id="final-average-rmse" class="level3">
<h3 class="anchored" data-anchor-id="final-average-rmse">Final Average RMSE</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Model</th>
<th>RMSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1A: Baseline Kidney Volume</td>
<td>6.52</td>
</tr>
<tr class="even">
<td>1B: Txti2</td>
<td>6.15</td>
</tr>
<tr class="odd">
<td>1C Baseline Kidney Volume and Txti2</td>
<td>6.14</td>
</tr>
</tbody>
</table>
</section>
<section id="compare-model-performance" class="level3">
<h3 class="anchored" data-anchor-id="compare-model-performance">Compare Model Performance</h3>
<p>We can also use the <code>caret</code> package to compare perfomance between these three models.</p>
<ul>
<li><p>Upper Diagonal Values: These are the differences in the metric values between models. Positive values mean the first model has a higher metric value, while negative values mean the first model has a lower metric value.</p></li>
<li><p>Lower Diagonal Values: These are the p-values from hypothesis tests comparing the metric values between models. Small p-values (typically &lt; 0.05) indicate significant differences between the models for that metric.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create list of models to compare</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">`</span><span class="at">Kidney Volume at Baseline</span><span class="st">`</span> <span class="ot">=</span> model1a, <span class="st">`</span><span class="at">Txti2</span><span class="st">`</span> <span class="ot">=</span> model1b2, <span class="st">`</span><span class="at">Kidney Volume at Baseline and Txti2</span><span class="st">`</span> <span class="ot">=</span> model1c)</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare models</span></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">resamples</span>(model_list)</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
summary.resamples(object = results)

Models: Kidney Volume at Baseline, Txti2, Kidney Volume at Baseline and Txti2 
Number of resamples: 5 

MAE 
                                        Min.  1st Qu.   Median     Mean
Kidney Volume at Baseline           4.296977 5.268043 5.312707 5.194627
Txti2                               3.442303 4.553295 4.891441 4.684340
Kidney Volume at Baseline and Txti2 3.282857 4.494957 4.952172 4.643702
                                     3rd Qu.     Max. NA's
Kidney Volume at Baseline           5.438730 5.656678    0
Txti2                               5.203527 5.331133    0
Kidney Volume at Baseline and Txti2 5.112327 5.376196    0

RMSE 
                                        Min.  1st Qu.   Median     Mean
Kidney Volume at Baseline           5.426090 6.382835 6.398772 6.519605
Txti2                               4.084323 6.119866 6.382093 6.153724
Kidney Volume at Baseline and Txti2 4.117591 5.917561 6.331809 6.140875
                                     3rd Qu.     Max. NA's
Kidney Volume at Baseline           6.857043 7.533286    0
Txti2                               6.536207 7.646131    0
Kidney Volume at Baseline and Txti2 6.550354 7.787060    0

Rsquared 
                                            Min.    1st Qu.     Median
Kidney Volume at Baseline           0.0003237652 0.02525581 0.03695319
Txti2                               0.0177893816 0.04359540 0.10855879
Kidney Volume at Baseline and Txti2 0.0163224093 0.05880114 0.19970450
                                          Mean    3rd Qu.      Max. NA's
Kidney Volume at Baseline           0.04277987 0.05047119 0.1008954    0
Txti2                               0.17123905 0.26687362 0.4193780    0
Kidney Volume at Baseline and Txti2 0.23832433 0.43143200 0.4853616    0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the RMSEs </span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>diffs <span class="ot">&lt;-</span> <span class="fu">diff</span>(results) </span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(diffs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
summary.diff.resamples(object = diffs)

p-value adjustment: bonferroni 
Upper diagonal: estimates of the difference
Lower diagonal: p-value for H0: difference = 0

MAE 
                                    Kidney Volume at Baseline Txti2  
Kidney Volume at Baseline                                     0.51029
Txti2                               0.05817                          
Kidney Volume at Baseline and Txti2 0.06738                   1.00000
                                    Kidney Volume at Baseline and Txti2
Kidney Volume at Baseline           0.55092                            
Txti2                               0.04064                            
Kidney Volume at Baseline and Txti2                                    

RMSE 
                                    Kidney Volume at Baseline Txti2  
Kidney Volume at Baseline                                     0.36588
Txti2                               0.6808                           
Kidney Volume at Baseline and Txti2 0.7453                    1.0000 
                                    Kidney Volume at Baseline and Txti2
Kidney Volume at Baseline           0.37873                            
Txti2                               0.01285                            
Kidney Volume at Baseline and Txti2                                    

Rsquared 
                                    Kidney Volume at Baseline Txti2   
Kidney Volume at Baseline                                     -0.12846
Txti2                               0.3766                            
Kidney Volume at Baseline and Txti2 0.2353                    0.2573  
                                    Kidney Volume at Baseline and Txti2
Kidney Volume at Baseline           -0.19554                           
Txti2                               -0.06709                           
Kidney Volume at Baseline and Txti2                                    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot RMSEs of each model</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dotplot</span>(results, <span class="at">metric =</span> <span class="st">"RMSE"</span>, <span class="at">main =</span> <span class="st">"Comparison of RMSE Across Models"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Model A had an RMSE that was 0.37 points higher than model B (p = 0.68), and 0.74 points higher than model C (p = 0.75)</p>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p>To evaluate whether differences in model performance were statistically significant, RMSE for each model were compared using pairwise t-tests with Bonferroni p-value correction. The differences in model performance were not statistically significant. Model A had a 0.37 higher RMSE compared to model B (p = 0.68), and a 0.38 higher RMSE compared to model C (p = 0.75).</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Model</th>
<th>RMSE</th>
<th>P-Adjusted</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1A: Baseline Kidney Volume</td>
<td>6.52</td>
<td>–</td>
<td></td>
</tr>
<tr class="even">
<td>1B: Txti2</td>
<td>6.15</td>
<td>0.68</td>
<td>—</td>
</tr>
<tr class="odd">
<td>1C Baseline Kidney Volume and Txti2</td>
<td>6.14</td>
<td>0.75</td>
<td>1.0000</td>
</tr>
</tbody>
</table>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The differences in model performance for task one were not statistically significant. Model A had an RMSE that was 0.37 points higher than model B (p = 0.68), and 0.74 points higher than model C (p = 0.75). This may be due to small sample size however.</p>
<p>Thus, including MRI image features into the predictive model did not increase predictive capability above and beyond that of just using kidney volume measurements at baseline.</p>
<p>On the other hand, if it is true that a model with baseline kidney volume, a model with <code>txti2</code> alone, and a model with both included all perform similarly at predicting percent change in kidney volume after 3 years, then this could provide support for predicting change in kidney volume percent by EITHER MRI image features or baseline kidney volume.</p>
<p>That is, utilizing MRI image features alone may offer similar predictive capabilities to using kidney volume measurements taken by a practiced physician. Therefore, if one is easier or cheaper than the other to acquire, the easier alternative could be used in place of the harder alternative and still achieve similar predictive power. For example, if there are MRI records but perhaps kidney volume measurements were not taken, then the MRI images can be used instead for making predictions.</p>
</section>
</section>
<section id="task-two-logistic-regression" class="level1">
<h1>Task Two: Logistic Regression</h1>
<p>Here we will perform the logistic regression predicting disease progression as <code>fast</code> or <code>slow</code>.</p>
<section id="2A" class="level2">
<h2 class="anchored" data-anchor-id="2A">Model 2A</h2>
<section id="baseline-kidney-volume-1" class="level3">
<h3 class="anchored" data-anchor-id="baseline-kidney-volume-1">Baseline Kidney Volume</h3>
<p>To answer the researcher’s first question for this task, we will run a predictive model that uses the baseline height-corrected total kidney volume to predict whether a patient had fast or slow disease progression.</p>
<p><span class="math display">\[ logit(Progression) = 𝛽_0 + 𝛽_{Baseline Kidney Volume} + e \]</span></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotROC)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert progression into a factor</span></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">progression_num =</span> <span class="fu">as.numeric</span>(progression)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>progression</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Slow Fast Slow Slow Fast Fast Slow Fast Slow Slow Fast Slow Fast Fast Slow
[16] Slow Slow Fast Slow Fast Fast Fast Fast Fast Slow Fast Fast Slow Fast Slow
[31] Slow Slow Slow Fast Slow Slow Slow Slow Slow Fast Fast Fast Slow Slow Fast
[46] Slow Fast Slow Fast Fast Fast Slow Slow Slow Fast Fast Fast Fast Slow Fast
[61] Slow Slow Fast Fast Slow Fast Fast
Levels: Slow Fast</code></pre>
</div>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a training control object with 5-fold cross-validation and class probabilities </span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>tc <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>, <span class="at">classProbs =</span> <span class="cn">TRUE</span>, <span class="at">summaryFunction =</span> twoClassSummary)</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the linear regression using 5-fold CV</span></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>model2a <span class="ot">&lt;-</span> <span class="fu">train</span>(progression<span class="sc">~</span> <span class="fu">log</span>(kidvol_base), </span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> data, </span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl =</span> tc,</span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">"ROC"</span>,</span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">preProc =</span> <span class="st">"scale"</span>)</span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine model</span></span>
<span id="cb218-15"><a href="#cb218-15" aria-hidden="true" tabindex="-1"></a>model2a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized Linear Model 

67 samples
 1 predictor
 2 classes: 'Slow', 'Fast' 

Pre-processing: scaled (1) 
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 54, 53, 53, 55, 53 
Resampling results:

  ROC        Sens  Spec     
  0.4746032  0.3   0.7142857</code></pre>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
NULL

Coefficients:
                   Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)         0.96887    2.93675   0.330    0.741
`log(kidvol_base)` -0.07914    0.24665  -0.321    0.748

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 92.867  on 66  degrees of freedom
Residual deviance: 92.764  on 65  degrees of freedom
AIC: 96.764

Number of Fisher Scoring iterations: 3</code></pre>
</div>
</div>
<p><code>kidvol_base_log</code> is not a significant predictor of change in kidney volume (p = 0.75).</p>
<p>The AUC for this model is 0.47, which is near guessing. The sensitivity is 0.3 and the specificity is 0.71</p>
<p><a href="#2A">Top of Tabset</a></p>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<section id="confusion-matrix" class="level4">
<h4 class="anchored" data-anchor-id="confusion-matrix">Confusion Matrix</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save predictions</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions2a <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2a, <span class="at">newdata =</span> data)</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions2a_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2a, <span class="at">newdata =</span> data, <span class="at">type =</span> <span class="st">"prob"</span>)[,<span class="dv">2</span>]</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions2a_num <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span>predictions2a_prob)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create confusion matrix</span></span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> data<span class="sc">$</span>predictions2a, <span class="at">Actual =</span> data<span class="sc">$</span>progression)</span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine confusion matrix and performance</span></span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>cm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Actual
Predicted Slow Fast
     Slow   11   11
     Fast   22   23</code></pre>
</div>
</div>
<p>We can see the poor performance clearly in the confusion matrix.</p>
</section>
<section id="roc-curve" class="level4">
<h4 class="anchored" data-anchor-id="roc-curve">ROC Curve</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ROC Curve</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>roc2a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">m =</span> predictions2a_num, <span class="at">d =</span> progression_num)) <span class="sc">+</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_roc</span>(<span class="at">n.cuts =</span> <span class="dv">10</span>, <span class="at">labels =</span> F, <span class="at">labelround =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ROC Curve Model 2A: Baseline Kidney Volume"</span>,</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"False Positive Rate"</span>,</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"True Positive Rate"</span>) <span class="sc">+</span></span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can see that the ROC curve is very poor, near guessing.</p>
</section>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<p>The model using <code>kidvol_base_log</code> alone performed poorly.</p>
<p>AUC: 0.47</p>
<p>Sensitivity: 0.3</p>
<p>Specificity: 0.71</p>
<p><a href="#2A">Top of Tabset</a></p>
</div>
</div>
</div>
</section>
</section>
<section id="2B" class="level2">
<h2 class="anchored" data-anchor-id="2B">Model 2B: MRI Image Features</h2>
<p>To answer the researcher’s second question for this task, we will run a predictive model that uses the MRI features to predict whether a patient had fast or slow disease progression.</p>
<p><span class="math display">\[ logit(Progression) = 𝛽_0 + 𝛽_{MRI Feature 1} + 𝛽_{MRI Feature 2} + ... + e \]</span></p>
<p>As the correlation matrices revealed similar relationship between the MRI image features and <code>progression</code> as they did with <code>kidvol_change</code>, we will select the same candidate covariates for Task 2 as we did for Task 1.</p>
<p>These are:</p>
<ul>
<li><code>geom_avg</code></li>
<li><code>gabor3</code></li>
<li><code>txti2</code></li>
<li><code>lbp5_log</code></li>
<li><code>glcm2_square</code></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">Model Selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-4" role="tab" aria-controls="tabset-14-4" aria-selected="false">Messing around with saturated model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-5" role="tab" aria-controls="tabset-14-5" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create variable</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>data1_train <span class="ot">&lt;-</span> data1_train <span class="sc">|&gt;</span> </span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">progression_num =</span> <span class="fu">as.numeric</span>(progression)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create model</span></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>model2b <span class="ot">&lt;-</span> <span class="fu">glm</span>(progression_num <span class="sc">~</span> geom_avg_scale <span class="sc">+</span> gabor3_scale <span class="sc">+</span> txti2_scale <span class="sc">+</span> lbp5_log_scale <span class="sc">+</span> glcm2_square_scale, <span class="at">data =</span> data1_train, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Model Summary</span></span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = progression_num ~ geom_avg_scale + gabor3_scale + 
    txti2_scale + lbp5_log_scale + glcm2_square_scale, family = "binomial", 
    data = data1_train)

Coefficients:
                   Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)         -0.1231     0.3313  -0.372  0.71018   
geom_avg_scale      -0.1339     0.3567  -0.375  0.70737   
gabor3_scale         0.8120     0.4575   1.775  0.07593 . 
txti2_scale         -1.2378     0.4499  -2.751  0.00594 **
lbp5_log_scale      -0.7129     0.3976  -1.793  0.07295 . 
glcm2_square_scale  -0.6465     0.4903  -1.318  0.18738   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 72.010  on 51  degrees of freedom
Residual deviance: 55.253  on 46  degrees of freedom
AIC: 67.253

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform backward elimination </span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_forward_sbc</span>(model2b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                              Stepwise Summary                               
---------------------------------------------------------------------------
Step    Variable        AIC       SBC         SBIC         R2       Adj. R2 
---------------------------------------------------------------------------
 0      Base Model     79.405    83.308    -66879.305    0.00000    0.00000 
 1      txti2_scale    71.935    77.789    -96068.990    0.16650    0.14983 
---------------------------------------------------------------------------

Final Model Output 
------------------

                        Model Summary                          
--------------------------------------------------------------
R                       0.408       RMSE                0.456 
R-Squared               0.167       MSE                 0.208 
Adj. R-Squared          0.150       Coef. Var          96.757 
Pred R-Squared          0.113       AIC                71.935 
MAE                     0.419       SBC                77.789 
--------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                              ANOVA                                
------------------------------------------------------------------
               Sum of                                             
              Squares        DF    Mean Square      F        Sig. 
------------------------------------------------------------------
Regression      2.161         1          2.161    9.988    0.0027 
Residual       10.819        50          0.216                    
Total          12.981        51                                   
------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)     0.487         0.065                  7.542    0.000     0.357     0.616 
txti2_scale    -0.205         0.065       -0.408    -3.160    0.003    -0.336    -0.075 
----------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<p>The model with the smallest BIC is with <code>txti2</code> alone, thus that will be our final model.</p>
<p><a href="#2B">Top of Tabset</a></p>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the linear regression using 5-fold CV</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>model2b <span class="ot">&lt;-</span> <span class="fu">train</span>(progression <span class="sc">~</span> txti2, </span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> data, </span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl =</span> tc,</span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">"ROC"</span>,</span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">preProc =</span> <span class="st">"scale"</span>)</span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine model</span></span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a>model2b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized Linear Model 

67 samples
 1 predictor
 2 classes: 'Slow', 'Fast' 

Pre-processing: scaled (1) 
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 54, 53, 53, 55, 53 
Resampling results:

  ROC        Sens       Spec     
  0.7376417  0.5666667  0.6428571</code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
NULL

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)  0.01522    0.26188   0.058  0.95364   
txti2       -0.82651    0.30174  -2.739  0.00616 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 92.867  on 66  degrees of freedom
Residual deviance: 83.741  on 65  degrees of freedom
AIC: 87.741

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p><code>txti2</code> is a significant predictor of <code>kidvol_change</code> (p = 0.0062).</p>
<p>The AUC is 0.74, the senstivity is 0.57, and the specificity is 0.64</p>
<p><a href="#2B">Top of Tabset</a></p>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<section id="confusion-matrix-1" class="level4">
<h4 class="anchored" data-anchor-id="confusion-matrix-1">Confusion Matrix</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save predictions</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions2b <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2b, <span class="at">newdata =</span> data)</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions2b_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2b, <span class="at">newdata =</span> data, <span class="at">type =</span> <span class="st">"prob"</span>)[,<span class="dv">2</span>]</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions2b_num <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span>predictions2b_prob)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create confusion matrix</span></span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> data<span class="sc">$</span>predictions2b, <span class="at">Actual =</span> data<span class="sc">$</span>progression)</span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine confusion matrix and performance</span></span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a>cm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Actual
Predicted Slow Fast
     Slow   20   12
     Fast   13   22</code></pre>
</div>
</div>
<p>We can see that we are getting more correct hits in the confusion matrix compared to using baseline kidney volume alone.</p>
<p><a href="#2B">Top of Tabset</a></p>
</section>
<section id="roc-curve-1" class="level4">
<h4 class="anchored" data-anchor-id="roc-curve-1">ROC Curve</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ROC Curve</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>roc2b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">m =</span> predictions2b_num, <span class="at">d =</span> progression_num)) <span class="sc">+</span></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_roc</span>(<span class="at">n.cuts =</span> <span class="dv">10</span>, <span class="at">labels =</span> F, <span class="at">labelround =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ROC Curve Model 2B: Txti2"</span>,</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"False Positive Rate"</span>,</span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"True Positive Rate"</span>) <span class="sc">+</span></span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Plot</span></span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true" tabindex="-1"></a>roc2b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-121-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That’s not a bad curve!</p>
<p><a href="#2B">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-14-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create variable</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geom_avg =</span> (geom1<span class="sc">+</span>geom2<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the linear regression using 5-fold CV</span></span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>model2b_sat <span class="ot">&lt;-</span> <span class="fu">train</span>(progression <span class="sc">~</span> txti2 <span class="sc">+</span> geom_avg <span class="sc">+</span> <span class="fu">log</span>(lbp5) <span class="sc">+</span> gabor3, </span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> data, </span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb236-11"><a href="#cb236-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb236-12"><a href="#cb236-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl =</span> tc,</span>
<span id="cb236-13"><a href="#cb236-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">"ROC"</span>,</span>
<span id="cb236-14"><a href="#cb236-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">preProc =</span> <span class="st">"scale"</span>)</span>
<span id="cb236-15"><a href="#cb236-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-16"><a href="#cb236-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine model</span></span>
<span id="cb236-17"><a href="#cb236-17" aria-hidden="true" tabindex="-1"></a>model2b_sat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized Linear Model 

67 samples
 4 predictor
 2 classes: 'Slow', 'Fast' 

Pre-processing: scaled (4) 
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 54, 53, 53, 55, 53 
Resampling results:

  ROC        Sens       Spec     
  0.6654195  0.6047619  0.6190476</code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2b_sat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
NULL

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept) -0.28058    0.42210  -0.665  0.50622   
txti2       -0.81344    0.31123  -2.614  0.00896 **
geom_avg    -0.01038    0.26837  -0.039  0.96915   
`log(lbp5)` -0.30809    0.29114  -1.058  0.28996   
gabor3       0.10950    0.26274   0.417  0.67686   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 92.867  on 66  degrees of freedom
Residual deviance: 82.263  on 62  degrees of freedom
AIC: 92.263

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save predictions</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions2b_sat <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2b_sat, <span class="at">newdata =</span> data)</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions2b_prob_sat <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2b_sat, <span class="at">newdata =</span> data, <span class="at">type =</span> <span class="st">"prob"</span>)[,<span class="dv">2</span>]</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions2b_num_sat <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span>predictions2b_prob_sat)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create confusion matrix</span></span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> data<span class="sc">$</span>predictions2b, <span class="at">Actual =</span> data<span class="sc">$</span>progression)</span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine confusion matrix and performance</span></span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a>cm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Actual
Predicted Slow Fast
     Slow   20   12
     Fast   13   22</code></pre>
</div>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ROC Curve</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>roc2b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">m =</span> predictions2b_num, <span class="at">d =</span> progression_num)) <span class="sc">+</span></span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_roc</span>(<span class="at">n.cuts =</span> <span class="dv">10</span>, <span class="at">labels =</span> F, <span class="at">labelround =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ROC Curve Model 2B: Txti2"</span>,</span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"False Positive Rate"</span>,</span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"True Positive Rate"</span>) <span class="sc">+</span></span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Plot</span></span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true" tabindex="-1"></a>roc2b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-122-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate area under the curve</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">calc_auc</span>(roc2b)<span class="sc">$</span>AUC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6934046</code></pre>
</div>
</div>
<p>Not that different from just txti2. I just wanted to check because I was getting the BIC backwards selection choosing this model.</p>
</div>
<div id="tabset-14-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-5-tab">
<p>Model 2B performs much better than model 2A. We can especially see this when we look at the ROC curve.</p>
<p>AUC: 0.74</p>
<p>Sensitivity: 0.57</p>
<p>Specificity: 0.64</p>
<p><a href="#2B">Top of Tabset</a></p>
</div>
</div>
</div>
</section>
<section id="2C" class="level2">
<h2 class="anchored" data-anchor-id="2C">Model 2C: Baseline Kidney Volume and MRI Image Features</h2>
<p>To answer the researcher’s third question, we will run a predictive model that uses the baseline height-corrected total kidney volume AND MRI image features to predict slow vs fast disease progression.</p>
<p><span class="math display">\[ logit(Progression) = 𝛽_0 + 𝛽_{Baseline Kidney Volume} + 𝛽_{Txti2} + ... + e \]</span></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the linear regression using 5-fold CV</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>model2c <span class="ot">&lt;-</span> <span class="fu">train</span>(progression <span class="sc">~</span> <span class="fu">log</span>(kidvol_base) <span class="sc">+</span> txti2, </span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> data, </span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl =</span> tc,</span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">"ROC"</span>,</span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">preProc =</span> <span class="st">"scale"</span>)</span>
<span id="cb245-11"><a href="#cb245-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-12"><a href="#cb245-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine model</span></span>
<span id="cb245-13"><a href="#cb245-13" aria-hidden="true" tabindex="-1"></a>model2c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized Linear Model 

67 samples
 2 predictor
 2 classes: 'Slow', 'Fast' 

Pre-processing: scaled (2) 
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 54, 53, 53, 55, 53 
Resampling results:

  ROC        Sens       Spec     
  0.7064626  0.5666667  0.5857143</code></pre>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
NULL

Coefficients:
                   Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)          3.2899     3.2933   0.999  0.31781   
`log(kidvol_base)`  -0.2757     0.2768  -0.996  0.31912   
txti2               -0.8901     0.3106  -2.866  0.00416 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 92.867  on 66  degrees of freedom
Residual deviance: 82.711  on 64  degrees of freedom
AIC: 88.711

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>The model performs similarly to using <code>txti2</code> alone.</p>
<p>The AUC is 0.71, the sensitivity is 0.57, and the specificity is 0.59</p>
<p><a href="#2C">Top of Tabset</a></p>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<section id="confusion-matrix-2" class="level4">
<h4 class="anchored" data-anchor-id="confusion-matrix-2">Confusion Matrix</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save predictions</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions2c <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2c, <span class="at">newdata =</span> data)</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions2c_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2c, <span class="at">newdata =</span> data, <span class="at">type =</span> <span class="st">"prob"</span>)[,<span class="dv">2</span>]</span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predictions2c_num <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span>predictions2c_prob)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create confusion matrix</span></span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> data<span class="sc">$</span>predictions2c, <span class="at">Actual =</span> data<span class="sc">$</span>progression)</span>
<span id="cb249-8"><a href="#cb249-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-9"><a href="#cb249-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine confusion matrix and performance</span></span>
<span id="cb249-10"><a href="#cb249-10" aria-hidden="true" tabindex="-1"></a>cm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Actual
Predicted Slow Fast
     Slow   22   13
     Fast   11   21</code></pre>
</div>
</div>
<p>Not much different than model 2.</p>
</section>
<section id="roc-curve-2" class="level4">
<h4 class="anchored" data-anchor-id="roc-curve-2">ROC Curve</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ROC Curve</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>roc2c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">m =</span> predictions2c_num, <span class="at">d =</span> progression_num)) <span class="sc">+</span></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_roc</span>(<span class="at">n.cuts =</span> <span class="dv">10</span>, <span class="at">labels =</span> F, <span class="at">labelround =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ROC Curve Model 2C: Baseline Kidney Volume and Txti2"</span>,</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"False Positive Rate"</span>,</span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"True Positive Rate"</span>) <span class="sc">+</span></span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-10"><a href="#cb251-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Plot</span></span>
<span id="cb251-11"><a href="#cb251-11" aria-hidden="true" tabindex="-1"></a>roc2c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-125-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Not much different than just using <code>txti2</code> alone.</p>
<p><a href="#2C">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<p>Model C does not appear to perform much differently than model B.</p>
<p>AUC: 0.71</p>
<p>Sensitivity: 0.57</p>
<p>Specificity is 0.59</p>
<p><a href="#2C">Top of Tabset</a></p>
</div>
</div>
</div>
</section>
<section id="model-comparison-1" class="level2">
<h2 class="anchored" data-anchor-id="model-comparison-1">Model Comparison</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create list of models to compare</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">`</span><span class="at">Kidney Volume at Baseline</span><span class="st">`</span> <span class="ot">=</span> model2a, <span class="at">Txti2 =</span> model2b, <span class="st">`</span><span class="at">Kidney Volume at Baseline and Txti2</span><span class="st">`</span> <span class="ot">=</span> model2c)</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare models</span></span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">resamples</span>(model_list)</span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
summary.resamples(object = results)

Models: Kidney Volume at Baseline, Txti2, Kidney Volume at Baseline and Txti2 
Number of resamples: 5 

ROC 
                                         Min.   1st Qu.    Median      Mean
Kidney Volume at Baseline           0.3469388 0.4081633 0.4761905 0.4746032
Txti2                               0.5555556 0.6428571 0.6938776 0.7376417
Kidney Volume at Baseline and Txti2 0.5833333 0.6428571 0.6530612 0.7064626
                                      3rd Qu.      Max. NA's
Kidney Volume at Baseline           0.5306122 0.6111111    0
Txti2                               0.7959184 1.0000000    0
Kidney Volume at Baseline and Txti2 0.6734694 0.9795918    0

Sens 
                                         Min.   1st Qu.    Median      Mean
Kidney Volume at Baseline           0.0000000 0.2857143 0.2857143 0.3000000
Txti2                               0.1428571 0.1666667 0.6666667 0.5666667
Kidney Volume at Baseline and Txti2 0.1666667 0.2857143 0.6666667 0.5666667
                                      3rd Qu. Max. NA's
Kidney Volume at Baseline           0.4285714  0.5    0
Txti2                               0.8571429  1.0    0
Kidney Volume at Baseline and Txti2 0.7142857  1.0    0

Spec 
                                         Min.   1st Qu.    Median      Mean
Kidney Volume at Baseline           0.5714286 0.5714286 0.7142857 0.7142857
Txti2                               0.4285714 0.5000000 0.7142857 0.6428571
Kidney Volume at Baseline and Txti2 0.4285714 0.4285714 0.5000000 0.5857143
                                      3rd Qu.      Max. NA's
Kidney Volume at Baseline           0.7142857 1.0000000    0
Txti2                               0.7142857 0.8571429    0
Kidney Volume at Baseline and Txti2 0.7142857 0.8571429    0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>models</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Kidney Volume at Baseline"           "Txti2"                              
[3] "Kidney Volume at Baseline and Txti2"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the AUCs </span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>diffs <span class="ot">&lt;-</span> <span class="fu">diff</span>(results) </span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(diffs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
summary.diff.resamples(object = diffs)

p-value adjustment: bonferroni 
Upper diagonal: estimates of the difference
Lower diagonal: p-value for H0: difference = 0

ROC 
                                    Kidney Volume at Baseline Txti2   
Kidney Volume at Baseline                                     -0.26304
Txti2                               0.2809                            
Kidney Volume at Baseline and Txti2 0.3134                    0.8648  
                                    Kidney Volume at Baseline and Txti2
Kidney Volume at Baseline           -0.23186                           
Txti2                                0.03118                           
Kidney Volume at Baseline and Txti2                                    

Sens 
                                    Kidney Volume at Baseline
Kidney Volume at Baseline                                    
Txti2                               0.4126                   
Kidney Volume at Baseline and Txti2 0.2756                   
                                    Txti2                 
Kidney Volume at Baseline           -0.2666666666666666630
Txti2                                                     
Kidney Volume at Baseline and Txti2 1.0000                
                                    Kidney Volume at Baseline and Txti2
Kidney Volume at Baseline           -0.2666666666666666630             
Txti2                               -0.0000000000000000111             
Kidney Volume at Baseline and Txti2                                    

Spec 
                                    Kidney Volume at Baseline Txti2  
Kidney Volume at Baseline                                     0.07143
Txti2                               1                                
Kidney Volume at Baseline and Txti2 1                         1      
                                    Kidney Volume at Baseline and Txti2
Kidney Volume at Baseline           0.12857                            
Txti2                               0.05714                            
Kidney Volume at Baseline and Txti2                                    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot RMSEs of each model</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dotplot</span>(results, <span class="at">metric =</span> <span class="st">"ROC"</span>,</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Comparison of AUC Across Models"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-126-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dotplot</span>(results, <span class="at">metric =</span> <span class="st">"Sens"</span>,</span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Comparison of Sensitivity Across Models"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-126-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dotplot</span>(results, <span class="at">metric =</span> <span class="st">"Spec"</span>,</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Comparison of Specificity Across Models"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-126-3.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The difference in performance between models was not statistically significant (report AUC’s and 95% CI’s here)</p>
</section>
<section id="results-1" class="level2">
<h2 class="anchored" data-anchor-id="results-1">Results</h2>
<p>Table 2. Results of Pairwise T-Tests Comparing Model Performance Predicting Disease Progression using AUC</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 18%">
</colgroup>
<tbody>
<tr class="odd">
<td>Model</td>
<td>AUC</td>
<td>Sensitivity</td>
<td>Specificity</td>
<td>&nbsp; P-Adjusted</td>
</tr>
<tr class="even">
<td>Baseline Kidney Volume</td>
<td>0.47</td>
<td>0.30</td>
<td>0.71</td>
<td>—</td>
</tr>
<tr class="odd">
<td>Txti2</td>
<td>0.74</td>
<td>0.57</td>
<td>0.64</td>
<td>0.28</td>
</tr>
<tr class="even">
<td>Baseline Kidney Volume and Txti2</td>
<td>0.71</td>
<td>0.57</td>
<td>0.59</td>
<td>0.31</td>
</tr>
</tbody>
</table>
</section>
<section id="summary-27" class="level2">
<h2 class="anchored" data-anchor-id="summary-27">Summary</h2>
<p>The model using <code>txti2</code> alone performed better at predicting disease progression than the model using <code>kidvol_base</code> alone. However, this difference was not statistically significant.</p>
<p>Additionally, the model incorporating both <code>txti2</code> and <code>kidvol_base</code> did not perform better than the model using just <code>txti</code>.</p>
<p>However, examining the ROC curves and the 95% CIs for all of the models, it does appear that there is a trend towards these difference being significant. It is possible that these may have not been statistically significant due to a small sample size (N = 67).</p>
</section>
</section>
<section id="results-2" class="level1">
<h1>Results</h1>
<section id="predicting-height-corrected-kidney-volume" class="level4">
<h4 class="anchored" data-anchor-id="predicting-height-corrected-kidney-volume">Predicting Height-Corrected Kidney Volume</h4>
<p>To evaluate whether differences in model performance were statistically significant, RMSE for each model were compared using pairwise t-tests with Bonferroni correction for p-values. The differences in model performance were not statistically significant (see Table 1 and Figure 1). Model A (Baseline only) had a 0.37 higher RMSE compared to model B (Txti2 only) (p = 0.68), and a 0.38 higher RMSE compared to model C (Mixed) (p = 0.75).</p>
<p><img src="images/clipboard-2391200633.png" class="img-fluid"></p>
<p><img src="images/clipboard-3668317329.png" class="img-fluid"></p>
<p><img src="images/clipboard-2980058113.png" class="img-fluid"></p>
</section>
<section id="predicting-disease-progression" class="level4">
<h4 class="anchored" data-anchor-id="predicting-disease-progression">Predicting Disease Progression</h4>
<p>To evaluate whether differences in model performance were statistically significant, AUC for each model was compared using pairwise t-test with Bonferroni correction for p-values, and ROC curves for each model were plotted (see Table 2 and Figure 2). The models using Txti2 alone (AUC = 0.74), or Txti2 and baseline kidney volume (AUC= 0.71), performed better at predicting disease progression speed than the model using baseline kidney volume alone (AUC 0.47). However, these differences were not statistically significant (p &gt; 0.05).</p>
<p><img src="images/clipboard-1453485702.png" class="img-fluid"></p>
<p><img src="images/clipboard-3181863504.png" class="img-fluid"></p>
</section>
<section id="roc-curves" class="level2">
<h2 class="anchored" data-anchor-id="roc-curves">ROC Curves</h2>
<p><a href="https://www.r-project.org/conferences/useR-2013/Tutorials/kuhn/user_caret_2up.pdf">Source</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example Data: Combine predictions into a single data frame</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>data_for_ROC <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">progression_num =</span> data<span class="sc">$</span>progression_num,  <span class="co"># Your actual outcomes</span></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Baseline Kidney Volume</span><span class="st">`</span> <span class="ot">=</span> data<span class="sc">$</span>predictions2a_num,</span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Txti2</span><span class="st">`</span> <span class="ot">=</span> data<span class="sc">$</span>predictions2b_num,</span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Baseline Kidney Volume and Txti2</span><span class="st">`</span> <span class="ot">=</span> data<span class="sc">$</span>predictions2c_num</span>
<span id="cb261-7"><a href="#cb261-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb261-8"><a href="#cb261-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-9"><a href="#cb261-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Melt the data frame for ggplot</span></span>
<span id="cb261-10"><a href="#cb261-10" aria-hidden="true" tabindex="-1"></a>data_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_for_ROC, <span class="at">id.vars =</span> <span class="st">"progression_num"</span>, <span class="at">variable.name =</span> <span class="st">"model"</span>, <span class="at">value.name =</span> <span class="st">"predictions"</span>)</span>
<span id="cb261-11"><a href="#cb261-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-12"><a href="#cb261-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ROC Curves</span></span>
<span id="cb261-13"><a href="#cb261-13" aria-hidden="true" tabindex="-1"></a>roc_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_melted, <span class="fu">aes</span>(<span class="at">m =</span> predictions, <span class="at">d =</span> progression_num, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb261-14"><a href="#cb261-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_roc</span>(<span class="at">n.cuts =</span> <span class="dv">10</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">labelround =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb261-15"><a href="#cb261-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb261-16"><a href="#cb261-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ROC Curves for Models Predicting Kidney Disease Progression"</span>,</span>
<span id="cb261-17"><a href="#cb261-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"False Positive Rate"</span>,</span>
<span id="cb261-18"><a href="#cb261-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb261-19"><a href="#cb261-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Model"</span>) <span class="sc">+</span></span>
<span id="cb261-20"><a href="#cb261-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb261-21"><a href="#cb261-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb261-22"><a href="#cb261-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span>
<span id="cb261-23"><a href="#cb261-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-24"><a href="#cb261-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Plot</span></span>
<span id="cb261-25"><a href="#cb261-25" aria-hidden="true" tabindex="-1"></a>roc_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_3_Predictive_Modelling_files/figure-html/unnamed-chunk-127-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<p>Note: Discussion section co-written with project partner Dominick DeMarsico.</p>
<p>After review of the many MRI image transformations available to the team, none of the feature engineering conducted stood out as particularly meaningful or helpful for prediction. However, the Txti2 variable was specifically created by the PI to be a summary value for kidney images. To avoid overfitting, we thought it best to primarily focus on this variable as our other variables of interest were not particularly associated with the outcome variables. With regard to our linear regression modeling, we found that none of the models were statistically better at predicting kidney change over time. Thus, including MRI image features did not increase the predictive capability of a model predicting kidney volume at 3 years above and beyond that of just using kidney volume measurements at baseline. Given the time and money needed to both collect MRI images and process them into usable formats, it may be more efficient to simply focus on measuring kidney volume in children with ADPKD. Given this outcome, we fail to reject the null hypothesis or question 1.</p>
<p>With regard to our logistic regression, we found that none of the models were statistically different from one another when comparing AUC. However, the combined model and the model containing solely Txti2 were approaching significance when compared to the baseline kidney volume in a Two Sample T-Test (figure 2.). Given our small sample size, it is possible that a larger N would lead to this effect becoming statistically significant. Thus, even though we failed to reject the null hypothesis for our given sample size, utilizing the MRI image feature of Txti2 in our model allows us to achieve an AUC of &gt; 0.70, yielding drastically better performance than the near-guess level performance of the model using baseline kidney volume alone (AUC = 0.47). Additionally, we believe this stark trend to be clinically significant as it provides significantly better outcomes at the higher end of the confidence interval.</p>
<p>The study’s primary limitation is sample size. It is difficult to make exceptionally accurate models without exceptionally large amounts of data; we would expect a higher degree of accuracy if our N was significantly larger. Additionally, we were not given demographic variables for subject sex, age, and eGFR (estimated glomerular filtration rate), which are significant predictors of ADPKD. We suspect that these additional factors in conjunction with the MRI image feature Txti2 would produce a more robust model.</p>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p><span class="citation" data-cites="fogel1989">(<a href="#ref-fogel1989" role="doc-biblioref">Fogel and Sagi 1989</a>)</span> [<span class="citation" data-cites="kumar2020">Kumar, Satyanarayana, and Prasad (<a href="#ref-kumar2020" role="doc-biblioref">2020</a>)</span>]<span class="citation" data-cites="haralick1973">(<a href="#ref-haralick1973" role="doc-biblioref">Haralick, Shanmugam, and Dinstein 1973</a>)</span> <span class="citation" data-cites="ojala2002">(<a href="#ref-ojala2002" role="doc-biblioref">Ojala, Pietikainen, and Maenpaa 2002</a>)</span></p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-fogel1989" class="csl-entry" role="listitem">
Fogel, I., and D. Sagi. 1989. <span>“Gabor Filters as Texture Discriminator.”</span> <em>Biological Cybernetics</em> 61 (2): 103–13. <a href="https://doi.org/10.1007/bf00204594">https://doi.org/10.1007/bf00204594</a>.
</div>
<div id="ref-haralick1973" class="csl-entry" role="listitem">
Haralick, Robert M., K. Shanmugam, and Its’Hak Dinstein. 1973. <span>“Textural Features for Image Classification.”</span> <em>IEEE Transactions on Systems, Man, and Cybernetics</em> SMC-3 (6): 610–21. <a href="https://doi.org/10.1109/tsmc.1973.4309314">https://doi.org/10.1109/tsmc.1973.4309314</a>.
</div>
<div id="ref-kumar2020" class="csl-entry" role="listitem">
Kumar, D. Maruthi, D. Satyanarayana, and M. N. Giri Prasad. 2020. <span>“An Improved Gabor Wavelet Transform and Rough K-Means Clustering Algorithm for MRI Brain Tumor Image Segmentation.”</span> <em>Multimedia Tools and Applications</em> 80 (5): 6939–57. <a href="https://doi.org/10.1007/s11042-020-09635-6">https://doi.org/10.1007/s11042-020-09635-6</a>.
</div>
<div id="ref-ojala2002" class="csl-entry" role="listitem">
Ojala, T., M. Pietikainen, and T. Maenpaa. 2002. <span>“Multiresolution Gray-Scale and Rotation Invariant Texture Classification with Local Binary Patterns.”</span> <em>IEEE Transactions on Pattern Analysis and Machine Intelligence</em> 24 (7): 971–87. <a href="https://doi.org/10.1109/tpami.2002.1017623">https://doi.org/10.1109/tpami.2002.1017623</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/svieau\.quarto\.pub\/portfolio");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>