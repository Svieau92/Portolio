<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sean Vieau">
<meta name="dcterms.date" content="2024-09-09">

<title>Advanced Data Analysis - Project 1 – Sean Vieau Portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

<link href="../../site_libs/table1-1.0/table1_defaults.css" rel="stylesheet">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Sean Vieau Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-advanced-data-analyses" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Advanced Data Analyses</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-advanced-data-analyses">    
        <li>
    <a class="dropdown-item" href="../../Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html">
 <span class="dropdown-text">Regression (R)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../_site/Project_1_Regression/Project_1_Regression_SAS/Project_1_Regression_SAS.html">
 <span class="dropdown-text">Regression (SAS)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Project_2/Project_2_R/Code/Project2.html">
 <span class="dropdown-text">Regression with Moderator (R)</span></a>
  </li>  
        <li class="dropdown-header">Regression with Moderator (SAS)</li>
    </ul>
  </li>
  <li class="nav-item">
    <span class="nav-link">
<span class="menu-text">Data Wrangling</span>
    </span>
  </li>  
  <li class="nav-item">
    <span class="nav-link">
<span class="menu-text">Clinical Research Informatics</span>
    </span>
  </li>  
  <li class="nav-item">
    <span class="nav-link">
<span class="menu-text">CV</span>
    </span>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a>
  <ul class="collapse">
  <li><a href="#variables" id="toc-variables" class="nav-link" data-scroll-target="#variables">Variables</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#Data_Management" id="toc-Data_Management" class="nav-link" data-scroll-target="#Data_Management">Data Management and Variable Creation</a>
  <ul class="collapse">
  <li><a href="#Descriptives" id="toc-Descriptives" class="nav-link" data-scroll-target="#Descriptives">Descriptive Statistics</a></li>
  <li><a href="#Preliminary" id="toc-Preliminary" class="nav-link" data-scroll-target="#Preliminary">Preliminary Evaluation of Assumptions</a></li>
  <li><a href="#Exploratory" id="toc-Exploratory" class="nav-link" data-scroll-target="#Exploratory">Exploratory Data Analysis</a></li>
  </ul></li>
  <li><a href="#data-analysis" id="toc-data-analysis" class="nav-link" data-scroll-target="#data-analysis">Data Analysis</a>
  <ul class="collapse">
  <li><a href="#Model_1" id="toc-Model_1" class="nav-link" data-scroll-target="#Model_1">Running the Model</a></li>
  <li><a href="#Assumptions" id="toc-Assumptions" class="nav-link" data-scroll-target="#Assumptions">Evaluating Assumptions</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  <li><a href="#bonus-practice" id="toc-bonus-practice" class="nav-link" data-scroll-target="#bonus-practice">Bonus / Practice</a>
  <ul class="collapse">
  <li><a href="#Multiple_imputation" id="toc-Multiple_imputation" class="nav-link" data-scroll-target="#Multiple_imputation">Multiple Imputation</a></li>
  <li><a href="#Jackknife" id="toc-Jackknife" class="nav-link" data-scroll-target="#Jackknife">Identify Outliers using Jackknife Residuals</a></li>
  </ul></li>
  <li><a href="#to-do-list" id="toc-to-do-list" class="nav-link" data-scroll-target="#to-do-list">To do List</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Advanced Data Analysis - Project 1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sean Vieau </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 9, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The aim of the current study is to assess whether a new gel treatment for gum disease results in lower whole-mouth average pocket depth and attachment loss after one year. Average pocket depth and attachment loss were taken at baseline, and participants were assigned into one of five groups (1 = placebo, 2 = no treatment, 3 = low concentration, 4 = medium concentration, 5 = high concentration) and instructed to apply the gel to their gums twice a day. After 1-year, average pocket depth and attachment loss were recorded again. Data was received as a .csv file containing treatment level, average pocket depth and attachment loss at baseline and at one-year, demographic information, gender, age, number of sites measured, and smoking status. The clinical hypothesis is that average pocket depth and attachment loss in participants who applied the gel will be lower compared to participants who did not. Gender, age, ethnicity, and smoking status will be investigated as potential covariates.</p>
<p>The project description provided by the PI is available below:</p>
<p><img src="Media/Project-1-Description.png" class="img-fluid"></p>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">Data Preparation</h2>
<p>First we begin by loading in the necessary packages</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co"># This lets me pretty print the tables</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar) <span class="co"># Used to visualize missing data</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue) <span class="co"># This is used for f-strings in R</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr) <span class="co"># Used for summary tables</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot) <span class="co"># Used to make the correlation matrix</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrtable) <span class="co"># used to make the table for the correlation matrix</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable) <span class="co"># Used to make the table for the correlation matrix</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlTable) <span class="co"># Used to make Table 1</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot) <span class="co"># Used to make Table 1</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(table1) <span class="co"># Used to make Table 1</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) <span class="co"># Used to generate publication quality tables for regressions</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice) <span class="co"># Used for multiple imputation</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car) <span class="co"># Used for outlier diagnostics with jackknife residuals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we will import the dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">sviea</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">Advanced Data Analysis</span><span class="sc">\\</span><span class="st">Project 1 MLR with Covariates</span><span class="sc">\\</span><span class="st">Project1_data.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"id"</span> <span class="co"># Renaming the weird character out of this colname</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And visualize the dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a nicely formatted table, code adapted from ChatGPT</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(data), <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">trtgroup</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">race</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">smoker</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sites</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attachbase</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attach1year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pdbase</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pd1year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">101</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">44.57221</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">2.432099</td>
<td style="text-align: right;">2.577640</td>
<td style="text-align: right;">3.246914</td>
<td style="text-align: right;">3.407407</td>
</tr>
<tr class="even">
<td style="text-align: right;">102</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">35.57290</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">2.543210</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3.006173</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">103</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">47.94524</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">2.881944</td>
<td style="text-align: right;">3.076389</td>
<td style="text-align: right;">3.118056</td>
<td style="text-align: right;">3.125000</td>
</tr>
<tr class="even">
<td style="text-align: right;">104</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">55.17864</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">4.956522</td>
<td style="text-align: right;">5.304348</td>
<td style="text-align: right;">5.217391</td>
<td style="text-align: right;">4.891304</td>
</tr>
<tr class="odd">
<td style="text-align: right;">105</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">43.79740</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">1.773810</td>
<td style="text-align: right;">1.452381</td>
<td style="text-align: right;">3.363095</td>
<td style="text-align: right;">2.898810</td>
</tr>
<tr class="even">
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">42.14921</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">2.369048</td>
<td style="text-align: right;">1.922619</td>
<td style="text-align: right;">3.910714</td>
<td style="text-align: right;">3.083333</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Acquire number of variables and observations of the data set</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 130  11</code></pre>
</div>
</div>
<p>Our data set is comprised of 130 observations, with 11 variables</p>
<section id="variables" class="level3">
<h3 class="anchored" data-anchor-id="variables">Variables</h3>
<p>The variables in the provided data set are as follows:</p>
<ul>
<li><u>id:</u> Patient ID</li>
<li><u>trtgroup</u>: Treatment group (1 = placebo, 2 = no treatment control, 3 = low concentration, 4 = medium concentration, 5 = high concentration gel)</li>
<li><u>gender</u>: Gender (1 = male, 2 = female)</li>
<li><u>race</u>: Race, (1 = Native American, 2 = African American, 3 = Not used, 4 = Asian, 5 = White)</li>
<li><u>age</u>: Age in years</li>
<li><u>smoker</u>: Smoking status (0 = No, 1 = Yes)</li>
<li><u>sites</u>: Number of sites gum measurements were averaged from</li>
<li><u>attachbase</u>: Whole-mouth average attachment loss taken at base timepoint</li>
<li><u>attach1year</u>: Whole-mouth average attachment loss after 1 year</li>
<li><u>pdbase</u>: Whole-mouth average pocket loss at base timepoint</li>
<li><u>pd1year</u>: Whole-mouth average pocket loss after 1 year</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pocket depth and attachment loss are both measurements of how far the gums have pulled away from the teeth, hence <em>smaller values are better</em></p>
</div>
</div>
</section>
</section>
</section>
<section id="Data_Management" class="level1">
<h1>Data Management and Variable Creation</h1>
<p>Here we will perform several assessments to ensure fidelity of the data</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Erroneous Data Entry</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Outliers</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Variable Creation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Missingness</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>First we will perform a simple check to assess for correct entry of data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to summarize each column</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>summarize_column <span class="ot">&lt;-</span> <span class="cf">function</span>(column) {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min =</span> <span class="fu">min</span>(column, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max =</span> <span class="fu">max</span>(column, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to each column and bind the results into a single data frame</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>summary_df <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(data, summarize_column, <span class="at">.id =</span> <span class="st">"Column"</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print the table</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(summary_df, <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Column</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: right;">101.0000000</td>
<td style="text-align: right;">270.000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">trtgroup</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">5.000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gender</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">2.000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">race</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">5.000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">28.5722108</td>
<td style="text-align: right;">74.532512</td>
</tr>
<tr class="even">
<td style="text-align: left;">smoker</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sites</td>
<td style="text-align: right;">114.0000000</td>
<td style="text-align: right;">168.000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">attachbase</td>
<td style="text-align: right;">0.8950617</td>
<td style="text-align: right;">5.089286</td>
</tr>
<tr class="odd">
<td style="text-align: left;">attach1year</td>
<td style="text-align: right;">0.8653846</td>
<td style="text-align: right;">5.304348</td>
</tr>
<tr class="even">
<td style="text-align: left;">pdbase</td>
<td style="text-align: right;">2.2628205</td>
<td style="text-align: right;">5.217391</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pd1year</td>
<td style="text-align: right;">1.9642857</td>
<td style="text-align: right;">4.891304</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>All of these values look believable, and we can conclude that there was at least no grievous mistake during data entry (e.g.&nbsp;no participants with attachment losses of 55, or ages of 180, etc.)</p>
<p><a href="#Data_Management">Back to top of tabset</a></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>First we will make a visual inspection for outliers using boxplots</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize data to identify outliers</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="do">#### Outlier code modified from Joey Kim's code</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This code creates a boxplot for the dvs, and labels the values of any outliers</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>outlier_attachbase <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(data<span class="sc">$</span>attachbase, <span class="at">main =</span> <span class="st">"Boxplot for Attachment Loss at baseline"</span>)<span class="sc">$</span>out</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="fl">1.2</span>, <span class="fu">length</span>(outlier_attachbase)),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> outlier_attachbase, <span class="at">labels =</span> outlier_attachbase, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeating for attachment loss at 1 year</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>outlier_attach1year <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(data<span class="sc">$</span>attach1year, <span class="at">main =</span> <span class="st">"Boxplot for Attachment Loss at 1 year"</span>)<span class="sc">$</span>out</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="fl">1.2</span>, <span class="fu">length</span>(outlier_attach1year)),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> outlier_attach1year, <span class="at">labels =</span> outlier_attach1year, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeating for pocket depth at base</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>outlier_pdbase <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(data<span class="sc">$</span>pdbase, <span class="at">main =</span> <span class="st">"Boxplot for Pocket Depth at baseline"</span>)<span class="sc">$</span>out</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="fl">1.2</span>, <span class="fu">length</span>(outlier_pdbase)),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> outlier_pdbase, <span class="at">labels =</span> outlier_pdbase, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeating for pocket depth at 1 year</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>outlier_pd1year <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(data<span class="sc">$</span>pd1year, <span class="at">main =</span> <span class="st">"Boxplot for Pocket Depth at 1 year"</span>)<span class="sc">$</span>out</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="fl">1.2</span>, <span class="fu">length</span>(outlier_pd1year)),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> outlier_pd1year, <span class="at">labels =</span> outlier_pd1year, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interestingly, there are 3 outliers for attachment loss at base, and only 1 after 1 year. Likewise, there are 4 outliers for pocket depth at base, but only 1 at 1 year. These outlier participants may have dropped out of the study or have missing values, or their values have returned to be within 3 SDs of the mean values. It will be important to assess this!</p>
<p>Outliers will be assessed statistically later using the jackknife residuals. A value will be considered an outlier if the jackknife residual is outside of the range of +/- 3, and has high leverage and influence in the model.</p>
<p><a href="#Data_Management">Back to top of tabset</a></p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Since we have two timepoints of both attachment loss and pocket depth loss, it will make the most sense to create a change score for each measurement and use those as the dependent variable. This will make the analysis significantly easier to perform and understand/explain, while still being an accurate analysis.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>attachchange and pdchange are coded such that <em>higher scores signify a greater loss over time</em></p>
</div>
</div>
<p>For example, for subject 101:</p>
<p><span class="math display">\[
2.577(1 year)-2.43(base) = 0.14 5 (change in attachment loss)
\]</span></p>
<p>Negative values mean that attachment loss/ pocket depth <em>IMPROVED</em> for that participant (i.e., they gained gum attachment back)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new variables for the change score of attachment loss and pocket depth </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"attachchange"</span>] <span class="ot">&lt;-</span> data[<span class="st">"attach1year"</span>] <span class="sc">-</span> data[<span class="st">"attachbase"</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"pdchange"</span>] <span class="ot">&lt;-</span> data[<span class="st">"pd1year"</span>] <span class="sc">-</span> data[<span class="st">"pdbase"</span>]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that our change scores are added correctly to the dataframe</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(data), <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">trtgroup</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">race</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">smoker</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sites</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attachbase</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attach1year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pdbase</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pd1year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attachchange</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pdchange</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">101</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">44.57221</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">2.432099</td>
<td style="text-align: right;">2.577640</td>
<td style="text-align: right;">3.246914</td>
<td style="text-align: right;">3.407407</td>
<td style="text-align: right;">0.1455410</td>
<td style="text-align: right;">0.1604938</td>
</tr>
<tr class="even">
<td style="text-align: right;">102</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">35.57290</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">2.543210</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3.006173</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">103</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">47.94524</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">2.881944</td>
<td style="text-align: right;">3.076389</td>
<td style="text-align: right;">3.118056</td>
<td style="text-align: right;">3.125000</td>
<td style="text-align: right;">0.1944444</td>
<td style="text-align: right;">0.0069444</td>
</tr>
<tr class="even">
<td style="text-align: right;">104</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">55.17864</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">4.956522</td>
<td style="text-align: right;">5.304348</td>
<td style="text-align: right;">5.217391</td>
<td style="text-align: right;">4.891304</td>
<td style="text-align: right;">0.3478261</td>
<td style="text-align: right;">-0.3260870</td>
</tr>
<tr class="odd">
<td style="text-align: right;">105</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">43.79740</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">1.773810</td>
<td style="text-align: right;">1.452381</td>
<td style="text-align: right;">3.363095</td>
<td style="text-align: right;">2.898810</td>
<td style="text-align: right;">-0.3214286</td>
<td style="text-align: right;">-0.4642857</td>
</tr>
<tr class="even">
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">42.14921</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">2.369048</td>
<td style="text-align: right;">1.922619</td>
<td style="text-align: right;">3.910714</td>
<td style="text-align: right;">3.083333</td>
<td style="text-align: right;">-0.4464286</td>
<td style="text-align: right;">-0.8273810</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>I am curious to look at the outliers for our change scores</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating boxplots to examine outliers for attachment loss change scores</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>outlier_attachchange <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(data<span class="sc">$</span>attachchange, <span class="at">main =</span> <span class="st">"Boxplot for Attachment Loss Change Score"</span>)<span class="sc">$</span>out</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="fl">1.2</span>, <span class="fu">length</span>(outlier_attachchange)),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> outlier_attachchange, <span class="at">labels =</span> outlier_attachchange, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating boxplots to examine outliers for pocket depth change scores</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>outlier_pdchange <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(data<span class="sc">$</span>pdchange, <span class="at">main =</span> <span class="st">"Boxplot for Pocket Depth Change Score"</span>)<span class="sc">$</span>out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: no outliers for this variable, commenting out the following code as it throws an error message as a result and prevents the code from knitting.</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># text(x = rep(1.2, length(outlier_pdchange)),</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#      y = outlier_pdchange, labels = outlier_pdchange, col = 'red', cex = 0.8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Interestingly, there are no outliers for pocket depth change, and 3 for attachment loss change.</p>
<p>We will also need to create dummy codes all categorical values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding dummy codes for all categorical variables with &gt;2 levels</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>placebo <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>trtgroup <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>control <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>trtgroup <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>low <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>trtgroup <span class="sc">==</span> <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>medium <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>trtgroup <span class="sc">==</span> <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>high <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>trtgroup <span class="sc">==</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>trt <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>trtgroup <span class="sc">==</span> <span class="dv">3</span> <span class="sc">|</span> data<span class="sc">$</span>trtgroup <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> data<span class="sc">$</span>trtgroup <span class="sc">==</span><span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># Collapsing all treatment levels into one category of treatment</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>trt3groups <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>trtgroup <span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(data<span class="sc">$</span>trtgroup <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(data), <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">trtgroup</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">race</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">smoker</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sites</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attachbase</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attach1year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pdbase</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pd1year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attachchange</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pdchange</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">placebo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">control</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">medium</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">high</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">trt</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">trt3groups</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">101</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">44.57221</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">2.432099</td>
<td style="text-align: right;">2.577640</td>
<td style="text-align: right;">3.246914</td>
<td style="text-align: right;">3.407407</td>
<td style="text-align: right;">0.1455410</td>
<td style="text-align: right;">0.1604938</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">102</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">35.57290</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">2.543210</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3.006173</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">103</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">47.94524</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">2.881944</td>
<td style="text-align: right;">3.076389</td>
<td style="text-align: right;">3.118056</td>
<td style="text-align: right;">3.125000</td>
<td style="text-align: right;">0.1944444</td>
<td style="text-align: right;">0.0069444</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">104</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">55.17864</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">4.956522</td>
<td style="text-align: right;">5.304348</td>
<td style="text-align: right;">5.217391</td>
<td style="text-align: right;">4.891304</td>
<td style="text-align: right;">0.3478261</td>
<td style="text-align: right;">-0.3260870</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">105</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">43.79740</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">1.773810</td>
<td style="text-align: right;">1.452381</td>
<td style="text-align: right;">3.363095</td>
<td style="text-align: right;">2.898810</td>
<td style="text-align: right;">-0.3214286</td>
<td style="text-align: right;">-0.4642857</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">42.14921</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">2.369048</td>
<td style="text-align: right;">1.922619</td>
<td style="text-align: right;">3.910714</td>
<td style="text-align: right;">3.083333</td>
<td style="text-align: right;">-0.4464286</td>
<td style="text-align: right;">-0.8273810</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><a href="#Data_Management">Back to top of tabset</a></p>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>Here we will investigate the missingness of the dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print number of missing data for each column </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(data)), <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">col.names =</span> <span class="st">"Missing"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Missing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">trtgroup</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gender</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">race</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">smoker</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sites</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">attachbase</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">attach1year</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="even">
<td style="text-align: left;">pdbase</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pd1year</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="even">
<td style="text-align: left;">attachchange</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pdchange</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="even">
<td style="text-align: left;">placebo</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">control</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">low</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">medium</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">high</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trt</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">trt3groups</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here is a handy package that lets us visualize missing data</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There is 1 missing value for age and smoking status, and 27 missing values for the one year measurements of attachment loss and pocket depth.</p>
<p>This is 27/130 = 20.77% of our sample size, quite large! We will still have 103 participants, which should be sufficient to run our analysis if there are 20-30 participants in each condition. Let’s check</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new dataframe that removes participants with NA outcome variables</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>data_missing <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(pdchange, attachchange)) </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 103  20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of participants in each group</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>group_counts <span class="ot">&lt;-</span> data_missing <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(trtgroup)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(group_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  trtgroup  n
1        1 23
2        2 23
3        3 21
4        4 20
5        5 16</code></pre>
</div>
</div>
<p>There are only 16 participants in the high concentrations (5) group.</p>
<p>This could cause problems! We will either have to combine all the treatment conditions into one group, or perform some multiple imputations to handle the missing data. This will have to be noted in the discussion.</p>
<p>See <a href="#Multiple_imputation">Multiple Imputation section</a> for analysis with multiple imputation.</p>
<p><a href="#Data_Management">Back to top of tabset</a></p>
</div>
</div>
</div>
<section id="Descriptives" class="level2">
<h2 class="anchored" data-anchor-id="Descriptives">Descriptive Statistics</h2>
<p>Here we will acquire the descriptive statistics of our data set and create Table 1. Code modified from <a href="https://cran.r-project.org/web/packages/table1/vignettes/table1-examples.html">cran.r-project.org</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Duplicate the dataset so we are not modifying the original</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> data</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor the basic variables that we're interested in</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>data2<span class="sc">$</span>trtgroup <span class="ot">&lt;-</span> <span class="fu">factor</span>(data2<span class="sc">$</span>trtgroup,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Placebo"</span>, <span class="st">"Control"</span>, <span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>data2<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(data2<span class="sc">$</span>gender,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>))</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>data2<span class="sc">$</span>race <span class="ot">&lt;-</span> <span class="fu">factor</span>(data2<span class="sc">$</span>race,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>),</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Native American"</span>, <span class="st">"African American"</span>, <span class="st">"White"</span>, <span class="st">"Asian"</span>))</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                             </span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>data2<span class="sc">$</span>smoker <span class="ot">&lt;-</span> <span class="fu">factor</span>(data2<span class="sc">$</span>smoker,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Non-Smoker"</span>, <span class="st">"Smoker"</span>))</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create labels to make the names of each variable more professional</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data2<span class="sc">$</span>gender) <span class="ot">&lt;-</span> <span class="st">"Gender"</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data2<span class="sc">$</span>race) <span class="ot">&lt;-</span> <span class="st">"Race"</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data2<span class="sc">$</span>age) <span class="ot">&lt;-</span> <span class="st">"Age (Years)"</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data2<span class="sc">$</span>smoker) <span class="ot">&lt;-</span> <span class="st">"Smoking Status"</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data2<span class="sc">$</span>sites) <span class="ot">&lt;-</span> <span class="st">"Sites"</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data2<span class="sc">$</span>attachbase) <span class="ot">&lt;-</span> <span class="st">"Attachment Loss at Baseline"</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data2<span class="sc">$</span>attach1year) <span class="ot">&lt;-</span> <span class="st">"Attachment Loss at 1 Year"</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data2<span class="sc">$</span>pdbase) <span class="ot">&lt;-</span> <span class="st">"Pocket Depth at Baseline"</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data2<span class="sc">$</span>pd1year) <span class="ot">&lt;-</span> <span class="st">"Pocket Depth at 1 Year"</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data2<span class="sc">$</span>attachchange) <span class="ot">&lt;-</span> <span class="st">"Attachment Loss Change"</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data2<span class="sc">$</span>pdchange) <span class="ot">&lt;-</span> <span class="st">"Pocket Depth Change"</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table 1</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> <span class="fu">table1</span>(<span class="sc">~</span> gender <span class="sc">+</span> race <span class="sc">+</span> age <span class="sc">+</span> smoker <span class="sc">+</span> sites <span class="sc">+</span> attachbase <span class="sc">+</span> attach1year <span class="sc">+</span> pdbase <span class="sc">+</span> pd1year <span class="sc">+</span> attachchange <span class="sc">+</span> pdchange<span class="sc">|</span> trtgroup,  <span class="at">data =</span> data2, <span class="at">caption =</span> <span class="st">"Descriptive Statistics"</span>, <span class="at">overall =</span> <span class="fu">c</span>(<span class="at">left=</span><span class="st">"Total"</span>))</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="Rtable1">
<table class="Rtable1 caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Descriptive Statistics</caption>
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th class="rowlabel firstrow lastrow" data-quarto-table-cell-role="th"></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">Total<br>
<span class="stratn">(N=130)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">Placebo<br>
<span class="stratn">(N=26)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">Control<br>
<span class="stratn">(N=26)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">Low<br>
<span class="stratn">(N=26)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">Medium<br>
<span class="stratn">(N=26)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">High<br>
<span class="stratn">(N=26)</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowlabel firstrow">Gender</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Male</td>
<td>54 (41.5%)</td>
<td>11 (42.3%)</td>
<td>10 (38.5%)</td>
<td>11 (42.3%)</td>
<td>11 (42.3%)</td>
<td>11 (42.3%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Female</td>
<td class="lastrow">76 (58.5%)</td>
<td class="lastrow">15 (57.7%)</td>
<td class="lastrow">16 (61.5%)</td>
<td class="lastrow">15 (57.7%)</td>
<td class="lastrow">15 (57.7%)</td>
<td class="lastrow">15 (57.7%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Race</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Native American</td>
<td>4 (3.1%)</td>
<td>0 (0%)</td>
<td>1 (3.8%)</td>
<td>1 (3.8%)</td>
<td>0 (0%)</td>
<td>2 (7.7%)</td>
</tr>
<tr class="even">
<td class="rowlabel">African American</td>
<td>9 (6.9%)</td>
<td>2 (7.7%)</td>
<td>1 (3.8%)</td>
<td>5 (19.2%)</td>
<td>0 (0%)</td>
<td>1 (3.8%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">White</td>
<td>3 (2.3%)</td>
<td>1 (3.8%)</td>
<td>1 (3.8%)</td>
<td>0 (0%)</td>
<td>1 (3.8%)</td>
<td>0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Asian</td>
<td class="lastrow">114 (87.7%)</td>
<td class="lastrow">23 (88.5%)</td>
<td class="lastrow">23 (88.5%)</td>
<td class="lastrow">20 (76.9%)</td>
<td class="lastrow">25 (96.2%)</td>
<td class="lastrow">23 (88.5%)</td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Age (Years)</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>49.9 (10.0)</td>
<td>47.1 (8.61)</td>
<td>50.7 (9.90)</td>
<td>51.9 (10.8)</td>
<td>49.0 (9.49)</td>
<td>50.8 (11.2)</td>
</tr>
<tr class="odd">
<td class="rowlabel">Median [Min, Max]</td>
<td>48.6 [28.6, 74.5]</td>
<td>44.7 [30.4, 67.1]</td>
<td>49.2 [36.1, 73.3]</td>
<td>51.5 [36.9, 71.9]</td>
<td>48.1 [28.6, 70.9]</td>
<td>49.9 [34.1, 74.5]</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">1 (0.8%)</td>
<td class="lastrow">1 (3.8%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Smoking Status</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Non-Smoker</td>
<td>81 (62.3%)</td>
<td>15 (57.7%)</td>
<td>17 (65.4%)</td>
<td>18 (69.2%)</td>
<td>14 (53.8%)</td>
<td>17 (65.4%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">Smoker</td>
<td>48 (36.9%)</td>
<td>11 (42.3%)</td>
<td>9 (34.6%)</td>
<td>8 (30.8%)</td>
<td>11 (42.3%)</td>
<td>9 (34.6%)</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">1 (0.8%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">1 (3.8%)</td>
<td class="lastrow">0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Sites</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>158 (11.3)</td>
<td>160 (10.1)</td>
<td>154 (10.9)</td>
<td>161 (8.54)</td>
<td>155 (15.7)</td>
<td>157 (9.65)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Median [Min, Max]</td>
<td class="lastrow">162 [114, 168]</td>
<td class="lastrow">162 [138, 168]</td>
<td class="lastrow">159 [126, 168]</td>
<td class="lastrow">162 [138, 168]</td>
<td class="lastrow">162 [114, 168]</td>
<td class="lastrow">159 [138, 168]</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Attachment Loss at Baseline</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Mean (SD)</td>
<td>2.15 (0.797)</td>
<td>1.79 (0.646)</td>
<td>2.46 (0.687)</td>
<td>2.07 (0.987)</td>
<td>2.17 (0.656)</td>
<td>2.24 (0.858)</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Median [Min, Max]</td>
<td class="lastrow">2.03 [0.895, 5.09]</td>
<td class="lastrow">1.71 [0.899, 3.64]</td>
<td class="lastrow">2.48 [1.22, 4.39]</td>
<td class="lastrow">1.77 [0.895, 4.96]</td>
<td class="lastrow">2.12 [1.02, 4.01]</td>
<td class="lastrow">1.97 [1.26, 5.09]</td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Attachment Loss at 1 Year</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>2.10 (0.772)</td>
<td>1.74 (0.542)</td>
<td>2.33 (0.551)</td>
<td>2.08 (1.06)</td>
<td>2.24 (0.652)</td>
<td>2.15 (0.915)</td>
</tr>
<tr class="odd">
<td class="rowlabel">Median [Min, Max]</td>
<td>1.98 [0.865, 5.30]</td>
<td>1.64 [0.964, 3.10]</td>
<td>2.23 [1.46, 3.49]</td>
<td>1.74 [0.865, 5.30]</td>
<td>2.25 [1.35, 3.83]</td>
<td>1.71 [1.22, 4.04]</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">27 (20.8%)</td>
<td class="lastrow">3 (11.5%)</td>
<td class="lastrow">3 (11.5%)</td>
<td class="lastrow">5 (19.2%)</td>
<td class="lastrow">6 (23.1%)</td>
<td class="lastrow">10 (38.5%)</td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Pocket Depth at Baseline</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>3.14 (0.437)</td>
<td>3.09 (0.372)</td>
<td>3.28 (0.473)</td>
<td>3.17 (0.593)</td>
<td>3.05 (0.402)</td>
<td>3.11 (0.273)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Median [Min, Max]</td>
<td class="lastrow">3.10 [2.26, 5.22]</td>
<td class="lastrow">3.11 [2.47, 4.08]</td>
<td class="lastrow">3.11 [2.65, 4.77]</td>
<td class="lastrow">3.07 [2.26, 5.22]</td>
<td class="lastrow">3.09 [2.42, 3.91]</td>
<td class="lastrow">3.14 [2.62, 3.60]</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Pocket Depth at 1 Year</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Mean (SD)</td>
<td>2.88 (0.488)</td>
<td>2.75 (0.482)</td>
<td>2.95 (0.455)</td>
<td>3.02 (0.578)</td>
<td>2.84 (0.469)</td>
<td>2.80 (0.423)</td>
</tr>
<tr class="even">
<td class="rowlabel">Median [Min, Max]</td>
<td>2.90 [1.96, 4.89]</td>
<td>2.70 [1.96, 3.75]</td>
<td>2.90 [2.24, 4.07]</td>
<td>2.97 [2.16, 4.89]</td>
<td>2.90 [2.05, 3.78]</td>
<td>2.87 [2.04, 3.40]</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">27 (20.8%)</td>
<td class="lastrow">3 (11.5%)</td>
<td class="lastrow">3 (11.5%)</td>
<td class="lastrow">5 (19.2%)</td>
<td class="lastrow">6 (23.1%)</td>
<td class="lastrow">10 (38.5%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Attachment Loss Change</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Mean (SD)</td>
<td>-0.0995 (0.276)</td>
<td>-0.0871 (0.242)</td>
<td>-0.222 (0.280)</td>
<td>-0.0178 (0.266)</td>
<td>-0.00656 (0.231)</td>
<td>-0.165 (0.326)</td>
</tr>
<tr class="even">
<td class="rowlabel">Median [Min, Max]</td>
<td>-0.0679 [-1.05, 0.452]</td>
<td>-0.0247 [-0.599, 0.452]</td>
<td>-0.123 [-0.901, 0.194]</td>
<td>0.0298 [-0.705, 0.348]</td>
<td>-0.0160 [-0.446, 0.339]</td>
<td>-0.0579 [-1.05, 0.199]</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">27 (20.8%)</td>
<td class="lastrow">3 (11.5%)</td>
<td class="lastrow">3 (11.5%)</td>
<td class="lastrow">5 (19.2%)</td>
<td class="lastrow">6 (23.1%)</td>
<td class="lastrow">10 (38.5%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Pocket Depth Change</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Mean (SD)</td>
<td>-0.294 (0.268)</td>
<td>-0.350 (0.277)</td>
<td>-0.338 (0.232)</td>
<td>-0.206 (0.279)</td>
<td>-0.203 (0.272)</td>
<td>-0.382 (0.245)</td>
</tr>
<tr class="even">
<td class="rowlabel">Median [Min, Max]</td>
<td>-0.284 [-0.858, 0.455]</td>
<td>-0.383 [-0.858, 0.161]</td>
<td>-0.367 [-0.759, 0.0145]</td>
<td>-0.244 [-0.661, 0.455]</td>
<td>-0.200 [-0.827, 0.175]</td>
<td>-0.347 [-0.845, 0.0536]</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">27 (20.8%)</td>
<td class="lastrow">3 (11.5%)</td>
<td class="lastrow">3 (11.5%)</td>
<td class="lastrow">5 (19.2%)</td>
<td class="lastrow">6 (23.1%)</td>
<td class="lastrow">10 (38.5%)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="Preliminary" class="level2">
<h2 class="anchored" data-anchor-id="Preliminary">Preliminary Evaluation of Assumptions</h2>
<p>Before we begin digging into the data, let’s take a closer look at the relationships between our variables.</p>
<p>We will first run a correlation matrix to assess the correlations between our IVs. Then we will explore any high correlations that which could affect our analysis.</p>
<p>Finally we will make histograms of attachment loss and pocket depth change to gauge whether they will be normally distributed or if we need to run some transformations.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Correlation Matrix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Gender and Missingness</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Normality of Dependent Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>First we will begin by making a correlation matrix to assess whether any of our IVs are related to each other (multicollinearity). This will inform which variables to incorporate into the final model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Since we made dummy codes, we will get spurious correlations that will obfuscate the main relationships we are interested in (e.g. between 'medium' and 'trtgroup'. So we will first make a separate dataset excluding the dummy coded variables</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>data_for_matrix <span class="ot">&lt;-</span> <span class="fu">select</span>(data_missing, <span class="sc">-</span>placebo, <span class="sc">-</span>control, <span class="sc">-</span>low, <span class="sc">-</span>medium,  <span class="sc">-</span>high, <span class="sc">-</span>trt, <span class="sc">-</span>trt3groups)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a correlation matrix with all variables of the trimmed data set</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_for_matrix, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the matrix</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(correlation_matrix, <span class="at">method =</span> <span class="st">"circle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trim the matrix</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>correlation_matrix[<span class="fu">upper.tri</span>(correlation_matrix)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the matrix as a LaTex file for paper</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>cor_table <span class="ot">&lt;-</span> <span class="fu">xtable</span>(correlation_matrix, <span class="at">caption =</span> <span class="st">"Correlation Matrix"</span>, <span class="at">label =</span> <span class="st">"tab:correlation"</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_table, <span class="at">type =</span> <span class="st">"latex"</span>, <span class="at">file =</span> <span class="st">"correlation_matrix.tex"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visually, we can see a cluster of high positive correlations between all of attachment loss and pocket depth at baseline and 1 year. This makes sense, as all measurements were taken from the same sites in the gums. This will be explored later <a href="#Exploratory">(See Exploratory Data Analysis - Dependent Variables)</a></p>
<p>Just for sanity (and practice), let’s make a table of our correlation coefficients.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the matrix to a dataframe for better formatting</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>correlation_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(correlation_matrix)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use Kable to pretty print the table</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(correlation_df, <span class="at">caption =</span> <span class="st">"Correlation Matrix"</span>, <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Correlation Matrix</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">trtgroup</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">race</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">smoker</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sites</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attachbase</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attach1year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pdbase</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pd1year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attachchange</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pdchange</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">trtgroup</td>
<td style="text-align: right;">-0.1452850</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gender</td>
<td style="text-align: right;">-0.8306185</td>
<td style="text-align: right;">0.1428866</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">race</td>
<td style="text-align: right;">0.1319767</td>
<td style="text-align: right;">-0.0314771</td>
<td style="text-align: right;">-0.0955531</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0.0593032</td>
<td style="text-align: right;">0.1100051</td>
<td style="text-align: right;">-0.0453862</td>
<td style="text-align: right;">0.1787040</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">smoker</td>
<td style="text-align: right;">-0.2742888</td>
<td style="text-align: right;">-0.0495029</td>
<td style="text-align: right;">0.0206456</td>
<td style="text-align: right;">0.0377211</td>
<td style="text-align: right;">-0.2229620</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sites</td>
<td style="text-align: right;">0.0520821</td>
<td style="text-align: right;">-0.0393742</td>
<td style="text-align: right;">-0.1291127</td>
<td style="text-align: right;">0.0505164</td>
<td style="text-align: right;">-0.0274695</td>
<td style="text-align: right;">-0.0226381</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">attachbase</td>
<td style="text-align: right;">-0.1641513</td>
<td style="text-align: right;">0.1440999</td>
<td style="text-align: right;">0.2416242</td>
<td style="text-align: right;">0.0313438</td>
<td style="text-align: right;">0.1354434</td>
<td style="text-align: right;">0.1456234</td>
<td style="text-align: right;">-0.4237813</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">attach1year</td>
<td style="text-align: right;">-0.1440182</td>
<td style="text-align: right;">0.1671499</td>
<td style="text-align: right;">0.2021284</td>
<td style="text-align: right;">0.0671713</td>
<td style="text-align: right;">0.0850851</td>
<td style="text-align: right;">0.1987327</td>
<td style="text-align: right;">-0.4042743</td>
<td style="text-align: right;">0.9450189</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">pdbase</td>
<td style="text-align: right;">-0.2010672</td>
<td style="text-align: right;">-0.0224838</td>
<td style="text-align: right;">0.2645908</td>
<td style="text-align: right;">0.0182289</td>
<td style="text-align: right;">-0.0884687</td>
<td style="text-align: right;">0.2614919</td>
<td style="text-align: right;">-0.1805543</td>
<td style="text-align: right;">0.6047132</td>
<td style="text-align: right;">0.6093346</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pd1year</td>
<td style="text-align: right;">-0.0685783</td>
<td style="text-align: right;">0.0126731</td>
<td style="text-align: right;">0.1362804</td>
<td style="text-align: right;">0.0606735</td>
<td style="text-align: right;">-0.1246106</td>
<td style="text-align: right;">0.2447030</td>
<td style="text-align: right;">-0.1901940</td>
<td style="text-align: right;">0.5601052</td>
<td style="text-align: right;">0.6685457</td>
<td style="text-align: right;">0.8436653</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">attachchange</td>
<td style="text-align: right;">0.0964391</td>
<td style="text-align: right;">0.0296043</td>
<td style="text-align: right;">-0.1696216</td>
<td style="text-align: right;">0.0928969</td>
<td style="text-align: right;">-0.1742586</td>
<td style="text-align: right;">0.1135740</td>
<td style="text-align: right;">0.1578683</td>
<td style="text-align: right;">-0.3976360</td>
<td style="text-align: right;">-0.0757224</td>
<td style="text-align: right;">-0.1342018</td>
<td style="text-align: right;">0.1679506</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pdchange</td>
<td style="text-align: right;">0.2251487</td>
<td style="text-align: right;">0.0622762</td>
<td style="text-align: right;">-0.2123192</td>
<td style="text-align: right;">0.0789059</td>
<td style="text-align: right;">-0.0731704</td>
<td style="text-align: right;">-0.0091784</td>
<td style="text-align: right;">-0.0323859</td>
<td style="text-align: right;">-0.0317726</td>
<td style="text-align: right;">0.1579534</td>
<td style="text-align: right;">-0.2031295</td>
<td style="text-align: right;">0.3543035</td>
<td style="text-align: right;">0.5400668</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Other than that, there is a correlation between gender and ID which seems spurious. Let’s investigate that in the next tab.</p>
<p><a href="#Preliminary">Back to top of tabset</a></p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>There is a correlation between gender and ID. Let’s make a simple plot to investigate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a simple plot of id and gender</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(gender), <span class="at">y =</span> id)) <span class="sc">+</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ID by Gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interestingly, it appears that the experimenters assigned ID based on gender. That is, females received ID’s starting at 101, and males received ID’s starting at 201 (for some reason there’s a few females with ID’s &gt; 200).</p>
<p>It will be important to double check with the PI’s how they assigned participants to treatment group to ensure it was in fact random.</p>
<p>Let’s make a contingency table to see what the breakdown between gender and treatment group is.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First make a contingency table of both variables</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data_missing<span class="sc">$</span>gender, data_missing<span class="sc">$</span>trtgroup)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the row and column names</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(contingency_table) <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Gender"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>),</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Treatment Condition"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Placebo"</span>, <span class="st">"Control"</span>, <span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the table to a dataframe for better formatting (from ChatGPT)</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>contingency_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(contingency_table)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print the table using kable</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(contingency_df, <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Placebo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Control</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Medium</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">High</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Male</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Female</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">13</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>That’s not good! It looks like males were less likely to be in the high treatment condition compared to females.</p>
<p>This could be because males were more likely to drop out then females. Let’s make a quick table using the original data set before we dropped the missing variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First make a contingency table of both variables</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>contingency_table_clean <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>gender, data<span class="sc">$</span>trtgroup)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the row and column names</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(contingency_table_clean) <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Gender"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Treatment Condition"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Placebo"</span>, <span class="st">"Control"</span>, <span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>))</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the table to a dataframe for better formatting (from ChatGPT)</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>contingency_df_clean <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(contingency_table_clean)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print the table using kable</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(contingency_df_clean, <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Placebo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Control</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Medium</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">High</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Male</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">Female</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">15</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>It looks more balanced before I took out participants with missing data.</p>
<p>Chi-square is known to be unsuitable if a cell has &lt; 5 counts, which we have in this case (3 males in high concentration condition). So I will run Fisher’s test to see if that difference is statistically significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>fisher_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(contingency_table)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>fisher_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  contingency_table
p-value = 0.506
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>The p-value is not signficant (p = 0.506).</p>
<p>We know from visualizing the missing data that there were 27 missing data points for the gum measurement DVs, and these all belong to the same people. Furthermore, it appears that males in the treatment groups were more likely to have missing values than in the placebo (and maybe control) group. Is it possible that the gel was having an adverse effect on these participants? Does the gel have an adverse effect only on males and not females for some reason? Let’s explore.</p>
<p>First, I want to investigate if males were more likely to have missing data points. It’s possible if their gums were hurting they simply rejected or avoided having these measurements taken.</p>
<p>Let’s repeat this process and make a contingency table of gender and missing variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First let's add a new dummy code for if a participant is missing any data points</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>missing <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">apply</span>(data, <span class="dv">1</span>, <span class="cf">function</span>(row) <span class="fu">any</span>(<span class="fu">is.na</span>(row))), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># First make a contingency table of both variables</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>contingency_table_missing <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>gender, data<span class="sc">$</span>missing)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the row and column names</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(contingency_table_missing) <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Gender"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>),</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Missing"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Not Missing"</span>, <span class="st">"Missing"</span>))</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the table to a dataframe for better formatting (from ChatGPT)</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>contingency_df_missing <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(contingency_table_missing)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print the table using kable</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(contingency_df_missing, <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Not Missing</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Missing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Male</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td style="text-align: left;">Female</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Proportionally, it appears that males may be more likely to have missing variables than females. Let’s run a chi-square to check.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chi_square_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_df_missing)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>chi_square_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  contingency_df_missing
X-squared = 7.6127, df = 1, p-value = 0.005796</code></pre>
</div>
</div>
<p>Success! Males were more likely to have missing values compared to females (p = 0.005796). This could be a problem (counfound) if something was causing males to avoid having their gums measured compared to females (such as adverse reactions from the gel)</p>
<p>Let’s do a quick chi square test to check if there is a relationship between missing values and treatment condition.</p>
<p>We start off the same way by making a contingency table and running a chi-square test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First make a contingency table of both variables</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>contingency_table_missing2 <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>missing, data<span class="sc">$</span>trtgroup)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the row and column names</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(contingency_table_missing2) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"Missing"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Not Missing"</span>, <span class="st">"Missing"</span>),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Treatmtent Condition"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Placebo"</span>, <span class="st">"Control"</span>, <span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the table to a dataframe for better formatting (from ChatGPT)</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>contingency_df_missing2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(contingency_table_missing2)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print the table using kable</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(contingency_df_missing2, <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Placebo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Control</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Medium</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">High</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Not Missing</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Missing</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>It does appear that there are more missing variables in the high concentration condition. Is it statistically significant?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a Fisher's Exact Test (since we have &lt; 5 observations in cells)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>fisher_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(contingency_df_missing2)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>fisher_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  contingency_df_missing2
p-value = 0.1675
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Not significant (p = 0.1675). So we can conclude that there is no difference in gender or missing values based on treatment condition (i.e., participants in all treatment conditions were equally likely to be male or female, or have missing values)</p>
<p><strong>However</strong>, across the board, males were more likely to have missing values than females. This will be important to note as a caveat during interpretation of the final results.</p>
<p><a href="#Preliminary">Back to top of tabset</a></p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Here we will simply plot the histograms of attachment loss and pocket depth changes scores, to assess if they appear normally distributed or if we will have to perform a transformation of some kind.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot simple histogram of attachment loss change score</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_missing<span class="sc">$</span>attachchange,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main  =</span> <span class="st">"Histogram of Attachment Loss Change"</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Attachment Loss Change"</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot simple histogram of pocket depth change score</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_missing<span class="sc">$</span>pdchange,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main  =</span> <span class="st">"Histogram of Attachment Loss Change"</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Pocket Depth Change"</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Both attachment loss and pocket depth change appear to be normally distributed and will not need to be transformed. Attachment loss change is slightly left-tailed but this could be due to outliers, or may just not impact the analysis.</p>
</div>
</div>
</div>
</section>
<section id="Exploratory" class="level2">
<h2 class="anchored" data-anchor-id="Exploratory">Exploratory Data Analysis</h2>
<p>Here I will plot the data and perform a number of simple linear regressions to examine relationships between variables in order to determine which covariates to include in the model.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Primary Explanatory Variable</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Covariates</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Dependent Variables</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">5 Treatment Groups</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">3 Treatment Groups</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Let’s examine if there appears to be a difference in the average attachment loss and pocket depth change according to treatment level</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(trtgroup), <span class="at">y =</span> attachchange)) <span class="sc">+</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Attachment Loss change by Treatment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(trtgroup), <span class="at">y =</span> pdchange)) <span class="sc">+</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()  <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Pocket Depth Change by treatment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><u>Attachment Loss Change</u></p>
<p>Visually, there does not appear to be a difference between the treatment group levels (low, medium, high concentration gel) compared to each other. Additionally, there does not seem to be a difference between the treatment groups and the placebo for attachment loss change.</p>
<p><u>Pocket Depth Change</u></p>
<p>Interestingly, the high concentration condition appears to have had a negative effect. Additionally, there seems to be a difference in the treatment groups compared to the no treatment control, but NOT when compared to the placebo. The exception is the low concentration condition compared to the placebo when looking at pocket depth change. Further analysis will reveal whether these differences are statistically significant or not.</p>
<p><a href="#Exploratory">Back to top of tabset</a></p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>The relationship between low vs medium vs high gel concentration does not look very strong. Furthermore, we technically do not have a large enough sample size in the high concentration condition to include it.</p>
<p>For those reasons, let’s make the same comparisons but while combining all treatment levels into one group called treatment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(trt3groups), <span class="at">y =</span> attachchange)) <span class="sc">+</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(trt3groups), <span class="at">y =</span> attachchange)) <span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Attachment Loss Change by Treatment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(trt3groups), <span class="at">y =</span> pdchange)) <span class="sc">+</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Pocket Depth Change by Treatment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-25-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>By eye, it appears as if there is no difference between the placebo and collapsed treatment groups in attachment loss change or pocket depth change. However, both placebo and any treatment conditions appear to have decreased (?) attachment loss and pocket depth. It may be that this study has null results, unless including one of the covariates changes the results. We will see come the analysis section.</p>
<p><a href="#Exploratory">Back to top of tabset</a></p>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Now we will exlore the relationships between our potential covariates and attachment loss and pocket depth change</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Age</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Sites</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Gender</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Race</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">Smoking Status</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot age vs attachment loss change</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> attachchange)) <span class="sc">+</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Age vs Attachment Loss Change"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot age vs pocket depth change</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> pdchange)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Age vs Pocket Depth Change"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There does not appear to be any kind of linear relationship between age and attachment loss change or pocket depth change. I will run a model where I include age, but it will likely be removed in the final model.</p>
<p><a href="#Exploratory">Back to top of tabset</a></p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Is there any relationship between the number of sites measured from and attachment loss change or pocket depth change (e.g.&nbsp;a lower number of sites could lead to less accurate readings)? If so this could be something to include in our data analysis</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot sites vs attachment change loss</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> sites, <span class="at">y =</span> attachchange)) <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Attachment Loss Change vs Sites"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot sites vs pocket depth chagne</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> sites, <span class="at">y =</span> pdchange)) <span class="sc">+</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Pocket Depth Change by Sites"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There does not seem to be a dramatic difference in attachment loss or pocket depth change based on the number of sites measured from. It’s a bit hard to tell with those two low site subjects, but the points are similar enough to the rest of the dataset that I do not think we have to worry about site number in our analysis.</p>
<p><a href="#Exploratory">Back to top of tabset</a></p>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>It is conceivable that there are sex differences in regards to gum health. Let’s examine if there is a difference in attachment loss or pocket depth change based on gender</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot gender vs attachment loss change</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(gender), <span class="at">y =</span> attachchange)) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Attachment Loss Change by Gender"</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot gender vs pocket depth change</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(gender), <span class="at">y =</span> pdchange)) <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Pocket Depth Change by Gender"</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>By eye, it appears that males may have more pocket depth loss compared with females. This will be a good variable to include as a covariate.</p>
<p>Let’s try a t-test to see if there is any difference in attachment loss or pocket depth change based on gender</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Running a t-test on attachment loss change by gender</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>male <span class="ot">&lt;-</span> data_missing<span class="sc">$</span>attachchange[data_missing<span class="sc">$</span>gender <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>female <span class="ot">&lt;-</span> data_missing<span class="sc">$</span>attachchange[data_missing<span class="sc">$</span>gender <span class="sc">==</span> <span class="dv">2</span>]</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(male, female)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>t_test_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  male and female
t = 2.1969, df = 100.8, p-value = 0.03032
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.01003279 0.19682842
sample estimates:
  mean of x   mean of y 
-0.03217094 -0.13560154 </code></pre>
</div>
</div>
<p>There is a significant difference in attachment loss change score based on gender (t = 2.0502, p = 0.04299)</p>
<p>Let’s repeat for pocket depth change</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Running a t-test on pocket depth change by gender</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>male <span class="ot">&lt;-</span> data_missing<span class="sc">$</span>pdchange[data_missing<span class="sc">$</span>gender <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>female <span class="ot">&lt;-</span> data_missing<span class="sc">$</span>pdchange[data_missing<span class="sc">$</span>gender <span class="sc">==</span> <span class="dv">2</span>]</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(male, female)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>t_test_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  male and female
t = 2.3534, df = 81.683, p-value = 0.02101
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.01884469 0.22488042
sample estimates:
 mean of x  mean of y 
-0.2150844 -0.3369470 </code></pre>
</div>
</div>
<p>There is also a statistically significant difference in pocket depth change based on gender (t = 2.2626, p = 0.02641).</p>
<p><strong>Therefore I will include gender as a covariate in the analysis!</strong></p>
<p><a href="#Exploratory">Back to top of tabset</a></p>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot race vs attachment loss change</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(race), <span class="at">y =</span> attachchange)) <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Attachment Change by Race"</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Race"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(race), <span class="at">y =</span> pdchange)) <span class="sc">+</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Pocket Depth Change by Race"</span>,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Race"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There does not seem to be much of a difference in attachment loss or pocket depth based on race. MAYBE African Americans (2) have more pocket depth loss compared to Asians(4), but the sample size was very small for both races (88.1% of the sample identified as White)</p>
<p><a href="#Exploratory">Back to top of tabset</a></p>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<p>Whether the participant is a smoker or not likely has a dramatic effect on gum health. Let’s assess</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot smoking status vs attachment loss change</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(smoker), <span class="at">y =</span> attachchange)) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Attachment loss by smoking status"</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Smoking Status"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot smoking status vs pocket depth change</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(smoker), <span class="at">y =</span> pdchange)) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Attachment loss by smoking status"</span>,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Smoking Status"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There does not appear to be any difference in attachment loss or pocket depth change based on smoking status. I will test a model with smoking status included, but it will likely be dropped in the final model.</p>
<p><a href="#Exploratory">Back to top of tabset</a></p>
</div>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Baseline vs 1 Year</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Attachment Loss vs Pocket Depth</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>I am curious what the relationship between base line and 1 year measurements are. The study is an RCT so even if baseline measurements affect 1 year measurements, participants should have been randomly assigned to groups so it is essentially controlled for in the study design. It will still be important to assess this relationship as a moderator however. Maybe treatment only worked for those with high attachment loss or pocket depth at the beginning?</p>
<p>First let’s make a simple plot of attachment loss at baseline and at 1 year</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a scatter plot of attachment loss at baseline and 1 year</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> attachbase, <span class="at">y =</span> attach1year)) <span class="sc">+</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Attachment Loss at Baseline and 1 Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s check the correlation coefficient.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a correlation test between attachment at base and 1 year</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data_missing<span class="sc">$</span>attachbase, data_missing<span class="sc">$</span>attach1year)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>correlation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_missing$attachbase and data_missing$attach1year
t = 29.198, df = 101, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.9204657 0.9628839
sample estimates:
      cor 
0.9455558 </code></pre>
</div>
</div>
<p>Those are highly correlated (R = 0.946, p &lt;.0001)! Let’s run a simple linear regression</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a regression with attachment loss at 1 year as the DV and attachment at base as the IV</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(attach1year <span class="sc">~</span> attachbase, <span class="at">data =</span> data_missing)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = attach1year ~ attachbase, data = data_missing)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.55683 -0.15641 -0.01841  0.15202  0.82062 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.19872    0.06975   2.849  0.00531 ** 
attachbase   0.86452    0.02961  29.198  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2525 on 101 degrees of freedom
Multiple R-squared:  0.8941,    Adjusted R-squared:  0.893 
F-statistic: 852.5 on 1 and 101 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the model</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> attachbase, <span class="at">y =</span> attach1year)) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simple Linear Regression of Attachment Loss at Baseline and 1 Year"</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Attachment Loss at Baseline"</span>,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Attachment Loss at 1 Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Attachment loss at baseline is a significant predictor of attachment loss at 1 year (t = 29.20, p &lt;.0001). This is important! We should account for attachment loss at baseline by including it as a covariate in our final model!</p>
<p>Let’s do the same process of pocket depth at baseline and 1 year</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of pocket depth at base vs 1 year</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> pdbase, <span class="at">y =</span> pd1year)) <span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Pocket Depth at Baseline and 1 Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Similar to attachment loss, we see a relationship between pocket depth at baseline and 1 year. Let’s run the correlation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a correlation between pocket depth at baseline and 1 year</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data_missing<span class="sc">$</span>pdbase, data_missing<span class="sc">$</span>pd1year)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>correlation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_missing$pdbase and data_missing$pd1year
t = 15.767, df = 101, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.7764571 0.8913340
sample estimates:
      cor 
0.8432691 </code></pre>
</div>
</div>
<p>While not as strong as attachment loss, there is still a strong relationship between pocket depth at baseline and 1 year (R = 0.84, p &lt;.0001). Let’s run the SLR.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run an SLR with pocket depth at 1 year as the DV and pocket depth at baseline as the DV</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(pd1year <span class="sc">~</span> pdbase, <span class="at">data =</span> data_missing)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = pd1year ~ pdbase, data = data_missing)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.55105 -0.17484  0.01996  0.19627  0.64381 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.07504    0.17948   0.418    0.677    
pdbase       0.88346    0.05603  15.767   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2634 on 101 degrees of freedom
Multiple R-squared:  0.7111,    Adjusted R-squared:  0.7082 
F-statistic: 248.6 on 1 and 101 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the model</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> pdbase, <span class="at">y =</span> pd1year)) <span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simple Linear Regression of Pocket Depth at Baseline and 1 Year"</span>,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Pocket Depth at Baseline"</span>,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Pocket Depth at 1 year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Pocket depth at baseline is also a significant predictor of pocket depth at 1 year (t = 15.78, p = &lt;.0001). We should also therefore include pocket depth at baseline as a covariate in our model to control for it!</p>
<p><a href="#Exploratory">Back to top of tabset</a></p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>I am interested in how attachment loss and pocket depth change are related. Since they are both measurements taken from the same sites in the gums, they are likely to be highly correlated. This could have implications on how we perform the analysis and interpret the results.</p>
<p>First, we plot attachment loss change against pocket depth change</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a scatter plot of attachment loss change against pocket depth change </span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> attachchange, <span class="at">y =</span> pdchange)) <span class="sc">+</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Attachment Loss Change and Pocket Depth Change"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That looks like a linear relationship! Let’s run a correlation and an SLR.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Running the correlation</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data_missing<span class="sc">$</span>attachchange, data_missing<span class="sc">$</span>pdchange)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>correlation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_missing$attachchange and data_missing$pdchange
t = 6.3717, df = 101, p-value = 5.621e-09
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.3814636 0.6605362
sample estimates:
      cor 
0.5354593 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Running the regression</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(attachchange <span class="sc">~</span> pdchange, <span class="at">data =</span> data_missing)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = attachchange ~ pdchange, data = data_missing)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.83130 -0.12683  0.00563  0.14913  0.46480 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.06312    0.03441   1.835   0.0695 .  
pdchange     0.55231    0.08668   6.372 5.62e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2343 on 101 degrees of freedom
Multiple R-squared:  0.2867,    Adjusted R-squared:  0.2797 
F-statistic:  40.6 on 1 and 101 DF,  p-value: 5.621e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the plot</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> attachchange, <span class="at">y =</span> pdchange)) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simple Linear Regression of Attachment Loss and Pocket Depth Change"</span>,</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Pocket Depth Change"</span>,</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Attachment Loss Change"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The correlation shows that attachment loss and pocket depth change are very correlated (R = 0.54, p &lt; .0001). The simple linear regression shows that pocket depth change significantly predicts attachment loss change (t = 6.37, p &lt;.0001).</p>
<p>However, multicollinearity is only an issue when IVs are correlated with each other. We can still run a multivariate multiple linear regression even though the DVs are correlated. In fact this is often the case, and is one of the justifications for using a multivariate MLR in the first place! <a href="#Exploratory">Back to top of tabset</a></p>
</div>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<p><u>Treatment Condition</u></p>
<p>Collapsing the low, medium, and high concentration gel groups into 1 group does not seem to improve the relationship between treatment and attachment loss or pocket depth change. Only models including all 5 treatment groups will therefore be considered from here on out to keep in alignment with the original study design.</p>
<p><u>Gender</u></p>
<p>Gender is related to attachment loss and pocket depth change, and as such will be included in the final model.</p>
<p><u>Supressor / Counfound Variables</u></p>
<p>A model will be tested with all covariates to assess for possible suppressor / confound variables. But the other potential covariates of race, age, sites, and smoking status were not related to attachment loss or pocket depth change by themselves.</p>
<p><u>Baseline vs 1 Year Measurements</u></p>
<p>The baseline measurements of attachment loss and pocket depth were significant predictors of attachment loss and pocket depth at 1 year, respectively. While the RCT nature of the study should ensure that participants were randomly assigned into treatment condition regardless of their baseline measurements, it will still be good practice to include baseline attachment loss and pocket depth into the final model.</p>
<p><u>Attachment Loss vs Pocket Depth Change Scores</u></p>
<p>Attachment loss and pocket depth change are highly related to each other, but this should not impact the analysis. PI’s will need to be consulted to interpret the clinical significance of findings, and to help fully understand the implications of any possible differences that may arise between attachment loss and pocket depth change in the analysis.</p>
<p><a href="#Exploratory">Back to top of tabset</a></p>
</div>
</div>
</div>
</section>
</section>
<section id="data-analysis" class="level1">
<h1>Data Analysis</h1>
<p>Now we can perform the actual analysis!</p>
<p>The clinical hypothesis for this study is that average pocket depth and attachment loss in participants who applied the gel will be lower compared to participants who did not.</p>
<p>The statistical hypotheses are:</p>
<p>• <u>Null Hypothesis:</u></p>
<p><span class="math display">\[
H_0: μ_{placebo} = μ_{no treatment} = μ_{low} = μ_{medium} = μ_{high}
\]</span></p>
<p>The average pocket depth and attachment loss for all conditions will be equal to each other.</p>
<p>• <u>Alternative Hypothesis</u>:</p>
<p><span class="math display">\[
H_A: μ_{placebo} \neq μ_{no treatment} \neq μ_{low} \neq μ_{medium} \neq μ_{high}
\]</span></p>
<p>At least one of the groups will have different average pocket depth or attachment loss.</p>
<section id="Model_1" class="level2">
<h2 class="anchored" data-anchor-id="Model_1">Running the Model</h2>
<p>For ease of interpretation I will be performing this analysis as two separate linear regressions, one for each outcome variable of either attachment loss or pocket depth change. I will begin with a simple linear regression only including the PEV and either attachment loss change or pocket depth change.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Attachment Loss Change</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Pocket Depth Change</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Post-Hoc Analysis</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>We start by constructing a model with attachment loss change as the dependent variable, and treatment group as the independent variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Running a SLR with attachment loss change as the DV, treatment group as the IV with no treatment as the reference group</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>model_attach1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(attachchange <span class="sc">~</span> placebo <span class="sc">+</span> low <span class="sc">+</span>  medium <span class="sc">+</span> high, <span class="at">data =</span> data_missing)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_attach1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = attachchange ~ placebo + low + medium + high, data = data_missing)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.88283 -0.14813  0.05115  0.17174  0.53945 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.22169    0.05590  -3.966 0.000139 ***
placebo      0.13462    0.07906   1.703 0.091771 .  
low          0.20388    0.08092   2.520 0.013365 *  
medium       0.21514    0.08197   2.625 0.010063 *  
high         0.05690    0.08728   0.652 0.515950    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2681 on 98 degrees of freedom
Multiple R-squared:  0.09368,   Adjusted R-squared:  0.05669 
F-statistic: 2.532 on 4 and 98 DF,  p-value: 0.0451</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Bonferroni correction</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_attach1)<span class="sc">$</span>coefficients[,<span class="dv">4</span>] <span class="co"># This line selects the fourth column of the resulting coefficients table from summary(model_attach), which is the p-values</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare adjusted p-values to unadjusted p-values</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>p_comparison <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p_values, p_adjusted)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>p_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                p_values   p_adjusted
(Intercept) 0.0001392148 0.0006960742
placebo     0.0917709125 0.4588545624
low         0.0133650749 0.0668253747
medium      0.0100625287 0.0503126435
high        0.5159498143 1.0000000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get confidence intervals</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>conf_intervals <span class="ot">&lt;-</span> <span class="fu">confint</span>(model_attach1)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>conf_intervals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %     97.5 %
(Intercept) -0.33262557 -0.1107577
placebo     -0.02226569  0.2915028
low          0.04330175  0.3644540
medium       0.05247446  0.3777966
high        -0.11629489  0.2300962</code></pre>
</div>
</div>
<p>The overall model is significant (F<sub>(4,98)</sub> = 2.53, p = 0.0451). Looking at the individual t-statistics, we see that - following adjustment for multiple pairwise comparisons - the placebo group (p = 0.549), low concentration group (p = 0.0668), and high concentration group (p = 1.000) are not statistically different from the control group. The medium concentration group is approaching significance (p = 0.0503).</p>
<p>That was with the no treatment control group as the reference. Let’s see if any of our treatment conditions were different from the placebo group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Running a SLR with attachment loss change as the DV, treatment group as the IV with placebo as the reference group</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>model_attach2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(attachchange <span class="sc">~</span> control <span class="sc">+</span> low <span class="sc">+</span>  medium <span class="sc">+</span> high, <span class="at">data =</span> data_missing)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_attach2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = attachchange ~ control + low + medium + high, data = data_missing)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.88283 -0.14813  0.05115  0.17174  0.53945 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -0.08707    0.05590  -1.558   0.1225  
control     -0.13462    0.07906  -1.703   0.0918 .
low          0.06926    0.08092   0.856   0.3941  
medium       0.08052    0.08197   0.982   0.3284  
high        -0.07772    0.08728  -0.890   0.3754  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2681 on 98 degrees of freedom
Multiple R-squared:  0.09368,   Adjusted R-squared:  0.05669 
F-statistic: 2.532 on 4 and 98 DF,  p-value: 0.0451</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Bonferroni correction</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_attach2)<span class="sc">$</span>coefficients[,<span class="dv">4</span>] <span class="co"># This line selects the fourth column of the resulting coefficients table from summary(model_attach), which is the p-values</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare adjusted p-values to unadjusted p-values</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>p_comparison <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p_values, p_adjusted)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>p_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              p_values p_adjusted
(Intercept) 0.12254523  0.6127262
control     0.09177091  0.4588546
low         0.39412117  1.0000000
medium      0.32836700  1.0000000
high        0.37538435  1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get confidence intervals</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>conf_intervals <span class="ot">&lt;-</span> <span class="fu">confint</span>(model_attach2)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>conf_intervals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %     97.5 %
(Intercept) -0.19800701 0.02386082
control     -0.29150281 0.02226569
low         -0.09131681 0.22983549
medium      -0.08214410 0.24317801
high        -0.25091345 0.09547760</code></pre>
</div>
</div>
<p>After applying a bonferroni correction, none of the groups are significantly different from the placebo group (p &gt; .05).</p>
<p><u>Conclusion</u></p>
<p>While the overall model was significant, the only groups that were statistically different from the no treatment control were the low and medium concentration gel groups (p &lt; 0.05). However, since this was a placebo-controlled RCT, and none of the treatment groups were significantly different from the placebo group, we can conclude that we <strong><em>fail to reject the null hypothesis</em></strong> that the average attachment loss over 1 year is the same between all groups.</p>
<p><u>Tables</u></p>
<p><img src="Media/Regression1_model_attach.png" alt="Regression Model" width="50%" height="50%"></p>
<p><img src="Media/Regression2_model_attach.png" alt="Regression Model" width="50%" height="50%"></p>
<p>Note: p-values are unadjusted.</p>
<p><a href="#Model_1">Back to top of tabset</a></p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>Now we will create our model with pocket depth change as the dependent variable and treatment group as the independent variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Running the regression with pocket depth change as the DV, treatment group as the IV with no treatment as the reference group</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>model_pd <span class="ot">&lt;-</span> <span class="fu">lm</span>(pdchange <span class="sc">~</span> placebo <span class="sc">+</span> low <span class="sc">+</span> medium <span class="sc">+</span> high, <span class="at">data =</span> data_missing)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_pd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = pdchange ~ placebo + low + medium + high, data = data_missing)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.62483 -0.14595 -0.01768  0.16029  0.66130 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.33817    0.05466  -6.187 1.43e-08 ***
placebo     -0.01152    0.07730  -0.149   0.8818    
low          0.13200    0.07912   1.668   0.0984 .  
medium       0.13562    0.08015   1.692   0.0938 .  
high        -0.04413    0.08534  -0.517   0.6063    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2621 on 98 degrees of freedom
Multiple R-squared:  0.07806,   Adjusted R-squared:  0.04043 
F-statistic: 2.074 on 4 and 98 DF,  p-value: 0.08994</code></pre>
</div>
</div>
<p>The overall model is not statistically significant (F<sub>(4,98)</sub>= 2.074, p = 0.0899). Based on this model, it appears that the gel treatment has no effect on pocket depth change after 1 year.</p>
<p><u>Conclusion</u></p>
<p>No groups were significantly different from each other in pocket depth change after 1 year (F<sub>(4,98)</sub>= 2.074, p = 0.0899), and we <strong><em>fail to reject the null hypothesis</em></strong> that the average pocket depth change over 1 year is the same between all groups.</p>
<p><u>Tables</u></p>
<p><img src="Media/Regression3_model_pd.png" alt="Regression Model" width="50%"></p>
<p>Note: p-values are unadjusted</p>
<p><a href="#Model_1">Back to top of tabset</a></p>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>We did not find a main effect based on treatment group. However I am still interested if including any of the covariates changes the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a SLR with attachment loss change as the DV and gender as a covariate</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>model2_attach <span class="ot">&lt;-</span> <span class="fu">lm</span>(attachchange <span class="sc">~</span> placebo <span class="sc">+</span> low <span class="sc">+</span> medium <span class="sc">+</span> high <span class="sc">+</span> gender, <span class="at">data =</span> data_missing) </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2_attach)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = attachchange ~ placebo + low + medium + high + gender, 
    data = data_missing)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.86656 -0.17533  0.02334  0.16395  0.57717 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -0.07460    0.10988  -0.679   0.4988  
placebo      0.12330    0.07883   1.564   0.1210  
low          0.19310    0.08064   2.395   0.0186 *
medium       0.21118    0.08143   2.593   0.0110 *
high         0.06704    0.08690   0.771   0.4423  
gender      -0.08675    0.05593  -1.551   0.1242  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2662 on 97 degrees of freedom
Multiple R-squared:  0.1156,    Adjusted R-squared:  0.07003 
F-statistic: 2.536 on 5 and 97 DF,  p-value: 0.03346</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Bonferroni correction</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">summary</span>(model2_attach)<span class="sc">$</span>coefficients[,<span class="dv">4</span>] <span class="co"># This line selects the fourth column of the resulting coefficients table from summary(model_attach), which is the p-values</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare adjusted p-values to unadjusted p-values</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>p_comparison <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p_values, p_adjusted)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>p_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              p_values p_adjusted
(Intercept) 0.49883151 1.00000000
placebo     0.12104977 0.72629859
low         0.01856222 0.11137333
medium      0.01097151 0.06582903
high        0.44234244 1.00000000
gender      0.12415264 0.74491582</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get confidence intervals</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>conf_intervals <span class="ot">&lt;-</span> <span class="fu">confint</span>(model2_attach)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>conf_intervals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %     97.5 %
(Intercept) -0.29268916 0.14349242
placebo     -0.03315881 0.27976619
low          0.03304940 0.35315426
medium       0.04956814 0.37278247
high        -0.10544029 0.23951403
gender      -0.19775102 0.02425639</code></pre>
</div>
</div>
<p>A model including gender does not seem to help anything. What about with all covariates (just for fun)?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a SLR with attachment loss change as the DV and gender as a covariate</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>model3_attach <span class="ot">&lt;-</span> <span class="fu">lm</span>(attachchange <span class="sc">~</span> placebo <span class="sc">+</span> low <span class="sc">+</span> medium <span class="sc">+</span> high <span class="sc">+</span> gender <span class="sc">+</span> race <span class="sc">+</span> age <span class="sc">+</span> smoker <span class="sc">+</span> sites <span class="sc">+</span> attachbase <span class="sc">+</span> pdbase , <span class="at">data =</span> data_missing) </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3_attach)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = attachchange ~ placebo + low + medium + high + gender + 
    race + age + smoker + sites + attachbase + pdbase, data = data_missing)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.60415 -0.16360  0.02131  0.16645  0.57481 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.160630   0.480855   0.334 0.739127    
placebo      0.017898   0.079113   0.226 0.821541    
low          0.151477   0.077598   1.952 0.054074 .  
medium       0.172196   0.079066   2.178 0.032060 *  
high         0.045948   0.081336   0.565 0.573557    
gender      -0.050360   0.054953  -0.916 0.361924    
race         0.032325   0.026871   1.203 0.232181    
age         -0.002472   0.002709  -0.912 0.364067    
smoker       0.069384   0.055052   1.260 0.210844    
sites       -0.001501   0.002539  -0.591 0.555885    
attachbase  -0.165154   0.043233  -3.820 0.000246 ***
pdbase       0.094444   0.072226   1.308 0.194370    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2456 on 89 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.2908,    Adjusted R-squared:  0.2032 
F-statistic: 3.318 on 11 and 89 DF,  p-value: 0.0007435</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Bonferroni correction</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">summary</span>(model3_attach)<span class="sc">$</span>coefficients[,<span class="dv">4</span>] <span class="co"># This line selects the fourth column of the resulting coefficients table from summary(model_attach), which is the p-values</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare adjusted p-values to unadjusted p-values</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>p_comparison <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p_values, p_adjusted)</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>p_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               p_values  p_adjusted
(Intercept) 0.739127379 1.000000000
placebo     0.821540779 1.000000000
low         0.054074263 0.648891153
medium      0.032060232 0.384722790
high        0.573556835 1.000000000
gender      0.361924208 1.000000000
race        0.232180658 1.000000000
age         0.364067210 1.000000000
smoker      0.210844428 1.000000000
sites       0.555885079 1.000000000
attachbase  0.000246493 0.002957916
pdbase      0.194369803 1.000000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get confidence intervals</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>conf_intervals <span class="ot">&lt;-</span> <span class="fu">confint</span>(model3_attach)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>conf_intervals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   2.5 %       97.5 %
(Intercept) -0.794818756  1.116078333
placebo     -0.139298371  0.175094025
low         -0.002709329  0.305662938
medium       0.015093048  0.329298305
high        -0.115665991  0.207561289
gender      -0.159551369  0.058830891
race        -0.021067104  0.085716311
age         -0.007855313  0.002911679
smoker      -0.040003508  0.178771331
sites       -0.006546011  0.003543891
attachbase  -0.251056725 -0.079251471
pdbase      -0.049067286  0.237955593</code></pre>
</div>
</div>
<p>Nope. Interestingly the best predictor of attachment loss at 1 year is attachment loss at baseline. The results for pocket depth are likely the same.</p>
<p>I also want to assess if controlling for baseline attachment loss or pocket depth change affects things, since those were strong predictors of each measurement at 1 year (still need to add those SLRs).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>model4_attach <span class="ot">&lt;-</span> <span class="fu">lm</span>(attachchange <span class="sc">~</span> placebo <span class="sc">+</span> low <span class="sc">+</span> medium <span class="sc">+</span> high <span class="sc">+</span> attachbase, <span class="at">data =</span> data_missing)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4_attach)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = attachchange ~ placebo + low + medium + high + attachbase, 
    data = data_missing)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.52469 -0.16400  0.02084  0.15231  0.73422 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.10707    0.09304   1.151   0.2527    
placebo      0.04202    0.07616   0.552   0.5824    
low          0.14605    0.07592   1.924   0.0573 .  
medium       0.17586    0.07622   2.307   0.0232 *  
high         0.02665    0.08087   0.330   0.7425    
attachbase  -0.12902    0.03039  -4.246 4.99e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2475 on 97 degrees of freedom
Multiple R-squared:  0.2357,    Adjusted R-squared:  0.1963 
F-statistic: 5.984 on 5 and 97 DF,  p-value: 7.236e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Bonferroni correction</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">summary</span>(model4_attach)<span class="sc">$</span>coefficients[,<span class="dv">4</span>] <span class="co"># This line selects the fourth column of the resulting coefficients table from summary(model_attach), which is the p-values</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare adjusted p-values to unadjusted p-values</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>p_comparison <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p_values, p_adjusted)</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>p_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                p_values   p_adjusted
(Intercept) 2.526878e-01 1.0000000000
placebo     5.824313e-01 1.0000000000
low         5.731590e-02 0.3438953943
medium      2.317045e-02 0.1390227138
high        7.424826e-01 1.0000000000
attachbase  4.989769e-05 0.0002993861</code></pre>
</div>
</div>
<p>After controlling for treatment group, the only significant predictor of attachment loss change is baseline attachment loss scores (p<sub>adj</sub> = 0.001)</p>
<p>These models were just for exploration, fun, and practice. The final models selected are the SLR’s with treatment group as the IV and either attachment loss change or pocket depth change as the DV. <a href="#Model_1">Back to top of tabset</a></p>
</div>
</div>
</div>
</section>
<section id="Assumptions" class="level2">
<h2 class="anchored" data-anchor-id="Assumptions">Evaluating Assumptions</h2>
<p>In order to evaluate the assumptions of our models, we will first gather the residuals of the model predicting attachment loss change score and the model predicting pocket depth change score.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the jackknife residuals of model_attach</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>jackknife_residuals_attach <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(model_attach1)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the jackknife residuals of model_pd</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>jackknife_residuals_pd <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(model_pd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have our residuals, we can take a closer look at the assumptions.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Linearity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Independence</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Normality</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false">Equal Variances (Homoscedasticity)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-5" role="tab" aria-controls="tabset-8-5" aria-selected="false">Residuals Centered Around Zero</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-6" role="tab" aria-controls="tabset-8-6" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>Since the IV is categorical, we do not need to assess linearity.</p>
<p><a href="#Assumptions">Back to top of tabset</a></p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>Independence can be assessed in part by the study design and how the data was collected. Based on the information provided by the PI, I will assume subjects are independent from each other (e.g.&nbsp;not siblings).</p>
<p>Additionally, we can examine a scatter plot of the model’s residuals against any time point variable (such as ID). Let’s do that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of jackknife residuals vs ID to assess independence for pocket depth change</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> jackknife_residuals_attach)) <span class="sc">+</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Jackknife Residuals vs ID for Attachment Loss Change"</span>,</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Jackknife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of jackknife residuals vs ID to assess independence for pocket depth change</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> jackknife_residuals_pd)) <span class="sc">+</span> </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Residuals vs ID for Pocket Depth Change"</span>,</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Jackknife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-51-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The pattern appears random, suggesting independence.</p>
<p>Note: The gap between ID’s 170 and 200 looks odd, but is an artifact from how the experimenters assigned ID, with females starting at 101, and males starting at 201.</p>
<p><a href="#Assumptions">Back to top of tabset</a></p>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<p>Here we will asses that, for any fixed value of X, Y has a normal distribution. We will do this using Q-Q plots and histograms of the residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the Q-Q plots using the jackknife residuals for attachment loss change</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(jackknife_residuals_attach, <span class="at">main =</span> <span class="st">"Q-Q plots of Jackknife Residuals for model_attach"</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(jackknife_residuals_attach, <span class="at">col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of jackknife residuals for model_attach</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(jackknife_residuals_attach, <span class="at">main =</span> <span class="st">"Histogram of Jackknife Residuals"</span>,</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Jackknife Residuals"</span>,</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-52-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the Q-Q plots using the jackknife residuals for pocket depth change</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(jackknife_residuals_pd, <span class="at">main =</span> <span class="st">"Q-Q plots of Jackknife Residuals for model_pd"</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(jackknife_residuals_pd, <span class="at">col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-52-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of jackknife residuals for model_pd</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(jackknife_residuals_pd, <span class="at">main =</span> <span class="st">"Histogram of Jackknife Residuals"</span>,</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Jackknife Residuals"</span>,</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-52-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The histogram for attachment loss change is a little left-tailed. This could be from an outlier. Comparatively, the Q-Q plot and histogram of the residuals for pocket depth change are normally distributed.</p>
<p>We can also include the Shapiro-Wilk test of normality, which provides a p-value and allows us to numerically establish that the assumption of normality is met. If the p-value is &lt; 0.05 you conclude that the assumption of normality is <em>not</em> met.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(jackknife_residuals_attach)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  jackknife_residuals_attach
W = 0.9604, p-value = 0.003601</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(jackknife_residuals_pd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  jackknife_residuals_pd
W = 0.99059, p-value = 0.6933</code></pre>
</div>
</div>
<p>The assumption of normality is violated for the attachment loss change model (p = 0.0036), but not for the pocket depth change model (p = 0.6933). Looking at the histogram of the residuals for attachment loss change, this is likely due to an outlier.</p>
<p><u>Summary</u></p>
<p>For attachment loss change, we have a slight violation of normality, which could be due to the presence of an outlier. However, regressions are robust to violations of assumptions and this may not actually be an issue. Outliers in the model will be assessed using jackknife residuals to confirm that these points do not have an excessive amount of influence on the model.</p>
<p>Based on the Q-Q plots and histograms of the residuals for pocket depth change, we can conclude that we satisfy the assumption of normality.</p>
<p><a href="#Assumptions">Back to top of tabset</a></p>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<p>Using the scale-location plot will allow us to evaluate the constant variance assumption. This will allow us to see whether the variability of the residuals is roughly constant between each group (<a href="https://tuos-bio-data-skills.github.io/intro-stats-book/regression-diagnostics-in-r.html">Source</a>).</p>
<p>To assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the residual scatterplot using the jackknife residuals for model_attach</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> trtgroup, <span class="at">y =</span> jackknife_residuals_attach)) <span class="sc">+</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Jackknife Residuals vs Treatment Condition for Attachment Loss Change"</span>,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Treatment Condition"</span>,</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"JackKnife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the residual scatterplot using the jackknife residuals for model_pd</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> trtgroup, <span class="at">y =</span> jackknife_residuals_pd)) <span class="sc">+</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Jackknife Residuals vs Treatment Condition for Pocket Depth Change"</span>,</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Treatment Condition"</span>,</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"JackKnife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-54-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It appears that our variances in all groups are equal!</p>
<p>Additionally, while it is not recommended to perform a statistical test to assess for equality of variances (because formal tests of equality of variance are not very powerful), we can still do this using Bartlett’s test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(attachchange <span class="sc">~</span> trtgroup, <span class="at">data =</span> data_missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  attachchange by trtgroup
Bartlett's K-squared = 2.5462, df = 4, p-value = 0.6364</code></pre>
</div>
</div>
<p>The null hypothesis of the Bartlett test is that the <em>variances are equal</em>. Thus failing to reject the null (p &gt; 0.05) indicates that the data are consistent with the equal variance assumption.</p>
<p>So we meet the assumption of equality of variances, looking good!</p>
<p><a href="#Assumptions">Back to top of tabset</a></p>
</div>
<div id="tabset-8-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-5-tab">
<p>To start, we can simply check that the mean of our residuals is close to 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### For attachment loss change score</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the mean of the jackknife residuals for attachment loss change. Should be close to 0.</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(jackknife_residuals_attach)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.004132486</code></pre>
</div>
</div>
<p>We are looking good for attachment loss change score. What about for pocket depth change?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### For pocket depth change score</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the mean of the jackknife residuals for attachment loss change. Should be close to 0.</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(jackknife_residuals_pd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -6.695748e-06</code></pre>
</div>
</div>
<p>A more sophisticated approach is to plot the fitted values vs jackknife residuals. We can then compare the trend between groups to see if they are random. The fitted line should gravitate around 0 with no obvious trends.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate vectors containing the fitted values vs jackknife residuals so we can plot them </span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>fitted_values_pd <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model_pd)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> fitted_values_pd, <span class="at">y =</span> jackknife_residuals_pd)) <span class="sc">+</span> </span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Jackknife Residuals vs Fitted Values for Attachment Loss Change"</span>,</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Fitted Values"</span>,</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Jackknife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$x
[1] "Fitted Values"

$y
[1] "Jackknife Residuals"

$title
[1] "Jackknife Residuals vs Fitted Values for Attachment Loss Change"

attr(,"class")
[1] "labels"</code></pre>
</div>
</div>
<p>The pattern looks random and we can conclude we meet this assumption.</p>
<p><a href="#Assumptions">Back to top of tabset</a></p>
</div>
<div id="tabset-8-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-6-tab">
<p>We meet the assumptions of independence, equal variances, and errors centered around zero required for this analysis. There is a slight violation of normality for the attachment loss change model, but this could be due to an outlier.</p>
</div>
</div>
</div>
</section>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<p>The total population of the study was 130 participants. Of that total, 54 were male and 76 were female. Each treatment group was evenly divided with 26 subjects. The study team found no cause for alarm within patient demographics (See Table 1). Primary outcome data was only collected on 103 subjects as there were 27 patients that were lost-to-follow-up. These subjects were not included in the final analysis. Additionally, Box-and-Whisker Plots were created to assess outliers in the dataset (See Figure 1). No values were excluded for this analysis. The team ran a correlation matrix to determine if any of the covariates had preexisting relationships. Figures 2A and 2B reveal that there was not any strong correlation between covariates. However, there was a strong relationship between both baseline attachment loss and pocket depth and their subsequent 1-year follow up (r’s &gt; 0.80). Additionally, there was a slight association between gender and attachment loss (r = -.17) and pocket depth change (r = -0.21). A two-sample t-test revealed a significant difference between means for males and females (t = 2.20, p = .0303). As a result, we only included gender as a potential demographic covariate. Given the lack of correlations between the outcome variables and the remaining demographic covariates, the team felt assured to move into regression modeling while primarily focusing on treatment group and the primary outcome variables.</p>
<p>To better determine the effect of randomization status on our primary outcome variables, the team created change-score variables to isolate the 1-year change in attachment loss and pocket depth from baseline. A series of linear regressions were conducted with attachment loss or pocket depth change score as the outcome variable and treatment group as the independent variable. Our first model to assess this question was a simple linear regression with treatment group as the independent variable and change in attachment loss as the dependent variable, using the control group as the reference category. A follow up regression with placebo group as the reference category allowed us to assess for any changes between the treatment groups and the placebo. Both of these models allow us to assess the effect of treatment status in comparison to the control or placebo group.</p>
<p>The results of the analyses can be seen in Figures 3-5. For attachment loss change, the overall model is significant (F(4,98) = 2.53, p = 0.0451). Looking at the individual t-statistics, we see that - following adjustment for multiple pairwise comparisons - the placebo group (p = 0.549), low concentration group (p = 0.0668), and high concentration group (p = 1.000) are not statistically different from the control group. The medium concentration group is approaching significance (95% CI: [0.052, 0.38], p = 0.0503). After changing the reference group to the placebo group and applying a Bonferroni correction, none of the groups are significantly different from the placebo group (all p’s &gt; 0.05). When looking at pocket depth change, the overall model is not statistically significant (F(4,96)= 1.958, p = 0.107). Neither model changed in significance when adding gender as a covariate. Assumptions for a regression were assessed using Q-Q plots, histograms of the residuals, scale-location plots, and scatterplots of the residuals against the fitted-values. All assumptions were met, except for a slight violation of normality for the model examining attachment loss, which is potentially due to outliers in the data.</p>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<p>While the overall model for attachment loss change was significant, the only groups that were statistically different from each other were the no treatment control and low concentration gel groups . However, since this was a placebo-controlled RCT, and none of the treatment groups were significantly different from the placebo group, we can conclude that we fail to reject the null hypothesis that the average attachment loss over 1 year is the same between all groups. The model for pocket depth change was not significant and we can conclude that we fail to reject the null hypothesis that the average pocket depth change over 1 year is the same between all groups. Therefore based on the results of both regressions, our final conclusion is that the gel treatment did not reduce attachment loss or pocket depth change compared to a placebo. In fact, there may be evidence that those in the medium-dose treatment group possibly have worse health outcomes compared to the control group, as that comparison was trending towards significance (p = .0503).</p>
<ul>
<li>Note: Next paragraph written by classmate Dominick DeMarsico</li>
</ul>
<p>However, we must address the effect of missingness on our interpretation of the data. There were 27 subjects that were lost-to-follow-up and were unable to provide outcome data (19 of which were male). The lack of males in the final dataset may make this data less predictive of treatment outcomes in males. Additionally, there were more individuals lost-to-follow-up in the treatment groups than the control or placebo groups (11.5% in the placebo and control groups, 19.2% in the low-dose group, 23.1% in the medium-dose group, and 38.5% in the high-dose group), which could further support a potential adverse effect of the gel. Alternatively, there may have been another factor affecting the treatment group which increased the rate of subject attrition that the experimenters are better poised to identify.</p>
</section>
<section id="bonus-practice" class="level1">
<h1>Bonus / Practice</h1>
<p>In this section I will perform multiple imputation and examine outliers using the jackknife residuals, both of which we’re not covered in class up to this point. This is self study.</p>
<section id="Multiple_imputation" class="level2">
<h2 class="anchored" data-anchor-id="Multiple_imputation">Multiple Imputation</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Background</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Coding Example</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">Performing the Multiple Imputation</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>Note: This information is taken from Biostats II (BIOS 6612) slides, week 13 lecture 20, and from <a href="https://stefvanbuuren.name/fimd/">Flexible Imputation of Missing Data</a> 2nd edition.</p>
<p><u>Missing Data</u></p>
<p>To review, there are several assumptions for missing data. The first is MCAR (Missing Completely at Random). This is when the probability of having a missing value is the same for everyone, and is rarely ever the case with real data.</p>
<p>The second is MAR (missing at random). This is when the probability of having a missing value is the same <em>within groups defined by the observed data</em>. That is, if we know that second variable by which the data is NOT MCAR, in addition to the measurements, we can assume MCAR within that second variable. For instance, if we know the missing data is not equal between the sexes, then we can assume MCAR within groups defined by sex. MAR is often observed in situations such as males missing more data than females, or older participants missing more data than younger ones, etc. MAR is more general and more realistic than MCAR. Modern missing data assumptions typically start from the MAR assumption.</p>
<p>MNAR (Missing Not At Random) is the final category of missingness, and is when the the probability of having a missing value varies for reasons that are unknown to you. For example, in public opinion research, those with weaker opinions may respond less than those with stronger opinions, and you may not know this ahead of time. MNAR is the most complex and if you have it, you have your work cut out for you. In that situation, you can find more data about the causes for the missingness, or run lots and lots of sensitivity analyses.</p>
<p>And as they say, the best way to handle missing data is not to have it.</p>
<p><u>Multiple Imputation</u></p>
<p>In the current experiment, we know that data is not MCAR (males are missing more data than females), and thus cannot simply throw out subjects with missing values. If the data are not MCAR, listwise deletion (deleting any subject with a missing value) can severely bias estimates of means, regression coefficients and correlations.</p>
<p>Multiple Imputation is a commonly used method to handle missing data when data is not MCAR, but is MAR. It is a process by which you use observed data to “predict” missing data, then use those “imputed” values in further analyses. Multiple imputation builds upon and pools together “single” imputation approaches.</p>
<p>For example, there exists very simple ways of imputing data, such as plugging in the average or median values in place of missing values. This is not sophisticated and kind of sketchy.</p>
<p>Then there exists regression imputation, where for each variable you fit a regression model of it to the observed data, and then use that model to predict missing values, and use those predictions in place of the missing values. However, this injects bias into the estimate for the correlation between X and Y (since the values fall perfectly in line with the hypothesis that X and Y have a non zero correlation. (and are in a perfect line)).</p>
<p><img src="Media/regression_imputation.png" width="65%" height="65%"></p>
<p>Then there is stochastic regression imputation, which is like regression imputation but <em>adds noise back into the imputations based on the variance of their residuals</em>. This helps account for variance in the results due to missing data.</p>
<p><img src="Media/stochastic_regression_imputation.png" width="65%" height="65%"></p>
<p>Multiple imputation works by fitting multiple stochastic imputation models (can be 100’s or 1000’s), analyzing each dataset separately to produce estimates of interest, and finally pooling together these statistics of interest. If done properly, the pooled statistics are <em>unbiased under MAR, and the SE’s will be correct</em>!</p>
<p><img src="Media/multiple_imputation.png" width="65%" height="65%"></p>
<p>Multiple Imputation is “simple, elegant and powerful. It is simple because it fills the holes in the data with plausible values. It is elegant because the uncertainty about the unknown data is coded in the data itself. And it is powerful because it can solve “other” problems that are actually missing data problems in disguise.” - Stef van Buuren</p>
<p><a href="#Multiple_imputation">Back to top of tabset</a></p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>First we will begin with an example of multiple imputation using the built in airquality dataset in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examining data set and missingness</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Ozone Solar.R Wind Temp Month Day
1    41     190  7.4   67     5   1
2    36     118  8.0   72     5   2
3    12     149 12.6   74     5   3
4    18     313 11.5   62     5   4
5    NA      NA 14.3   56     5   5
6    28      NA 14.9   66     5   6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(airquality))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Ozone Solar.R    Wind    Temp   Month     Day 
     37       7       0       0       0       0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We’re missing 37 values in the Ozone column (24% of values!). We will have to address this missing data somehow.</p>
<p><u>Mean Imputation</u></p>
<p>We could quickly fill in missing data with mean imputation…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here's how you do mean imputation in mice</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(airquality, <span class="at">method =</span> <span class="st">"mean"</span>, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  Ozone  Solar.R</code></pre>
</div>
</div>
<p>But mean imputation will “underestimate the variance, disturb the relations between variables, bias almost any estimate other than the mean and bias the estimate of the mean when data are not MCAR.” You can use mean imputation as a quick fix when there’s a handful of missing values, but it should be avoided in general.</p>
<p><u>Regression Imputation</u></p>
<p>We could alternatively do regression imputation, where we fit a model and then use that model to predict the missing values. In regression imputation, you are essentially using the observed data to predict the missing data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Performing regression imputation using the mice package</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>data_example <span class="ot">&lt;-</span> airquality[, <span class="fu">c</span>(<span class="st">"Ozone"</span>, <span class="st">"Solar.R"</span>)]</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(data_example, <span class="at">method =</span> <span class="st">"norm.predict"</span>, <span class="at">seed =</span> <span class="dv">1</span>,</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">m =</span> <span class="dv">1</span>, <span class="at">print =</span> <span class="cn">FALSE</span>)</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting missing vs observed values</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(imp, Ozone <span class="sc">~</span> Solar.R,</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">"Missing vs Observed values for Ozone ~ Solar.R"</span>,</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">auto.key =</span> <span class="fu">list</span>(<span class="at">corner =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">points =</span> <span class="cn">TRUE</span>, </span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">text =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Missing"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"steelblue"</span>, <span class="st">"red3"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>You predict the values of the missing datapoints with the regression equation resulting from your model. That is, the imputed values correspond to the most likely values under that model. However, the imputed values (red) vary less than the observed values (blue). So each value is the best under the model, but it is very unlikely that the real values would have had this distribution.</p>
<p>Regression imputation yields unbiased estimates of the means and of the regression weights of the model under MCAR. It also does so under MAR, provided that the factors that influence missinginess are part of the model. However, correlations are biased to be greater/higher.</p>
<p>“Regression imputation, as well as its modern incarnations in machine learning is probably the most dangerous of all methods described here. We may be led to believe that we’re to do a good job by preserving the relations between the variables. In reality however, regression imputation artificially strengthens the relations in the data. Correlations are biased upwards. Variability is underestimated. Imputations are too good to be true. Regression imputation is a recipe for false positive and spurious relations.”</p>
<p><u>Stochastic regression imputation</u></p>
<p>Stochastic regression imputation is a refinement of regression imputation that attempts to address correlation bias by adding noise back into the predictions of the missing values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Impute Ozone from Solar.R by stochastic regression imputation using the mice package.</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>data_example <span class="ot">&lt;-</span> airquality[, <span class="fu">c</span>(<span class="st">"Ozone"</span>, <span class="st">"Solar.R"</span>)]</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform stochastic regression imputation</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(data_example, <span class="at">method =</span> <span class="st">"norm.nob"</span>, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1</span>, <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">print =</span> <span class="cn">FALSE</span>)</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting missing vs observed values</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(imp, Ozone <span class="sc">~</span> Solar.R,</span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">"Missing vs Observed values for Ozone ~ Solar.R"</span>,</span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">auto.key =</span> <span class="fu">list</span>(<span class="at">corner =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">points =</span> <span class="cn">TRUE</span>, </span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">text =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Missing"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"steelblue"</span>, <span class="st">"red3"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>“The method = norm.nob argument requests a plain, non-Bayesian, stochastic regression method. This method first estimates the intercept, slope and residual variance under the linear model, then calculates the predicted value for each missing value, and adds a random draw from the residual to the prediction”.</p>
<p>This can create issues though, such as we have one imputed value that is negative! Which might not be plausible (such as in this case, there is no such thing as a negative ozone level).</p>
<p>A more convenient solution is multiple imputation</p>
<p><u>Multiple Imputation</u></p>
<p>Multiple imputation creates m &gt; 1 complete data sets. The m results are then pooled into a final point estimate plus standard error. So each data set is identical in observed values, but differs in imputed values.</p>
<p>We then estimate the parameters of interest from each dataset. This is done by applying the analytic method you would have used if the dataset was complete in the first place (here, a regression). The results of the model on each dataset will differ because the data is different. These differences are caused by the uncertainty of what value to impute.</p>
<p>The last step is that these parameter estimates are then pooled together into a single value, and its variance estimated. The variance is assessed by combining the “within-imputation variance with the extra variance caused by the missing data (between-imputation variance)”. So under the appropriate conditions the pooled estimates are unbiased. MI solves the problem of ‘too small’ SEs of other imputation methods we just covered.</p>
<p>Now let’s perform the multiple imputation on the airquality data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform multiple imputation on the airquality data set</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(airquality, <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">m =</span> <span class="dv">20</span>, <span class="at">print =</span> <span class="cn">FALSE</span>) <span class="co"># This line imputes the missing data 20 times</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a linear regression </span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>model_imp <span class="ot">&lt;-</span> <span class="fu">with</span>(imp, <span class="fu">lm</span>(Ozone <span class="sc">~</span> Wind <span class="sc">+</span> Temp <span class="sc">+</span> Solar.R)) <span class="co"># You have to run the regression with "with(imp, lm(etc))</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_imp) <span class="co"># This runs a regression on each imputed dataset (so 20 different regressions)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 6
   term        estimate std.error statistic  p.value  nobs
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;
 1 (Intercept) -60.7      17.9        -3.40 8.78e- 4   153
 2 Wind         -2.95      0.514      -5.75 4.96e- 8   153
 3 Temp          1.53      0.197       7.74 1.42e-12   153
 4 Solar.R       0.0671    0.0184      3.64 3.70e- 4   153
 5 (Intercept) -56.8      18.5        -3.07 2.56e- 3   153
 6 Wind         -3.33      0.532      -6.25 4.04e- 9   153
 7 Temp          1.56      0.205       7.58 3.49e-12   153
 8 Solar.R       0.0554    0.0191      2.89 4.37e- 3   153
 9 (Intercept) -74.0      18.7        -3.95 1.19e- 4   153
10 Wind         -2.69      0.540      -4.99 1.67e- 6   153
# ℹ 70 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">pool</span>(model_imp)) <span class="co"># This pools together the parameters of all 20 regressions (statistic is Wald's test) into a single model.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         term     estimate   std.error statistic       df      p.value
1 (Intercept) -65.87829658 23.09377412 -2.852643 69.97033 5.696702e-03
2        Wind  -3.01897171  0.66252377 -4.556775 70.51194 2.125022e-05
3        Temp   1.63483547  0.25107557  6.511328 75.99913 7.203792e-09
4     Solar.R   0.05861581  0.02267832  2.584662 90.10797 1.135441e-02</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mids workflow using pipes</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>est3 <span class="ot">&lt;-</span> airquality <span class="sc">%&gt;%</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mice</span>(<span class="at">seed =</span> <span class="dv">1</span>, <span class="at">print =</span> <span class="cn">FALSE</span>, <span class="at">m =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">lm</span>(<span class="at">formula =</span> Ozone <span class="sc">~</span> Wind <span class="sc">+</span> Temp <span class="sc">+</span> Solar.R)) <span class="sc">%&gt;%</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pool</span>()</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(est3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         term     estimate   std.error statistic       df      p.value
1 (Intercept) -65.87829658 23.09377412 -2.852643 69.97033 5.696702e-03
2        Wind  -3.01897171  0.66252377 -4.556775 70.51194 2.125022e-05
3        Temp   1.63483547  0.25107557  6.511328 75.99913 7.203792e-09
4     Solar.R   0.05861581  0.02267832  2.584662 90.10797 1.135441e-02</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a regression on the imputed airquality data set. </span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(airquality, <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">print =</span> <span class="cn">FALSE</span>)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">with</span>(imp, <span class="fu">lm</span>(Ozone <span class="sc">~</span> Solar.R))</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print out the estimates for the first and second data set</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit<span class="sc">$</span>analyses[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     Solar.R 
 22.2963201   0.1057437 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit<span class="sc">$</span>analyses[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     Solar.R 
 20.7891622   0.1140081 </code></pre>
</div>
</div>
<p>Notice that the paremter estimates differ because of the uncertainty created by the missing data.</p>
<p>Applying the standard pooling rules is done with</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">pool</span>(fit)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         term   estimate  std.error statistic       df      p.value
1 (Intercept) 21.5321395 5.67991951  3.790923 136.3544 0.0002245626
2     Solar.R  0.1091546 0.02846503  3.834693 102.7169 0.0002170873</code></pre>
</div>
</div>
<p>Any R expression produced by <sub>expression()</sub> can be used on the multiply imputed data…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract residuals and fitted values</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This gets you ALL the residuals for ALL the models/dataset</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>imp_residuals <span class="ot">&lt;-</span> <span class="fu">sapply</span>(model_imp[[<span class="dv">4</span>]], residuals)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Same thing but for the fitted</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>imp_fitted <span class="ot">&lt;-</span> <span class="fu">sapply</span>(model_imp[[<span class="dv">4</span>]],fitted)</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Don't know where to go from here. Apparently you can take the average of all of these to get the average residuals, but it's not published anywhere.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can compare the results of our multiple imputation model with the listwise deletion model to see how different they came out.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>model_non_imp <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ozone <span class="sc">~</span> Wind <span class="sc">+</span> Temp <span class="sc">+</span> Solar.R, <span class="at">data =</span> airquality, <span class="at">na.action =</span> na.omit)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_non_imp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Ozone ~ Wind + Temp + Solar.R, data = airquality, 
    na.action = na.omit)

Residuals:
    Min      1Q  Median      3Q     Max 
-40.485 -14.219  -3.551  10.097  95.619 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -64.34208   23.05472  -2.791  0.00623 ** 
Wind         -3.33359    0.65441  -5.094 1.52e-06 ***
Temp          1.65209    0.25353   6.516 2.42e-09 ***
Solar.R       0.05982    0.02319   2.580  0.01124 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 21.18 on 107 degrees of freedom
  (42 observations deleted due to missingness)
Multiple R-squared:  0.6059,    Adjusted R-squared:  0.5948 
F-statistic: 54.83 on 3 and 107 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">pool</span>(model_imp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         term     estimate   std.error statistic       df      p.value
1 (Intercept) -65.87829658 23.09377412 -2.852643 69.97033 5.696702e-03
2        Wind  -3.01897171  0.66252377 -4.556775 70.51194 2.125022e-05
3        Temp   1.63483547  0.25107557  6.511328 75.99913 7.203792e-09
4     Solar.R   0.05861581  0.02267832  2.584662 90.10797 1.135441e-02</code></pre>
</div>
</div>
<p>Our regression using MI and the complete case (i.e.&nbsp;listwise deletion) data set are comparable!</p>
<p>Note: what we are NOT doing in multiple imputation is taking an average of the imputed data and running a model on that as if its a single, complete data set. “Researchers are often tempted to average the multiply imputed data, and analyze the averaged data as if it were complete. This method yields incorrect standard errors, confidence intervals and p-values, and thus should not be used if any form of statistical testing or uncertainty analysis is to be done on the imputed data. The reason is that the procedure ignores the between-imputation variability, and hence shares all the drawbacks of single imputation”.</p>
<p>Note: It’s recommended to <em>impute then transform</em>, because if you create variables based on other variables, there are relationships between those variables that MI doesn’t account for (it might create combinations of variables that are unrealistic)</p>
<p>You can do this as</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of impute then transform method (i.e. how to add variables to an imputed dataset)</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>data_ex <span class="ot">&lt;-</span> boys[, <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"hgt"</span>, <span class="st">"wgt"</span>, <span class="st">"hc"</span>, <span class="st">"reg"</span>)]</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(data_ex, <span class="at">print =</span> <span class="cn">FALSE</span>, <span class="at">seed =</span> <span class="dv">1</span>)</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="co"># put the data in long format</span></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>long <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">complete</span>(imp, <span class="st">"long"</span>, <span class="at">include =</span> <span class="cn">TRUE</span>)</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>long<span class="sc">$</span>new_var <span class="ot">&lt;-</span> <span class="fu">with</span>(long, <span class="dv">100</span> <span class="sc">*</span> wgt <span class="sc">/</span> hgt)</span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>imp.itt <span class="ot">&lt;-</span> <span class="fu">as.mids</span>(long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#Multiple_imputation">Back to top of tabset</a></p>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<p>Now that we have reviewed the background and gone through coding examples of multiple imputation, we are ready to perform it for the dataset for Project 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pool the parameters of interest for a regression on the imputed values for attach change control as reference</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>model_imp <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mice</span>(<span class="at">seed =</span> <span class="dv">1</span>, <span class="at">print =</span> <span class="cn">FALSE</span>, <span class="at">m =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">lm</span>(attachchange <span class="sc">~</span> placebo <span class="sc">+</span> low <span class="sc">+</span> medium <span class="sc">+</span> high)) <span class="sc">%&gt;%</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pool</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 1158</code></pre>
</div>
</div>
<p>None of the p-values for the pooled regressions on the MI data are significant (p &gt; 0.05).</p>
<p>How do those parameter estimates compare to the complete case analysis model?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare coefficients to complete case analysis for attachment loss with control as reference category</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>MI <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_imp)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>MI</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         term   estimate  std.error  statistic       df     p.value
1 (Intercept) -0.1853493 0.06920536 -2.6782512 65.79196 0.009337056
2     placebo  0.1158204 0.09076258  1.2760813 91.37003 0.205161055
3         low  0.1608502 0.10027097  1.6041549 59.48514 0.113976747
4      medium  0.1612700 0.11393844  1.4154130 37.61151 0.165174849
5        high  0.0930271 0.15435067  0.6026997 18.41109 0.554060413</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>complete_case <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_attach1)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>complete_case<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Estimate Std. Error    t value     Pr(&gt;|t|)
(Intercept) -0.22169165 0.05590110 -3.9657832 0.0001392148
placebo      0.13461856 0.07905610  1.7028232 0.0917709125
low          0.20387790 0.08091650  2.5196086 0.0133650749
medium       0.21513551 0.08196711  2.6246567 0.0100625287
high         0.05690063 0.08727557  0.6519652 0.5159498143</code></pre>
</div>
</div>
<p>They are drastically different, although still not significant.</p>
<p>We can also plot the imputed values for a sample of m dataset (not too many or it’s hard to see!) in order to visually assess that our imputed values are comparabe to the observed values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot imputed values for m = 5 data set</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>impy <span class="ot">&lt;-</span> <span class="fu">mice</span>(data, <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">print =</span> <span class="cn">FALSE</span>, <span class="at">m =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 285</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>model_impy <span class="ot">&lt;-</span> <span class="fu">with</span>(imp, attachchange <span class="sc">~</span> trtgroup)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This is cool, here's how I can plot the imputed values for attach change </span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(impy, attachchange <span class="sc">~</span> trtgroup,</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">"Example of Imputed Values for m = 5 Dataset"</span>,</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">auto.key =</span> <span class="fu">list</span>(<span class="at">space =</span> <span class="st">"right"</span>,</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">points =</span> <span class="cn">TRUE</span>, </span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Missing"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue4"</span>, <span class="st">"red3"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What about for the same model but with placebo as the reference group?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pool the parameters of interest for a regression on the imputed values for attach change placebo as reference</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>model_imp <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mice</span>(<span class="at">seed =</span> <span class="dv">1</span>, <span class="at">print =</span> <span class="cn">FALSE</span>, <span class="at">m =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">lm</span>(attachchange <span class="sc">~</span> control <span class="sc">+</span> low <span class="sc">+</span> medium <span class="sc">+</span> high)) <span class="sc">%&gt;%</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pool</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 1158</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare coefficients for complete case analysis with attachment with placebo as reference category</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_imp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         term    estimate  std.error  statistic       df   p.value
1 (Intercept) -0.06952890 0.06697153 -1.0381859 75.81298 0.3024834
2     control -0.11582043 0.09076258 -1.2760813 91.37003 0.2051611
3         low  0.04502973 0.11027780  0.4083299 41.79227 0.6851161
4      medium  0.04544952 0.11870540  0.3828766 33.28878 0.7042453
5        high -0.02279333 0.16350701 -0.1394028 16.62753 0.8908064</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_attach2)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Estimate Std. Error    t value   Pr(&gt;|t|)
(Intercept) -0.08707309 0.05590110 -1.5576275 0.12254523
control     -0.13461856 0.07905610 -1.7028232 0.09177091
low          0.06925934 0.08091650  0.8559360 0.39412117
medium       0.08051695 0.08196711  0.9823081 0.32836700
high        -0.07771793 0.08727557 -0.8904889 0.37538435</code></pre>
</div>
</div>
<p>The estimates are more comparable, although still pretty different. Still not significant with both methods.</p>
<p>And finally for pocket depth change.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pool the parameters of interest for a regression on the imputed values for pocket depth  change placebo as reference</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>model_imp <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mice</span>(<span class="at">seed =</span> <span class="dv">1</span>, <span class="at">print =</span> <span class="cn">FALSE</span>, <span class="at">m =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">lm</span>(pdchange <span class="sc">~</span> placebo <span class="sc">+</span> low <span class="sc">+</span> medium <span class="sc">+</span> high)) <span class="sc">%&gt;%</span></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pool</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 1158</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare coefficients with complete case analysis for pocket depth change</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>MI <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_imp)</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>MI</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         term    estimate  std.error  statistic       df      p.value
1 (Intercept) -0.33597389 0.06144440 -5.4679330 66.87925 7.296278e-07
2     placebo -0.00982096 0.08061544 -0.1218248 92.74234 9.033013e-01
3         low  0.11415425 0.07995226  1.4277802 96.05307 1.565984e-01
4      medium  0.11260463 0.08900896  1.2650932 60.47912 2.106907e-01
5        high -0.02704497 0.10936047 -0.2473011 30.38938 8.063384e-01</code></pre>
</div>
</div>
<p>Here the models are a LOT more comparable, although still not significant. It seems we can conclude that missing values impact the attachment loss measurements more than pocket depth change.</p>
<p>Let’s finish by plotting the imputed values for pocket depth change</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot imputed values for m = 5 data set</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>impy <span class="ot">&lt;-</span> <span class="fu">mice</span>(data, <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">print =</span> <span class="cn">FALSE</span>, <span class="at">m =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 285</code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>model_impy <span class="ot">&lt;-</span> <span class="fu">with</span>(imp, pdchange <span class="sc">~</span> trtgroup)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This is cool, here's how I can plot the imputed values for attach change </span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(impy, pdchange <span class="sc">~</span> trtgroup,</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">"Example of Imputed Values for m = 5 Dataset"</span>,</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">auto.key =</span> <span class="fu">list</span>(<span class="at">space =</span> <span class="st">"right"</span>,</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">points =</span> <span class="cn">TRUE</span>, </span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Missing"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue4"</span>, <span class="st">"red3"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks pretty good.</p>
<p><a href="#Multiple_imputation">Back to top of tabset</a></p>
</div>
</div>
</div>
</section>
<section id="Jackknife" class="level2">
<h2 class="anchored" data-anchor-id="Jackknife">Identify Outliers using Jackknife Residuals</h2>
<p>In this section we will explore how our analysis would have changed if we identified outliers using the jackknife residuals.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Background</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Identifying Outliers</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">Rerunning the Model with Outliers Removed</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<p>*Note: This information is from BIOS 6602 Week 6 Lecture 10</p>
<p>Jackknife residuals are a type of residual used in regressions that allows us to detect outliers that have a significant impact on the regression coefficients of the model.</p>
<p>Jackknife residuals are calculated by systematically leaving out one observation (i) at a time from a dataset, fitting the regression model to the remaining dataset, and predicting the left out observation. The residual for each observation is then computed based on that prediction.</p>
<p>This process follows three step:</p>
<ul>
<li><p>Fit the regression model to the data, excluding observation (i)</p></li>
<li><p>Use the model to predict the left-out observation (i)</p></li>
<li><p>Calculate the jackknife residual as the difference between the actual value and that fitted value</p></li>
</ul>
<p>Jackknife residuals are similar to standardized residuals. Standardized residuals are standardized by the standard error of the regression, and are primarily used for identifying outliers. Jackknife residuals on the other hand allow you to assess the leverage of individuals data points, to see how much they actually influence the model (<a href="https://stats.stackexchange.com/questions/204708/is-studentized-residuals-v-s-standardized-residuals-in-lm-model">Source</a>)</p>
<p><img src="Media/rstudent-jackknife.png" width="95%"></p>
<p>Jackknife residuals follow exactly a t(n-p-2) distribution, where approximately 5% of residuals are expected to exceed 1.96 in absolute value. Jackknife residuals make suspicious values more obvious compared to other residuals.</p>
<p>Definitions vary, but we generally consider a residual to be an outlier if the jackknife residual is +- 3.</p>
<p>However, a potential outlier value may not actually have that dramatic of an impact on the model (which is what we are concerned that outliers will do). That is why we use jackknife residuals to investigate leverage and influence.</p>
<ul>
<li>Extreme X values can have <em>high leverage</em>.</li>
<li>Extreme X values can have <em>high influence</em></li>
<li>A high-leverage point becomes an <em>influential</em> point if its Y value doesn’t follow the pattern of the rest of the data (i.e.&nbsp;is too low or too high)</li>
</ul>
<p><img src="Media/leverage_influence.png" width="80%"></p>
<p>An observation is influential if removing it substantially changes the estimate of the coefficients for that model. We use five measurements to assess influence: Jackknife residuals, Leverage, Cook’s Distance (Cook’s D), DFFITS, and DFBETAS.</p>
<ul>
<li><p>Leverage: Measures how far a measurement deviates from the mean. You want to examine values greater than 2(p+1)/n</p></li>
<li><p>Cook’s D: Measures the influence of an observation on regression predictions. You want to examine observations with d_i &gt; 1.0</p></li>
<li><p>DFFITS: Measures the influence of an observation on regression predictions (related to Cook’s D). You want to examine observations outside the range of +-2(sqrt(p+10n)). If h_i is near zero, then that observation has little effect.</p></li>
<li><p>DDFBETAS: Measure the influence of an observation on *individual* coefficient estimates. You want to examine estimates outside the range of +- 2/sqrt(n). A large DFBETA for variable k indicates that the i-th observation has a sizeable impact on the k-th regression coefficient.</p></li>
</ul>
<p>Note: p = the number of variables in the model</p>
<p><img src="Media/jackknife_cheet_sheet.png" width="90%"></p>
<p><a href="#Jackknife">Back to top of tabset</a></p>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<p><a href="https://rpubs.com/liamroel13/stat312_mod4_les15">This website</a> was used for coding information for this section, alongside the notes from BIOS 6602</p>
<p>Now that we have covered the background for jackknife residuals, we can apply that knowledge to assess for outliers in our dataset for this project!</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Attachment Loss</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Pocket Depth</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Set up</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Jackknife Residuals</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">Leverage</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false">Cook’s D</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-5" role="tab" aria-controls="tabset-10-5" aria-selected="false">DFFITS</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-6" role="tab" aria-controls="tabset-10-6" aria-selected="false">DFBETAS</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-7" role="tab" aria-controls="tabset-10-7" aria-selected="false">Additional Plots</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-8" role="tab" aria-controls="tabset-10-8" aria-selected="false">Final Look and Conclusion</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>Recall that we computed the jackknife residuals earlier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the jackknife residuals of model_attach</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>jackknife_residuals_attach <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(model_attach1)</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the jackknife residuals of model_pd</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>jackknife_residuals_pd <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(model_pd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s generate a table so we can handily compare: ID, jackknife residual, leverage (diagonal hat), DFFITS, and DFBETAs for each participant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get leverage values (hat values)</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>hat_values_attach <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(model_attach1)</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Cook's D values</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>cooks_d_attach <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(model_attach1)</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the DFFITS values</span></span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>dffits_attach <span class="ot">&lt;-</span> <span class="fu">dffits</span>(model_attach1)</span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the DFBETAS</span></span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>dfbetas_attach <span class="ot">&lt;-</span> <span class="fu">dfbetas</span>(model_attach1)</span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a table with ID and all diagnostic values</span></span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a>diagnostics_attach <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> data_missing<span class="sc">$</span>id, <span class="at">jackknife_residuals =</span> jackknife_residuals_attach, <span class="at">leverage =</span> hat_values_attach, <span class="at">cooks_D =</span> cooks_d_attach, <span class="at">dffits =</span> dffits_attach, <span class="at">dfbetas =</span> dfbetas_attach)</span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-16"><a href="#cb184-16" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(diagnostics_attach), <span class="at">caption =</span> <span class="st">"Diagnostics for Attachment Loss Change Model"</span>, <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb184-17"><a href="#cb184-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Diagnostics for Attachment Loss Change Model</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">jackknife_residuals</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">leverage</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cooks_D</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dffits</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas..Intercept.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.placebo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.medium</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">101</td>
<td style="text-align: right;">0.5800959</td>
<td style="text-align: right;">0.0500000</td>
<td style="text-align: right;">0.0035664</td>
<td style="text-align: right;">0.1330831</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0973313</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">103</td>
<td style="text-align: right;">1.5996714</td>
<td style="text-align: right;">0.0434783</td>
<td style="text-align: right;">0.0228989</td>
<td style="text-align: right;">0.3410511</td>
<td style="text-align: right;">0.3410511</td>
<td style="text-align: right;">-0.2411595</td>
<td style="text-align: right;">-0.2356149</td>
<td style="text-align: right;">-0.2325949</td>
<td style="text-align: right;">-0.2184475</td>
</tr>
<tr class="odd">
<td style="text-align: right;">104</td>
<td style="text-align: right;">1.4044559</td>
<td style="text-align: right;">0.0476190</td>
<td style="text-align: right;">0.0195311</td>
<td style="text-align: right;">0.3140459</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.2270548</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">105</td>
<td style="text-align: right;">-0.8928811</td>
<td style="text-align: right;">0.0434783</td>
<td style="text-align: right;">0.0072626</td>
<td style="text-align: right;">-0.1903629</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-0.1346069</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">106</td>
<td style="text-align: right;">-1.6995151</td>
<td style="text-align: right;">0.0500000</td>
<td style="text-align: right;">0.0298289</td>
<td style="text-align: right;">-0.3898955</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-0.2851530</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">107</td>
<td style="text-align: right;">-2.7107885</td>
<td style="text-align: right;">0.0476190</td>
<td style="text-align: right;">0.0690131</td>
<td style="text-align: right;">-0.6061507</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-0.4382463</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><a href="#Jackknife">Back to top of tabset</a></p>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<p>We can start by making a plot of the jackknife residuals to assess if there are outliers &lt; -3 or &gt; 3 SDs).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot jackknife outiers and label any values that are &gt; 3 or &lt; -3.</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> jackknife_residuals_attach)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">3</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Jackknife Residuals"</span>,</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Jackknife Residuals vs ID"</span>) <span class="sc">+</span> </span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(jackknife_residuals_attach <span class="sc">&gt;</span> <span class="dv">3</span> <span class="sc">|</span> jackknife_residuals_attach <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">3</span>, id, <span class="st">''</span>)), </span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Participant 168 is a potential outlier based on the residual value.</p>
<p>Let’s look at this participant more closely.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine participant 168 to assess what values could make them an outlier</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>data_missing[data_missing<span class="sc">$</span>id <span class="sc">==</span> <span class="dv">168</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    id trtgroup gender race      age smoker sites attachbase attach1year
58 168        5      2    5 54.20397      0   168   5.089286    4.041667
     pdbase  pd1year attachchange   pdchange placebo control low medium high
58 3.410714 2.904762    -1.047619 -0.5059524       0       0   0      0    1
   trt trt3groups
58   1          3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort our dataset by descending order of attachment at baseline to see if participant 168 is the highest</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(data_missing[<span class="fu">order</span>(<span class="sc">-</span>data_missing<span class="sc">$</span>attachbase),]), <span class="at">caption =</span> <span class="st">"Diagnostics for Attachment Loss Change Model"</span>, <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Diagnostics for Attachment Loss Change Model</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">trtgroup</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">race</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">smoker</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sites</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attachbase</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attach1year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pdbase</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pd1year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attachchange</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pdchange</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">placebo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">control</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">medium</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">high</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">trt</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">trt3groups</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">58</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">54.20397</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">5.089286</td>
<td style="text-align: right;">4.041667</td>
<td style="text-align: right;">3.410714</td>
<td style="text-align: right;">2.904762</td>
<td style="text-align: right;">-1.0476190</td>
<td style="text-align: right;">-0.5059524</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">55.17864</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">4.956522</td>
<td style="text-align: right;">5.304348</td>
<td style="text-align: right;">5.217391</td>
<td style="text-align: right;">4.891304</td>
<td style="text-align: right;">0.3478261</td>
<td style="text-align: right;">-0.3260870</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">40</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">49.07598</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">126</td>
<td style="text-align: right;">4.388889</td>
<td style="text-align: right;">3.488000</td>
<td style="text-align: right;">3.666667</td>
<td style="text-align: right;">3.230159</td>
<td style="text-align: right;">-0.9008889</td>
<td style="text-align: right;">-0.4365079</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">102</td>
<td style="text-align: right;">269</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">64.90075</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">4.080247</td>
<td style="text-align: right;">3.685185</td>
<td style="text-align: right;">3.370370</td>
<td style="text-align: right;">3.265432</td>
<td style="text-align: right;">-0.3950617</td>
<td style="text-align: right;">-0.1049383</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">18</td>
<td style="text-align: right;">121</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">54.49692</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">4.014493</td>
<td style="text-align: right;">3.825000</td>
<td style="text-align: right;">3.608696</td>
<td style="text-align: right;">3.783333</td>
<td style="text-align: right;">-0.1894928</td>
<td style="text-align: right;">0.1746377</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">17</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">41.83710</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">3.886667</td>
<td style="text-align: right;">3.920000</td>
<td style="text-align: right;">4.200000</td>
<td style="text-align: right;">3.880000</td>
<td style="text-align: right;">0.0333333</td>
<td style="text-align: right;">-0.3200000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>We have confirmed that participant 168 has the largest values for attachment loss at baseline (5.09). If that’s the case however, participant 3 is not far behind them (4.96) (who incidentally has the highest baseline pocket depth measurement), followed by participant 40 a large amount lower (4.39).</p>
<p>We can also (apparently) run a test statistic to test if we have an outlier using the ‘car’ package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">outlierTest</span>(model_attach1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>No Studentized residuals with Bonferroni p &lt; 0.05
Largest |rstudent|:
    rstudent unadjusted p-value Bonferroni p
58 -3.602896         0.00049863     0.051359</code></pre>
</div>
</div>
<p>This is a test of a hypothesis that we do not have an outlier. We reject that hypothesis (p &lt; 0.05) so we have an outlier (I think).</p>
<p><a href="#Jackknife">Back to top of tabset</a></p>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<p><strong>Leverage</strong> is a measure of geometric distance of an observation’s predictor point from the center point of the predictor space. In other words, leverage is a measurement of how far that observation deviates from the mean of that variable. High leverage observations have the potential to be very influential, but they are not <em>necessarily</em> influential. It’s possible for a high leverage point to not be influential, but very difficult for a low leverage point to be influential.</p>
<p>Leverage is calculated as</p>
<p>&lt;img src=“Media/leverage.png” width=“90%&gt;</p>
<p>If X _i is close to Xbar, then h_i is small (i.e.&nbsp;the i-th point has low leverage).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Caculate cutoff for leverage</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>cutoff_leverage <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>((<span class="dv">4</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">103</span>)</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>cutoff_leverage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09708738</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make leverage plot in ggplot. Set a horizontal line at the cutoff point, and label ID's for participants that pass that line</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostics_attach, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> leverage)) <span class="sc">+</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> cutoff_leverage) <span class="sc">+</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Leverage Plot with Cutoff Line"</span>,</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hat Values"</span>) <span class="sc">+</span> </span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(leverage <span class="sc">&gt;</span> cutoff_leverage, id, <span class="st">""</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>None of our data points pass the cutoff point for leverage/hat values. I think this may be because the IV is categorical which changes the pattern and interpretation. Will check with a professor.</p>
<p><a href="#Jackknife">Back to top of tabset</a></p>
</div>
<div id="tabset-10-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<p>Cook’s D combines information about the residuals and leverage into a single value. A higher Cook’s D value signifies that the data point woud greatly change the regression coefficients, and is therefore influential and may impact the model’s accuracy.</p>
<p>Apparently we actually want to look at a cutoff of Cook’s D as 4/(n-p-1). Let’s calculate that and store it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cutoff for Cook's D</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>cutoff_d <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">/</span>((<span class="fu">nrow</span>(data_missing) <span class="sc">-</span> <span class="fu">length</span>(model_attach1<span class="sc">$</span>coefficients) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>cutoff_d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04123711</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Cook's D plot in ggplot. Set a horizontal line at the cutoff point, and label ID's for participants that pass that line</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostics_attach, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> cooks_D)) <span class="sc">+</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> cutoff_d) <span class="sc">+</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cook's D with Cutoff Line"</span>,</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cook's D"</span>) <span class="sc">+</span> </span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(cooks_D <span class="sc">&gt;</span> cutoff_d, id, <span class="st">""</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that participants 107, 144, 146 and 168 are past the cutoff for Cook’s D. As when looking at the residuals plot, participant 168 is drastically different compared to the other potential outliers.</p>
<p><a href="#Jackknife">Back to top of tabset</a></p>
</div>
<div id="tabset-10-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-5-tab">
<p>Now we will examine DFFITS (Difference in fits). DFFITS is a measure used to identify influential data points in a regression analysis. It quantifes how much the predicted values (Y) of a model change when that particular observation is left out from the analysis. So in this case it is the difference in attachment loss change if we take out observation i from the analysis.</p>
<p>Let’s make a plot where we label the values that are past the cutoff.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the cutoff for DFFITS</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>cutoff_dffits <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>((<span class="dv">4</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">103</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>cutoff_dffits</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4406526</code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make DFFITS plot in ggplot. Set a horizontal line at the cutoff points, and label ID's for participants that pass those lines.</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostics_attach, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> dffits)) <span class="sc">+</span> </span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(cutoff_dffits, <span class="sc">-</span>cutoff_dffits)) <span class="sc">+</span> </span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(dffits <span class="sc">&lt;</span> <span class="sc">-</span>cutoff_dffits <span class="sc">|</span> dffits <span class="sc">&gt;</span> cutoff_dffits, id, <span class="st">""</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DFFITS by ID"</span>,</span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"DFFITS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Again we are flagging participants 107, 113, 144, 168. The new addition is 113, who is right on the cutoff line. Again participant 168 is the most egregious, and the other potential outliers are a lot closer to the cutoff.</p>
<p><a href="#Jackknife">Back to top of tabset</a></p>
</div>
<div id="tabset-10-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-6-tab">
<p>Now we can look at the DFBETAs (Difference in Betas). DFBETAS quantify how much the beta coefficients for each variable in the model change when you exclude observation i from the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the cutoff for DFBETAS</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>cutoff_dfbetas <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">103</span>)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>cutoff_dfbetas</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1970659</code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make DFBETAS plot in ggplot. Set a horizontal line at the cutoff points, and label ID's for participants that pass those lines.</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="co"># For placebo group</span></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostics_attach, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> dfbetas.placebo)) <span class="sc">+</span> </span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(cutoff_dfbetas, <span class="sc">-</span>cutoff_dfbetas)) <span class="sc">+</span> </span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(dfbetas.placebo <span class="sc">&lt;</span> <span class="sc">-</span>cutoff_dfbetas <span class="sc">|</span> dfbetas.placebo <span class="sc">&gt;</span> cutoff_dfbetas, id, <span class="st">""</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DFBETAS by ID for Placebo"</span>,</span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"DFBETA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For low dose group</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostics_attach, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> dfbetas.low)) <span class="sc">+</span> </span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(cutoff_dfbetas, <span class="sc">-</span>cutoff_dfbetas)) <span class="sc">+</span> </span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(dfbetas.low <span class="sc">&lt;</span> <span class="sc">-</span>cutoff_dfbetas <span class="sc">|</span> dfbetas.low <span class="sc">&gt;</span> cutoff_dfbetas, id, <span class="st">""</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DFBETAS by ID for Low Dose"</span>,</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"DFBETA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-84-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For medium dose group</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostics_attach, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> dfbetas.medium)) <span class="sc">+</span> </span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(cutoff_dfbetas, <span class="sc">-</span>cutoff_dfbetas)) <span class="sc">+</span> </span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(dfbetas.medium <span class="sc">&lt;</span> <span class="sc">-</span>cutoff_dfbetas <span class="sc">|</span> dfbetas.medium <span class="sc">&gt;</span> cutoff_dfbetas, id, <span class="st">""</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DFBETAS by ID for Medium Dose"</span>,</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"DFBETA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-84-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For high does group</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostics_attach, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> dfbetas.high)) <span class="sc">+</span> </span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(cutoff_dfbetas, <span class="sc">-</span>cutoff_dfbetas)) <span class="sc">+</span> </span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(dfbetas.high <span class="sc">&lt;</span> <span class="sc">-</span>cutoff_dfbetas <span class="sc">|</span> dfbetas.high <span class="sc">&gt;</span> cutoff_dfbetas, id, <span class="st">""</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DFBETAS by ID for High Dose"</span>,</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"DFBETA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-84-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That’s a lot of points that are past the cutoff! I think for these plots it might matter less if we’re pass that point. I think the idea here is we get a fine tune look at, for instance, how participant 168 drastically changes the beta for high, compared to how much any other point changes the betas. Other possible values of concern are 144 and 146. All the other data points are still roughly around the cutoff of .20, but 168 is around .7!</p>
<p><a href="#Jackknife">Back to top of tabset</a></p>
</div>
<div id="tabset-10-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-7-tab">
<p>The car package in R has some handy plots that we can use to help us with diagnosing outliers.</p>
<p>The first is the influence plot, which essentially combines the jackknife residuals plot with the Cook’s D plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(model_attach1, <span class="at">main =</span> <span class="st">"Influence Plot"</span>,</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">sub =</span> <span class="st">"Circle size is proportional to Cook's Distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      StudRes        Hat       CookD
6  -2.7107885 0.04761905 0.069013121
8  -0.5238664 0.06250000 0.003686439
12  1.4073671 0.06250000 0.026147438
58 -3.6028957 0.06250000 0.154223694</code></pre>
</div>
</div>
<p>Using this plot, we can see that obseration 58 (ID 168) has the largest residual value and Cook’s D value by a large margin!</p>
<p>Additionally, a single line of code provides us with some useful diagnostic plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># infIndexPlot gives us a series of plots that we need to investigate influence points</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">infIndexPlot</span>(model_attach1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The first plot is the Cook’s D plot, the second plot is the studentized residuals plot, and the leverage/hat values plot, all of which we plotted before. New is the third plot which is the Bonferroni P-value plot.</p>
<p>Based on these plots we can see pretty readily that participant 168 is a true outlier. That is, they are a point that has high leverage AND influence in this model.</p>
<p><a href="#Jackknife">Back to top of tabset</a></p>
</div>
<div id="tabset-10-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-8-tab">
<p>We saw that participant 168 is the most egregious offender, and participants 107, 144, 146, and MAYBE 113 are flagging past our different cutoff points.</p>
<p>Let’s take one last look at the table of these participants</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print diagnostics table of potential outliers</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(diagnostics_attach[diagnostics_attach<span class="sc">$</span>id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">107</span>,<span class="dv">113</span>,<span class="dv">144</span>,<span class="dv">146</span>,<span class="dv">168</span>),], <span class="at">caption =</span> <span class="st">"Correlation Matrix"</span>, <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Correlation Matrix</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">jackknife_residuals</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">leverage</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cooks_D</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dffits</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas..Intercept.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.placebo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.medium</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">-2.710789</td>
<td style="text-align: right;">0.0476190</td>
<td style="text-align: right;">0.0690131</td>
<td style="text-align: right;">-0.6061507</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-0.4382463</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">113</td>
<td style="text-align: right;">2.092587</td>
<td style="text-align: right;">0.0434783</td>
<td style="text-align: right;">0.0384816</td>
<td style="text-align: right;">0.4461411</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.3154694</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">40</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">-2.670168</td>
<td style="text-align: right;">0.0434783</td>
<td style="text-align: right;">0.0610008</td>
<td style="text-align: right;">-0.5692818</td>
<td style="text-align: right;">-0.5692818</td>
<td style="text-align: right;">0.4025431</td>
<td style="text-align: right;">0.3932880</td>
<td style="text-align: right;">0.3882470</td>
<td style="text-align: right;">0.3646322</td>
</tr>
<tr class="even">
<td style="text-align: left;">42</td>
<td style="text-align: right;">146</td>
<td style="text-align: right;">-2.291912</td>
<td style="text-align: right;">0.0434783</td>
<td style="text-align: right;">0.0457672</td>
<td style="text-align: right;">-0.4886373</td>
<td style="text-align: right;">-0.4886373</td>
<td style="text-align: right;">0.3455188</td>
<td style="text-align: right;">0.3375748</td>
<td style="text-align: right;">0.3332479</td>
<td style="text-align: right;">0.3129784</td>
</tr>
<tr class="odd">
<td style="text-align: left;">58</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">-3.602896</td>
<td style="text-align: right;">0.0625000</td>
<td style="text-align: right;">0.1542237</td>
<td style="text-align: right;">-0.9302637</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-0.7143938</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Across the board we can see that participant 168 has worse values for almost everything, in particular the jackknife residual, Cook’s D, and DFFITS values. I can confidently conclude that we should remove participant 168 as an outlier, and feel justified in keeping participants 107, 113, 144, and 146 based on the closeness to the rest of the data points on the previous plots.</p>
</div>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Set Up</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Jackknife Residuals</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">Leverage</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-4" role="tab" aria-controls="tabset-11-4" aria-selected="false">Cook’s D</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-5" role="tab" aria-controls="tabset-11-5" aria-selected="false">DFFITS</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-6" role="tab" aria-controls="tabset-11-6" aria-selected="false">DFBETAS</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-7" role="tab" aria-controls="tabset-11-7" aria-selected="false">Additional Plots</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-8" role="tab" aria-controls="tabset-11-8" aria-selected="false">Final Look and Conclusion</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<p>Let’s generate a table so we can handily compare: ID, jackknife residual, leverage (diagonal hat), DFFITS, and DFBETAs for each participant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get leverage values (hat values)</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>hat_values_pd <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(model_pd)</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Cook's D values</span></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>cooks_d_pd <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(model_pd)</span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the DFFITS values</span></span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>dffits_pd <span class="ot">&lt;-</span> <span class="fu">dffits</span>(model_pd)</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the DFBETAS</span></span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a>dfbetas_pd <span class="ot">&lt;-</span> <span class="fu">dfbetas</span>(model_pd)</span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a table with ID and all diagnostic values</span></span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a>diagnostics_pd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> data_missing<span class="sc">$</span>id, <span class="at">jackknife_residuals =</span> jackknife_residuals_pd, <span class="at">leverage =</span> hat_values_pd, <span class="at">cooks_D =</span> cooks_d_pd, <span class="at">dffits =</span> dffits_pd, <span class="at">dfbetas =</span> dfbetas_pd)</span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(diagnostics_pd), <span class="at">caption =</span> <span class="st">"Diagnostics for Attachment Loss Change Model"</span>, <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb210-17"><a href="#cb210-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Diagnostics for Attachment Loss Change Model</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">jackknife_residuals</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">leverage</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cooks_D</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dffits</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas..Intercept.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.placebo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.medium</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">101</td>
<td style="text-align: right;">1.4284091</td>
<td style="text-align: right;">0.0500000</td>
<td style="text-align: right;">0.0212518</td>
<td style="text-align: right;">0.3276995</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.2396655</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">103</td>
<td style="text-align: right;">1.3517762</td>
<td style="text-align: right;">0.0434783</td>
<td style="text-align: right;">0.0164727</td>
<td style="text-align: right;">0.2881997</td>
<td style="text-align: right;">0.2881997</td>
<td style="text-align: right;">-0.2037879</td>
<td style="text-align: right;">-0.1991025</td>
<td style="text-align: right;">-0.1965505</td>
<td style="text-align: right;">-0.1845955</td>
</tr>
<tr class="odd">
<td style="text-align: right;">104</td>
<td style="text-align: right;">-0.4668576</td>
<td style="text-align: right;">0.0476190</td>
<td style="text-align: right;">0.0021971</td>
<td style="text-align: right;">-0.1043925</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-0.0754757</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">105</td>
<td style="text-align: right;">-0.4451251</td>
<td style="text-align: right;">0.0434783</td>
<td style="text-align: right;">0.0018161</td>
<td style="text-align: right;">-0.0949010</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-0.0671051</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">106</td>
<td style="text-align: right;">-2.5107398</td>
<td style="text-align: right;">0.0500000</td>
<td style="text-align: right;">0.0629491</td>
<td style="text-align: right;">-0.5760032</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-0.4212642</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">107</td>
<td style="text-align: right;">-1.7949702</td>
<td style="text-align: right;">0.0476190</td>
<td style="text-align: right;">0.0315049</td>
<td style="text-align: right;">-0.4013675</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-0.2901882</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><a href="#Jackknife">Back to top of tabset</a></p>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<p>We can start by making a plot of the jackknife residuals to assess if there are outliers &lt; -3 or &gt; 3 SDs).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot jackknife outiers and label any values that are &gt; 3 or &lt; -3.</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_missing, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> jackknife_residuals_pd)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">3</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Jackknife Residuals"</span>,</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Jackknife Residuals vs ID"</span>) <span class="sc">+</span> </span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(jackknife_residuals_pd <span class="sc">&gt;</span> <span class="dv">3</span> <span class="sc">|</span> jackknife_residuals_pd <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">3</span>, id, <span class="st">''</span>)), </span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We have no jackknife residuals +- 3. That’s a good sign!</p>
<p>Let’s sort our dataset and see who has the highest pocket depth at baseline.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort our dataset by descending order of pocket depth at baseline to see who is the highest</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(data_missing[<span class="fu">order</span>(<span class="sc">-</span>data_missing<span class="sc">$</span>pdbase),]), <span class="at">caption =</span> <span class="st">"Diagnostics for Attachment Loss Change Model"</span>, <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Diagnostics for Attachment Loss Change Model</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">trtgroup</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">race</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">smoker</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sites</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attachbase</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attach1year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pdbase</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pd1year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">attachchange</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pdchange</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">placebo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">control</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">medium</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">high</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">trt</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">trt3groups</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">55.17864</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">4.956522</td>
<td style="text-align: right;">5.304348</td>
<td style="text-align: right;">5.217391</td>
<td style="text-align: right;">4.891304</td>
<td style="text-align: right;">0.3478261</td>
<td style="text-align: right;">-0.3260870</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">20</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">41.01574</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">2.901235</td>
<td style="text-align: right;">2.808642</td>
<td style="text-align: right;">4.771605</td>
<td style="text-align: right;">4.067901</td>
<td style="text-align: right;">-0.0925926</td>
<td style="text-align: right;">-0.7037037</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">17</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">41.83710</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">3.886667</td>
<td style="text-align: right;">3.920000</td>
<td style="text-align: right;">4.200000</td>
<td style="text-align: right;">3.880000</td>
<td style="text-align: right;">0.0333333</td>
<td style="text-align: right;">-0.3200000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">77</td>
<td style="text-align: right;">234</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">51.12115</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">2.756944</td>
<td style="text-align: right;">2.527778</td>
<td style="text-align: right;">4.083333</td>
<td style="text-align: right;">3.631944</td>
<td style="text-align: right;">-0.2291667</td>
<td style="text-align: right;">-0.4513889</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">42.14921</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">2.369048</td>
<td style="text-align: right;">1.922619</td>
<td style="text-align: right;">3.910714</td>
<td style="text-align: right;">3.083333</td>
<td style="text-align: right;">-0.4464286</td>
<td style="text-align: right;">-0.8273810</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">37.15811</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">156</td>
<td style="text-align: right;">3.544872</td>
<td style="text-align: right;">2.839744</td>
<td style="text-align: right;">3.897436</td>
<td style="text-align: right;">3.237179</td>
<td style="text-align: right;">-0.7051282</td>
<td style="text-align: right;">-0.6602564</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Participant 104 has the highest baseline pocket depth. Interestingly it is not 168, who was our outlier for attachment loss.</p>
<p>Let’s run that test we did earlier to see if there’s an outlier in the pocket depth model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">outlierTest</span>(model_pd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>No Studentized residuals with Bonferroni p &lt; 0.05
Largest |rstudent|:
   rstudent unadjusted p-value Bonferroni p
82 2.664155          0.0090393      0.93105</code></pre>
</div>
</div>
<p>This is a test of a hypothesis that we do not have an outlier. We fail to reject the null and thus have more evidence that we do not have outliers for the pocket depth model.</p>
<p><a href="#Jackknife">Back to top of tabset</a></p>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<p>Let’s plot leverage for our model on pocket depth change.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Caculate cutoff for leverage</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>cutoff_leverage <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>((<span class="dv">4</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">103</span>)</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>cutoff_leverage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09708738</code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make leverage plot in ggplot. Set a horizontal line at the cutoff point, and label ID's for participants that pass that line</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostics_pd, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> leverage)) <span class="sc">+</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> cutoff_leverage) <span class="sc">+</span></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Leverage Plot with Cutoff Line"</span>,</span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hat Values"</span>) <span class="sc">+</span> </span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(leverage <span class="sc">&gt;</span> cutoff_leverage, id, <span class="st">""</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Again we are good on leverage.</p>
<p><a href="#Jackknife">Back to top of tabset</a></p>
</div>
<div id="tabset-11-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-4-tab">
<p>Let’s make our plot for Cook’s D for pocket depth change.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cutoff for Cook's D</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>cutoff_d <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">/</span>((<span class="fu">nrow</span>(data_missing) <span class="sc">-</span> <span class="fu">length</span>(model_attach1<span class="sc">$</span>coefficients) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>cutoff_d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04123711</code></pre>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Cook's D plot in ggplot. Set a horizontal line at the cutoff point, and label ID's for participants that pass that line</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostics_pd, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> cooks_D)) <span class="sc">+</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> cutoff_d) <span class="sc">+</span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cook's D with Cutoff Line"</span>,</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cook's D"</span>) <span class="sc">+</span> </span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(cooks_D <span class="sc">&gt;</span> cutoff_d, id, <span class="st">""</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that participants 106, 118, and 239 have Cook’s D values past the cutoff. Interestingly participant 104 who had the highest baseline pocket depth did not flag here.</p>
<p><a href="#Jackknife">Back to top of tabset</a></p>
</div>
<div id="tabset-11-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-5-tab">
<p>Let’s make the DFFITS plot for pocket depth change.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the cutoff for DFFITS</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>cutoff_dffits <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>((<span class="dv">4</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">103</span>)</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>cutoff_dffits</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4406526</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make DFFITS plot in ggplot. Set a horizontal line at the cutoff points, and label ID's for participants that pass those lines.</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostics_pd, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> dffits)) <span class="sc">+</span> </span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(cutoff_dffits, <span class="sc">-</span>cutoff_dffits)) <span class="sc">+</span> </span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(dffits <span class="sc">&lt;</span> <span class="sc">-</span>cutoff_dffits <span class="sc">|</span> dffits <span class="sc">&gt;</span> cutoff_dffits, id, <span class="st">""</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DFFITS by ID"</span>,</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"DFFITS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Participants 106, 118, and 239 are flagging here again. In addition we have 137 and 233, which are near enough to the cutoff that we can ignore them.</p>
<p><a href="#Jackknife">Back to top of tabset</a></p>
</div>
<div id="tabset-11-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-6-tab">
<p>Now we can look at the DFBETAS plot for pocket depth change.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the cutoff for DFBETAS</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>cutoff_dfbetas <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">103</span>)</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>cutoff_dfbetas</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1970659</code></pre>
</div>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make DFBETAS plot in ggplot. Set a horizontal line at the cutoff points, and label ID's for participants that pass those lines.</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="co"># For placebo group</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostics_pd, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> dfbetas.placebo)) <span class="sc">+</span> </span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(cutoff_dfbetas, <span class="sc">-</span>cutoff_dfbetas)) <span class="sc">+</span> </span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(dfbetas.placebo <span class="sc">&lt;</span> <span class="sc">-</span>cutoff_dfbetas <span class="sc">|</span> dfbetas.placebo <span class="sc">&gt;</span> cutoff_dfbetas, id, <span class="st">""</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DFBETAS by ID for Placebo"</span>,</span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"DFBETA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For low dose group</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostics_pd, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> dfbetas.low)) <span class="sc">+</span> </span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(cutoff_dfbetas, <span class="sc">-</span>cutoff_dfbetas)) <span class="sc">+</span> </span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(dfbetas.low <span class="sc">&lt;</span> <span class="sc">-</span>cutoff_dfbetas <span class="sc">|</span> dfbetas.low <span class="sc">&gt;</span> cutoff_dfbetas, id, <span class="st">""</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DFBETAS by ID for Low Dose"</span>,</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"DFBETA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-95-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For medium dose group</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostics_pd, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> dfbetas.medium)) <span class="sc">+</span> </span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(cutoff_dfbetas, <span class="sc">-</span>cutoff_dfbetas)) <span class="sc">+</span> </span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(dfbetas.medium <span class="sc">&lt;</span> <span class="sc">-</span>cutoff_dfbetas <span class="sc">|</span> dfbetas.medium <span class="sc">&gt;</span> cutoff_dfbetas, id, <span class="st">""</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DFBETAS by ID for Medium Dose"</span>,</span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"DFBETA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-95-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For high does group</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostics_pd, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> dfbetas.high)) <span class="sc">+</span> </span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(cutoff_dfbetas, <span class="sc">-</span>cutoff_dfbetas)) <span class="sc">+</span> </span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(dfbetas.high <span class="sc">&lt;</span> <span class="sc">-</span>cutoff_dfbetas <span class="sc">|</span> dfbetas.high <span class="sc">&gt;</span> cutoff_dfbetas, id, <span class="st">""</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DFBETAS by ID for High Dose"</span>,</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"DFBETA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-95-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Again we have a lot of points that are past the cutoff here. None as far off as 168 in the attachment loss model, 239 is the only one that is concerning.</p>
<p><a href="#Jackknife">Back to top of tabset</a></p>
</div>
<div id="tabset-11-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-7-tab">
<p>The car package in R has some handy plots that we can use to help us with diagnosing outliers.</p>
<p>The first is the influence plot, which essentially combines the jackknife residuals plot with the Cook’s D plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(model_pd, <span class="at">main =</span> <span class="st">"Influence Plot"</span>,</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">sub =</span> <span class="st">"Circle size is proportional to Cook's Distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      StudRes        Hat       CookD
5  -2.5107398 0.05000000 0.062949101
8  -0.8158788 0.06250000 0.008905825
12  0.4184503 0.06250000 0.002354494
82  2.6641548 0.04761905 0.066819586</code></pre>
</div>
</div>
<p>Here we can see that none of our residuals are +- 3, but we do have some concerns with large Cook’s distance, particularly with observation 82 (ID = 239).</p>
<p>Additionally, a single line of code provides us with some useful diagnostic plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># infIndexPlot gives us a series of plots that we need to investigate influence points</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="fu">infIndexPlot</span>(model_pd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project_1_Regression_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Based on these plots, it is arguable that participant 239 is an outlier for pocket depth. Though they do not have an extreme jackknife residual, the large Cook’s distance suggests that this data point has substantial infuence on the model’s parameters.</p>
<p>However, a closer look reveals that the influence and leverage values for the pocket depth model are all comparable to the potential outliers in the attachmnet loss model we chose to keep (Cook’s D ~0.06). Specifically, while it appears that participant 239 here has a large Cook’s D (0.068) compared to the rest of the values, it is nowhere near as high as participant 168 was in the attachment loss model (0.15)!</p>
<p><a href="#Jackknife">Back to top of tabset</a></p>
</div>
<div id="tabset-11-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-8-tab">
<p>Participants 106 and 239 were the only potential concerns here. However, as noted, their Cook’s D is comparable to the values we kept in the attachment loss model, and are &lt; 1/2 of what the Cook’s D was for participant 168 who we plan to remove as an outlier in the attachment loss model!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print diagnostics table of potential outliers</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(diagnostics_pd[diagnostics_attach<span class="sc">$</span>id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">106</span>,<span class="dv">239</span>),], <span class="at">caption =</span> <span class="st">"Correlation Matrix"</span>, <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Correlation Matrix</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">jackknife_residuals</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">leverage</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cooks_D</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dffits</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas..Intercept.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.placebo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.medium</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">-2.510740</td>
<td style="text-align: right;">0.050000</td>
<td style="text-align: right;">0.0629491</td>
<td style="text-align: right;">-0.5760032</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-0.4212642</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">82</td>
<td style="text-align: right;">239</td>
<td style="text-align: right;">2.664155</td>
<td style="text-align: right;">0.047619</td>
<td style="text-align: right;">0.0668196</td>
<td style="text-align: right;">0.5957231</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4307071</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove participant 168 from the dataset</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>data_missing_outlier <span class="ot">&lt;-</span> data_missing[data_missing<span class="sc">$</span>id <span class="sc">!=</span> <span class="dv">168</span>,]</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Run model 1 attachment loss</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>model_attach1_outlier <span class="ot">&lt;-</span> <span class="fu">lm</span>(attachchange <span class="sc">~</span> placebo <span class="sc">+</span> low <span class="sc">+</span> medium <span class="sc">+</span> high, <span class="at">data =</span> data_missing_outlier)</span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_attach1_outlier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = attachchange ~ placebo + low + medium + high, data = data_missing_outlier)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.68731 -0.16279  0.04936  0.16823  0.53945 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.22169    0.05277  -4.201  5.9e-05 ***
placebo      0.13462    0.07463   1.804  0.07435 .  
low          0.20388    0.07638   2.669  0.00891 ** 
medium       0.21514    0.07737   2.780  0.00652 ** 
high         0.11576    0.08399   1.378  0.17130    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2531 on 97 degrees of freedom
Multiple R-squared:  0.09493,   Adjusted R-squared:  0.05761 
F-statistic: 2.543 on 4 and 97 DF,  p-value: 0.04442</code></pre>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run model 2 attachmnent loss</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>model_attach2_outlier <span class="ot">&lt;-</span> <span class="fu">lm</span>(attachchange <span class="sc">~</span> control <span class="sc">+</span> low <span class="sc">+</span> medium <span class="sc">+</span> high, <span class="at">data =</span> data_missing_outlier)</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_attach2_outlier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = attachchange ~ control + low + medium + high, data = data_missing_outlier)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.68731 -0.16279  0.04936  0.16823  0.53945 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -0.08707    0.05277  -1.650   0.1022  
control     -0.13462    0.07463  -1.804   0.0743 .
low          0.06926    0.07638   0.907   0.3668  
medium       0.08052    0.07737   1.041   0.3006  
high        -0.01886    0.08399  -0.225   0.8228  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2531 on 97 degrees of freedom
Multiple R-squared:  0.09493,   Adjusted R-squared:  0.05761 
F-statistic: 2.543 on 4 and 97 DF,  p-value: 0.04442</code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the pocket depth model</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>model_pd_outlier <span class="ot">&lt;-</span> <span class="fu">lm</span>(pdchange <span class="sc">~</span> control <span class="sc">+</span> low <span class="sc">+</span> medium <span class="sc">+</span> high, <span class="at">data =</span> data_missing_outlier)</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_pd_outlier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = pdchange ~ control + low + medium + high, data = data_missing_outlier)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.6248 -0.1513 -0.0129  0.1616  0.6613 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.34969    0.05488  -6.372 6.26e-09 ***
control      0.01152    0.07761   0.148   0.8823    
low          0.14352    0.07943   1.807   0.0739 .  
medium       0.14714    0.08046   1.829   0.0705 .  
high        -0.02437    0.08734  -0.279   0.7809    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2632 on 97 degrees of freedom
Multiple R-squared:  0.07456,   Adjusted R-squared:  0.0364 
F-statistic: 1.954 on 4 and 97 DF,  p-value: 0.1077</code></pre>
</div>
</div>
<p>There is no difference in our models after removing outlier 168.</p>
</div>
</div>
</div>
</section>
</section>
<section id="to-do-list" class="level1">
<h1>To do List</h1>
<p><u>Important</u></p>
<p>check for outliers using jackknife residuals</p>
<p><u>Aesthetic</u></p>
<p>Try adding captions to all graphs and tables (eg #| fig-cap )</p>
<p>mess around with a final clean version that makes use of echo = FALSE to hide unneeded code chunks</p>
<p>question for a TA or prof:</p>
<ul>
<li><p>consuslting Prof: Did he make the slides for jackknife residuals? Why the cutoff in Cooks D of 1.0, interwebs says other equation.</p></li>
<li><p>what is leverage vs half normal quantile plot? in detecting outliers.</p></li>
<li><p>good way to get correlation matrix or just how do you get good tables out of R for papers? What’s you rmethodology/pipeline?</p></li>
</ul>
<p>Suppose that the complete-data model is a regression with outcome Y and predictors X . If the missing data occur in Y only, complete-case analysis and multiple imputation are equivalent, so then complete-case analysis is preferred since it is easier, more efficient and more robust (Von Hippel 2007).</p>
<p>Complete case analysis is the same as listwise deletion, which we did anyway.</p>
<p>If the missing data occur in y only, then it is possible to correct the variance formulas of method norm.predict. However, if the missing data occur in X , norm.predict is severely biased, so then variance correction is not useful.</p>
<p>…</p>
<p>good format to follow for write up. “I used mice (Multiple imputation by chained equations) to impute my dataset with missing variables. Next, I did a linear regression on the imputed datasets (m=50) and pooled the results according to Rubin’s Rules.”</p>
<p>Look into Little’s Test for MCAR</p>
<hr>
<p>Meeting with Zoey</p>
<p>**Look into making R shiny apps**</p>
<p>Be careful with Kable cause it can cause conflicts (and crashes)</p>
<p>Work with base R so it’s not effected by updates of packages</p>
<p>Table 1 is good enough, if not use custom table. You can create a matrix first.</p>
<p>Look into R custom table (could also use kable)(but can crash)</p>
<p>plotly for interactive graphs</p>
<p>r-graph-galler.com/interactive-charts.html plotly gampinder, highchart interactive line plot in R (plotly is more popular) (highchart requires minimal coding, seems simpler. but is limited)</p>
<p>can use R to directly send an email to someone</p>
<p>Options: Directly upload photos to online cloud and link to those Everytime you share the doc, share as folders and include link to those folders. Use setwd()./(test) command and set the working directory at the start(the . means the current folder) Use github (?) (be careful of automatic updates function, )</p>
<p>alexkaizer.com/bios_6618 - can ask him how to turn my qmd into a website.</p>
<p>look into Tableau for interactive graphs (she says its easy).</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>