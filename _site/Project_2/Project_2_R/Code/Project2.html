<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sean Vieau">
<meta name="dcterms.date" content="2024-10-09">

<title>Advanced Data Analysis - Project 2 – Sean Vieau Portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../../site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="../../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

<link href="../../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="../../../site_libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="../../../site_libs/typedarray-0.1/typedarray.min.js"></script>

<script src="../../../site_libs/jquery-3.5.1/jquery.min.js"></script>

<link href="../../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="../../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="../../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="../../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

<link href="../../../site_libs/table1-1.0/table1_defaults.css" rel="stylesheet">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Sean Vieau Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-advanced-data-analyses-(rsas" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Advanced Data Analyses (R/SAS)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-advanced-data-analyses-(rsas">    
        <li>
    <a class="dropdown-item" href="../../../Project_1_Regression/Project_1_Regression_R/Project_1_Regression.html">
 <span class="dropdown-text">Regression (R)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../Project_1_Regression/Project_1_Regression_SAS/Project_1_Regression_SAS.html">
 <span class="dropdown-text">Regression (SAS)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../Project_2/Project_2_R/Code/Project2.html">
 <span class="dropdown-text">MLR With Confounding and Interaction (R)</span></a>
  </li>  
        <li class="dropdown-header">MLR With Confounding and Interaction (SAS)</li>
        <li>
    <a class="dropdown-item" href="../../../Project_2/Project_2_R/Code/Project2LMM.html">
 <span class="dropdown-text">Linear Mixed Model (R)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../Project_2/Project_2_SAS/Code/Linear_Mixed_Model_SAS.html">
 <span class="dropdown-text">Linear Mixed Model (SAS)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../Project_3_Predictive_Modelling/Project_3_R/Code/Project_3_Predictive_Modelling.html">
 <span class="dropdown-text">Predictive Modelling (R)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../Data_Wrangling/Treadmill_Data_Cleaning/Code/Automated_Treadmill_Data_Cleaning.html"> 
<span class="menu-text">Data Wrangling (Python)</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data-management-(sas" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Data Management (SAS)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-data-management-(sas">    
        <li>
    <a class="dropdown-item" href="../../../Data_Management_(SAS)/Project_1/Project_1_Importing.html">
 <span class="dropdown-text">Project 1 - Importing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../Data_Management_(SAS)/Project_3/Project3.html">
 <span class="dropdown-text">Project 3 - Data Set Creation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../Data_Management_(SAS)/Project_5/Project_5_Report_and_Analysis.html">
 <span class="dropdown-text">Project 5 - Report and Analysis</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-statistical-consulting-(r" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Statistical Consulting (R)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-statistical-consulting-(r">    
        <li>
    <a class="dropdown-item" href="../../../Statistical_Consulting/Vieau_Project_01/Code/Megan_Watson_Project.html">
 <span class="dropdown-text">Scope of Work and Negative Binomial Regression (R)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data-viz-(r" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Data Viz (R)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-data-viz-(r">    
        <li>
    <a class="dropdown-item" href="../../../Data_Visualization/Cancer_Animations/Gapminder_Cancer_Animations.html">
 <span class="dropdown-text">Animated Plots (R)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../Statistical_Consulting/Opioid_Epidemic/GeoSpatial_Opioid_Epidemic.html">
 <span class="dropdown-text">Geospatial Analysis (R)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../Resume/Publications_and_Presentations.html"> 
<span class="menu-text">Publications/Presentations</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#method" id="toc-method" class="nav-link" data-scroll-target="#method">Method</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a>
  <ul class="collapse">
  <li><a href="#labeling-categorical-variables" id="toc-labeling-categorical-variables" class="nav-link" data-scroll-target="#labeling-categorical-variables">Labeling Categorical Variables</a></li>
  <li><a href="#filtering-data-set" id="toc-filtering-data-set" class="nav-link" data-scroll-target="#filtering-data-set">Filtering Data Set</a></li>
  <li><a href="#transpose-to-wideform" id="toc-transpose-to-wideform" class="nav-link" data-scroll-target="#transpose-to-wideform">Transpose to Wideform</a></li>
  </ul></li>
  <li><a href="#missingness-i" id="toc-missingness-i" class="nav-link" data-scroll-target="#missingness-i">Missingness I</a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">Data Cleaning</a>
  <ul class="collapse">
  <li><a href="#Clean_DVs" id="toc-Clean_DVs" class="nav-link" data-scroll-target="#Clean_DVs">Cleaning Dependent Variables</a></li>
  <li><a href="#Clean_IVs" id="toc-Clean_IVs" class="nav-link" data-scroll-target="#Clean_IVs">Cleaning Covariates</a></li>
  </ul></li>
  <li><a href="#missingness-ii" id="toc-missingness-ii" class="nav-link" data-scroll-target="#missingness-ii">Missingness II</a></li>
  <li><a href="#Variable_Creation" id="toc-Variable_Creation" class="nav-link" data-scroll-target="#Variable_Creation">Variable Creation</a></li>
  <li><a href="#Descriptives" id="toc-Descriptives" class="nav-link" data-scroll-target="#Descriptives">Descriptive Statistics</a></li>
  <li><a href="#correlation-matrix" id="toc-correlation-matrix" class="nav-link" data-scroll-target="#correlation-matrix">Correlation Matrix</a>
  <ul class="collapse">
  <li><a href="#precision-variables" id="toc-precision-variables" class="nav-link" data-scroll-target="#precision-variables">Precision Variables</a></li>
  <li><a href="#mutlicollinearity-issues" id="toc-mutlicollinearity-issues" class="nav-link" data-scroll-target="#mutlicollinearity-issues">Mutlicollinearity Issues</a></li>
  <li><a href="#removing-superfluous-variables" id="toc-removing-superfluous-variables" class="nav-link" data-scroll-target="#removing-superfluous-variables">Removing Superfluous Variables</a></li>
  <li><a href="#correlation-matrix-redux" id="toc-correlation-matrix-redux" class="nav-link" data-scroll-target="#correlation-matrix-redux">Correlation Matrix Redux</a></li>
  </ul></li>
  <li><a href="#EDA" id="toc-EDA" class="nav-link" data-scroll-target="#EDA">Interactive Variable Selection</a></li>
  <li><a href="#Data_Analysis" id="toc-Data_Analysis" class="nav-link" data-scroll-target="#Data_Analysis">Data Analysis</a>
  <ul class="collapse">
  <li><a href="#log-viral-load-change-1" id="toc-log-viral-load-change-1" class="nav-link" data-scroll-target="#log-viral-load-change-1">Log Viral Load Change</a></li>
  <li><a href="#cd4-t-cell-count-change-1" id="toc-cd4-t-cell-count-change-1" class="nav-link" data-scroll-target="#cd4-t-cell-count-change-1">CD4+ T Cell Count Change</a></li>
  <li><a href="#mental-qol-change" id="toc-mental-qol-change" class="nav-link" data-scroll-target="#mental-qol-change">Mental QOL Change</a></li>
  <li><a href="#Phys" id="toc-Phys" class="nav-link" data-scroll-target="#Phys">Physical QOL Score</a></li>
  </ul></li>
  <li><a href="#Assumptions" id="toc-Assumptions" class="nav-link" data-scroll-target="#Assumptions">Evaluating Assumptions</a>
  <ul class="collapse">
  <li><a href="#log-viral-load-1" id="toc-log-viral-load-1" class="nav-link" data-scroll-target="#log-viral-load-1">Log Viral Load</a></li>
  <li><a href="#cd4-t-cell-count-3" id="toc-cd4-t-cell-count-3" class="nav-link" data-scroll-target="#cd4-t-cell-count-3">CD4+ T Cell Count</a></li>
  <li><a href="#mental-quality-of-life" id="toc-mental-quality-of-life" class="nav-link" data-scroll-target="#mental-quality-of-life">Mental Quality of Life</a></li>
  <li><a href="#physical-quality-of-life" id="toc-physical-quality-of-life" class="nav-link" data-scroll-target="#physical-quality-of-life">Physical Quality of Life</a></li>
  </ul></li>
  <li><a href="#outliers" id="toc-outliers" class="nav-link" data-scroll-target="#outliers">Outliers</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  <li><a href="#bonus" id="toc-bonus" class="nav-link" data-scroll-target="#bonus">Bonus</a>
  <ul class="collapse">
  <li><a href="#plotting-outcome-variables-across-full-8-years" id="toc-plotting-outcome-variables-across-full-8-years" class="nav-link" data-scroll-target="#plotting-outcome-variables-across-full-8-years">Plotting Outcome Variables Across Full 8 Years</a>
  <ul class="collapse">
  <li><a href="#mental-qol" id="toc-mental-qol" class="nav-link" data-scroll-target="#mental-qol">Mental QOL</a></li>
  <li><a href="#physical-qol" id="toc-physical-qol" class="nav-link" data-scroll-target="#physical-qol">Physical QOL</a></li>
  <li><a href="#log-viral-load-3" id="toc-log-viral-load-3" class="nav-link" data-scroll-target="#log-viral-load-3">Log Viral Load</a></li>
  <li><a href="#cd4-t-cell-count-5" id="toc-cd4-t-cell-count-5" class="nav-link" data-scroll-target="#cd4-t-cell-count-5">CD4+ T Cell Count</a></li>
  <li><a href="#comparing-high-vs-low-adherence-groups" id="toc-comparing-high-vs-low-adherence-groups" class="nav-link" data-scroll-target="#comparing-high-vs-low-adherence-groups">Comparing High Vs Low Adherence Groups</a></li>
  <li><a href="#other-literature" id="toc-other-literature" class="nav-link" data-scroll-target="#other-literature">Other literature</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Advanced Data Analysis - Project 2</h1>
<p class="subtitle lead">MLR with Confounding and Interaction</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sean Vieau </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 9, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The aim of the current study is to assess how treatment response differs for HIV+ patients 2 years after initiating Highly Active Antiretroviral Therapy (HAART) based on hard drug usage (such as heroin or cocaine). This study is of particular scientific interest because it is unclear whether the use of hard drugs inhibits the immune system in humans; treatment strategies may differ based on these results. The researchers are interested in comparing subjects who never used hard drugs to current hard drug users (those that use hard drugs at year 2) or previous hard drug users (those who used drugs at year 0 or 1). Outcomes of interest are: viral load (HIV copies in a mL of blood), CD4+ T cell count (a measure of immunologic health), and aggregate physical and quality of life scores from the SF-36.</p>
<p>The clinical hypothesis is that, if hard drugs inhibit the immune system in humans, subjects who currently or previously used hard drugs will have higher viral load and lower CD4+ T cell counts than those who never used hard drugs. Additionally, the researchers are interested in knowing if potential differences between the drug use groups can be explained by differences in adherence to the treatment regimen. The researchers are agnostic on how quality of life changes after treatment, since side effects of the treatment are significant.</p>
<p>The project description provided by the PI is available below:</p>
<div style="text-align: center;">
<p><img src="../../../Project_2/Project_2_R/Media/Project2_description1.png" width="85%"></p>
</div>
</section>
<section id="method" class="level1">
<h1>Method</h1>
<p><strong>Study Design</strong></p>
<p>This is a secondary data analysis of the Multicenter AIDS Cohort Study, an ongoing prospective cohort study investigating the natural and treated disease progression of HIV-1 in bisexual men in 4 major cities in the U.S. Measurements for all variables were taken once per year over an 8-year time period; however, the current analysis is only concerned with treatment outcomes after 2 years of HAART. Data was received as a longform .csv file containing 33 columns along with a data dictionary. The main outcomes of interest are viral load, CD4+ T cell count, and aggregate physical and quality of life scores. Adherence to treatment regiment will be investigated as a potential confounder.</p>
<p>Potential covariates of interest include: marijuana usage since last visit and frequency of usage, income, BMI, high blood pressure, diabetes, liver disease stage 3 / 4, kidney disease, frailty related phenotype, total cholesterol, triglycerides, fasting LDL, dyslipidemia, depression score, smoking status, alcohol use since last visit, heroin or opiate use since last visit, intravenous drug use since last visit, race, education at baseline, age, if they took ART at the visit or if they have ever taken it before, and years since initiating ART.</p>
</section>
<section id="data-preparation" class="level1">
<h1>Data Preparation</h1>
<p>First we load the necessary packages</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly) <span class="co"># Used for interactive plots</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar) <span class="co"># Used to visualize missing data</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co"># Used for pretty printing (kable_styling)</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(table1) <span class="co"># Used to make Table 1</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr) <span class="co"># Used for reshaping</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bestNormalize) <span class="co"># Used in selecting best transformation for a variable</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot) <span class="co"># Used to make the correlation matrix</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrtable) <span class="co"># used to make the table for the correlation matrix</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(interactions) <span class="co"># Easy plotting of interactions</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car) <span class="co"># Used to get VIFs</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(olsrr) <span class="co"># used for backwards elimination model.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we import the data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">sviea</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">Portfolio</span><span class="sc">\\</span><span class="st">Project_2</span><span class="sc">\\</span><span class="st">Project_2_R</span><span class="sc">\\</span><span class="st">RawData</span><span class="sc">\\</span><span class="st">hiv_dataset.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And take a look.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,632
Columns: 33
$ newid      &lt;dbl&gt; 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4,…
$ AGG_MENT   &lt;dbl&gt; 44.90710, 58.20754, 59.65136, 56.80657, 46.34190, 48.71791,…
$ AGG_PHYS   &lt;dbl&gt; 52.52557, 41.29347, 48.54453, 46.73991, 27.92331, 38.03807,…
$ HASHV      &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 1, 2, 2, 1,…
$ HASHF      &lt;dbl&gt; NA, 4, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 4, 0, 0, 0, 0, 0, 4, 2…
$ income     &lt;dbl&gt; 4, 4, 4, 5, 2, 1, 2, 1, 9, 2, 6, 6, 6, NA, 7, 7, 7, NA, 1, …
$ BMI        &lt;dbl&gt; 24.71756, 26.06801, 27.16421, 25.71786, 26.66936, 25.96576,…
$ HBP        &lt;dbl&gt; 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1,…
$ DIAB       &lt;dbl&gt; 1, 1, 1, 1, 9, 9, 9, 1, 1, 1, 9, 9, 1, 9, 9, 9, 9, 9, 1, 3,…
$ LIV34      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1,…
$ KID        &lt;dbl&gt; 1, 1, 1, 1, 9, 9, 9, 2, 2, 2, 1, 1, 1, 2, 1, 1, 1, 2, 9, 9,…
$ FRP        &lt;dbl&gt; 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2,…
$ FP         &lt;dbl&gt; 1, 1, 1, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2,…
$ TCHOL      &lt;dbl&gt; 133, 131, 180, 171, 125, NA, 134, 105, 141, 153, 170, 170, …
$ TRIG       &lt;dbl&gt; 176, 107, 233, 139, NA, NA, NA, 104, 162, 127, NA, NA, 82, …
$ LDL        &lt;dbl&gt; 62, 66, 86, 96, NA, NA, NA, 44, 73, 84, NA, NA, 127, NA, NA…
$ DYSLIP     &lt;dbl&gt; 2, 1, 2, 1, 2, 9, 4, 1, 2, 1, 2, 2, 2, 9, 2, 2, 2, 2, 2, 4,…
$ CESD       &lt;dbl&gt; 14, 2, 1, 18, 20, 18, 18, 21, 23, 17, 18, 22, 23, 14, 1, 1,…
$ SMOKE      &lt;dbl&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3,…
$ DKGRP      &lt;dbl&gt; 0, 3, 0, 1, 0, 3, 2, 1, 0, 1, 0, 0, 0, 1, 2, 1, 1, 2, 1, 2,…
$ HEROPIATE  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2,…
$ IDU        &lt;dbl&gt; 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1,…
$ LEU3N      &lt;dbl&gt; 104.1659, 262.0061, 345.4010, 292.3271, 257.8278, 459.4562,…
$ VLOAD      &lt;dbl&gt; 102013.000000, 27.000000, 60.000000, 9.000000, 8121.000000,…
$ ADH        &lt;dbl&gt; NA, 2, 1, 1, NA, 1, 1, 1, 1, 1, NA, 1, 1, 2, 1, 1, 2, 1, NA…
$ RACE       &lt;dbl&gt; 1, 1, 1, 1, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ EDUCBAS    &lt;dbl&gt; 4, 4, 4, 4, 2, 2, 2, 2, 2, 2, 7, 7, 7, 7, 7, 7, 7, 7, 5, 5,…
$ hivpos     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ age        &lt;dbl&gt; 52, 53, 54, 55, 54, 55, 56, 60, 61, 62, 47, 48, 49, 51, 52,…
$ ART        &lt;dbl&gt; 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1,…
$ everART    &lt;dbl&gt; 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1,…
$ years      &lt;dbl&gt; 0, 1, 2, 3, 0, 1, 2, 6, 7, 8, 0, 1, 2, 4, 5, 6, 7, 8, 0, 1,…
$ hard_drugs &lt;dbl&gt; 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1,…</code></pre>
</div>
</div>
<p>Everything appears properly imported, however all our categorical variables are coded as doubles.</p>
<section id="labeling-categorical-variables" class="level2">
<h2 class="anchored" data-anchor-id="labeling-categorical-variables">Labeling Categorical Variables</h2>
<p>Let’s factor and label our categorical variables so they are appropriately represented (and not doubles, which will yield incorrect results in models)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting all appropriate variables from doubles to categorical variables</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>HASHV <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>HASHV,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>HASHF <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>HASHF,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Never"</span>, <span class="st">"Daily"</span>, <span class="st">"Weekly"</span>, <span class="st">"Monthly"</span>, <span class="st">"Less Often"</span>))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>income <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>income,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">9</span>),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Less than $10,000"</span>, <span class="st">"$10,000-$19,999"</span>, <span class="st">"$20,000-$29,999"</span>, <span class="st">"$30,000-$39,999"</span>, <span class="st">"$40,000-$49,999"</span>, <span class="st">"$50,000-$59,999"</span>, <span class="st">"$60,000 or more"</span>, <span class="st">"Do not wish to answer"</span>))</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>HBP <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>HBP,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">9</span>, <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"No, based on data trajectory"</span>, <span class="st">"Yes, based on data trajectory"</span>, <span class="st">"Insufficient data, may include reported treatment without diagnosis"</span>, <span class="st">"Improbable Value"</span>))</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>DIAB <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>DIAB,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">9</span>),</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"No, based on data trajectory"</span>, <span class="st">"Yes, based on data trajectory"</span>, <span class="st">"Insufficient data"</span>))</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>LIV34 <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>LIV34,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">9</span>),</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"Insufficient Data"</span>))</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>KID <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>KID,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">9</span>),</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"No, based on data trajectory"</span>, <span class="st">"Yes, based on data trajectory"</span>, <span class="st">"Insufficient data"</span>))</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>FRP <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>FRP,</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">9</span>),</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"Insufficient Data"</span>))</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>FP <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>FP,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">9</span>),</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"Insufficient Data"</span>))</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>DYSLIP <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>DYSLIP,</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">9</span>),</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"No, based on data trajectory"</span>, <span class="st">"Yes, based on data trajectory"</span>, <span class="st">"Insufficient data"</span>))</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>SMOKE <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>SMOKE,</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Never Smoked"</span>, <span class="st">"Former Smoker"</span>, <span class="st">"Current Smoker"</span>))</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>DKGRP <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>DKGRP,</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"None"</span>, <span class="st">"1-3 drinks/week"</span>, <span class="st">"4-13 drinks/week"</span>, <span class="st">"&gt;13 drinks/week"</span>))</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>HEROPIATE <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>HEROPIATE,</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">9</span>),</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"Not Specified"</span>))</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>IDU <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>IDU,</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>))</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ADH <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>ADH,</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"100%"</span>, <span class="st">"95-99%"</span>, <span class="st">"75-94%"</span>, <span class="st">"&lt;75%"</span>))</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>RACE <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>RACE,</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>),</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"White, non-Hispanic"</span>, <span class="st">"White, Hispanic"</span>, <span class="st">"Black, non-Hispanic "</span>, <span class="st">"Black, Hispanic"</span>,  <span class="st">"American Indian or Alaskan Native"</span>, <span class="st">"Asian or Pacific Islander"</span>, <span class="st">"Other Hispanic"</span>))</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>EDUCBAS <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>EDUCBAS,</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>),</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"8th grade or less "</span>, <span class="st">"9,10, or 11th grade"</span>, <span class="st">"12th grade"</span>, <span class="st">"At least one year college but no degree"</span>, <span class="st">"Four years college or got degree"</span>, <span class="st">"Some graduate work"</span>, <span class="st">"Post-graduate degree"</span>))</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>hard_drugs <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>hard_drugs,</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>                          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>))</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Create labels for variables to make the names of each variable more professional in outputs</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>newid) <span class="ot">&lt;-</span> <span class="st">"ID"</span></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>AGG_MENT) <span class="ot">&lt;-</span> <span class="st">"Aggregate Mental QOL Score"</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>AGG_PHYS) <span class="ot">&lt;-</span> <span class="st">"Aggregate Physical QOL Score"</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>HASHF) <span class="ot">&lt;-</span> <span class="st">"Hash/Marijuana Use Since Last Visit"</span></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>HASHV) <span class="ot">&lt;-</span> <span class="st">"Frequency of Hash/Marijuana Use"</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>income) <span class="ot">&lt;-</span> <span class="st">"Income"</span></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>HBP) <span class="ot">&lt;-</span> <span class="st">"High Blood Pressure"</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>DIAB) <span class="ot">&lt;-</span> <span class="st">"Diabetes"</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>LIV34) <span class="ot">&lt;-</span> <span class="st">"Liver Disease Stage 3/4"</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>KID) <span class="ot">&lt;-</span><span class="st">"Kidney Disease"</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>FRP) <span class="ot">&lt;-</span> <span class="st">"Frailty Related Phenotype"</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>FP) <span class="ot">&lt;-</span> <span class="st">"Fraily Phenotype"</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>BMI) <span class="ot">&lt;-</span> <span class="st">"BMI"</span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>TCHOL) <span class="ot">&lt;-</span> <span class="st">"Total Cholesterol"</span></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>TRIG) <span class="ot">&lt;-</span> <span class="st">"Triglycerides"</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>LDL) <span class="ot">&lt;-</span> <span class="st">"LDL"</span></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>DYSLIP) <span class="sc">&lt;</span> <span class="st">"Dyslipidemia"</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>SMOKE) <span class="sc">&lt;</span> <span class="st">"Smoking Status"</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>CESD) <span class="ot">&lt;-</span> <span class="st">"CESD Depression Score"</span></span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>SMOKE) <span class="sc">&lt;</span> <span class="st">"Smoking Status"</span></span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>DKGRP) <span class="ot">&lt;-</span> <span class="st">"Drinking Group"</span></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>HEROPIATE) <span class="ot">&lt;-</span> <span class="st">"Heroin or Opiate Use Since Last Visit"</span></span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>IDU) <span class="ot">&lt;-</span> <span class="st">"Intravenous Drug Usage Since Last Visit"</span></span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>LEU3N) <span class="ot">&lt;-</span> <span class="st">"CD4+ T Cell Count"</span></span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>VLOAD) <span class="ot">&lt;-</span> <span class="st">"Viral Load"</span></span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>ADH) <span class="ot">&lt;-</span> <span class="st">"Adherence to Treatment Regimen"</span></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>RACE) <span class="ot">&lt;-</span> <span class="st">"Race"</span></span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>EDUCBAS) <span class="ot">&lt;-</span> <span class="st">"Education at Baseline"</span></span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>hivpos) <span class="ot">&lt;-</span> <span class="st">"HIV Serostatus"</span></span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>age) <span class="ot">&lt;-</span> <span class="st">"Age"</span></span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>ART) <span class="ot">&lt;-</span> <span class="st">"Antiretroviral Therapy"</span></span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>years) <span class="ot">&lt;-</span> <span class="st">"Year of Visit"</span></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data<span class="sc">$</span>hard_drugs) <span class="ot">&lt;-</span> <span class="st">"Hard Drug Usage"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s take another look to check that those variables are no longer doubles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,632
Columns: 33
$ newid      &lt;dbl&gt; 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4,…
$ AGG_MENT   &lt;dbl&gt; 44.90710, 58.20754, 59.65136, 56.80657, 46.34190, 48.71791,…
$ AGG_PHYS   &lt;dbl&gt; 52.52557, 41.29347, 48.54453, 46.73991, 27.92331, 38.03807,…
$ HASHV      &lt;fct&gt; No, No, No, No, No, Yes, No, Yes, No, Yes, No, No, Yes, No,…
$ HASHF      &lt;fct&gt; NA, Less Often, Never, Never, Never, Never, Never, Never, N…
$ income     &lt;fct&gt; "$30,000-$39,999", "$30,000-$39,999", "$30,000-$39,999", "$…
$ BMI        &lt;dbl&gt; 24.71756, 26.06801, 27.16421, 25.71786, 26.66936, 25.96576,…
$ HBP        &lt;fct&gt; "No", "No", "No", "No", "Yes", "Yes", "Yes", "Yes", "Yes", …
$ DIAB       &lt;fct&gt; "No", "No", "No", "No", "Insufficient data", "Insufficient …
$ LIV34      &lt;fct&gt; No, No, No, No, No, No, No, No, No, No, No, No, No, No, Yes…
$ KID        &lt;fct&gt; "No", "No", "No", "No", "Insufficient data", "Insufficient …
$ FRP        &lt;fct&gt; No, No, No, No, Yes, No, No, No, No, No, No, No, No, No, No…
$ FP         &lt;fct&gt; No, No, No, No, Insufficient Data, Insufficient Data, No, N…
$ TCHOL      &lt;dbl&gt; 133, 131, 180, 171, 125, NA, 134, 105, 141, 153, 170, 170, …
$ TRIG       &lt;dbl&gt; 176, 107, 233, 139, NA, NA, NA, 104, 162, 127, NA, NA, 82, …
$ LDL        &lt;dbl&gt; 62, 66, 86, 96, NA, NA, NA, 44, 73, 84, NA, NA, 127, NA, NA…
$ DYSLIP     &lt;fct&gt; "Yes", "No", "Yes", "No", "Yes", "Insufficient data", "Yes,…
$ CESD       &lt;dbl&gt; 14, 2, 1, 18, 20, 18, 18, 21, 23, 17, 18, 22, 23, 14, 1, 1,…
$ SMOKE      &lt;fct&gt; Current Smoker, Current Smoker, Current Smoker, Current Smo…
$ DKGRP      &lt;fct&gt; None, &gt;13 drinks/week, None, 1-3 drinks/week, None, &gt;13 dri…
$ HEROPIATE  &lt;fct&gt; No, No, No, No, No, No, No, No, No, No, No, No, No, No, No,…
$ IDU        &lt;fct&gt; Yes, No, No, No, Yes, No, No, No, No, No, Yes, Yes, Yes, Ye…
$ LEU3N      &lt;dbl&gt; 104.1659, 262.0061, 345.4010, 292.3271, 257.8278, 459.4562,…
$ VLOAD      &lt;dbl&gt; 102013.000000, 27.000000, 60.000000, 9.000000, 8121.000000,…
$ ADH        &lt;fct&gt; NA, 95-99%, 100%, 100%, NA, 100%, 100%, 100%, 100%, 100%, N…
$ RACE       &lt;fct&gt; "White, non-Hispanic", "White, non-Hispanic", "White, non-H…
$ EDUCBAS    &lt;fct&gt; "At least one year college but no degree", "At least one ye…
$ hivpos     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ age        &lt;dbl&gt; 52, 53, 54, 55, 54, 55, 56, 60, 61, 62, 47, 48, 49, 51, 52,…
$ ART        &lt;dbl&gt; 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1,…
$ everART    &lt;dbl&gt; 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1,…
$ years      &lt;dbl&gt; 0, 1, 2, 3, 0, 1, 2, 6, 7, 8, 0, 1, 2, 4, 5, 6, 7, 8, 0, 1,…
$ hard_drugs &lt;fct&gt; Yes, No, No, No, Yes, No, No, No, No, No, Yes, Yes, Yes, Ye…</code></pre>
</div>
</div>
<p>Looks good.</p>
</section>
<section id="filtering-data-set" class="level2">
<h2 class="anchored" data-anchor-id="filtering-data-set">Filtering Data Set</h2>
<p>Now let’s take a look at the header to get a good feeling for our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print data header</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">newid</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG_MENT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG_PHYS</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HASHV</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HASHF</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">income</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMI</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HBP</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DIAB</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LIV34</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">KID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FRP</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FP</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">TCHOL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">TRIG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LDL</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DYSLIP</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CESD</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SMOKE</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DKGRP</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HEROPIATE</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">IDU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LEU3N</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">VLOAD</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ADH</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RACE</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EDUCBAS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">hivpos</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ART</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">everART</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">years</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">hard_drugs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">44.90710</td>
<td style="text-align: right;">52.52557</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">$30,000-$39,999</td>
<td style="text-align: right;">24.71756</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">133</td>
<td style="text-align: right;">176</td>
<td style="text-align: right;">62</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">104.1659</td>
<td style="text-align: right;">102013</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">At least one year college but no degree</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">58.20754</td>
<td style="text-align: right;">41.29346</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Less Often</td>
<td style="text-align: left;">$30,000-$39,999</td>
<td style="text-align: right;">26.06801</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">131</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">66</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">&gt;13 drinks/week</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">262.0061</td>
<td style="text-align: right;">27</td>
<td style="text-align: left;">95-99%</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">At least one year college but no degree</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">59.65136</td>
<td style="text-align: right;">48.54453</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Never</td>
<td style="text-align: left;">$30,000-$39,999</td>
<td style="text-align: right;">27.16421</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">233</td>
<td style="text-align: right;">86</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">345.4010</td>
<td style="text-align: right;">60</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">At least one year college but no degree</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">56.80657</td>
<td style="text-align: right;">46.73991</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Never</td>
<td style="text-align: left;">$40,000-$49,999</td>
<td style="text-align: right;">25.71786</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">171</td>
<td style="text-align: right;">139</td>
<td style="text-align: right;">96</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">1-3 drinks/week</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">292.3271</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">At least one year college but no degree</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">46.34190</td>
<td style="text-align: right;">27.92331</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Never</td>
<td style="text-align: left;">$10,000-$19,999</td>
<td style="text-align: right;">26.66936</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Insufficient Data</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">20</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">257.8278</td>
<td style="text-align: right;">8121</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Black, non-Hispanic</td>
<td style="text-align: left;">9,10, or 11th grade</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">48.71791</td>
<td style="text-align: right;">38.03807</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Never</td>
<td style="text-align: left;">Less than $10,000</td>
<td style="text-align: right;">25.96576</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Insufficient Data</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">&gt;13 drinks/week</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">459.4562</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">Black, non-Hispanic</td>
<td style="text-align: left;">9,10, or 11th grade</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">No</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Hmm, we have 8 years worth of data points, but the experimenters are only interested in the first 2 years.</p>
<p>Out of curiosity, let’s look at how many participants they had each year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize patient drop off over 8 years of study</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data<span class="sc">$</span>years))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check number of patients in each year</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data<span class="sc">$</span>years))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">550</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">550</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">550</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">414</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">381</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">338</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">325</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">272</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">252</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>This is interesting, we don’t seem to have as drastic a drop off as I expected. The researchers managed to retain all participants for the first 2 years, and 50% by the end of the 8-year study.</p>
<p>Let’s filter to only include values from the first 2 years, as this is the timeframe the researchers are interested in.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter long form data set to be include only first 2 years</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> data[data<span class="sc">$</span>years <span class="sc">&lt;=</span> <span class="dv">2</span>,]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check how many visits we have in the filtered data set.</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1650   33</code></pre>
</div>
</div>
<p>We went from 3632 visits in the 8 year data set to 1650 in the 2 year filtered data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Double check if any patients dropped out within the first 2 years</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(data_2<span class="sc">$</span>years))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>Luckily, no patients dropped out within the first 2 years of the study!</p>
</section>
<section id="transpose-to-wideform" class="level2">
<h2 class="anchored" data-anchor-id="transpose-to-wideform">Transpose to Wideform</h2>
<p>We can also see that the provided data set is in longform. Let’s convert that to wideform.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new wideform data set for first 2 years of study              </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>data_wide_2 <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(data_2, <span class="at">id_cols =</span> newid, <span class="at">names_from =</span> years, <span class="at">values_from =</span> <span class="sc">-</span><span class="fu">c</span>(newid, years))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And take a look at the header to check that was done correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print header of wideform data</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(data_wide_2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">newid</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG_MENT_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG_MENT_1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG_MENT_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG_PHYS_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG_PHYS_1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG_PHYS_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HASHV_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HASHV_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HASHV_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HASHF_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HASHF_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HASHF_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">income_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">income_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">income_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMI_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMI_1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMI_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HBP_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HBP_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HBP_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DIAB_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DIAB_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DIAB_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LIV34_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LIV34_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LIV34_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">KID_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">KID_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">KID_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FRP_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FRP_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FRP_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FP_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FP_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FP_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">TCHOL_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">TCHOL_1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">TCHOL_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">TRIG_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">TRIG_1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">TRIG_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LDL_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LDL_1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LDL_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DYSLIP_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DYSLIP_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DYSLIP_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CESD_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CESD_1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CESD_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SMOKE_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SMOKE_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SMOKE_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DKGRP_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DKGRP_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DKGRP_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HEROPIATE_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HEROPIATE_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HEROPIATE_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">IDU_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">IDU_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">IDU_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LEU3N_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LEU3N_1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LEU3N_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">VLOAD_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">VLOAD_1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">VLOAD_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ADH_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ADH_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ADH_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RACE_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RACE_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RACE_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EDUCBAS_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EDUCBAS_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EDUCBAS_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">hivpos_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">hivpos_1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">hivpos_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">age_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">age_1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">age_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ART_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ART_1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ART_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">everART_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">everART_1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">everART_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">hard_drugs_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">hard_drugs_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">hard_drugs_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">44.90710</td>
<td style="text-align: right;">58.20754</td>
<td style="text-align: right;">59.65136</td>
<td style="text-align: right;">52.52557</td>
<td style="text-align: right;">41.29346</td>
<td style="text-align: right;">48.54453</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Less Often</td>
<td style="text-align: left;">Never</td>
<td style="text-align: left;">$30,000-$39,999</td>
<td style="text-align: left;">$30,000-$39,999</td>
<td style="text-align: left;">$30,000-$39,999</td>
<td style="text-align: right;">24.71756</td>
<td style="text-align: right;">26.06801</td>
<td style="text-align: right;">27.16421</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">133</td>
<td style="text-align: right;">131</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">176</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">233</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">86</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">&gt;13 drinks/week</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">104.1659</td>
<td style="text-align: right;">262.0061</td>
<td style="text-align: right;">345.4010</td>
<td style="text-align: right;">102013.000</td>
<td style="text-align: right;">27.00000</td>
<td style="text-align: right;">60.00000</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">95-99%</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">At least one year college but no degree</td>
<td style="text-align: left;">At least one year college but no degree</td>
<td style="text-align: left;">At least one year college but no degree</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">46.34190</td>
<td style="text-align: right;">48.71791</td>
<td style="text-align: right;">45.41483</td>
<td style="text-align: right;">27.92331</td>
<td style="text-align: right;">38.03807</td>
<td style="text-align: right;">37.32204</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Never</td>
<td style="text-align: left;">Never</td>
<td style="text-align: left;">Never</td>
<td style="text-align: left;">$10,000-$19,999</td>
<td style="text-align: left;">Less than $10,000</td>
<td style="text-align: left;">$10,000-$19,999</td>
<td style="text-align: right;">26.66936</td>
<td style="text-align: right;">25.96576</td>
<td style="text-align: right;">26.96037</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Insufficient Data</td>
<td style="text-align: left;">Insufficient Data</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Yes, based on data trajectory</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">&gt;13 drinks/week</td>
<td style="text-align: left;">4-13 drinks/week</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">257.8278</td>
<td style="text-align: right;">459.4562</td>
<td style="text-align: right;">263.0693</td>
<td style="text-align: right;">8121.000</td>
<td style="text-align: right;">21.00000</td>
<td style="text-align: right;">48.00000</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">Black, non-Hispanic</td>
<td style="text-align: left;">Black, non-Hispanic</td>
<td style="text-align: left;">Black, non-Hispanic</td>
<td style="text-align: left;">9,10, or 11th grade</td>
<td style="text-align: left;">9,10, or 11th grade</td>
<td style="text-align: left;">9,10, or 11th grade</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">40.22337</td>
<td style="text-align: right;">44.42011</td>
<td style="text-align: right;">41.70079</td>
<td style="text-align: right;">60.06970</td>
<td style="text-align: right;">62.71705</td>
<td style="text-align: right;">58.51450</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Less Often</td>
<td style="text-align: left;">Less Often</td>
<td style="text-align: left;">Less Often</td>
<td style="text-align: left;">$50,000-$59,999</td>
<td style="text-align: left;">$50,000-$59,999</td>
<td style="text-align: left;">$50,000-$59,999</td>
<td style="text-align: right;">28.59085</td>
<td style="text-align: right;">28.35320</td>
<td style="text-align: right;">28.18510</td>
<td style="text-align: left;">Insufficient data, may include reported treatment without diagnosis</td>
<td style="text-align: left;">Insufficient data, may include reported treatment without diagnosis</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">82</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">127</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">23</td>
<td style="text-align: left;">Former Smoker</td>
<td style="text-align: left;">Former Smoker</td>
<td style="text-align: left;">Former Smoker</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">563.1223</td>
<td style="text-align: right;">488.9100</td>
<td style="text-align: right;">405.1816</td>
<td style="text-align: right;">4001.556</td>
<td style="text-align: right;">2020.00000</td>
<td style="text-align: right;">27.50917</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">Post-graduate degree</td>
<td style="text-align: left;">Post-graduate degree</td>
<td style="text-align: left;">Post-graduate degree</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">42.90638</td>
<td style="text-align: right;">31.15971</td>
<td style="text-align: right;">52.68223</td>
<td style="text-align: right;">50.78850</td>
<td style="text-align: right;">44.62883</td>
<td style="text-align: right;">51.50533</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Less Often</td>
<td style="text-align: left;">Weekly</td>
<td style="text-align: left;">Never</td>
<td style="text-align: left;">Less than $10,000</td>
<td style="text-align: left;">Less than $10,000</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">20.36451</td>
<td style="text-align: right;">18.21865</td>
<td style="text-align: right;">20.28485</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No, based on data trajectory</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">214</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">251</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">260</td>
<td style="text-align: right;">147</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">152</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes, based on data trajectory</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">1-3 drinks/week</td>
<td style="text-align: left;">4-13 drinks/week</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">110.4218</td>
<td style="text-align: right;">159.6297</td>
<td style="text-align: right;">179.6409</td>
<td style="text-align: right;">740.000</td>
<td style="text-align: right;">26.64732</td>
<td style="text-align: right;">27.00000</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">75-94%</td>
<td style="text-align: left;">95-99%</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">Four years college or got degree</td>
<td style="text-align: left;">Four years college or got degree</td>
<td style="text-align: left;">Four years college or got degree</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">56.42904</td>
<td style="text-align: right;">56.21993</td>
<td style="text-align: right;">66.50629</td>
<td style="text-align: right;">43.75671</td>
<td style="text-align: right;">30.47055</td>
<td style="text-align: right;">18.82350</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Monthly</td>
<td style="text-align: left;">Monthly</td>
<td style="text-align: left;">Less Often</td>
<td style="text-align: left;">$50,000-$59,999</td>
<td style="text-align: left;">$10,000-$19,999</td>
<td style="text-align: left;">Do not wish to answer</td>
<td style="text-align: right;">22.26986</td>
<td style="text-align: right;">24.97865</td>
<td style="text-align: right;">20.80193</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Insufficient Data</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Insufficient Data</td>
<td style="text-align: left;">Insufficient Data</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">204</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">192</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Yes, based on data trajectory</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">Current Smoker</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">1-3 drinks/week</td>
<td style="text-align: left;">1-3 drinks/week</td>
<td style="text-align: left;">Not Specified</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">252.6634</td>
<td style="text-align: right;">92.6634</td>
<td style="text-align: right;">59.6219</td>
<td style="text-align: right;">62727.039</td>
<td style="text-align: right;">30389.00000</td>
<td style="text-align: right;">419.50000</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">Post-graduate degree</td>
<td style="text-align: left;">Post-graduate degree</td>
<td style="text-align: left;">Post-graduate degree</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">59.74437</td>
<td style="text-align: right;">53.84956</td>
<td style="text-align: right;">50.26010</td>
<td style="text-align: right;">56.86261</td>
<td style="text-align: right;">57.91396</td>
<td style="text-align: right;">55.95668</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Less Often</td>
<td style="text-align: left;">$30,000-$39,999</td>
<td style="text-align: left;">$30,000-$39,999</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">23.22166</td>
<td style="text-align: right;">23.75318</td>
<td style="text-align: right;">22.41001</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">216</td>
<td style="text-align: right;">216</td>
<td style="text-align: right;">151</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">81</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Never Smoked</td>
<td style="text-align: left;">Never Smoked</td>
<td style="text-align: left;">Never Smoked</td>
<td style="text-align: left;">1-3 drinks/week</td>
<td style="text-align: left;">1-3 drinks/week</td>
<td style="text-align: left;">1-3 drinks/week</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">634.1246</td>
<td style="text-align: right;">745.6517</td>
<td style="text-align: right;">893.4328</td>
<td style="text-align: right;">15745.000</td>
<td style="text-align: right;">7870.00000</td>
<td style="text-align: right;">53.50000</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">95-99%</td>
<td style="text-align: left;">95-99%</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">Some graduate work</td>
<td style="text-align: left;">Some graduate work</td>
<td style="text-align: left;">Some graduate work</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Good. now we have a long and wide form of the data set for the first two years of the study.</p>
<p>Finally, let’s just clean that wide data set up a bit to drop repeat measures of variables that are constant over time (race, education at baseline, HIV serostatus, everART)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up the wide data set a bit by deleting multiple observations across time for constant variables such as race</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>data_wide_2 <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>RACE_1, <span class="sc">-</span>RACE_2, <span class="sc">-</span>EDUCBAS_1, <span class="sc">-</span>EDUCBAS_2, <span class="sc">-</span>hivpos_1, <span class="sc">-</span> hivpos_2, <span class="sc">-</span>everART_1, <span class="sc">-</span>everART_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that our data sets are adequately prepared, we can move on to performing our data checks to ensure fidelity of the data set.</p>
</section>
</section>
<section id="missingness-i" class="level1">
<h1>Missingness I</h1>
<p>First we begin by examining missingness in our data set</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check missingness for long form data</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(data_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This shows that we are missing the most values for <code>LDL</code>, <code>TRIG</code>, <code>ADH</code>, <code>TCHOL</code>, and <code>income</code>.</p>
<p>A closer examination reveals…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missing values for longform data</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(data_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>53% of <code>LDL</code>, 53% of <code>TRIG</code>, 33% of <code>ADH</code>, 32% of <code>TCHOL</code>, and 24% of <code>income</code> values are missing.</p>
<p><code>LDL</code> and<code>TRIG</code> have egregious amounts of missing data (&gt; 50%). <code>TCHOL</code> and <code>income</code> are in a range where we may be able to save them with MI or a linear mixed model that allows for missing data. We will have to see.</p>
<p><code>ADH</code> is missing 33% of values. That could be problematic as that’s a key variable the researchers are interested in.</p>
<p>But there’s an odd, systematic pattern there… what if we look at the wide form of the data?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missing values for wideform data</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(data_wide_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ah, 1/3 of the values for <code>ADH</code> are missing because there are 3 time points and you can’t have baseline adherence to a protocol you just started (i.e.&nbsp;<code>ADH_0</code>).</p>
<p>There’s a small blip there that looks like someone DOES have a value for <code>ADH_0</code>, I wonder what that’s about…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For some reason participant 426 has an adherence of 1 at baseline</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>adh_at_baseline <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ADH_0 <span class="sc">==</span> <span class="st">"100%"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, ADH_0)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(adh_at_baseline)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">newid</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ADH_0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">426</td>
<td style="text-align: left;">100%</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Apparently if you’re participant 426, you can have 100% adherence to a protocol you’ve just started (clearly a typo). Let’s fix that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of that value of 1 for adherence at baseline for patient 426</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ADH[data<span class="sc">$</span>years <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great, we can still use <code>ADH</code> as a variable! We just have to use adherence at years 1 or 2.</p>
</section>
<section id="data-cleaning" class="level1">
<h1>Data Cleaning</h1>
<p>We just examined missingness as a preliminary check. However there is more work to be done.</p>
<p>The dataset we received has variables that were coded inconsistently. For instance, some variables are coded so that missing values are represented by a blank, and some variables (like <code>CESD</code>) are coded so that missing values are represented by -1. In other cases, such as with <code>BMI</code>, improbable values are coded as 999.</p>
<p>We can see this if we examine the mins and maxes for each numerical variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Code from ChatGPT</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This function summarizes the mins and maxes of numeric variables</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>summarize_column <span class="ot">&lt;-</span> <span class="cf">function</span>(column) {</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.numeric</span>(column)) {</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">data.frame</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">Type =</span> <span class="st">"Numeric"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">Min =</span> <span class="fu">min</span>(column, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">Max =</span> <span class="fu">max</span>(column, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to each column and bind the results into a single data frame</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>summary_df <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(data_2, summarize_column, <span class="at">.id =</span> <span class="st">"Column"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> <span class="fu">format</span>(., <span class="at">scientific =</span> <span class="cn">FALSE</span>))) <span class="co"># Eliminates scientific notation</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print the mins and maxes of longform data_2</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(summary_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Column</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">newid</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">1.000000</td>
<td style="text-align: left;">550.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">AGG_MENT</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">7.229315</td>
<td style="text-align: left;">73.31224</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AGG_PHYS</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">9.116614</td>
<td style="text-align: left;">70.43724</td>
</tr>
<tr class="even">
<td style="text-align: left;">BMI</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">-1.000000</td>
<td style="text-align: left;">1000.11465</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TCHOL</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">57.000000</td>
<td style="text-align: left;">613.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRIG</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">28.000000</td>
<td style="text-align: left;">2237.00000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LDL</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">5.000000</td>
<td style="text-align: left;">704.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">CESD</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">-1.000000</td>
<td style="text-align: left;">53.00000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LEU3N</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">10.859882</td>
<td style="text-align: left;">1727.92558</td>
</tr>
<tr class="even">
<td style="text-align: left;">VLOAD</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">0.246597</td>
<td style="text-align: left;">190695039.60000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hivpos</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">1.000000</td>
<td style="text-align: left;">1.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">20.000000</td>
<td style="text-align: left;">75.00000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ART</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">0.000000</td>
<td style="text-align: left;">1.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">everART</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">0.000000</td>
<td style="text-align: left;">1.00000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">years</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">0.000000</td>
<td style="text-align: left;">2.00000</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>In effect, our data is not correctly showing all missing values. Let’s clean all that up, variable by variable.</p>
<section id="Clean_DVs" class="level3">
<h3 class="anchored" data-anchor-id="Clean_DVs">Cleaning Dependent Variables</h3>
<p>First we will begin by examining and cleaning our 4 primary outcomes of interest.</p>
<p>The first two are laboratory measures.</p>
<ul>
<li><u>Viral load (VLOAD):</u> The number of HIV copies in a mL of blood</li>
<li><u>CD4+ T cell count (LEU3N):</u> A measure of immunologic health.</li>
</ul>
<p>In untreated HIV infection, viral load increases over time and CD4+ T cell counts decline as the immune system is attacked by the virus. Once treatment is initiated, we expect viral load to decrease rapidly and CD4 counts to recover.</p>
<p>Our last two measures are quality of life measures from the <a href="https://www.rand.org/health-care/surveys_tools/mos/36-item-short-form.html">SF-36</a>.</p>
<ul>
<li><p><u>Aggregate physical quality of life score (AGG_PHYS)</u></p></li>
<li><p><u>Aggregate mental quality of life score (AGG_MENT)</u></p></li>
</ul>
<p>These scores range from 0 to 100, with higher scores indicating better quality of life. The researchers are not sure what happens to quality of life after initiating treatment. While in theory subjects’ improving health should result in increased quality of life, the side effects of these treatments are significant. If subjects experience declines in quality of life after initiating treatment, we would be concerned that they would stop treatment.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Viral Load</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">CD4+ T Cell Count</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Aggregate Mental QOL Score</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Aggregate Physical QOL Score</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Standardized viral load</p>
<ul>
<li><p>0 = 0 copies/ml</p></li>
<li><p>999,999,999 = 999,999,999 copies/ml</p></li>
<li><p>Blank = Missing</p></li>
</ul>
<p>Our min max function earlier showed the max VLOAD was 190695039.60. I wonder if this is real or a data error?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create histogram of viral load</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>VLOAD)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplots of viral load</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>VLOAD)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>VLOAD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Yeah, looks like there are about 3 data points throwing off our qqplot from being normal.</p>
<p>Let’s investigate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort data set by descending viral load</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>sorted_data <span class="ot">&lt;-</span> data_2[<span class="fu">order</span>(<span class="sc">-</span>data_2<span class="sc">$</span>VLOAD),] <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, VLOAD, years)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print resulting table</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(sorted_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">newid</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">VLOAD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">years</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">224</td>
<td style="text-align: right;">190695040</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">78</td>
<td style="text-align: right;">143419477</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">437</td>
<td style="text-align: right;">83835646</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">196</td>
<td style="text-align: right;">5227511</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">142</td>
<td style="text-align: right;">2520009</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">19</td>
<td style="text-align: right;">2515706</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>So the highest VLOAD value is 75x the 5th highest, and the 4th highest is 2x 5th highest. All these values are from different patients at the baseline.</p>
<p>Based on the data dictionary provided, these values fall below the specified range of 999,999,999 copies/ml. That the PI’s specified this range could mean these are real data points. Maybe immediately after when someone is first exposed to HIV the viral load is incredibly high, and these 4 or so patients fell in that time period?</p>
<p>I will first check if removing them makes our data normally distributed.</p>
<p>We will then add them back into the data set and keep them in mind. Checking with the jackknife residuals after we run our model will tell us if they are high leverage points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplot to assess for outliers</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>outlier_vload <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(data_2<span class="sc">$</span>VLOAD, <span class="at">main =</span> <span class="st">"Boxplot for VLOAD"</span>)<span class="sc">$</span>out</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="fl">1.2</span>, <span class="fu">length</span>(outlier_vload)),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> outlier_vload, <span class="at">labels =</span> outlier_vload, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Indeed the boxplot shows these values really mess with our data.</p>
<p>These top 4 patients based on VLOAD are 224, 78, 437, and 196. Patient 196 has double the VLOAD of the next highest person, which means this could be an outlier or real data, but let’s remove them just to see.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove 4 highest viral load visits</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>data_vload_removed <span class="ot">&lt;-</span> data</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>data_vload_removed<span class="sc">$</span>VLOAD[data_vload_removed<span class="sc">$</span>newid <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">224</span>, <span class="dv">78</span>, <span class="dv">437</span>, <span class="dv">196</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots to assess for normality</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_vload_removed<span class="sc">$</span>VLOAD)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_vload_removed<span class="sc">$</span>VLOAD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Oh, that makes more sense. Those might not have been outliers, we just need to log transform viral load. Right, viral load is often used as a real world example of a biological measurement that is logarithmic…</p>
<p>Let’s do that log transform, and just pretend we remembered that from the start.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Log transform viral load in the long form data set</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>VLOAD_log <span class="ot">&lt;-</span> <span class="fu">log</span>(data_2<span class="sc">$</span>VLOAD)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram of log transformed viral load</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>VLOAD_log)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot of log transformed viral load</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>VLOAD_log)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>VLOAD_log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplot of log transformed viral load to assess for potential outliers</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>outlier_vload <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(data_2<span class="sc">$</span>VLOAD_log, <span class="at">main =</span> <span class="st">"Boxplot for VLOAD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That looks much better!</p>
<p>I’d say that’s roughly normally distributed, maybe a bit right tailed but likely still acceptable.</p>
<p>Looks like this took care of those values that were showing up as outliers before, and we have no outliers for this variable.</p>
<p><code>VLOAD</code> has now been cleaned!</p>
<p><a href="#Clean_DVs">Top of Tabset</a></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>A measure of immunologic health.</p>
<p>Number of CD4 positive cells (helpers)</p>
<ul>
<li>0 - 9999 cells</li>
<li>Blank = Missing</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of CD4 T Cells</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>LEU3N, <span class="at">breaks =</span> <span class="dv">24</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot of CD4 T Cells</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>LEU3N)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>LEU3N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort data set by descending CD4 T Cell</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>sorted_data <span class="ot">&lt;-</span> data_2[<span class="fu">order</span>(<span class="sc">-</span>data_2<span class="sc">$</span>LEU3N),] <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, LEU3N, years)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print resulting table</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(sorted_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">newid</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LEU3N</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">years</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">63</td>
<td style="text-align: right;">1727.926</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">255</td>
<td style="text-align: right;">1560.152</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">355</td>
<td style="text-align: right;">1505.613</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">291</td>
<td style="text-align: right;">1395.958</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">1395.432</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">137</td>
<td style="text-align: right;">1382.626</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>These values all look believable and like there was no errors during data collection or entering. It is unclear whether this variable is right tailed because of outliers, or if it needs to be transformed.</p>
<p>Let’s look at potential outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplot of CD4 T cell count to assess for outliers</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>outlier_leu3n <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(data_2<span class="sc">$</span>LEU3N, <span class="at">main =</span> <span class="st">"Boxplot for Leu3n"</span>)<span class="sc">$</span>out</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="fl">1.2</span>, <span class="fu">length</span>(outlier_leu3n)),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> outlier_leu3n, <span class="at">labels =</span> outlier_leu3n, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Yeah, the boxplot is showing a lot of outliers.</p>
<p>Let’s try a log transform.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Log transform CD4 T Cell count</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>LEU3N_log <span class="ot">&lt;-</span> <span class="fu">log</span>(data_2<span class="sc">$</span>LEU3N)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of log transformed CD4 T cell count</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>LEU3N_log)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot of log transformed CD4 T cell count</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>LEU3N_log)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>LEU3N_log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That… didn’t work. Maybe let’s try standardization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a standardization transformation of CD4 T Cell Count</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>LEU3N_standard <span class="ot">&lt;-</span> <span class="fu">scale</span>(data_2<span class="sc">$</span>LEU3N)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of standardized CD4 T Cell count</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>LEU3N_standard)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot of standardized CD4 T Cell count.</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>LEU3N_standard)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>LEU3N_standard)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hmm, that didn’t do the trick.</p>
<p>At this point I asked my professor in passing and he recommended the bestNormalize package (which he happened to write) to help in selecting the best transformation for a variable.</p>
<p>Let’s take a shot at it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize R package to select the best transformation for CD4 T Cell count</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>BNObject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data_2<span class="sc">$</span>LEU3N)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>BNObject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 1606 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 3.0006
 - Box-Cox: 1.3451
 - Center+scale: 1.7618
 - Double Reversed Log_b(x+a): 3.2455
 - Log_b(x+a): 3.0006
 - orderNorm (ORQ): 1.2157
 - sqrt(x + a): 1.3668
 - Yeo-Johnson: 1.3457
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
orderNorm Transformation with 1606 nonmissing obs and ties
 - 1607 unique values 
 - Original quantiles:
      0%      25%      50%      75%     100% 
  10.860  285.847  438.078  611.673 1727.926 </code></pre>
</div>
</div>
<p>The bestNormalize function selects the best transformation according to the Pearson P statistic (divided by its degrees of freedom), as calculated by the nortest package. There are a variety of normality tests out there, but the benefit of the Pearson P / df is that it is a relatively interpretable goodness of fit test, and the ratio P / df can be compared between transformations as an absolute measure of the departure from normality (if the data follows close to a normal distribution, this ratio will be close to 1).</p>
<p>Here we can see that orderNorm (1.14), Yeo-Johnson (1.26), and Box-Cox (1.26) all perform relatively similar to each other. Let’s see what those plots look like if I do those transformations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Peform ordernNorm transformation of CD4 T Cell count</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>LEU3N_orderNorm <span class="ot">&lt;-</span> <span class="fu">orderNorm</span>(data_2<span class="sc">$</span>LEU3N)<span class="sc">$</span>x.t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in orderNorm(data_2$LEU3N): Ties in data, Normal distribution not guaranteed</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Peform Box-Cox transformation of CD4 T Cell count</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>LEU3N_boxcox <span class="ot">&lt;-</span> <span class="fu">boxcox</span>(data_2<span class="sc">$</span>LEU3N)<span class="sc">$</span>x.t</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Peform Yeo-Johnson transformation of CD4 T Cell count</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>LEU3N_yeojohnson <span class="ot">&lt;-</span> <span class="fu">yeojohnson</span>(data_2<span class="sc">$</span>LEU3N)<span class="sc">$</span>x.t</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all histograms using MASS</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">truehist</span>(data_2<span class="sc">$</span>LEU3N_orderNorm, <span class="at">main =</span> <span class="st">"OrderNorm transformation"</span>, <span class="at">nbins =</span> <span class="dv">24</span>)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">truehist</span>(data_2<span class="sc">$</span>LEU3N_boxcox, <span class="at">main =</span> <span class="st">"Box Cox transformation"</span>, <span class="at">nbins =</span> <span class="dv">24</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">truehist</span>(data_2<span class="sc">$</span>LEU3N_yeojohnson, <span class="at">main =</span> <span class="st">"Yeo-Johnson transformation"</span>, <span class="at">nbins =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This function visualizes the estimated normality statistics obtained for each fold and repeat of cross-validation via boxplots. It allows you to compare transformation methods</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log10</span>(BNObject<span class="sc">$</span>oos_preds), <span class="at">yaxt =</span> <span class="st">'n'</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fu">log10</span>(<span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>)), <span class="at">labels=</span><span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>I will select Box-Cox as those two names are more familiar to me so I trust it more per the availability heuristic (and because orderNorm looks TOO good to be true).</p>
<p>More information on Box-Cox Transformation <a href="https://www.statisticshowto.com/probability-and-statistics/normal-distributions/box-cox-transformation/">here</a></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note: <a href="#Variable_Creation">Later in the document</a> we see that the distribution of the change score for each outcome variable is normally distributed, and thus absolves us of the need to perform any transformations besides log transforming <code>VLOAD</code>.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p><a href="#Clean_DVs">Top of Tabset</a></p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>The values for <code>AGG_MENT</code> in our data set range from 7.229315 to 73.31224, which is believable and leads us to conclude there were no data entry errors here.</p>
<p>Let’s examine normality.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram for aggregate mental QOL score</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>AGG_MENT)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot for aggregate mental QOL score</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>AGG_MENT)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>AGG_MENT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by descending to examine highest values</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>sorted_data_2 <span class="ot">&lt;-</span> data_2[<span class="fu">order</span>(data_2<span class="sc">$</span>AGG_MENT),] <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, AGG_MENT, years)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print resulting table</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(sorted_data_2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">newid</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG_MENT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">years</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">263</td>
<td style="text-align: right;">7.229315</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">368</td>
<td style="text-align: right;">9.851272</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">368</td>
<td style="text-align: right;">10.510143</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">499</td>
<td style="text-align: right;">10.891071</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">306</td>
<td style="text-align: right;">10.954260</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">309</td>
<td style="text-align: right;">11.206351</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplot of aggregate mental QOL to assess for outliers</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>outlier_AGG_MENT <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(data_2<span class="sc">$</span>AGG_MENT, <span class="at">main =</span> <span class="st">"Boxplot for Aggregate Mental QOL"</span>)<span class="sc">$</span>out</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="fl">1.2</span>, <span class="fu">length</span>(outlier_AGG_MENT)),</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> outlier_AGG_MENT, <span class="at">labels =</span> outlier_AGG_MENT, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It appears that <code>AGG_MENT</code> only has 2 potential outliers, and is also not normally distributed, it is left-tailed. Let’s address that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize function to test which transformation performs the best</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>BNobject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data_2<span class="sc">$</span>AGG_MENT)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>BNobject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 1640 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 9.5256
 - Box-Cox: 3.3336
 - Center+scale: 5.2062
 - Double Reversed Log_b(x+a): 2.3793
 - Exp(x): 168.9372
 - Log_b(x+a): 9.5247
 - orderNorm (ORQ): 1.0353
 - sqrt(x + a): 6.9394
 - Yeo-Johnson: 3.1865
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
orderNorm Transformation with 1640 nonmissing obs and ties
 - 1641 unique values 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 7.229 37.863 50.386 56.401 73.312 </code></pre>
</div>
</div>
<p>The orderNorm transformation beats out the other transformations by a mile. Let’s perform that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform orderNorm transformation of aggregate mental QOL score</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>AGG_MENT_orderNorm <span class="ot">&lt;-</span> <span class="fu">orderNorm</span>(data_2<span class="sc">$</span>AGG_MENT)<span class="sc">$</span>x.t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in orderNorm(data_2$AGG_MENT): Ties in data, Normal distribution not guaranteed</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">truehist</span>(data_2<span class="sc">$</span>AGG_MENT_orderNorm, <span class="at">main =</span> <span class="st">"OrderNorm transformation"</span>, <span class="at">nbins =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That appears to be what we have to do but I have some misgivings with orderNorm transforming everything…</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note: <a href="#Variable_Creation">Later in the document</a> we see that the distribution of the change score for each outcome variable is normally distributed, and thus absolves us of the need to perform any transformations besides log transforming <code>VLOAD</code>.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p><a href="#Clean_DVs">Top of Tabset</a></p>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>AGG_PHYS has a min of 9.12 and a max of 73.57. These are within the specified range of 0 - 100, and it appears there were no data error entries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creat histogram of aggregate physical QOL score</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>AGG_PHYS)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplots of aggregate physical QOL score</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>AGG_PHYS)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>AGG_PHYS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>AGG_PHYS</code> is not normally distributed, it is left-tailed.</p>
<p>Let’s test which type of transformation might suit it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bestNormalize function to test which transformation performs the best</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>BNobject <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(data_2<span class="sc">$</span>AGG_PHYS)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>BNobject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Normalizing transformation with 1640 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 6.6807
 - Box-Cox: 2.4618
 - Center+scale: 3.7505
 - Double Reversed Log_b(x+a): 1.8969
 - Exp(x): 175.8084
 - Log_b(x+a): 6.6879
 - orderNorm (ORQ): 1.1791
 - sqrt(x + a): 4.957
 - Yeo-Johnson: 1.9941
Estimation method: Out-of-sample via CV with 10 folds and 5 repeats
 
Based off these, bestNormalize chose:
orderNorm Transformation with 1640 nonmissing obs and ties
 - 1641 unique values 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 9.117 44.240 52.791 56.389 70.437 </code></pre>
</div>
</div>
<p>Again orderNorm performs the best.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform orderNorm transformation of aggregate mental QOL score</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>AGG_PHYS_orderNorm <span class="ot">&lt;-</span> <span class="fu">orderNorm</span>(data_2<span class="sc">$</span>AGG_PHYS)<span class="sc">$</span>x.t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in orderNorm(data_2$AGG_PHYS): Ties in data, Normal distribution not guaranteed</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">truehist</span>(data_2<span class="sc">$</span>AGG_PHYS_orderNorm, <span class="at">main =</span> <span class="st">"OrderNorm transformation"</span>, <span class="at">nbins =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>OrderNorm transforming all our DVs might make interpration difficult…</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note: <a href="#Variable_Creation">Later in the document</a> we see that the distribution of the change score for each outcome variable is normally distributed, and thus absolves us of the need to perform any transformations besides log transforming <code>VLOAD</code>.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p><a href="#Clean_DVs">Top of Tabset</a></p>
</div>
</div>
</div>
</section>
<section id="Clean_IVs" class="level3">
<h3 class="anchored" data-anchor-id="Clean_IVs">Cleaning Covariates</h3>
<p>Now let’s perform data quality checks on our covariates.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Hash Use</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Hash Frequency</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Income</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">BMI</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">High Blood Pressure</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">Diabetes</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-7" role="tab" aria-controls="tabset-2-7" aria-selected="false">Liver Disease</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-8" role="tab" aria-controls="tabset-2-8" aria-selected="false">Kidney Disease</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-9" role="tab" aria-controls="tabset-2-9" aria-selected="false">Frailty Related Phenotype</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-10-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-10" role="tab" aria-controls="tabset-2-10" aria-selected="false">Frailty Phenotype</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-11-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-11" role="tab" aria-controls="tabset-2-11" aria-selected="false">Total Cholesterol</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-12-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-12" role="tab" aria-controls="tabset-2-12" aria-selected="false">Triglycerides</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-13-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-13" role="tab" aria-controls="tabset-2-13" aria-selected="false">Low Density Lipoprotein</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-14-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-14" role="tab" aria-controls="tabset-2-14" aria-selected="false">Dyslipidemia</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-15-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-15" role="tab" aria-controls="tabset-2-15" aria-selected="false">Depression</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-16-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-16" role="tab" aria-controls="tabset-2-16" aria-selected="false">Smoking Status</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-17-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-17" role="tab" aria-controls="tabset-2-17" aria-selected="false">Drinking Group</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-18-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-18" role="tab" aria-controls="tabset-2-18" aria-selected="false">Heroin or Opiate Use</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-19-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-19" role="tab" aria-controls="tabset-2-19" aria-selected="false">Intravenous Drug Use</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-20-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-20" role="tab" aria-controls="tabset-2-20" aria-selected="false">Adherence</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-21-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-21" role="tab" aria-controls="tabset-2-21" aria-selected="false">Race</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-22-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-22" role="tab" aria-controls="tabset-2-22" aria-selected="false">Education at Baseline</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-23-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-23" role="tab" aria-controls="tabset-2-23" aria-selected="false">HIV Serostatus</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-24-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-24" role="tab" aria-controls="tabset-2-24" aria-selected="false">Age</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-25-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-25" role="tab" aria-controls="tabset-2-25" aria-selected="false">Antiretroviral Therapy</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-26-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-26" role="tab" aria-controls="tabset-2-26" aria-selected="false">everART</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-27-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-27" role="tab" aria-controls="tabset-2-27" aria-selected="false">Hard Drug Use</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-28-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-28" role="tab" aria-controls="tabset-2-28" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Hash/marijuana use since last visit</p>
<ul>
<li>1 = no</li>
<li>2 = yes</li>
<li>blank = missing</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a barplot for hash use</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>HASHV))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Missing data is correctly handled for this variable.</p>
<p>We have more visits where participants used hash since the last visit than visits where participants did not use hash.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Frequency hash/marijuana was used since last visit.</p>
<ul>
<li>0 = Never</li>
<li>1 = Daily</li>
<li>2 = Weekly</li>
<li>3 = Monthly</li>
<li>4 = Less Often</li>
<li>Blank = Missing</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot for hash frequency</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>HASHF))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This variable is coded correctly. Most participants answered they have never used Hash.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Income</p>
<ul>
<li>1 = Less than $10,000</li>
<li>2 = $10,000 - $19,999</li>
<li>3 = $20,000 - $29,999</li>
<li>4 = $30,000 - $39,999</li>
<li>5 = $40,000 - $49,999</li>
<li>6 = $50,000 - $59,999</li>
<li>7 = $60,000 or more</li>
<li>9 = Do not wish to answer</li>
</ul>
<p>The min and max for income are 1 - 9, which matches that data dictionary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot for income</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>income))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get values for each income level</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>income))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Less than $10,000</td>
<td style="text-align: right;">285</td>
</tr>
<tr class="even">
<td style="text-align: left;">$10,000-$19,999</td>
<td style="text-align: right;">164</td>
</tr>
<tr class="odd">
<td style="text-align: left;">$20,000-$29,999</td>
<td style="text-align: right;">175</td>
</tr>
<tr class="even">
<td style="text-align: left;">$30,000-$39,999</td>
<td style="text-align: right;">172</td>
</tr>
<tr class="odd">
<td style="text-align: left;">$40,000-$49,999</td>
<td style="text-align: right;">123</td>
</tr>
<tr class="even">
<td style="text-align: left;">$50,000-$59,999</td>
<td style="text-align: right;">202</td>
</tr>
<tr class="odd">
<td style="text-align: left;">$60,000 or more</td>
<td style="text-align: right;">89</td>
</tr>
<tr class="even">
<td style="text-align: left;">Do not wish to answer</td>
<td style="text-align: right;">38</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>We have to convert those values of ‘Do not wish to answer’ to be NA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting scores of 9 (do not wish to answer) to be NA</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>income[data_2<span class="sc">$</span>income <span class="sc">==</span> <span class="st">"Do not wish to answer"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop empty levels</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>income <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(data_2<span class="sc">$</span>income) </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a barplot of income with cleaned values</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>income))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks good, we just converted 38 participants from do not wish to answer, to count as missing.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>Body Mass Index</p>
<p>We have a min of -1 and a max of 1000.</p>
<ul>
<li><p>-1: Improbable values</p></li>
<li><p>999: Insufficient data (why it shows up with decimals and is not exactly 999, who knows).</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of BMI</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>BMI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s convert those values of -1 and &gt;= 998 into missing values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert missing and improbably values to NA</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>BMI[data_2<span class="sc">$</span>BMI <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> data_2<span class="sc">$</span>BMI <span class="sc">&gt;=</span> <span class="dv">998</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And check out the histogram again and the qqplot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of BMI</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>BMI, <span class="at">breaks =</span> <span class="dv">20</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot of BMI</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>BMI)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>BMI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize_column</span>(data_2<span class="sc">$</span>BMI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Type      Min    Max
1 Numeric 15.94907 52.832</code></pre>
</div>
</div>
<p>Looks better. Now we have a BMI range of 15.94 - 52.83.</p>
<p>The histogram and qqplots show BMI is slightly right skewed, with more morbidly obese patients than underweight. Is this close enough to normal to ignore, if we take out outliers?</p>
<p>The patient with a BMI of 52.83 may be an outlier based on the qqplot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Investigating highest BMI value to see if its an outlier</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>highest_bmi <span class="ot">&lt;-</span> data[data<span class="sc">$</span>newid <span class="sc">==</span> <span class="dv">206</span>,]</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot BMI for each year for this patient</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(highest_bmi<span class="sc">$</span>years, highest_bmi<span class="sc">$</span>BMI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interestingly, participant 206 got heavier over the first year, then dropped weight in the proceeding years. Either that or that second year entry point was an error and was meant to be 42.83</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing to see if these plots look normal after taking the participant with BMI of 52.83 out</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>BMI[data_2<span class="sc">$</span>newid <span class="sc">==</span> <span class="dv">206</span> <span class="sc">&amp;</span> data_2<span class="sc">$</span>years <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>BMI, <span class="at">breaks =</span> <span class="dv">20</span>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>BMI)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>BMI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add back in that value we removed</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>BMI[data_2<span class="sc">$</span>newid <span class="sc">==</span> <span class="dv">206</span> <span class="sc">&amp;</span> data_2<span class="sc">$</span>years <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">52.832</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After removing that highest BMI value, the histogram is still right tailed.</p>
<p>What do the boxplots look like?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>outlier_bmi <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(data_2<span class="sc">$</span>BMI, <span class="at">main =</span> <span class="st">"Boxplot for BMI"</span>)<span class="sc">$</span>out</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="fl">1.2</span>, <span class="fu">length</span>(outlier_bmi)),</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> outlier_bmi, <span class="at">labels =</span> outlier_bmi, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That’s a lot of potential outliers for BMI. If we really want to use this variable we may have to remove these values to keep BMI normally distributed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run simple correlation matrix to see if BMI correlated with any outcomes of interest</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation between VMI and VLOAD log</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>cor_test_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data_2<span class="sc">$</span>BMI, data_2<span class="sc">$</span>VLOAD_log)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>cor_test_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_2$BMI and data_2$VLOAD_log
t = -5.8077, df = 1499, p-value = 0.000000007721
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.1974585 -0.0984866
sample estimates:
      cor 
-0.148344 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation between BMI and CD4+ T Cell count boxcox</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>cor_test_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data_2<span class="sc">$</span>BMI, data_2<span class="sc">$</span>LEU3N_boxcox)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>cor_test_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_2$BMI and data_2$LEU3N_boxcox
t = 7.5505, df = 1503, p-value = 0.00000000000007484
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1420089 0.2393834
sample estimates:
      cor 
0.1911664 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation between BMI and mental QOL </span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>cor_test_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data_2<span class="sc">$</span>BMI, data_2<span class="sc">$</span>AGG_MENT)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>cor_test_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_2$BMI and data_2$AGG_MENT
t = 2.2657, df = 1504, p-value = 0.02361
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.007834005 0.108516221
sample estimates:
       cor 
0.05832342 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation between BMI and physical QOL.</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>cor_test_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data_2<span class="sc">$</span>BMI, data_2<span class="sc">$</span>AGG_PHYS)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>cor_test_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_2$BMI and data_2$AGG_PHYS
t = 4.4256, df = 1504, p-value = 0.00001031
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.06323068 0.16296024
sample estimates:
     cor 
0.113381 </code></pre>
</div>
</div>
<p>BMI is correlated with all our outcome variables, so we should make sure it’s cleaned.</p>
<p>It looks like we have a lot of outliers for BMI we can clean out from our data set to make sure it has a normal distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute mean and sd values for BMI</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>mean_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(data_2<span class="sc">$</span>BMI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>sd_value <span class="ot">&lt;-</span> <span class="fu">sd</span>(data_2<span class="sc">$</span>BMI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Use plotly to label outliers</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> data_2, <span class="at">type =</span> <span class="st">'box'</span>) </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_boxplot</span>(<span class="at">y =</span> <span class="sc">~</span>BMI, <span class="at">name =</span> <span class="st">"Suspected Outlier"</span>, </span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">boxpoints =</span> <span class="st">'suspectedoutliers'</span>,</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'rgb(8,81,156)'</span>,</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">outliercolor =</span> <span class="st">'rgba(219, 64, 82, 0.6)'</span>,</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">line =</span> <span class="fu">list</span>(<span class="at">outliercolor =</span> <span class="st">'rgba(219, 64, 82, 1.0)'</span>,</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">outlierwidth =</span> <span class="dv">2</span>)),</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'rgb(8,81,156)'</span>),</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"ID:"</span>, newid),</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">"text"</span>)</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Ignoring 135 observations</code></pre>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c7392379ee9ee0243be4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c7392379ee9ee0243be4">{"x":{"visdat":{"3d383368348f":["function () ","plotlyVisDat"]},"cur_data":"3d383368348f","attrs":{"3d383368348f":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"},"3d383368348f.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","y":{},"name":"Suspected Outlier","boxpoints":"suspectedoutliers","marker":{"color":"rgb(8,81,156)","outliercolor":"rgba(219, 64, 82, 0.6)","line":{"outliercolor":"rgba(219, 64, 82, 1.0)","outlierwidth":2}},"line":{"color":"rgb(8,81,156)"},"text":{},"hoverinfo":"text","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":"BMI"},"xaxis":{"domain":[0,1],"automargin":true},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(31,119,180,0.5)","type":"box","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(255,127,14,0.5)","type":"box","y":[24.717559090000002,26.068007170000001,27.164209230000001,26.669360149999999,25.965761950000001,26.96036793,28.590848210000001,28.353199069999999,28.185097509999999,20.364513250000002,18.21865476,20.284854840000001,22.269860099999999,24.978654219999999,20.80192959,23.221658479999999,23.7531848,22.410008940000001,24.716879779999999,26.566404559999999,25.465513810000001,28.85804285,29.215645389999999,31.360615039999999,19.910766840000001,22.636661320000002,23.934005840000001,20.59908544,19.32619854,21.071920559999999,18.55779905,19.826809279999999,20.415883860000001,20.27133169,20.256111180000001,22.594786710000001,23.308751829999999,22.48906873,24.76099529,25.613095869999999,26.641296029999999,23.504980719999999,21.584542880000001,20.936008269999999,28.497813749999999,30.84426242,30.254312219999999,22.401980519999999,24.22315094,23.181228699999998,25.57984025,30.156051089999998,26.73805037,30.283562889999999,32.975994479999997,34.708666809999997,29.381398149999999,30.008437799999999,26.463931469999999,25.102298619999999,25.54188066,28.181149080000001,28.377350209999999,28.45378539,29.87478411,30.27654369,29.311000180000001,22.418650370000002,24.460950740000001,22.50568715,22.951714460000002,21.200573250000001,21.39584369,30.835604929999999,29.724980259999999,28.578760819999999,21.285015680000001,23.56807083,22.55871711,21.267300890000001,19.499797730000001,18.958614879999999,18.08698609,19.118829359999999,21.148610219999998,23.955868779999999,22.781145110000001,19.518361930000001,23.504366340000001,27.102646350000001,25.377539039999998,27.30225751,30.35525513,30.469110700000002,23.014031840000001,24.37753726,24.7462187,23.52290082,31.987308689999999,28.06058273,29.935707369999999,26.915740790000001,22.386996880000002,24.306872760000001,25.330425290000001,28.108278819999999,26.963438310000001,28.181134849999999,28.066689839999999,26.72919349,27.289349519999998,22.78103647,24.71993917,21.894391240000001,23.359948939999999,23.481535569999998,22.540731919999999,28.82353861,30.922300719999999,32.59591503,20.66837323,21.720828239999999,23.256337739999999,19.577684260000002,19.450085139999999,18.953457570000001,21.11509934,19.952520209999999,19.06541618,21.727143640000001,23.464785129999999,23.456379250000001,22.565496830000001,25.7980622,26.721905599999999,28.226216099999998,30.003661860000001,30.41635157,24.184745629999998,24.671943240000001,26.011017989999999,25.973183240000001,27.501665639999999,27.9083614,29.642022699999998,27.371147180000001,25.22083056,24.903933970000001,22.56627048,22.366238299999999,26.378704939999999,35.633011609999997,38.896173679999997,36.212029970000003,26.12902076,26.035766939999998,23.468264900000001,32.350382699999997,31.647466850000001,30.017366519999999,34.258444429999997,29.388870220000001,26.007725310000001,24.865273479999999,24.214417090000001,25.59975172,22.385352180000002,22.203250659999998,23.393993120000001,28.318000319999999,27.26619273,24.903623240000002,24.375597020000001,26.28658081,23.493920299999999,30.85484314,30.346417249999998,31.008418590000002,24.770034259999999,23.14444962,24.892474610000001,18.585619380000001,19.299406579999999,19.402647900000002,29.15438597,27.007671940000002,28.391921050000001,22.955177549999998,24.950296789999999,22.107853899999999,31.63990141,32.934923910000002,32.21844351,24.167772039999999,24.260476870000002,24.02500916,19.15583397,19.787030949999998,20.692581969999999,24.684720469999998,25.91671285,25.219321090000001,23.82667665,23.540040520000002,24.899810590000001,25.391190129999998,24.813419740000001,24.84642328,27.428419439999999,25.382324969999999,26.668283819999999,25.602158889999998,27.639293980000001,27.37145391,23.95181972,23.388530889999998,20.172496819999999,22.668678740000001,22.783140020000001,24.586316480000001,29.401735760000001,29.600403870000001,31.693584019999999,29.52729025,28.685514149999999,27.751094640000002,33.15458521,29.509357470000001,28.42807723,26.322058080000001,25.91510912,28.135182650000001,21.422303429999999,22.614447670000001,20.42436365,26.615772509999999,25.633075850000001,23.6386924,27.972252309999998,27.818658840000001,28.015665670000001,20.976975729999999,21.188665889999999,30.588276910000001,30.420687879999999,30.109845050000001,16.495330259999999,17.0667334,16.619948359999999,24.746385969999999,23.747405860000001,23.424574839999998,23.92077368,22.87218979,21.377864150000001,23.51005331,24.094824500000001,25.12245016,24.417306400000001,27.913991849999999,29.675282209999999,29.86535787,18.906459380000001,20.6853351,19.65325391,23.7976645,22.079425579999999,22.897307810000001,35.718392909999999,35.527666629999999,36.300846219999997,25.159155640000002,25.68450133,26.52178932,23.177619839999998,28.476647119999999,27.186752550000001,22.368732720000001,25.61164819,28.90289877,27.179001970000002,28.694763269999999,26.949758119999998,22.479034290000001,23.1933723,25.071229840000001,26.234239859999999,25.784310999999999,20.30380546,21.974944019999999,23.378991330000002,32.734807240000002,29.515070120000001,27.678780660000001,35.425191499999997,31.666224870000001,35.884919670000002,35.49820897,34.384990600000002,39.583909869999999,27.45211252,28.383498679999999,25.872811609999999,25.46359593,26.098174140000001,26.870049179999999,27.989676169999999,29.719113530000001,28.5841569,22.376534119999999,24.819856390000002,20.924082210000002,23.741357879999999,22.771832450000002,24.835836780000001,25.304319670000002,22.730463719999999,22.296991370000001,26.423977709999999,24.910562049999999,23.347858939999998,25.77774977,26.938712540000001,23.849269509999999,21.53702251,21.150352139999999,22.32810014,24.364319470000002,24.32599205,24.446395750000001,23.501720590000001,22.56586793,28.003292479999999,20.553285070000001,24.767678780000001,23.365542980000001,22.682985599999999,23.222267500000001,21.88186932,22.889965849999999,23.83790329,24.141370080000002,23.978553300000002,24.768529260000001,25.82638438,25.066123059999999,22.190055520000001,22.62789141,24.2525239,21.57987116,21.517975660000001,21.404915630000001,18.827353819999999,18.288513850000001,18.789197949999998,20.102907600000002,20.389814260000001,23.97946439,25.46709997,26.499000890000001,24.681831899999999,25.467629680000002,23.819345160000001,40.381710490000003,39.29654068,36.000437249999997,28.954110029999999,29.829511579999998,29.746386869999998,28.189867979999999,29.107341120000001,29.545606339999999,21.85539897,21.84436475,23.78137233,27.628655930000001,23.59116852,24.163557040000001,23.01878,40.197379320000003,39.2594979,41.13526074,25.377663250000001,20.36829577,18.36929851,20.895995880000001,27.079136290000001,27.28970417,28.125402350000002,18.360931260000001,16.86896402,18.596473079999999,19.51273759,23.00365755,20.612795779999999,26.101822819999999,29.916830780000002,29.293643629999998,23.608739289999999,21.738023930000001,21.863317439999999,27.54451151,25.21453082,25.497402560000001,20.216029689999999,18.499249500000001,18.94221654,23.14054788,23.459316560000001,23.745801579999998,19.166276910000001,20.02336738,19.39956944,33.619866780000002,36.591612300000001,33.884569229999997,20.864799730000001,22.38151925,24.538818729999999,24.788943809999999,25.674299210000001,34.228886670000001,31.5704387,33.750673149999997,23.680840069999999,24.304076460000001,22.437769759999998,24.2125348,23.715371099999999,27.25216966,25.65908357,24.16986116,35.881334979999998,32.261023989999998,29.096310379999998,38.436748039999998,39.778882520000003,28.10798986,29.710200990000001,18.976309369999999,19.52664103,19.698685179999998,21.48903344,20.20071767,22.15563229,22.954563409999999,27.89883545,24.128122659999999,22.93735174,23.440081459999998,25.06721495,30.438229,28.654609239999999,23.1152224,23.776907529999999,23.504766910000001,21.2943742,19.614767130000001,20.002687399999999,20.183669550000001,25.542304250000001,26.607176620000001,28.602498149999999,28.500984750000001,25.26692727,27.590397939999999,32.501798780000001,31.052325159999999,31.74351291,21.709719239999998,21.21300291,20.873034270000002,25.440435050000001,23.114422569999999,24.31805997,17.66341311,21.142975280000002,18.858083799999999,20.49546467,20.650046969999998,25.843179240000001,27.636316189999999,26.28639768,29.38705517,29.085023209999999,29.38705517,18.317541949999999,18.865168310000001,19.181078150000001,24.421936599999999,24.53771674,24.485146879999999,37.58512107,24.924668499999999,27.113233569999998,26.888035439999999,23.424832859999999,23.183929190000001,22.253934569999998,25.55884588,25.374069899999999,26.17359553,18.88270687,18.88798491,20.233415040000001,23.064244819999999,23.11917863,23.74721143,22.805985329999999,24.09593465,24.14268057,29.502773399999999,29.502773399999999,21.206956529999999,20.559254249999999,18.327492700000001,20.739823810000001,20.550337379999998,21.157218440000001,23.34598785,25.44316808,25.047169199999999,28.33548351,27.003245759999999,40.831008609999998,35.754747459999997,33.989384739999998,26.018265,27.106558790000001,24.81098798,28.19027415,28.41959241,28.19027415,24.312538480000001,25.611009060000001,27.197309449999999,26.72543366,25.741141769999999,27.709725550000002,21.661210820000001,22.678738299999999,24.412190129999999,21.896288139999999,23.12313674,26.692981939999999,24.69690104,23.193034730000001,24.175072149999998,25.944721229999999,27.381612390000001,28.165168600000001,29.250181040000001,24.427214580000001,23.785999,24.32759472,24.962382009999999,25.683561009999998,32.074330240000002,31.3209053,32.074330240000002,25.571236240000001,27.2418324,25.04404027,28.32349769,28.871802649999999,31.296382220000002,30.922688969999999,31.40387913,31.978496100000001,25.938923939999999,28.136185650000002,28.901622570000001,39.862992929999997,52.832000000000001,44.295911869999998,29.020276540000001,28.630310659999999,20.75599528,19.1475191,20.645741350000002,18.926016919999999,24.384561309999999,24.55336964,23.051326759999998,23.354173939999999,26.399402340000002,24.254963660000001,23.161855129999999,25.18514832,28.891431440000002,28.19808579,27.332306410000001,23.651867330000002,22.867386339999999,22.476748740000001,27.695788960000002,26.479366500000001,29.88601907,26.013721749999998,25.503957759999999,26.455503790000002,22.143399469999999,22.971713560000001,24.748775510000002,25.152331199999999,27.287337870000002,24.896017539999999,20.697462120000001,22.718942299999998,25.861429650000002,24.30096262,25.400777250000001,27.815503960000001,27.821332479999999,25.604923580000001,25.417586289999999,26.10730478,24.729985509999999,29.3841401,22.3928242,23.316881510000002,21.508503470000001,23.84878776,27.37593644,24.31868828,25.85164786,19.767741579999999,18.480036550000001,20.673307579999999,26.93885028,28.032992790000002,26.72144887,23.231233140000001,21.819648529999998,20.08660394,22.175179450000002,21.90071056,21.107229100000001,19.063013089999998,21.48023542,19.855748470000002,25.05480785,22.520836809999999,21.62981671,28.271421310000001,32.37633391,26.329561569999999,26.32620528,24.299471199999999,25.99291873,37.37963439,39.973983029999999,37.841532260000001,23.529012120000001,23.824079309999998,26.239269449999998,35.288523499999997,35.288523499999997,21.44542332,21.040167650000001,20.882029800000002,22.584806390000001,21.932294370000001,24.06146944,18.144981059999999,20.321569109999999,17.94502997,21.636299770000001,23.827093959999999,24.6179348,30.113155299999999,28.429845629999999,29.048382889999999,23.6590749,23.63758782,23.3634697,25.331188900000001,26.663177359999999,26.206508719999999,30.60311183,29.787178300000001,27.83824139,21.80724292,20.453286930000001,22.522521009999998,23.153856650000002,26.12614379,24.128356790000002,24.83487379,23.259946469999999,25.111924940000002,24.010516970000001,21.359737559999999,20.02774432,20.503381059999999,18.698168949999999,22.616527479999998,22.935029929999999,19.006117010000001,15.94907484,18.02263512,22.257975940000001,22.328905240000001,24.48765083,28.106526479999999,28.656547010000001,30.79641384,22.083940040000002,24.69868898,29.629378760000002,28.578618809999998,27.673526939999999,24.29341715,26.996081019999998,32.099340959999999,31.948960639999999,23.777730160000001,25.264893140000002,23.60131479,23.101673510000001,22.784969149999998,23.490415760000001,20.987880990000001,19.464248749999999,22.495888669999999,23.580403969999999,24.883977009999999,25.771362679999999,31.06014858,29.813119820000001,30.176592240000002,30.568793880000001,28.252277750000001,29.08070674,28.850301989999998,32.088269310000001,30.35171171,38.708937329999998,38.65914051,39.197063890000003,22.7304256,23.256565609999999,22.82679255,27.366505709999998,25.50323874,25.355387050000001,21.860692319999998,20.268976429999999,20.873141,22.05304516,25.08566604,20.876499809999999,32.139172549999998,35.790648709999999,34.15591156,26.25423631,27.799214880000001,31.457470839999999,22.06320565,24.199662979999999,22.872823780000001,17.5358944,20.566207080000002,19.151604450000001,18.540265260000002,21.186077569999998,20.955266940000001,26.95299322,27.779301570000001,28.56723487,26.577966790000001,25.04440237,26.82623641,24.27905878,25.151989369999999,22.38089956,23.549151649999999,22.06285248,22.01090348,19.366132,18.398364619999999,20.389480989999999,25.961633339999999,25.981966669999998,23.7266333,27.609486489999998,24.255219019999998,22.770672480000002,22.702351289999999,22.293356030000002,25.656998529999999,23.593854310000001,23.875657919999998,27.005851830000001,25.10731367,28.458327780000001,25.368978510000002,25.495911719999999,25.910782449999999,29.010765469999999,28.736608059999998,28.23865567,24.60383289,25.488207639999999,27.206491119999999,24.675577789999998,26.531419060000001,25.701171670000001,24.32571536,25.240448000000001,24.747311839999998,24.510091070000001,24.151189370000001,23.950396959999999,29.209103930000001,29.132142510000001,31.704598019999999,26.1744865,27.278867470000002,29.480145350000001,24.119457520000001,25.481513889999999,30.255786000000001,30.699956820000001,32.655850700000002,23.600735190000002,24.107877899999998,22.085442319999999,20.915759730000001,22.57218482,23.448024319999998,23.5157256,23.295827160000002,22.726337099999999,25.254019280000001,25.294528140000001,21.493263809999998,23.314773899999999,22.81934695,23.01104604,27.573215340000001,28.760944080000002,21.955160549999999,22.17556961,22.410757709999999,21.687873799999998,24.07525364,30.607054219999998,21.05077563,19.294522130000001,21.62271599,18.22014879,18.029481029999999,24.146964759999999,23.940637120000002,25.475213190000002,25.613063390000001,24.926773109999999,23.564487889999999,25.278978859999999,24.992472859999999,20.865166259999999,21.60955418,20.716405259999998,18.591857319999999,18.928563520000001,29.319174960000002,24.807577930000001,21.090858040000001,20.818395850000002,21.91438394,20.103351230000001,24.380039570000001,22.7422951,18.878678359999999,19.659485979999999,28.584526260000001,29.939706439999998,32.283624490000001,29.735504169999999,29.064541380000001,29.735504169999999,28.525134300000001,28.04373163,23.77064566,24.432476510000001,27.77368427,28.869405610000001,24.912210949999999,26.87415373,25.709265729999998,24.531048779999999,21.65341643,27.061114920000001,23.679102220000001,23.919217419999999,22.072833209999999,20.439266660000001,21.869848149999999,24.664115689999999,20.79840497,19.220589650000001,21.255468990000001,21.356106499999999,22.587458789999999,21.028535160000001,21.648354019999999,23.247360069999999,24.66647511,24.07756277,20.07202448,19.673430410000002,18.511406099999999,21.717914159999999,21.597789760000001,20.765744999999999,20.768997089999999,45.275162880000003,43.708919049999999,43.621458799999999,23.01872358,18.56434539,23.782962250000001,19.965016989999999,20.351268019999999,19.811362540000001,22.860948759999999,21.294469119999999,22.860948759999999,27.941899379999999,30.3420679,29.918857339999999,23.790497240000001,26.442588220000001,23.637177659999999,29.3673979,29.70070737,29.121750630000001,26.393652230000001,32.606241939999997,31.252870120000001,33.959613750000003,20.750302510000001,23.407617219999999,21.761456379999998,19.50064695,21.304978290000001,21.795932860000001,24.760699729999999,23.565760959999999,25.724166660000002,22.928629690000001,24.48358245,20.971262169999999,20.733163009999998,33.400870130000001,31.63275668,29.466506949999999,21.584317129999999,23.243305320000001,21.998138690000001,24.166634420000001,25.781771469999999,27.039518739999998,28.467045450000001,26.578025069999999,28.382234960000002,34.878982399999998,33.864955790000003,36.008928109999999,34.533793629999998,33.856570490000003,34.757396759999999,24.048613799999998,21.648165030000001,20.85032726,26.391898130000001,25.76438795,27.019408309999999,23.791304700000001,23.459842269999999,25.572517340000001,22.800627039999998,25.38648178,22.102134960000001,27.30905534,28.013796379999999,31.878135440000001,24.44143042,23.82735628,25.055504549999998,31.464218150000001,31.360903449999999,28.503899629999999,25.445743539999999,23.183769569999999,22.982724180000002,23.506895180000001,23.542340530000001,25.003499479999999,25.946452730000001,25.977290530000001,25.784470979999998,25.861988010000001,27.92746348,29.608350739999999,31.160497889999998,27.689511209999999,29.196989500000001,30.185006269999999,26.95672034,22.727318830000002,25.514026950000002,24.796680120000001,22.564686399999999,24.351231840000001,23.39881244,25.957091070000001,26.149067420000002,23.323803999999999,24.391663829999999,23.478271159999998,24.44466894,16.366321989999999,32.523015880000003,35.371992159999998,41.693098919999997,40.870025249999998,26.7731843,28.207953839999998,27.671342129999999,29.538457040000001,30.28645684,32.082203110000002,28.673896039999999,29.094728190000001,27.502052620000001,28.52450554,28.07357077,27.649975749999999,20.15646916,22.260416490000001,18.239467099999999,17.758410510000001,17.95834207,29.833288849999999,28.603214680000001,30.215630569999998,22.56970944,24.322259119999998,22.65785975,32.41562948,28.589886910000001,26.93869492,26.093696919999999,26.092110309999999,22.02286217,22.19820782,20.436256780000001,26.394836130000002,28.774412120000001,28.261627470000001,28.70382437,35.04680226,33.928673789999998,23.87602562,23.41189572,28.316153310000001,22.850318810000001,21.738570599999999,23.30899234,28.290771800000002,22.247427999999999,24.662541269999998,23.247128109999998,26.322309480000001,27.234702739999999,28.632445659999998,26.80377975,24.24959922,27.726961360000001,26.112321260000002,26.8880357,22.931203379999999,22.495853189999998,20.80855523,28.603695420000001,31.533488640000002,28.270813189999998,28.316859860000001,30.47626679,29.696747120000001,30.378196089999999,28.34689324,28.862263110000001,22.56134312,20.420141959999999,21.04230531,19.988988030000002,21.252786100000002,24.90941192,23.678798969999999,26.226697779999999,22.18449055,24.038901410000001,23.604037250000001,34.651193370000001,34.733368939999998,34.343536780000001,28.576911389999999,27.735705549999999,28.741666200000001,26.467038670000001,31.256653660000001,29.019177729999999,24.687434669999998,29.692884660000001,27.00498988,30.311987949999999,33.073093239999999,30.626971380000001,22.720186429999998,23.038301730000001,26.74667346,27.917959570000001,29.455783409999999,31.401961549999999,33.633683349999998,40.429190579999997,38.576914299999999,24.521657099999999,23.370875300000002,24.74718944,36.704505920000003,32.498174710000001,31.96077184,30.442800999999999,32.929988710000003,34.430239159999999,20.730598789999998,22.525250079999999,19.553201730000001,18.310177249999999,27.747408740000001,26.312602550000001,27.274660220000001,31.056626349999998,26.222232000000002,26.786038229999999,27.141461499999998,29.582344379999999,25.380783170000001,26.291979940000001,26.819827220000001,26.03265918,24.452930349999999,26.284502010000001,24.903707449999999,25.173596450000002,25.85010033,24.381684180000001,24.75901897,25.262330370000001,27.384002120000002,23.264673599999998,22.479914529999999,20.879528749999999,21.66760013,23.416114159999999,23.22717608,24.6655564,22.35557262,26.760907159999999,25.09261338,28.413690240000001,26.00852587,29.221360170000001,31.06518505,20.11871958,19.045308179999999,16.847810979999998,25.526639459999998,23.77700639,28.178917559999999,28.30800481,28.801479180000001,20.03680683,19.88013162,26.789730479999999,28.526472850000001,29.940390059999999,24.64588711,24.75293293,28.116523000000001,23.04176554,23.181656830000001,23.432168860000001,22.70943166,23.841583589999999,23.948845460000001,23.657500939999998,29.828728819999998,31.39361989,27.543554969999999,27.164527329999999,27.63697221,25.763874739999999,27.74355014,26.46121303,23.299700949999998,21.760003609999998,21.390541330000001,23.102113159999998,18.39350091,22.268582179999999,22.592812030000001,24.133419079999999,23.932365130000001,24.364654560000002,24.288729719999999,26.389607030000001,22.187852400000001,20.575271369999999,21.96744009,21.26847866,22.134421360000001,22.26423475,28.4865362,29.452899330000001,30.65961879,18.543541529999999,20.937744070000001,21.191987090000001,23.588651370000001,24.843620510000001,24.336254950000001,24.9376593,25.067699780000002,23.626988189999999,24.883594599999999,23.7301267,25.69833642,22.434163739999999,22.635390260000001,21.052107939999999,27.22044022,25.846071599999998,23.935652999999999,29.005674859999999,29.509551760000001,28.325923589999999,28.940355589999999,30.78327831,27.479161130000001,22.13490135,25.342751660000001,27.036359879999999,25.898269379999999,26.45697354,28.12203702,30.188128649999999,30.610425759999998,31.3616119,33.43448764,24.229554629999999,24.788238969999998,25.314142579999999,26.948374319999999,28.031669409999999,26.7615941,24.796221259999999,25.56051905,27.232039650000001,22.4237857,24.584978960000001,25.381169889999999,30.449913639999998,30.61119991,29.911266090000002,18.425217799999999,18.97253817,19.260829640000001,25.706616400000001,24.586174079999999,25.175172490000001,21.830709649999999,18.209215950000001,19.657764790000002,24.519326289999999,25.526173799999999,29.354122960000002,29.547889489999999,28.884145199999999,29.01351798,25.850744089999999,25.174633650000001,26.322668060000002,25.686250879999999,25.774212869999999,17.0602828,19.46671186,21.452605680000001,27.857611219999999,26.629820039999998,27.857611219999999,40.297663460000003,37.537376870000003,34.355807040000002,27.578887160000001,27.110761279999998,27.578887160000001,28.372641260000002,27.838751810000002,28.906530700000001,29.483446260000001,29.10615014,29.372840249999999,26.435850760000001,27.868207229999999,28.763140270000001,23.978494080000001,24.932081740000001,24.588035390000002,23.400251860000001,24.560352730000002,22.903762830000002,17.952500879999999,19.381637319999999,19.956317739999999,18.55379739,18.33992391,18.895671020000002,23.214242729999999,21.675734479999999,21.096404920000001,31.150669820000001,29.791920050000002,29.58180819,20.33425424,23.317944300000001,22.885996200000001,20.662133870000002,20.240377200000001,19.772580550000001,20.68446355,19.823708960000001,19.10813443,23.28507974,25.958569929999999,25.102161120000002,19.524795430000001,20.230946020000001,19.713582639999998,17.995331010000001,19.749027099999999,21.5499826,26.308922809999999,20.61568634,22.190753780000001,23.245990720000002,23.53074544,23.740623710000001,19.322613270000002,23.279980720000001,27.536451240000002,25.287735940000001,21.410228350000001,22.461987700000002,25.253052629999999,33.088671269999999,28.474010960000001,31.93928974,33.802083949999997,31.604124070000001,28.054505200000001,30.473183670000001,29.888568759999998,23.410022550000001,24.40896489,24.345156769999999,23.642534900000001,31.310359500000001,27.9725462,22.441401800000001,23.596945250000001,25.101135150000001,24.654127259999999,25.58524177,23.823244949999999,28.585655429999999,27.299402539999999,25.069295960000002,30.183401199999999,27.718148840000001,23.23885881,24.355455970000001,27.239584780000001,28.727655219999999,29.262002930000001,29.609109449999998,19.629540739999999,19.677233699999999,19.619866009999999,25.02714667,24.648494970000002,26.327312549999998,20.16700359,19.767558650000002,19.915583380000001,21.399781149999999,27.511948709999999,28.435846359999999,29.666484029999999,30.40278047,27.987792809999998,22.47205207,24.683982589999999,25.073255400000001,26.105693720000001,25.005808729999998,18.003075760000002,20.860196389999999,19.414562889999999,28.497372980000002,29.008303900000001,28.497372980000002,40.978416449999997,35.655543280000003,34.81387075,27.133126189999999,27.281756489999999,27.133126189999999,27.733990200000001,27.06025704,28.407723350000001,28.016243790000001,26.86154505,26.523814479999999,26.97149478,27.635613039999999,28.396767010000001,24.903493260000001,24.92811627,27.387685449999999,23.993612339999999,23.95648654,22.197851870000001,19.298459050000002,20.116732320000001,19.5495792,19.653060450000002,18.19027457,19.93956244,23.154604890000002,23.106570860000001,22.755238309999999,29.368567680000002,30.748816789999999,32.057511550000001,20.963422250000001,21.64005075,22.612826009999999,24.002792400000001,20.810362959999999,21.886886879999999,19.721216760000001,19.719986800000001,19.090179169999999,25.082012110000001,24.610885629999999,26.241797680000001,20.03681036,19.666383769999999,21.046377939999999,21.17168895,20.44604571,19.475384380000001,27.172571309999999,18.387116599999999,22.48533437,23.793579390000001,22.127219199999999,23.985034150000001,23.060669829999998,23.244155660000001,25.85973443,26.236176199999999,20.273890909999999,22.112185369999999,24.380521259999998,30.079349180000001,29.09963218,29.091952280000001,31.28557421,30.44565201,28.001075740000001,30.384441249999998,30.558438540000001,23.36116453,24.997435670000002,24.7982166,25.427770779999999,28.11637953,27.628386119999998,24.25708435,25.47150633,25.906237539999999,22.878951170000001,25.006592680000001,24.525288450000001,24.173621820000001,24.745953780000001,25.843964840000002,29.039068159999999,28.259226170000002],"name":"Suspected Outlier","boxpoints":"suspectedoutliers","marker":{"color":"rgb(8,81,156)","outliercolor":"rgba(219, 64, 82, 0.6)","line":{"color":"rgba(255,127,14,1)","outliercolor":"rgba(219, 64, 82, 1.0)","outlierwidth":2}},"line":{"color":"rgb(8,81,156)"},"text":["ID: 1","ID: 1","ID: 1","ID: 2","ID: 2","ID: 2","ID: 3","ID: 3","ID: 3","ID: 4","ID: 4","ID: 4","ID: 5","ID: 5","ID: 5","ID: 6","ID: 6","ID: 6","ID: 7","ID: 7","ID: 7","ID: 8","ID: 8","ID: 8","ID: 9","ID: 9","ID: 9","ID: 10","ID: 10","ID: 10","ID: 11","ID: 11","ID: 12","ID: 12","ID: 12","ID: 13","ID: 13","ID: 13","ID: 14","ID: 14","ID: 14","ID: 15","ID: 15","ID: 15","ID: 16","ID: 16","ID: 16","ID: 17","ID: 17","ID: 17","ID: 18","ID: 18","ID: 18","ID: 19","ID: 19","ID: 19","ID: 21","ID: 21","ID: 22","ID: 22","ID: 22","ID: 23","ID: 23","ID: 23","ID: 24","ID: 24","ID: 24","ID: 25","ID: 25","ID: 25","ID: 26","ID: 26","ID: 26","ID: 27","ID: 27","ID: 27","ID: 28","ID: 28","ID: 28","ID: 29","ID: 29","ID: 29","ID: 30","ID: 30","ID: 30","ID: 31","ID: 31","ID: 31","ID: 32","ID: 32","ID: 32","ID: 33","ID: 33","ID: 33","ID: 34","ID: 34","ID: 34","ID: 35","ID: 35","ID: 35","ID: 37","ID: 37","ID: 38","ID: 38","ID: 38","ID: 39","ID: 39","ID: 39","ID: 40","ID: 40","ID: 40","ID: 41","ID: 41","ID: 41","ID: 42","ID: 42","ID: 42","ID: 43","ID: 43","ID: 43","ID: 44","ID: 44","ID: 44","ID: 45","ID: 45","ID: 45","ID: 46","ID: 46","ID: 46","ID: 47","ID: 47","ID: 47","ID: 48","ID: 48","ID: 48","ID: 49","ID: 49","ID: 49","ID: 50","ID: 50","ID: 50","ID: 51","ID: 51","ID: 51","ID: 53","ID: 53","ID: 54","ID: 54","ID: 55","ID: 55","ID: 55","ID: 56","ID: 56","ID: 56","ID: 57","ID: 57","ID: 57","ID: 58","ID: 58","ID: 58","ID: 59","ID: 59","ID: 59","ID: 60","ID: 60","ID: 60","ID: 61","ID: 61","ID: 61","ID: 62","ID: 62","ID: 62","ID: 63","ID: 63","ID: 63","ID: 64","ID: 64","ID: 64","ID: 65","ID: 65","ID: 65","ID: 66","ID: 66","ID: 66","ID: 67","ID: 67","ID: 67","ID: 68","ID: 68","ID: 68","ID: 69","ID: 69","ID: 69","ID: 70","ID: 70","ID: 70","ID: 71","ID: 71","ID: 71","ID: 72","ID: 72","ID: 72","ID: 73","ID: 73","ID: 73","ID: 74","ID: 74","ID: 74","ID: 75","ID: 75","ID: 75","ID: 76","ID: 76","ID: 76","ID: 77","ID: 77","ID: 77","ID: 78","ID: 78","ID: 78","ID: 79","ID: 79","ID: 79","ID: 80","ID: 80","ID: 80","ID: 81","ID: 81","ID: 81","ID: 82","ID: 82","ID: 82","ID: 83","ID: 83","ID: 83","ID: 84","ID: 84","ID: 84","ID: 85","ID: 85","ID: 85","ID: 86","ID: 86","ID: 87","ID: 87","ID: 87","ID: 88","ID: 88","ID: 88","ID: 89","ID: 89","ID: 90","ID: 90","ID: 91","ID: 91","ID: 91","ID: 92","ID: 92","ID: 92","ID: 93","ID: 93","ID: 93","ID: 94","ID: 94","ID: 94","ID: 95","ID: 95","ID: 95","ID: 96","ID: 96","ID: 96","ID: 97","ID: 97","ID: 97","ID: 99","ID: 99","ID: 99","ID: 100","ID: 100","ID: 100","ID: 101","ID: 101","ID: 101","ID: 102","ID: 102","ID: 103","ID: 103","ID: 103","ID: 104","ID: 104","ID: 104","ID: 105","ID: 105","ID: 105","ID: 106","ID: 106","ID: 106","ID: 107","ID: 107","ID: 107","ID: 108","ID: 108","ID: 108","ID: 109","ID: 109","ID: 109","ID: 110","ID: 110","ID: 110","ID: 111","ID: 111","ID: 111","ID: 112","ID: 112","ID: 112","ID: 113","ID: 113","ID: 113","ID: 114","ID: 114","ID: 114","ID: 115","ID: 115","ID: 116","ID: 117","ID: 117","ID: 117","ID: 118","ID: 118","ID: 119","ID: 119","ID: 119","ID: 120","ID: 120","ID: 120","ID: 121","ID: 121","ID: 121","ID: 122","ID: 122","ID: 122","ID: 123","ID: 123","ID: 123","ID: 124","ID: 124","ID: 125","ID: 125","ID: 125","ID: 126","ID: 126","ID: 126","ID: 127","ID: 127","ID: 127","ID: 128","ID: 128","ID: 129","ID: 129","ID: 129","ID: 130","ID: 130","ID: 130","ID: 131","ID: 131","ID: 131","ID: 132","ID: 132","ID: 132","ID: 133","ID: 133","ID: 133","ID: 134","ID: 134","ID: 134","ID: 135","ID: 136","ID: 136","ID: 136","ID: 137","ID: 137","ID: 137","ID: 138","ID: 139","ID: 139","ID: 139","ID: 140","ID: 140","ID: 140","ID: 141","ID: 141","ID: 141","ID: 142","ID: 142","ID: 142","ID: 143","ID: 143","ID: 143","ID: 144","ID: 144","ID: 144","ID: 146","ID: 146","ID: 146","ID: 147","ID: 147","ID: 147","ID: 148","ID: 148","ID: 148","ID: 149","ID: 149","ID: 149","ID: 150","ID: 150","ID: 150","ID: 151","ID: 151","ID: 152","ID: 152","ID: 152","ID: 153","ID: 153","ID: 153","ID: 154","ID: 154","ID: 154","ID: 155","ID: 155","ID: 155","ID: 156","ID: 156","ID: 157","ID: 157","ID: 157","ID: 158","ID: 158","ID: 159","ID: 159","ID: 160","ID: 160","ID: 160","ID: 161","ID: 161","ID: 161","ID: 162","ID: 162","ID: 162","ID: 163","ID: 163","ID: 163","ID: 164","ID: 164","ID: 164","ID: 165","ID: 165","ID: 165","ID: 166","ID: 166","ID: 166","ID: 167","ID: 167","ID: 167","ID: 168","ID: 168","ID: 168","ID: 169","ID: 169","ID: 169","ID: 170","ID: 170","ID: 170","ID: 171","ID: 171","ID: 171","ID: 172","ID: 172","ID: 173","ID: 173","ID: 173","ID: 174","ID: 174","ID: 174","ID: 175","ID: 175","ID: 175","ID: 176","ID: 176","ID: 176","ID: 177","ID: 177","ID: 177","ID: 178","ID: 179","ID: 179","ID: 179","ID: 180","ID: 180","ID: 180","ID: 181","ID: 181","ID: 181","ID: 182","ID: 182","ID: 182","ID: 183","ID: 183","ID: 183","ID: 184","ID: 184","ID: 184","ID: 185","ID: 185","ID: 186","ID: 186","ID: 186","ID: 187","ID: 187","ID: 187","ID: 188","ID: 188","ID: 188","ID: 189","ID: 189","ID: 190","ID: 190","ID: 190","ID: 191","ID: 191","ID: 191","ID: 192","ID: 192","ID: 192","ID: 193","ID: 193","ID: 193","ID: 194","ID: 194","ID: 194","ID: 195","ID: 195","ID: 195","ID: 196","ID: 196","ID: 196","ID: 197","ID: 197","ID: 197","ID: 198","ID: 198","ID: 198","ID: 199","ID: 199","ID: 199","ID: 200","ID: 200","ID: 200","ID: 201","ID: 201","ID: 201","ID: 202","ID: 202","ID: 202","ID: 203","ID: 203","ID: 203","ID: 204","ID: 204","ID: 204","ID: 205","ID: 205","ID: 205","ID: 206","ID: 206","ID: 206","ID: 207","ID: 207","ID: 208","ID: 208","ID: 209","ID: 209","ID: 210","ID: 210","ID: 210","ID: 211","ID: 211","ID: 212","ID: 212","ID: 212","ID: 213","ID: 213","ID: 213","ID: 214","ID: 214","ID: 214","ID: 215","ID: 215","ID: 215","ID: 216","ID: 216","ID: 216","ID: 217","ID: 217","ID: 217","ID: 218","ID: 218","ID: 218","ID: 219","ID: 220","ID: 220","ID: 220","ID: 221","ID: 221","ID: 221","ID: 222","ID: 222","ID: 222","ID: 223","ID: 223","ID: 224","ID: 224","ID: 224","ID: 225","ID: 225","ID: 225","ID: 226","ID: 227","ID: 227","ID: 227","ID: 228","ID: 228","ID: 228","ID: 229","ID: 229","ID: 229","ID: 230","ID: 230","ID: 230","ID: 231","ID: 231","ID: 231","ID: 232","ID: 232","ID: 232","ID: 233","ID: 233","ID: 233","ID: 234","ID: 234","ID: 234","ID: 235","ID: 235","ID: 235","ID: 236","ID: 236","ID: 236","ID: 237","ID: 237","ID: 238","ID: 238","ID: 238","ID: 239","ID: 239","ID: 239","ID: 240","ID: 240","ID: 240","ID: 241","ID: 241","ID: 241","ID: 242","ID: 242","ID: 242","ID: 243","ID: 243","ID: 243","ID: 244","ID: 244","ID: 244","ID: 245","ID: 245","ID: 245","ID: 246","ID: 246","ID: 246","ID: 247","ID: 247","ID: 247","ID: 248","ID: 248","ID: 249","ID: 249","ID: 249","ID: 250","ID: 250","ID: 250","ID: 251","ID: 251","ID: 252","ID: 252","ID: 252","ID: 253","ID: 253","ID: 253","ID: 255","ID: 255","ID: 255","ID: 256","ID: 257","ID: 258","ID: 259","ID: 259","ID: 259","ID: 260","ID: 260","ID: 260","ID: 261","ID: 261","ID: 261","ID: 262","ID: 262","ID: 262","ID: 263","ID: 263","ID: 263","ID: 264","ID: 264","ID: 264","ID: 265","ID: 265","ID: 265","ID: 266","ID: 266","ID: 266","ID: 267","ID: 267","ID: 267","ID: 268","ID: 268","ID: 268","ID: 269","ID: 269","ID: 269","ID: 270","ID: 270","ID: 270","ID: 271","ID: 271","ID: 271","ID: 272","ID: 272","ID: 272","ID: 273","ID: 273","ID: 273","ID: 274","ID: 274","ID: 274","ID: 275","ID: 275","ID: 275","ID: 276","ID: 276","ID: 276","ID: 277","ID: 277","ID: 277","ID: 278","ID: 278","ID: 278","ID: 279","ID: 279","ID: 279","ID: 280","ID: 280","ID: 280","ID: 281","ID: 281","ID: 281","ID: 282","ID: 282","ID: 282","ID: 283","ID: 283","ID: 284","ID: 284","ID: 284","ID: 285","ID: 285","ID: 285","ID: 286","ID: 286","ID: 286","ID: 287","ID: 287","ID: 287","ID: 288","ID: 288","ID: 288","ID: 289","ID: 289","ID: 289","ID: 290","ID: 290","ID: 290","ID: 291","ID: 291","ID: 291","ID: 292","ID: 292","ID: 292","ID: 293","ID: 293","ID: 293","ID: 294","ID: 294","ID: 294","ID: 295","ID: 295","ID: 296","ID: 296","ID: 296","ID: 297","ID: 297","ID: 297","ID: 298","ID: 298","ID: 298","ID: 299","ID: 299","ID: 299","ID: 300","ID: 300","ID: 300","ID: 301","ID: 301","ID: 301","ID: 302","ID: 302","ID: 302","ID: 303","ID: 303","ID: 304","ID: 305","ID: 305","ID: 305","ID: 306","ID: 307","ID: 308","ID: 308","ID: 308","ID: 309","ID: 309","ID: 310","ID: 310","ID: 311","ID: 311","ID: 311","ID: 313","ID: 313","ID: 313","ID: 314","ID: 314","ID: 314","ID: 315","ID: 315","ID: 316","ID: 316","ID: 317","ID: 317","ID: 317","ID: 318","ID: 318","ID: 318","ID: 319","ID: 319","ID: 320","ID: 320","ID: 320","ID: 321","ID: 321","ID: 321","ID: 322","ID: 322","ID: 322","ID: 323","ID: 323","ID: 323","ID: 324","ID: 324","ID: 324","ID: 325","ID: 326","ID: 326","ID: 326","ID: 327","ID: 327","ID: 327","ID: 328","ID: 328","ID: 328","ID: 329","ID: 329","ID: 329","ID: 330","ID: 330","ID: 330","ID: 331","ID: 331","ID: 331","ID: 332","ID: 332","ID: 332","ID: 333","ID: 334","ID: 334","ID: 334","ID: 335","ID: 335","ID: 335","ID: 336","ID: 336","ID: 336","ID: 337","ID: 337","ID: 337","ID: 338","ID: 338","ID: 338","ID: 339","ID: 339","ID: 339","ID: 340","ID: 340","ID: 340","ID: 341","ID: 341","ID: 341","ID: 342","ID: 343","ID: 343","ID: 343","ID: 344","ID: 344","ID: 344","ID: 345","ID: 345","ID: 345","ID: 346","ID: 346","ID: 346","ID: 347","ID: 348","ID: 348","ID: 348","ID: 350","ID: 350","ID: 350","ID: 351","ID: 351","ID: 351","ID: 352","ID: 352","ID: 352","ID: 353","ID: 353","ID: 353","ID: 354","ID: 354","ID: 354","ID: 355","ID: 355","ID: 355","ID: 356","ID: 356","ID: 356","ID: 357","ID: 357","ID: 357","ID: 358","ID: 358","ID: 358","ID: 359","ID: 359","ID: 359","ID: 360","ID: 360","ID: 360","ID: 361","ID: 361","ID: 361","ID: 362","ID: 362","ID: 362","ID: 363","ID: 364","ID: 364","ID: 364","ID: 365","ID: 365","ID: 365","ID: 366","ID: 366","ID: 366","ID: 367","ID: 367","ID: 367","ID: 368","ID: 368","ID: 368","ID: 369","ID: 369","ID: 369","ID: 370","ID: 370","ID: 370","ID: 371","ID: 371","ID: 371","ID: 372","ID: 372","ID: 372","ID: 373","ID: 373","ID: 373","ID: 374","ID: 374","ID: 374","ID: 375","ID: 375","ID: 375","ID: 376","ID: 376","ID: 376","ID: 377","ID: 377","ID: 377","ID: 378","ID: 378","ID: 378","ID: 379","ID: 379","ID: 380","ID: 380","ID: 380","ID: 381","ID: 381","ID: 381","ID: 382","ID: 382","ID: 382","ID: 383","ID: 383","ID: 384","ID: 384","ID: 384","ID: 385","ID: 385","ID: 385","ID: 386","ID: 386","ID: 386","ID: 387","ID: 387","ID: 387","ID: 388","ID: 388","ID: 388","ID: 389","ID: 389","ID: 389","ID: 390","ID: 391","ID: 391","ID: 391","ID: 392","ID: 392","ID: 392","ID: 393","ID: 393","ID: 394","ID: 394","ID: 394","ID: 395","ID: 395","ID: 395","ID: 396","ID: 396","ID: 396","ID: 397","ID: 397","ID: 397","ID: 398","ID: 398","ID: 398","ID: 399","ID: 399","ID: 400","ID: 400","ID: 400","ID: 401","ID: 401","ID: 401","ID: 402","ID: 402","ID: 402","ID: 403","ID: 403","ID: 403","ID: 404","ID: 404","ID: 404","ID: 405","ID: 405","ID: 405","ID: 406","ID: 406","ID: 406","ID: 407","ID: 407","ID: 407","ID: 408","ID: 408","ID: 408","ID: 409","ID: 409","ID: 409","ID: 410","ID: 410","ID: 410","ID: 411","ID: 411","ID: 411","ID: 412","ID: 412","ID: 412","ID: 413","ID: 413","ID: 413","ID: 414","ID: 414","ID: 415","ID: 415","ID: 416","ID: 416","ID: 417","ID: 417","ID: 417","ID: 418","ID: 418","ID: 418","ID: 419","ID: 419","ID: 419","ID: 420","ID: 420","ID: 420","ID: 421","ID: 421","ID: 421","ID: 422","ID: 422","ID: 422","ID: 423","ID: 423","ID: 423","ID: 424","ID: 424","ID: 424","ID: 426","ID: 426","ID: 426","ID: 427","ID: 427","ID: 427","ID: 428","ID: 428","ID: 428","ID: 429","ID: 429","ID: 429","ID: 430","ID: 430","ID: 431","ID: 431","ID: 431","ID: 432","ID: 432","ID: 433","ID: 433","ID: 433","ID: 434","ID: 434","ID: 434","ID: 435","ID: 435","ID: 435","ID: 436","ID: 436","ID: 436","ID: 437","ID: 438","ID: 438","ID: 438","ID: 439","ID: 439","ID: 440","ID: 440","ID: 440","ID: 441","ID: 441","ID: 442","ID: 442","ID: 443","ID: 443","ID: 443","ID: 444","ID: 444","ID: 444","ID: 445","ID: 445","ID: 445","ID: 446","ID: 446","ID: 446","ID: 447","ID: 447","ID: 448","ID: 448","ID: 448","ID: 449","ID: 449","ID: 449","ID: 450","ID: 450","ID: 450","ID: 451","ID: 451","ID: 452","ID: 452","ID: 452","ID: 453","ID: 454","ID: 454","ID: 454","ID: 455","ID: 455","ID: 455","ID: 456","ID: 456","ID: 457","ID: 457","ID: 457","ID: 458","ID: 458","ID: 458","ID: 459","ID: 459","ID: 460","ID: 460","ID: 460","ID: 461","ID: 461","ID: 461","ID: 462","ID: 462","ID: 462","ID: 463","ID: 463","ID: 463","ID: 464","ID: 464","ID: 464","ID: 465","ID: 465","ID: 465","ID: 466","ID: 466","ID: 466","ID: 467","ID: 467","ID: 467","ID: 468","ID: 468","ID: 468","ID: 469","ID: 469","ID: 469","ID: 470","ID: 470","ID: 470","ID: 471","ID: 471","ID: 471","ID: 472","ID: 472","ID: 472","ID: 473","ID: 473","ID: 474","ID: 474","ID: 474","ID: 475","ID: 475","ID: 475","ID: 476","ID: 476","ID: 476","ID: 477","ID: 477","ID: 477","ID: 478","ID: 478","ID: 478","ID: 479","ID: 479","ID: 479","ID: 480","ID: 480","ID: 480","ID: 481","ID: 481","ID: 481","ID: 482","ID: 482","ID: 482","ID: 483","ID: 483","ID: 483","ID: 484","ID: 484","ID: 484","ID: 485","ID: 485","ID: 485","ID: 486","ID: 486","ID: 486","ID: 487","ID: 487","ID: 487","ID: 488","ID: 488","ID: 488","ID: 489","ID: 489","ID: 489","ID: 490","ID: 490","ID: 490","ID: 491","ID: 491","ID: 491","ID: 492","ID: 492","ID: 492","ID: 493","ID: 494","ID: 494","ID: 494","ID: 495","ID: 495","ID: 495","ID: 496","ID: 496","ID: 496","ID: 497","ID: 497","ID: 497","ID: 498","ID: 498","ID: 498","ID: 499","ID: 499","ID: 500","ID: 500","ID: 500","ID: 501","ID: 501","ID: 501","ID: 502","ID: 502","ID: 502","ID: 503","ID: 503","ID: 503","ID: 505","ID: 505","ID: 505","ID: 506","ID: 506","ID: 506","ID: 507","ID: 507","ID: 508","ID: 508","ID: 508","ID: 509","ID: 509","ID: 509","ID: 510","ID: 510","ID: 510","ID: 511","ID: 511","ID: 511","ID: 512","ID: 512","ID: 512","ID: 513","ID: 513","ID: 513","ID: 514","ID: 514","ID: 514","ID: 515","ID: 515","ID: 515","ID: 516","ID: 516","ID: 517","ID: 517","ID: 517","ID: 518","ID: 518","ID: 518","ID: 519","ID: 519","ID: 519","ID: 520","ID: 520","ID: 520","ID: 521","ID: 521","ID: 521","ID: 522","ID: 522","ID: 522","ID: 523","ID: 523","ID: 523","ID: 524","ID: 524","ID: 524","ID: 525","ID: 525","ID: 525","ID: 526","ID: 526","ID: 526","ID: 527","ID: 527","ID: 527","ID: 528","ID: 528","ID: 528","ID: 529","ID: 529","ID: 529","ID: 530","ID: 530","ID: 530","ID: 531","ID: 531","ID: 531","ID: 532","ID: 532","ID: 532","ID: 533","ID: 533","ID: 533","ID: 534","ID: 534","ID: 534","ID: 535","ID: 535","ID: 535","ID: 536","ID: 537","ID: 537","ID: 537","ID: 538","ID: 538","ID: 538","ID: 539","ID: 539","ID: 539","ID: 540","ID: 540","ID: 540","ID: 541","ID: 541","ID: 541","ID: 542","ID: 542","ID: 543","ID: 543","ID: 543","ID: 544","ID: 544","ID: 544","ID: 545","ID: 545","ID: 545","ID: 546","ID: 546","ID: 546","ID: 548","ID: 548","ID: 548","ID: 549","ID: 549","ID: 549","ID: 550","ID: 550"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify outliers</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>BMI_outlier <span class="ot">&lt;-</span> (<span class="fu">abs</span>(data_2<span class="sc">$</span>BMI <span class="sc">-</span> mean_value) <span class="sc">&gt;</span> <span class="dv">3</span><span class="sc">*</span> sd_value)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># See how many outliers we have</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data_2 <span class="sc">%&gt;%</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, BMI, BMI_outlier) <span class="sc">%&gt;%</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(BMI_outlier <span class="sc">==</span> <span class="st">"TRUE"</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(filtered_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22  3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty Print</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(filtered_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">newid</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMI</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMI_outlier</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">56</td>
<td style="text-align: right;">38.89617</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">107</td>
<td style="text-align: right;">39.58391</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">131</td>
<td style="text-align: right;">40.38171</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">131</td>
<td style="text-align: right;">39.29654</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">137</td>
<td style="text-align: right;">40.19738</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">137</td>
<td style="text-align: right;">39.25950</td>
<td style="text-align: left;">TRUE</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>We have 22 patients that had a BMI +- 3 SD from the mean. Let’s clear them from the data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter our values greater than 3SD from the mean.</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>BMI[(<span class="fu">abs</span>(data_2<span class="sc">$</span>BMI <span class="sc">-</span> mean_value) <span class="sc">&gt;</span> <span class="dv">3</span><span class="sc">*</span> sd_value)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of BMI now that we have removed outleirs</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>BMI)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot of BMI now that we have removed outliers</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>BMI)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>BMI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot outliers one more time</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> data_2, <span class="at">type =</span> <span class="st">'box'</span>) </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_boxplot</span>(<span class="at">y =</span> <span class="sc">~</span>BMI, <span class="at">name =</span> <span class="st">"Suspected Outlier"</span>, </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">boxpoints =</span> <span class="st">'suspectedoutliers'</span>,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'rgb(8,81,156)'</span>,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">outliercolor =</span> <span class="st">'rgba(219, 64, 82, 0.6)'</span>,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">line =</span> <span class="fu">list</span>(<span class="at">outliercolor =</span> <span class="st">'rgba(219, 64, 82, 1.0)'</span>,</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">outlierwidth =</span> <span class="dv">2</span>)),</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'rgb(8,81,156)'</span>),</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"ID:"</span>, newid),</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">"text"</span>)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Ignoring 157 observations</code></pre>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-967ebc822fe474cb4778" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-967ebc822fe474cb4778">{"x":{"visdat":{"3d38be14e78":["function () ","plotlyVisDat"]},"cur_data":"3d38be14e78","attrs":{"3d38be14e78":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"},"3d38be14e78.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","y":{},"name":"Suspected Outlier","boxpoints":"suspectedoutliers","marker":{"color":"rgb(8,81,156)","outliercolor":"rgba(219, 64, 82, 0.6)","line":{"outliercolor":"rgba(219, 64, 82, 1.0)","outlierwidth":2}},"line":{"color":"rgb(8,81,156)"},"text":{},"hoverinfo":"text","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":"BMI"},"xaxis":{"domain":[0,1],"automargin":true},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(31,119,180,0.5)","type":"box","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(255,127,14,0.5)","type":"box","y":[24.717559090000002,26.068007170000001,27.164209230000001,26.669360149999999,25.965761950000001,26.96036793,28.590848210000001,28.353199069999999,28.185097509999999,20.364513250000002,18.21865476,20.284854840000001,22.269860099999999,24.978654219999999,20.80192959,23.221658479999999,23.7531848,22.410008940000001,24.716879779999999,26.566404559999999,25.465513810000001,28.85804285,29.215645389999999,31.360615039999999,19.910766840000001,22.636661320000002,23.934005840000001,20.59908544,19.32619854,21.071920559999999,18.55779905,19.826809279999999,20.415883860000001,20.27133169,20.256111180000001,22.594786710000001,23.308751829999999,22.48906873,24.76099529,25.613095869999999,26.641296029999999,23.504980719999999,21.584542880000001,20.936008269999999,28.497813749999999,30.84426242,30.254312219999999,22.401980519999999,24.22315094,23.181228699999998,25.57984025,30.156051089999998,26.73805037,30.283562889999999,32.975994479999997,34.708666809999997,29.381398149999999,30.008437799999999,26.463931469999999,25.102298619999999,25.54188066,28.181149080000001,28.377350209999999,28.45378539,29.87478411,30.27654369,29.311000180000001,22.418650370000002,24.460950740000001,22.50568715,22.951714460000002,21.200573250000001,21.39584369,30.835604929999999,29.724980259999999,28.578760819999999,21.285015680000001,23.56807083,22.55871711,21.267300890000001,19.499797730000001,18.958614879999999,18.08698609,19.118829359999999,21.148610219999998,23.955868779999999,22.781145110000001,19.518361930000001,23.504366340000001,27.102646350000001,25.377539039999998,27.30225751,30.35525513,30.469110700000002,23.014031840000001,24.37753726,24.7462187,23.52290082,31.987308689999999,28.06058273,29.935707369999999,26.915740790000001,22.386996880000002,24.306872760000001,25.330425290000001,28.108278819999999,26.963438310000001,28.181134849999999,28.066689839999999,26.72919349,27.289349519999998,22.78103647,24.71993917,21.894391240000001,23.359948939999999,23.481535569999998,22.540731919999999,28.82353861,30.922300719999999,32.59591503,20.66837323,21.720828239999999,23.256337739999999,19.577684260000002,19.450085139999999,18.953457570000001,21.11509934,19.952520209999999,19.06541618,21.727143640000001,23.464785129999999,23.456379250000001,22.565496830000001,25.7980622,26.721905599999999,28.226216099999998,30.003661860000001,30.41635157,24.184745629999998,24.671943240000001,26.011017989999999,25.973183240000001,27.501665639999999,27.9083614,29.642022699999998,27.371147180000001,25.22083056,24.903933970000001,22.56627048,22.366238299999999,26.378704939999999,35.633011609999997,36.212029970000003,26.12902076,26.035766939999998,23.468264900000001,32.350382699999997,31.647466850000001,30.017366519999999,34.258444429999997,29.388870220000001,26.007725310000001,24.865273479999999,24.214417090000001,25.59975172,22.385352180000002,22.203250659999998,23.393993120000001,28.318000319999999,27.26619273,24.903623240000002,24.375597020000001,26.28658081,23.493920299999999,30.85484314,30.346417249999998,31.008418590000002,24.770034259999999,23.14444962,24.892474610000001,18.585619380000001,19.299406579999999,19.402647900000002,29.15438597,27.007671940000002,28.391921050000001,22.955177549999998,24.950296789999999,22.107853899999999,31.63990141,32.934923910000002,32.21844351,24.167772039999999,24.260476870000002,24.02500916,19.15583397,19.787030949999998,20.692581969999999,24.684720469999998,25.91671285,25.219321090000001,23.82667665,23.540040520000002,24.899810590000001,25.391190129999998,24.813419740000001,24.84642328,27.428419439999999,25.382324969999999,26.668283819999999,25.602158889999998,27.639293980000001,27.37145391,23.95181972,23.388530889999998,20.172496819999999,22.668678740000001,22.783140020000001,24.586316480000001,29.401735760000001,29.600403870000001,31.693584019999999,29.52729025,28.685514149999999,27.751094640000002,33.15458521,29.509357470000001,28.42807723,26.322058080000001,25.91510912,28.135182650000001,21.422303429999999,22.614447670000001,20.42436365,26.615772509999999,25.633075850000001,23.6386924,27.972252309999998,27.818658840000001,28.015665670000001,20.976975729999999,21.188665889999999,30.588276910000001,30.420687879999999,30.109845050000001,16.495330259999999,17.0667334,16.619948359999999,24.746385969999999,23.747405860000001,23.424574839999998,23.92077368,22.87218979,21.377864150000001,23.51005331,24.094824500000001,25.12245016,24.417306400000001,27.913991849999999,29.675282209999999,29.86535787,18.906459380000001,20.6853351,19.65325391,23.7976645,22.079425579999999,22.897307810000001,35.718392909999999,35.527666629999999,36.300846219999997,25.159155640000002,25.68450133,26.52178932,23.177619839999998,28.476647119999999,27.186752550000001,22.368732720000001,25.61164819,28.90289877,27.179001970000002,28.694763269999999,26.949758119999998,22.479034290000001,23.1933723,25.071229840000001,26.234239859999999,25.784310999999999,20.30380546,21.974944019999999,23.378991330000002,32.734807240000002,29.515070120000001,27.678780660000001,35.425191499999997,31.666224870000001,35.884919670000002,35.49820897,34.384990600000002,27.45211252,28.383498679999999,25.872811609999999,25.46359593,26.098174140000001,26.870049179999999,27.989676169999999,29.719113530000001,28.5841569,22.376534119999999,24.819856390000002,20.924082210000002,23.741357879999999,22.771832450000002,24.835836780000001,25.304319670000002,22.730463719999999,22.296991370000001,26.423977709999999,24.910562049999999,23.347858939999998,25.77774977,26.938712540000001,23.849269509999999,21.53702251,21.150352139999999,22.32810014,24.364319470000002,24.32599205,24.446395750000001,23.501720590000001,22.56586793,28.003292479999999,20.553285070000001,24.767678780000001,23.365542980000001,22.682985599999999,23.222267500000001,21.88186932,22.889965849999999,23.83790329,24.141370080000002,23.978553300000002,24.768529260000001,25.82638438,25.066123059999999,22.190055520000001,22.62789141,24.2525239,21.57987116,21.517975660000001,21.404915630000001,18.827353819999999,18.288513850000001,18.789197949999998,20.102907600000002,20.389814260000001,23.97946439,25.46709997,26.499000890000001,24.681831899999999,25.467629680000002,23.819345160000001,36.000437249999997,28.954110029999999,29.829511579999998,29.746386869999998,28.189867979999999,29.107341120000001,29.545606339999999,21.85539897,21.84436475,23.78137233,27.628655930000001,23.59116852,24.163557040000001,23.01878,25.377663250000001,20.36829577,18.36929851,20.895995880000001,27.079136290000001,27.28970417,28.125402350000002,18.360931260000001,16.86896402,18.596473079999999,19.51273759,23.00365755,20.612795779999999,26.101822819999999,29.916830780000002,29.293643629999998,23.608739289999999,21.738023930000001,21.863317439999999,27.54451151,25.21453082,25.497402560000001,20.216029689999999,18.499249500000001,18.94221654,23.14054788,23.459316560000001,23.745801579999998,19.166276910000001,20.02336738,19.39956944,33.619866780000002,36.591612300000001,33.884569229999997,20.864799730000001,22.38151925,24.538818729999999,24.788943809999999,25.674299210000001,34.228886670000001,31.5704387,33.750673149999997,23.680840069999999,24.304076460000001,22.437769759999998,24.2125348,23.715371099999999,27.25216966,25.65908357,24.16986116,35.881334979999998,32.261023989999998,29.096310379999998,38.436748039999998,28.10798986,29.710200990000001,18.976309369999999,19.52664103,19.698685179999998,21.48903344,20.20071767,22.15563229,22.954563409999999,27.89883545,24.128122659999999,22.93735174,23.440081459999998,25.06721495,30.438229,28.654609239999999,23.1152224,23.776907529999999,23.504766910000001,21.2943742,19.614767130000001,20.002687399999999,20.183669550000001,25.542304250000001,26.607176620000001,28.602498149999999,28.500984750000001,25.26692727,27.590397939999999,32.501798780000001,31.052325159999999,31.74351291,21.709719239999998,21.21300291,20.873034270000002,25.440435050000001,23.114422569999999,24.31805997,17.66341311,21.142975280000002,18.858083799999999,20.49546467,20.650046969999998,25.843179240000001,27.636316189999999,26.28639768,29.38705517,29.085023209999999,29.38705517,18.317541949999999,18.865168310000001,19.181078150000001,24.421936599999999,24.53771674,24.485146879999999,37.58512107,24.924668499999999,27.113233569999998,26.888035439999999,23.424832859999999,23.183929190000001,22.253934569999998,25.55884588,25.374069899999999,26.17359553,18.88270687,18.88798491,20.233415040000001,23.064244819999999,23.11917863,23.74721143,22.805985329999999,24.09593465,24.14268057,29.502773399999999,29.502773399999999,21.206956529999999,20.559254249999999,18.327492700000001,20.739823810000001,20.550337379999998,21.157218440000001,23.34598785,25.44316808,25.047169199999999,28.33548351,27.003245759999999,35.754747459999997,33.989384739999998,26.018265,27.106558790000001,24.81098798,28.19027415,28.41959241,28.19027415,24.312538480000001,25.611009060000001,27.197309449999999,26.72543366,25.741141769999999,27.709725550000002,21.661210820000001,22.678738299999999,24.412190129999999,21.896288139999999,23.12313674,26.692981939999999,24.69690104,23.193034730000001,24.175072149999998,25.944721229999999,27.381612390000001,28.165168600000001,29.250181040000001,24.427214580000001,23.785999,24.32759472,24.962382009999999,25.683561009999998,32.074330240000002,31.3209053,32.074330240000002,25.571236240000001,27.2418324,25.04404027,28.32349769,28.871802649999999,31.296382220000002,30.922688969999999,31.40387913,31.978496100000001,25.938923939999999,28.136185650000002,28.901622570000001,29.020276540000001,28.630310659999999,20.75599528,19.1475191,20.645741350000002,18.926016919999999,24.384561309999999,24.55336964,23.051326759999998,23.354173939999999,26.399402340000002,24.254963660000001,23.161855129999999,25.18514832,28.891431440000002,28.19808579,27.332306410000001,23.651867330000002,22.867386339999999,22.476748740000001,27.695788960000002,26.479366500000001,29.88601907,26.013721749999998,25.503957759999999,26.455503790000002,22.143399469999999,22.971713560000001,24.748775510000002,25.152331199999999,27.287337870000002,24.896017539999999,20.697462120000001,22.718942299999998,25.861429650000002,24.30096262,25.400777250000001,27.815503960000001,27.821332479999999,25.604923580000001,25.417586289999999,26.10730478,24.729985509999999,29.3841401,22.3928242,23.316881510000002,21.508503470000001,23.84878776,27.37593644,24.31868828,25.85164786,19.767741579999999,18.480036550000001,20.673307579999999,26.93885028,28.032992790000002,26.72144887,23.231233140000001,21.819648529999998,20.08660394,22.175179450000002,21.90071056,21.107229100000001,19.063013089999998,21.48023542,19.855748470000002,25.05480785,22.520836809999999,21.62981671,28.271421310000001,32.37633391,26.329561569999999,26.32620528,24.299471199999999,25.99291873,37.37963439,37.841532260000001,23.529012120000001,23.824079309999998,26.239269449999998,35.288523499999997,35.288523499999997,21.44542332,21.040167650000001,20.882029800000002,22.584806390000001,21.932294370000001,24.06146944,18.144981059999999,20.321569109999999,17.94502997,21.636299770000001,23.827093959999999,24.6179348,30.113155299999999,28.429845629999999,29.048382889999999,23.6590749,23.63758782,23.3634697,25.331188900000001,26.663177359999999,26.206508719999999,30.60311183,29.787178300000001,27.83824139,21.80724292,20.453286930000001,22.522521009999998,23.153856650000002,26.12614379,24.128356790000002,24.83487379,23.259946469999999,25.111924940000002,24.010516970000001,21.359737559999999,20.02774432,20.503381059999999,18.698168949999999,22.616527479999998,22.935029929999999,19.006117010000001,15.94907484,18.02263512,22.257975940000001,22.328905240000001,24.48765083,28.106526479999999,28.656547010000001,30.79641384,22.083940040000002,24.69868898,29.629378760000002,28.578618809999998,27.673526939999999,24.29341715,26.996081019999998,32.099340959999999,31.948960639999999,23.777730160000001,25.264893140000002,23.60131479,23.101673510000001,22.784969149999998,23.490415760000001,20.987880990000001,19.464248749999999,22.495888669999999,23.580403969999999,24.883977009999999,25.771362679999999,31.06014858,29.813119820000001,30.176592240000002,30.568793880000001,28.252277750000001,29.08070674,28.850301989999998,32.088269310000001,30.35171171,38.708937329999998,38.65914051,22.7304256,23.256565609999999,22.82679255,27.366505709999998,25.50323874,25.355387050000001,21.860692319999998,20.268976429999999,20.873141,22.05304516,25.08566604,20.876499809999999,32.139172549999998,35.790648709999999,34.15591156,26.25423631,27.799214880000001,31.457470839999999,22.06320565,24.199662979999999,22.872823780000001,17.5358944,20.566207080000002,19.151604450000001,18.540265260000002,21.186077569999998,20.955266940000001,26.95299322,27.779301570000001,28.56723487,26.577966790000001,25.04440237,26.82623641,24.27905878,25.151989369999999,22.38089956,23.549151649999999,22.06285248,22.01090348,19.366132,18.398364619999999,20.389480989999999,25.961633339999999,25.981966669999998,23.7266333,27.609486489999998,24.255219019999998,22.770672480000002,22.702351289999999,22.293356030000002,25.656998529999999,23.593854310000001,23.875657919999998,27.005851830000001,25.10731367,28.458327780000001,25.368978510000002,25.495911719999999,25.910782449999999,29.010765469999999,28.736608059999998,28.23865567,24.60383289,25.488207639999999,27.206491119999999,24.675577789999998,26.531419060000001,25.701171670000001,24.32571536,25.240448000000001,24.747311839999998,24.510091070000001,24.151189370000001,23.950396959999999,29.209103930000001,29.132142510000001,31.704598019999999,26.1744865,27.278867470000002,29.480145350000001,24.119457520000001,25.481513889999999,30.255786000000001,30.699956820000001,32.655850700000002,23.600735190000002,24.107877899999998,22.085442319999999,20.915759730000001,22.57218482,23.448024319999998,23.5157256,23.295827160000002,22.726337099999999,25.254019280000001,25.294528140000001,21.493263809999998,23.314773899999999,22.81934695,23.01104604,27.573215340000001,28.760944080000002,21.955160549999999,22.17556961,22.410757709999999,21.687873799999998,24.07525364,30.607054219999998,21.05077563,19.294522130000001,21.62271599,18.22014879,18.029481029999999,24.146964759999999,23.940637120000002,25.475213190000002,25.613063390000001,24.926773109999999,23.564487889999999,25.278978859999999,24.992472859999999,20.865166259999999,21.60955418,20.716405259999998,18.591857319999999,18.928563520000001,29.319174960000002,24.807577930000001,21.090858040000001,20.818395850000002,21.91438394,20.103351230000001,24.380039570000001,22.7422951,18.878678359999999,19.659485979999999,28.584526260000001,29.939706439999998,32.283624490000001,29.735504169999999,29.064541380000001,29.735504169999999,28.525134300000001,28.04373163,23.77064566,24.432476510000001,27.77368427,28.869405610000001,24.912210949999999,26.87415373,25.709265729999998,24.531048779999999,21.65341643,27.061114920000001,23.679102220000001,23.919217419999999,22.072833209999999,20.439266660000001,21.869848149999999,24.664115689999999,20.79840497,19.220589650000001,21.255468990000001,21.356106499999999,22.587458789999999,21.028535160000001,21.648354019999999,23.247360069999999,24.66647511,24.07756277,20.07202448,19.673430410000002,18.511406099999999,21.717914159999999,21.597789760000001,20.765744999999999,20.768997089999999,23.01872358,18.56434539,23.782962250000001,19.965016989999999,20.351268019999999,19.811362540000001,22.860948759999999,21.294469119999999,22.860948759999999,27.941899379999999,30.3420679,29.918857339999999,23.790497240000001,26.442588220000001,23.637177659999999,29.3673979,29.70070737,29.121750630000001,26.393652230000001,32.606241939999997,31.252870120000001,33.959613750000003,20.750302510000001,23.407617219999999,21.761456379999998,19.50064695,21.304978290000001,21.795932860000001,24.760699729999999,23.565760959999999,25.724166660000002,22.928629690000001,24.48358245,20.971262169999999,20.733163009999998,33.400870130000001,31.63275668,29.466506949999999,21.584317129999999,23.243305320000001,21.998138690000001,24.166634420000001,25.781771469999999,27.039518739999998,28.467045450000001,26.578025069999999,28.382234960000002,34.878982399999998,33.864955790000003,36.008928109999999,34.533793629999998,33.856570490000003,34.757396759999999,24.048613799999998,21.648165030000001,20.85032726,26.391898130000001,25.76438795,27.019408309999999,23.791304700000001,23.459842269999999,25.572517340000001,22.800627039999998,25.38648178,22.102134960000001,27.30905534,28.013796379999999,31.878135440000001,24.44143042,23.82735628,25.055504549999998,31.464218150000001,31.360903449999999,28.503899629999999,25.445743539999999,23.183769569999999,22.982724180000002,23.506895180000001,23.542340530000001,25.003499479999999,25.946452730000001,25.977290530000001,25.784470979999998,25.861988010000001,27.92746348,29.608350739999999,31.160497889999998,27.689511209999999,29.196989500000001,30.185006269999999,26.95672034,22.727318830000002,25.514026950000002,24.796680120000001,22.564686399999999,24.351231840000001,23.39881244,25.957091070000001,26.149067420000002,23.323803999999999,24.391663829999999,23.478271159999998,24.44466894,16.366321989999999,32.523015880000003,35.371992159999998,26.7731843,28.207953839999998,27.671342129999999,29.538457040000001,30.28645684,32.082203110000002,28.673896039999999,29.094728190000001,27.502052620000001,28.52450554,28.07357077,27.649975749999999,20.15646916,22.260416490000001,18.239467099999999,17.758410510000001,17.95834207,29.833288849999999,28.603214680000001,30.215630569999998,22.56970944,24.322259119999998,22.65785975,32.41562948,28.589886910000001,26.93869492,26.093696919999999,26.092110309999999,22.02286217,22.19820782,20.436256780000001,26.394836130000002,28.774412120000001,28.261627470000001,28.70382437,35.04680226,33.928673789999998,23.87602562,23.41189572,28.316153310000001,22.850318810000001,21.738570599999999,23.30899234,28.290771800000002,22.247427999999999,24.662541269999998,23.247128109999998,26.322309480000001,27.234702739999999,28.632445659999998,26.80377975,24.24959922,27.726961360000001,26.112321260000002,26.8880357,22.931203379999999,22.495853189999998,20.80855523,28.603695420000001,31.533488640000002,28.270813189999998,28.316859860000001,30.47626679,29.696747120000001,30.378196089999999,28.34689324,28.862263110000001,22.56134312,20.420141959999999,21.04230531,19.988988030000002,21.252786100000002,24.90941192,23.678798969999999,26.226697779999999,22.18449055,24.038901410000001,23.604037250000001,34.651193370000001,34.733368939999998,34.343536780000001,28.576911389999999,27.735705549999999,28.741666200000001,26.467038670000001,31.256653660000001,29.019177729999999,24.687434669999998,29.692884660000001,27.00498988,30.311987949999999,33.073093239999999,30.626971380000001,22.720186429999998,23.038301730000001,26.74667346,27.917959570000001,29.455783409999999,31.401961549999999,33.633683349999998,38.576914299999999,24.521657099999999,23.370875300000002,24.74718944,36.704505920000003,32.498174710000001,31.96077184,30.442800999999999,32.929988710000003,34.430239159999999,20.730598789999998,22.525250079999999,19.553201730000001,18.310177249999999,27.747408740000001,26.312602550000001,27.274660220000001,31.056626349999998,26.222232000000002,26.786038229999999,27.141461499999998,29.582344379999999,25.380783170000001,26.291979940000001,26.819827220000001,26.03265918,24.452930349999999,26.284502010000001,24.903707449999999,25.173596450000002,25.85010033,24.381684180000001,24.75901897,25.262330370000001,27.384002120000002,23.264673599999998,22.479914529999999,20.879528749999999,21.66760013,23.416114159999999,23.22717608,24.6655564,22.35557262,26.760907159999999,25.09261338,28.413690240000001,26.00852587,29.221360170000001,31.06518505,20.11871958,19.045308179999999,16.847810979999998,25.526639459999998,23.77700639,28.178917559999999,28.30800481,28.801479180000001,20.03680683,19.88013162,26.789730479999999,28.526472850000001,29.940390059999999,24.64588711,24.75293293,28.116523000000001,23.04176554,23.181656830000001,23.432168860000001,22.70943166,23.841583589999999,23.948845460000001,23.657500939999998,29.828728819999998,31.39361989,27.543554969999999,27.164527329999999,27.63697221,25.763874739999999,27.74355014,26.46121303,23.299700949999998,21.760003609999998,21.390541330000001,23.102113159999998,18.39350091,22.268582179999999,22.592812030000001,24.133419079999999,23.932365130000001,24.364654560000002,24.288729719999999,26.389607030000001,22.187852400000001,20.575271369999999,21.96744009,21.26847866,22.134421360000001,22.26423475,28.4865362,29.452899330000001,30.65961879,18.543541529999999,20.937744070000001,21.191987090000001,23.588651370000001,24.843620510000001,24.336254950000001,24.9376593,25.067699780000002,23.626988189999999,24.883594599999999,23.7301267,25.69833642,22.434163739999999,22.635390260000001,21.052107939999999,27.22044022,25.846071599999998,23.935652999999999,29.005674859999999,29.509551760000001,28.325923589999999,28.940355589999999,30.78327831,27.479161130000001,22.13490135,25.342751660000001,27.036359879999999,25.898269379999999,26.45697354,28.12203702,30.188128649999999,30.610425759999998,31.3616119,33.43448764,24.229554629999999,24.788238969999998,25.314142579999999,26.948374319999999,28.031669409999999,26.7615941,24.796221259999999,25.56051905,27.232039650000001,22.4237857,24.584978960000001,25.381169889999999,30.449913639999998,30.61119991,29.911266090000002,18.425217799999999,18.97253817,19.260829640000001,25.706616400000001,24.586174079999999,25.175172490000001,21.830709649999999,18.209215950000001,19.657764790000002,24.519326289999999,25.526173799999999,29.354122960000002,29.547889489999999,28.884145199999999,29.01351798,25.850744089999999,25.174633650000001,26.322668060000002,25.686250879999999,25.774212869999999,17.0602828,19.46671186,21.452605680000001,27.857611219999999,26.629820039999998,27.857611219999999,37.537376870000003,34.355807040000002,27.578887160000001,27.110761279999998,27.578887160000001,28.372641260000002,27.838751810000002,28.906530700000001,29.483446260000001,29.10615014,29.372840249999999,26.435850760000001,27.868207229999999,28.763140270000001,23.978494080000001,24.932081740000001,24.588035390000002,23.400251860000001,24.560352730000002,22.903762830000002,17.952500879999999,19.381637319999999,19.956317739999999,18.55379739,18.33992391,18.895671020000002,23.214242729999999,21.675734479999999,21.096404920000001,31.150669820000001,29.791920050000002,29.58180819,20.33425424,23.317944300000001,22.885996200000001,20.662133870000002,20.240377200000001,19.772580550000001,20.68446355,19.823708960000001,19.10813443,23.28507974,25.958569929999999,25.102161120000002,19.524795430000001,20.230946020000001,19.713582639999998,17.995331010000001,19.749027099999999,21.5499826,26.308922809999999,20.61568634,22.190753780000001,23.245990720000002,23.53074544,23.740623710000001,19.322613270000002,23.279980720000001,27.536451240000002,25.287735940000001,21.410228350000001,22.461987700000002,25.253052629999999,33.088671269999999,28.474010960000001,31.93928974,33.802083949999997,31.604124070000001,28.054505200000001,30.473183670000001,29.888568759999998,23.410022550000001,24.40896489,24.345156769999999,23.642534900000001,31.310359500000001,27.9725462,22.441401800000001,23.596945250000001,25.101135150000001,24.654127259999999,25.58524177,23.823244949999999,28.585655429999999,27.299402539999999,25.069295960000002,30.183401199999999,27.718148840000001,23.23885881,24.355455970000001,27.239584780000001,28.727655219999999,29.262002930000001,29.609109449999998,19.629540739999999,19.677233699999999,19.619866009999999,25.02714667,24.648494970000002,26.327312549999998,20.16700359,19.767558650000002,19.915583380000001,21.399781149999999,27.511948709999999,28.435846359999999,29.666484029999999,30.40278047,27.987792809999998,22.47205207,24.683982589999999,25.073255400000001,26.105693720000001,25.005808729999998,18.003075760000002,20.860196389999999,19.414562889999999,28.497372980000002,29.008303900000001,28.497372980000002,35.655543280000003,34.81387075,27.133126189999999,27.281756489999999,27.133126189999999,27.733990200000001,27.06025704,28.407723350000001,28.016243790000001,26.86154505,26.523814479999999,26.97149478,27.635613039999999,28.396767010000001,24.903493260000001,24.92811627,27.387685449999999,23.993612339999999,23.95648654,22.197851870000001,19.298459050000002,20.116732320000001,19.5495792,19.653060450000002,18.19027457,19.93956244,23.154604890000002,23.106570860000001,22.755238309999999,29.368567680000002,30.748816789999999,32.057511550000001,20.963422250000001,21.64005075,22.612826009999999,24.002792400000001,20.810362959999999,21.886886879999999,19.721216760000001,19.719986800000001,19.090179169999999,25.082012110000001,24.610885629999999,26.241797680000001,20.03681036,19.666383769999999,21.046377939999999,21.17168895,20.44604571,19.475384380000001,27.172571309999999,18.387116599999999,22.48533437,23.793579390000001,22.127219199999999,23.985034150000001,23.060669829999998,23.244155660000001,25.85973443,26.236176199999999,20.273890909999999,22.112185369999999,24.380521259999998,30.079349180000001,29.09963218,29.091952280000001,31.28557421,30.44565201,28.001075740000001,30.384441249999998,30.558438540000001,23.36116453,24.997435670000002,24.7982166,25.427770779999999,28.11637953,27.628386119999998,24.25708435,25.47150633,25.906237539999999,22.878951170000001,25.006592680000001,24.525288450000001,24.173621820000001,24.745953780000001,25.843964840000002,29.039068159999999,28.259226170000002],"name":"Suspected Outlier","boxpoints":"suspectedoutliers","marker":{"color":"rgb(8,81,156)","outliercolor":"rgba(219, 64, 82, 0.6)","line":{"color":"rgba(255,127,14,1)","outliercolor":"rgba(219, 64, 82, 1.0)","outlierwidth":2}},"line":{"color":"rgb(8,81,156)"},"text":["ID: 1","ID: 1","ID: 1","ID: 2","ID: 2","ID: 2","ID: 3","ID: 3","ID: 3","ID: 4","ID: 4","ID: 4","ID: 5","ID: 5","ID: 5","ID: 6","ID: 6","ID: 6","ID: 7","ID: 7","ID: 7","ID: 8","ID: 8","ID: 8","ID: 9","ID: 9","ID: 9","ID: 10","ID: 10","ID: 10","ID: 11","ID: 11","ID: 12","ID: 12","ID: 12","ID: 13","ID: 13","ID: 13","ID: 14","ID: 14","ID: 14","ID: 15","ID: 15","ID: 15","ID: 16","ID: 16","ID: 16","ID: 17","ID: 17","ID: 17","ID: 18","ID: 18","ID: 18","ID: 19","ID: 19","ID: 19","ID: 21","ID: 21","ID: 22","ID: 22","ID: 22","ID: 23","ID: 23","ID: 23","ID: 24","ID: 24","ID: 24","ID: 25","ID: 25","ID: 25","ID: 26","ID: 26","ID: 26","ID: 27","ID: 27","ID: 27","ID: 28","ID: 28","ID: 28","ID: 29","ID: 29","ID: 29","ID: 30","ID: 30","ID: 30","ID: 31","ID: 31","ID: 31","ID: 32","ID: 32","ID: 32","ID: 33","ID: 33","ID: 33","ID: 34","ID: 34","ID: 34","ID: 35","ID: 35","ID: 35","ID: 37","ID: 37","ID: 38","ID: 38","ID: 38","ID: 39","ID: 39","ID: 39","ID: 40","ID: 40","ID: 40","ID: 41","ID: 41","ID: 41","ID: 42","ID: 42","ID: 42","ID: 43","ID: 43","ID: 43","ID: 44","ID: 44","ID: 44","ID: 45","ID: 45","ID: 45","ID: 46","ID: 46","ID: 46","ID: 47","ID: 47","ID: 47","ID: 48","ID: 48","ID: 48","ID: 49","ID: 49","ID: 49","ID: 50","ID: 50","ID: 50","ID: 51","ID: 51","ID: 51","ID: 53","ID: 53","ID: 54","ID: 54","ID: 55","ID: 55","ID: 55","ID: 56","ID: 56","ID: 57","ID: 57","ID: 57","ID: 58","ID: 58","ID: 58","ID: 59","ID: 59","ID: 59","ID: 60","ID: 60","ID: 60","ID: 61","ID: 61","ID: 61","ID: 62","ID: 62","ID: 62","ID: 63","ID: 63","ID: 63","ID: 64","ID: 64","ID: 64","ID: 65","ID: 65","ID: 65","ID: 66","ID: 66","ID: 66","ID: 67","ID: 67","ID: 67","ID: 68","ID: 68","ID: 68","ID: 69","ID: 69","ID: 69","ID: 70","ID: 70","ID: 70","ID: 71","ID: 71","ID: 71","ID: 72","ID: 72","ID: 72","ID: 73","ID: 73","ID: 73","ID: 74","ID: 74","ID: 74","ID: 75","ID: 75","ID: 75","ID: 76","ID: 76","ID: 76","ID: 77","ID: 77","ID: 77","ID: 78","ID: 78","ID: 78","ID: 79","ID: 79","ID: 79","ID: 80","ID: 80","ID: 80","ID: 81","ID: 81","ID: 81","ID: 82","ID: 82","ID: 82","ID: 83","ID: 83","ID: 83","ID: 84","ID: 84","ID: 84","ID: 85","ID: 85","ID: 85","ID: 86","ID: 86","ID: 87","ID: 87","ID: 87","ID: 88","ID: 88","ID: 88","ID: 89","ID: 89","ID: 90","ID: 90","ID: 91","ID: 91","ID: 91","ID: 92","ID: 92","ID: 92","ID: 93","ID: 93","ID: 93","ID: 94","ID: 94","ID: 94","ID: 95","ID: 95","ID: 95","ID: 96","ID: 96","ID: 96","ID: 97","ID: 97","ID: 97","ID: 99","ID: 99","ID: 99","ID: 100","ID: 100","ID: 100","ID: 101","ID: 101","ID: 101","ID: 102","ID: 102","ID: 103","ID: 103","ID: 103","ID: 104","ID: 104","ID: 104","ID: 105","ID: 105","ID: 105","ID: 106","ID: 106","ID: 106","ID: 107","ID: 107","ID: 108","ID: 108","ID: 108","ID: 109","ID: 109","ID: 109","ID: 110","ID: 110","ID: 110","ID: 111","ID: 111","ID: 111","ID: 112","ID: 112","ID: 112","ID: 113","ID: 113","ID: 113","ID: 114","ID: 114","ID: 114","ID: 115","ID: 115","ID: 116","ID: 117","ID: 117","ID: 117","ID: 118","ID: 118","ID: 119","ID: 119","ID: 119","ID: 120","ID: 120","ID: 120","ID: 121","ID: 121","ID: 121","ID: 122","ID: 122","ID: 122","ID: 123","ID: 123","ID: 123","ID: 124","ID: 124","ID: 125","ID: 125","ID: 125","ID: 126","ID: 126","ID: 126","ID: 127","ID: 127","ID: 127","ID: 128","ID: 128","ID: 129","ID: 129","ID: 129","ID: 130","ID: 130","ID: 130","ID: 131","ID: 132","ID: 132","ID: 132","ID: 133","ID: 133","ID: 133","ID: 134","ID: 134","ID: 134","ID: 135","ID: 136","ID: 136","ID: 136","ID: 138","ID: 139","ID: 139","ID: 139","ID: 140","ID: 140","ID: 140","ID: 141","ID: 141","ID: 141","ID: 142","ID: 142","ID: 142","ID: 143","ID: 143","ID: 143","ID: 144","ID: 144","ID: 144","ID: 146","ID: 146","ID: 146","ID: 147","ID: 147","ID: 147","ID: 148","ID: 148","ID: 148","ID: 149","ID: 149","ID: 149","ID: 150","ID: 150","ID: 150","ID: 151","ID: 151","ID: 152","ID: 152","ID: 152","ID: 153","ID: 153","ID: 153","ID: 154","ID: 154","ID: 154","ID: 155","ID: 155","ID: 155","ID: 156","ID: 156","ID: 157","ID: 157","ID: 157","ID: 158","ID: 159","ID: 159","ID: 160","ID: 160","ID: 160","ID: 161","ID: 161","ID: 161","ID: 162","ID: 162","ID: 162","ID: 163","ID: 163","ID: 163","ID: 164","ID: 164","ID: 164","ID: 165","ID: 165","ID: 165","ID: 166","ID: 166","ID: 166","ID: 167","ID: 167","ID: 167","ID: 168","ID: 168","ID: 168","ID: 169","ID: 169","ID: 169","ID: 170","ID: 170","ID: 170","ID: 171","ID: 171","ID: 171","ID: 172","ID: 172","ID: 173","ID: 173","ID: 173","ID: 174","ID: 174","ID: 174","ID: 175","ID: 175","ID: 175","ID: 176","ID: 176","ID: 176","ID: 177","ID: 177","ID: 177","ID: 178","ID: 179","ID: 179","ID: 179","ID: 180","ID: 180","ID: 180","ID: 181","ID: 181","ID: 181","ID: 182","ID: 182","ID: 182","ID: 183","ID: 183","ID: 183","ID: 184","ID: 184","ID: 184","ID: 185","ID: 185","ID: 186","ID: 186","ID: 186","ID: 187","ID: 187","ID: 187","ID: 188","ID: 188","ID: 188","ID: 189","ID: 189","ID: 190","ID: 190","ID: 191","ID: 191","ID: 191","ID: 192","ID: 192","ID: 192","ID: 193","ID: 193","ID: 193","ID: 194","ID: 194","ID: 194","ID: 195","ID: 195","ID: 195","ID: 196","ID: 196","ID: 196","ID: 197","ID: 197","ID: 197","ID: 198","ID: 198","ID: 198","ID: 199","ID: 199","ID: 199","ID: 200","ID: 200","ID: 200","ID: 201","ID: 201","ID: 201","ID: 202","ID: 202","ID: 202","ID: 203","ID: 203","ID: 203","ID: 204","ID: 204","ID: 204","ID: 205","ID: 205","ID: 205","ID: 207","ID: 207","ID: 208","ID: 208","ID: 209","ID: 209","ID: 210","ID: 210","ID: 210","ID: 211","ID: 211","ID: 212","ID: 212","ID: 212","ID: 213","ID: 213","ID: 213","ID: 214","ID: 214","ID: 214","ID: 215","ID: 215","ID: 215","ID: 216","ID: 216","ID: 216","ID: 217","ID: 217","ID: 217","ID: 218","ID: 218","ID: 218","ID: 219","ID: 220","ID: 220","ID: 220","ID: 221","ID: 221","ID: 221","ID: 222","ID: 222","ID: 222","ID: 223","ID: 223","ID: 224","ID: 224","ID: 224","ID: 225","ID: 225","ID: 225","ID: 226","ID: 227","ID: 227","ID: 227","ID: 228","ID: 228","ID: 228","ID: 229","ID: 229","ID: 229","ID: 230","ID: 230","ID: 230","ID: 231","ID: 231","ID: 231","ID: 232","ID: 232","ID: 232","ID: 233","ID: 233","ID: 233","ID: 234","ID: 234","ID: 234","ID: 235","ID: 235","ID: 236","ID: 236","ID: 236","ID: 237","ID: 237","ID: 238","ID: 238","ID: 238","ID: 239","ID: 239","ID: 239","ID: 240","ID: 240","ID: 240","ID: 241","ID: 241","ID: 241","ID: 242","ID: 242","ID: 242","ID: 243","ID: 243","ID: 243","ID: 244","ID: 244","ID: 244","ID: 245","ID: 245","ID: 245","ID: 246","ID: 246","ID: 246","ID: 247","ID: 247","ID: 247","ID: 248","ID: 248","ID: 249","ID: 249","ID: 249","ID: 250","ID: 250","ID: 250","ID: 251","ID: 251","ID: 252","ID: 252","ID: 252","ID: 253","ID: 253","ID: 253","ID: 255","ID: 255","ID: 255","ID: 256","ID: 257","ID: 258","ID: 259","ID: 259","ID: 259","ID: 260","ID: 260","ID: 260","ID: 261","ID: 261","ID: 261","ID: 262","ID: 262","ID: 262","ID: 263","ID: 263","ID: 263","ID: 264","ID: 264","ID: 264","ID: 265","ID: 265","ID: 265","ID: 266","ID: 266","ID: 266","ID: 267","ID: 267","ID: 267","ID: 268","ID: 268","ID: 269","ID: 269","ID: 269","ID: 270","ID: 270","ID: 270","ID: 271","ID: 271","ID: 271","ID: 272","ID: 272","ID: 272","ID: 273","ID: 273","ID: 273","ID: 274","ID: 274","ID: 274","ID: 275","ID: 275","ID: 275","ID: 276","ID: 276","ID: 276","ID: 277","ID: 277","ID: 277","ID: 278","ID: 278","ID: 278","ID: 279","ID: 279","ID: 279","ID: 280","ID: 280","ID: 280","ID: 281","ID: 281","ID: 281","ID: 282","ID: 282","ID: 282","ID: 283","ID: 283","ID: 284","ID: 284","ID: 284","ID: 285","ID: 285","ID: 285","ID: 286","ID: 286","ID: 286","ID: 287","ID: 287","ID: 287","ID: 288","ID: 288","ID: 288","ID: 289","ID: 289","ID: 289","ID: 290","ID: 290","ID: 290","ID: 291","ID: 291","ID: 291","ID: 292","ID: 292","ID: 292","ID: 293","ID: 293","ID: 293","ID: 294","ID: 294","ID: 294","ID: 295","ID: 295","ID: 296","ID: 296","ID: 296","ID: 297","ID: 297","ID: 297","ID: 298","ID: 298","ID: 298","ID: 299","ID: 299","ID: 299","ID: 300","ID: 300","ID: 300","ID: 301","ID: 301","ID: 301","ID: 302","ID: 302","ID: 302","ID: 303","ID: 303","ID: 304","ID: 305","ID: 305","ID: 305","ID: 306","ID: 307","ID: 308","ID: 308","ID: 308","ID: 309","ID: 309","ID: 310","ID: 310","ID: 311","ID: 311","ID: 311","ID: 313","ID: 313","ID: 313","ID: 314","ID: 314","ID: 314","ID: 315","ID: 315","ID: 316","ID: 316","ID: 317","ID: 317","ID: 317","ID: 318","ID: 318","ID: 318","ID: 319","ID: 319","ID: 320","ID: 320","ID: 320","ID: 321","ID: 321","ID: 321","ID: 322","ID: 322","ID: 322","ID: 323","ID: 323","ID: 323","ID: 324","ID: 324","ID: 324","ID: 325","ID: 326","ID: 326","ID: 326","ID: 327","ID: 327","ID: 327","ID: 328","ID: 328","ID: 328","ID: 329","ID: 329","ID: 329","ID: 330","ID: 330","ID: 330","ID: 331","ID: 331","ID: 331","ID: 332","ID: 332","ID: 332","ID: 333","ID: 334","ID: 334","ID: 334","ID: 336","ID: 336","ID: 336","ID: 337","ID: 337","ID: 337","ID: 338","ID: 338","ID: 338","ID: 339","ID: 339","ID: 339","ID: 340","ID: 340","ID: 340","ID: 341","ID: 341","ID: 341","ID: 342","ID: 343","ID: 343","ID: 343","ID: 344","ID: 344","ID: 344","ID: 345","ID: 345","ID: 345","ID: 346","ID: 346","ID: 346","ID: 347","ID: 348","ID: 348","ID: 348","ID: 350","ID: 350","ID: 350","ID: 351","ID: 351","ID: 351","ID: 352","ID: 352","ID: 352","ID: 353","ID: 353","ID: 353","ID: 354","ID: 354","ID: 354","ID: 355","ID: 355","ID: 355","ID: 356","ID: 356","ID: 356","ID: 357","ID: 357","ID: 357","ID: 358","ID: 358","ID: 358","ID: 359","ID: 359","ID: 359","ID: 360","ID: 360","ID: 360","ID: 361","ID: 361","ID: 361","ID: 362","ID: 362","ID: 362","ID: 363","ID: 364","ID: 364","ID: 364","ID: 365","ID: 365","ID: 365","ID: 366","ID: 366","ID: 366","ID: 367","ID: 367","ID: 367","ID: 368","ID: 368","ID: 368","ID: 369","ID: 369","ID: 369","ID: 370","ID: 370","ID: 370","ID: 371","ID: 371","ID: 371","ID: 372","ID: 372","ID: 372","ID: 373","ID: 373","ID: 373","ID: 374","ID: 375","ID: 375","ID: 375","ID: 376","ID: 376","ID: 376","ID: 377","ID: 377","ID: 377","ID: 378","ID: 378","ID: 378","ID: 379","ID: 379","ID: 380","ID: 380","ID: 380","ID: 381","ID: 381","ID: 381","ID: 382","ID: 382","ID: 382","ID: 383","ID: 383","ID: 384","ID: 384","ID: 384","ID: 385","ID: 385","ID: 385","ID: 386","ID: 386","ID: 386","ID: 387","ID: 387","ID: 387","ID: 388","ID: 388","ID: 388","ID: 389","ID: 389","ID: 389","ID: 390","ID: 391","ID: 391","ID: 391","ID: 392","ID: 392","ID: 392","ID: 393","ID: 393","ID: 394","ID: 394","ID: 394","ID: 395","ID: 395","ID: 395","ID: 396","ID: 396","ID: 396","ID: 397","ID: 397","ID: 397","ID: 398","ID: 398","ID: 398","ID: 399","ID: 399","ID: 400","ID: 400","ID: 400","ID: 401","ID: 401","ID: 401","ID: 402","ID: 402","ID: 402","ID: 403","ID: 403","ID: 403","ID: 404","ID: 404","ID: 404","ID: 405","ID: 405","ID: 405","ID: 406","ID: 406","ID: 406","ID: 407","ID: 407","ID: 407","ID: 408","ID: 408","ID: 408","ID: 409","ID: 409","ID: 409","ID: 410","ID: 410","ID: 411","ID: 411","ID: 411","ID: 412","ID: 412","ID: 412","ID: 413","ID: 413","ID: 413","ID: 414","ID: 414","ID: 415","ID: 415","ID: 416","ID: 416","ID: 417","ID: 417","ID: 417","ID: 418","ID: 418","ID: 418","ID: 419","ID: 419","ID: 419","ID: 420","ID: 420","ID: 420","ID: 421","ID: 421","ID: 421","ID: 422","ID: 422","ID: 422","ID: 423","ID: 423","ID: 423","ID: 424","ID: 424","ID: 424","ID: 426","ID: 426","ID: 426","ID: 427","ID: 427","ID: 427","ID: 428","ID: 428","ID: 428","ID: 429","ID: 429","ID: 429","ID: 430","ID: 430","ID: 431","ID: 431","ID: 431","ID: 432","ID: 432","ID: 433","ID: 433","ID: 433","ID: 434","ID: 434","ID: 434","ID: 435","ID: 435","ID: 435","ID: 436","ID: 436","ID: 436","ID: 437","ID: 438","ID: 438","ID: 438","ID: 439","ID: 439","ID: 440","ID: 440","ID: 440","ID: 441","ID: 441","ID: 442","ID: 442","ID: 443","ID: 443","ID: 443","ID: 444","ID: 444","ID: 444","ID: 445","ID: 445","ID: 445","ID: 446","ID: 446","ID: 446","ID: 447","ID: 447","ID: 448","ID: 448","ID: 448","ID: 449","ID: 449","ID: 449","ID: 450","ID: 450","ID: 450","ID: 451","ID: 451","ID: 452","ID: 452","ID: 452","ID: 453","ID: 454","ID: 454","ID: 454","ID: 455","ID: 455","ID: 455","ID: 456","ID: 456","ID: 457","ID: 457","ID: 457","ID: 458","ID: 458","ID: 458","ID: 459","ID: 459","ID: 460","ID: 460","ID: 460","ID: 461","ID: 461","ID: 461","ID: 462","ID: 462","ID: 462","ID: 463","ID: 463","ID: 463","ID: 464","ID: 464","ID: 464","ID: 465","ID: 465","ID: 465","ID: 466","ID: 466","ID: 466","ID: 467","ID: 467","ID: 467","ID: 468","ID: 468","ID: 468","ID: 469","ID: 469","ID: 469","ID: 470","ID: 470","ID: 470","ID: 471","ID: 471","ID: 471","ID: 472","ID: 472","ID: 472","ID: 473","ID: 473","ID: 474","ID: 474","ID: 474","ID: 475","ID: 475","ID: 475","ID: 476","ID: 476","ID: 477","ID: 477","ID: 477","ID: 478","ID: 478","ID: 478","ID: 479","ID: 479","ID: 479","ID: 480","ID: 480","ID: 480","ID: 481","ID: 481","ID: 481","ID: 482","ID: 482","ID: 482","ID: 483","ID: 483","ID: 483","ID: 484","ID: 484","ID: 484","ID: 485","ID: 485","ID: 485","ID: 486","ID: 486","ID: 486","ID: 487","ID: 487","ID: 487","ID: 488","ID: 488","ID: 488","ID: 489","ID: 489","ID: 489","ID: 490","ID: 490","ID: 490","ID: 491","ID: 491","ID: 491","ID: 492","ID: 492","ID: 492","ID: 493","ID: 494","ID: 494","ID: 494","ID: 495","ID: 495","ID: 495","ID: 496","ID: 496","ID: 496","ID: 497","ID: 497","ID: 497","ID: 498","ID: 498","ID: 498","ID: 499","ID: 499","ID: 500","ID: 500","ID: 500","ID: 501","ID: 501","ID: 501","ID: 502","ID: 502","ID: 502","ID: 503","ID: 503","ID: 503","ID: 505","ID: 505","ID: 505","ID: 506","ID: 506","ID: 506","ID: 507","ID: 507","ID: 508","ID: 508","ID: 508","ID: 509","ID: 509","ID: 509","ID: 510","ID: 510","ID: 510","ID: 511","ID: 511","ID: 511","ID: 512","ID: 512","ID: 512","ID: 513","ID: 513","ID: 513","ID: 514","ID: 514","ID: 514","ID: 515","ID: 515","ID: 515","ID: 516","ID: 516","ID: 517","ID: 517","ID: 517","ID: 518","ID: 518","ID: 518","ID: 519","ID: 519","ID: 520","ID: 520","ID: 520","ID: 521","ID: 521","ID: 521","ID: 522","ID: 522","ID: 522","ID: 523","ID: 523","ID: 523","ID: 524","ID: 524","ID: 524","ID: 525","ID: 525","ID: 525","ID: 526","ID: 526","ID: 526","ID: 527","ID: 527","ID: 527","ID: 528","ID: 528","ID: 528","ID: 529","ID: 529","ID: 529","ID: 530","ID: 530","ID: 530","ID: 531","ID: 531","ID: 531","ID: 532","ID: 532","ID: 532","ID: 533","ID: 533","ID: 533","ID: 534","ID: 534","ID: 534","ID: 535","ID: 535","ID: 535","ID: 536","ID: 537","ID: 537","ID: 537","ID: 538","ID: 538","ID: 538","ID: 539","ID: 539","ID: 539","ID: 540","ID: 540","ID: 540","ID: 541","ID: 541","ID: 541","ID: 542","ID: 542","ID: 543","ID: 543","ID: 543","ID: 544","ID: 544","ID: 544","ID: 545","ID: 545","ID: 545","ID: 546","ID: 546","ID: 546","ID: 548","ID: 548","ID: 548","ID: 549","ID: 549","ID: 549","ID: 550","ID: 550"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Those all look a lot better! We can now conclude that <code>BMI</code> is normally distributed and can be used as a covariate in our models.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<p>High Blood Pressure (SBP &gt;= 140 or DBP &gt;= 90 or (diagnosed with hypertension and use of medication)</p>
<ul>
<li>1 = No</li>
<li>2 = Yes</li>
<li>3 = No, based on data trajectory</li>
<li>4 = Yes, based on data trajectory</li>
<li>9 = Insufficient data, may include reported treatment without diagnosis</li>
<li>-1 = improbable value</li>
</ul>
<p>We will have to exclude values of 9 or -1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of high blood pressure</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>HBP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get values for high blood pressure category</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>HBP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">1109</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">366</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No, based on data trajectory</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes, based on data trajectory</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Insufficient data, may include reported treatment without diagnosis</td>
<td style="text-align: right;">137</td>
</tr>
<tr class="even">
<td style="text-align: left;">Improbable Value</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>There are 137 participants with insufficient data. Let’s purge them from the data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert values of insufficient data to NA for high blood pressure</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>HBP[data_2<span class="sc">$</span>HBP <span class="sc">==</span> <span class="st">"Insufficient data, may include reported treatment without diagnosis"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop empty levels</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>HBP <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(data_2<span class="sc">$</span>HBP) </span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of high blood pressure </span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>HBP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>HBP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">1109</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">366</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No, based on data trajectory</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes, based on data trajectory</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Looks better.</p>
<p>Only 34 visits where participants had no based on trajectory, and 4 that had yes based on trajectory.</p>
<p>We will have to decide to either exclude these or merge them into the no or yes groups, respectively. We can do that after we run our correlations to see if there’s any relationship here worth pursuing.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<p>Diabetes (GLUC 2 &gt;= 126 or (diagnosed with diabetes and use of medication))</p>
<ul>
<li>1 = No</li>
<li>2 = Yes</li>
<li>3 = No, based on data trajectory</li>
<li>4 = Yes, based on data trajectory</li>
<li>9 = Insufficient data</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of diabetes</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>DIAB))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>DIAB))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">628</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">65</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No, based on data trajectory</td>
<td style="text-align: right;">76</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes, based on data trajectory</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: right;">881</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>There are 881 visits with patient who had insuffiicent data to make a diabetes diagnosis!</p>
<p>Let’s change those values to NA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert values of insufficient data to NA for diabetes</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>DIAB[data_2<span class="sc">$</span>DIAB <span class="sc">==</span> <span class="st">"Insufficient data"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop empty levels</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>DIAB <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(data_2<span class="sc">$</span>DIAB)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a barplot for diabetes</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>DIAB))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>DIAB))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">628</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">65</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No, based on data trajectory</td>
<td style="text-align: right;">76</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Great, <code>HBP</code> is now cleaned.</p>
<p>Notably, there were no visits with a yes, based on trajectory.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-7-tab">
<p>Liver disease stage 3/4 (SGPT or SGOP &gt; 150), preliminary algorithm</p>
<ul>
<li>1 = No</li>
<li>2 = Yes</li>
<li>9 = Insufficient data</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of liver disease stage</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>LIV34))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>LIV34))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">1092</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">51</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Insufficient Data</td>
<td style="text-align: right;">507</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>There are 507 patients with insufficient data for a liver disease diagnosis.</p>
<p>Let’s convert those values to NA to reflect this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert values of insufficient data to NA for liver disease stage</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>LIV34[data_2<span class="sc">$</span>LIV34 <span class="sc">==</span> <span class="st">"Insufficient Data"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop empty levels</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>LIV34 <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(data_2<span class="sc">$</span>LIV34)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of cleaned liver stage disease</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>LIV34))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>LIV34))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">1092</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">51</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Looks good, <code>LIV34</code> is now cleaned!</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-8-tab">
<p>Kidney disease (EGFR &lt; 60 or UPRCR &gt;= 200)</p>
<ul>
<li><p>1 = No</p></li>
<li><p>2 = Yes</p></li>
<li><p>3 = No, based on data trajectory</p></li>
<li><p>4 = Yes, based on data trajectory</p></li>
<li><p>- 9 = Insufficient data</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplots of kidney disease</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>KID))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>KID))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">476</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">94</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No, based on data trajectory</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes, based on data trajectory</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: right;">1068</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>There are 1068 visits where there was insufficient data for a diagnosis.</p>
<p>Let’s convert those to NA values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert values of insufficient data to NA for kidney disease</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>KID[data_2<span class="sc">$</span>KID <span class="sc">==</span> <span class="st">"Insufficient data"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop empty levels</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>KID <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(data_2<span class="sc">$</span>KID)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of kidney disease</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>KID))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks good, <code>KID</code> is now cleaned!</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-9-tab">
<p>Frailty Related Phenotype (3 out of 4 conditions = YES; WTLOS, PHDWA, HLTWB, HLTVA</p>
<ul>
<li>1 = No</li>
<li>2 = Yes</li>
<li>9 = Insufficient data</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of frailty related phenotype</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>FRP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>FRP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">1555</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">92</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Insufficient Data</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Only 3 patients with insufficient data.</p>
<p>Let’s convert them to NA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert values of insufficient data to NA for frailty related phenotype</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>FRP[data_2<span class="sc">$</span>FRP <span class="sc">==</span> <span class="st">"Insufficient Data"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop empty levels</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>FRP <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(data_2<span class="sc">$</span>FRP)</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of frailty related phenotype</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>FRP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks good, <code>FRP</code> is now cleaned.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-10" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-10-tab">
<p>Frailty Phenotype (3 out of 5 conditions = YES: WTLOS, PHWDA, HLTVA, SLOW, WEAK)</p>
<ul>
<li>1 = No</li>
<li>2 = Yes</li>
<li>9 = Insufficient Data</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of frailty phenotype</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>FP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>FP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">1195</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">98</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Insufficient Data</td>
<td style="text-align: right;">357</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>357 visits with insufficient data. Let’s convert to NA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert values of insufficient data to NA for frailty phenotype</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>FP[data_2<span class="sc">$</span>FP <span class="sc">==</span> <span class="st">"Insufficient Data"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop empty levels</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>FP <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(data_2<span class="sc">$</span>FP)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of frailty phenotype</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>FP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks good, <code>FP</code> is now cleaned!</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-11" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-11-tab">
<p>Total cholesterol mg/dL</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram for total cholesterol</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>TCHOL)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot for total cholesterol</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>TCHOL)</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>TCHOL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The histogram and qq plot show what may be outliers for total cholesterol at the higher range. How many values are potential outliers?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplot to assess for outliers for total cholesterol</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>outlier_tchol <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(data_2<span class="sc">$</span>TCHOL, <span class="at">main =</span> <span class="st">"Boxplot for Total Cholesterol"</span>)<span class="sc">$</span>out</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="fl">1.2</span>, <span class="fu">length</span>(outlier_tchol)),</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> outlier_tchol, <span class="at">labels =</span> outlier_tchol, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by descending total cholesterol</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>sorted_data <span class="ot">&lt;-</span> data_2[<span class="fu">order</span>(<span class="sc">-</span>data_2<span class="sc">$</span>TCHOL),] <span class="sc">%&gt;%</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, TCHOL, years)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(sorted_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">newid</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">TCHOL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">years</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">199</td>
<td style="text-align: right;">613</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">89</td>
<td style="text-align: right;">375</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">428</td>
<td style="text-align: right;">362</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">433</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">418</td>
<td style="text-align: right;">348</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">203</td>
<td style="text-align: right;">337</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The highest cholesterol value is ~2x higher than the next highest value. Let’s see what happens if we remove it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete highest total cholesterol value</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>TCHOL[data_2<span class="sc">$</span>TCHOL <span class="sc">==</span> <span class="dv">613</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span> </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of total cholesterol</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>TCHOL)</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot of total cholesterol</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>TCHOL)</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>TCHOL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks better but still slightly right skewed. This variable had ~30% missing values, so we may end up not using it.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-12" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-12-tab">
<p>Triglycerides, mg/dL</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of triglycerides</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>TRIG)</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot of triglycerides</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>TRIG)</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>TRIG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>VERY skewed! Based on the qqplots, it looks like we would have to perform a log transform on <code>TRIG</code> if we wanted to use it. However we have nearly 50% missing values for this variable, so we should drop it as a covariate.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-13" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-13-tab">
<p>Low Density Lipoprotein (fasting) mg/dL</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram for LDL</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>LDL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks like we may have an erroneous value at the highest range there.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by descending total cholesterol</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>sorted_data <span class="ot">&lt;-</span> data_2[<span class="fu">order</span>(<span class="sc">-</span>data_2<span class="sc">$</span>LDL),] <span class="sc">%&gt;%</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, LDL, years)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(sorted_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">newid</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LDL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">years</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">19</td>
<td style="text-align: right;">704</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">413</td>
<td style="text-align: right;">704</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">275</td>
<td style="text-align: right;">247</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">275</td>
<td style="text-align: right;">217</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">242</td>
<td style="text-align: right;">212</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">203</td>
<td style="text-align: right;">204</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Patients 19 and 413 have the same value of 704 at baseline. Clearly an error with the measurement process.</p>
<p><code>LDL</code> has close to 50% missing values and we will not be using it in our model, so I will move on. But good to know we can’t just blindly trust all the values to be correct!</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-14" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-14-tab">
<p>Dyslipidemia at visit. fasting TC &gt;=200 mg/dl or &gt;=130 mg/dl or HDL &lt; 40 mg/dl or triglycerides &gt;=150 mg/dl or use of lipid lowering medications (HICHOLRX) with self report or clinical diagnosis in the past.</p>
<ul>
<li>1 = No</li>
<li>2 = Yes</li>
<li>3 = No, based on data trajectory</li>
<li>4 = Yes from data trajectory</li>
<li>9 = Insufficient data</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of dyslipidemia</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>DYSLIP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>DYSLIP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">235</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">630</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No, based on data trajectory</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes, based on data trajectory</td>
<td style="text-align: right;">57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Insufficient data</td>
<td style="text-align: right;">718</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>There are 718 visits with insufficient data for a dyslipidemia diagnosis.</p>
<p>Let’s convert those to NAs to reflect this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert values of insufficient data to NA for dyslipidemia</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>DYSLIP[data_2<span class="sc">$</span>DYSLIP <span class="sc">==</span> <span class="st">"Insufficient data"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop empty levels</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>DYSLIP <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(data_2<span class="sc">$</span>DYSLIP)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of dyslipidemia</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>DYSLIP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks good, <code>DYSLIP</code> is now cleaned!</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-15" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-15-tab">
<p>Center for Epidemiological Studies Depression Scale ( &gt;= 16 is depressed).</p>
<ul>
<li><p>0 - 60</p></li>
<li><p>-1 = missing</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram for depression score</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>CESD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s correctly reflect those -1’s as NA’s</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove depression scores that were coded as missing</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>CESD[data_2<span class="sc">$</span>CESD <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of depression score</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>CESD)</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot for depression score</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>CESD)</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>CESD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks good. <code>CESD</code> is now cleaned!</p>
<p>For fun, let’s see if a square root transformation helps at all.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try a sqrt transformation</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>CESD_sqrt <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(data_2<span class="sc">$</span>CESD)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of sqrt depression score</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>CESD_sqrt)</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot of sqrt depressions score</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>CESD_sqrt)</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>CESD_sqrt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That does look a bit better, but the central limit theorem justifies inclusion of <code>CESD</code> without performing transformation.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-16" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-16-tab">
<p>Smoking status</p>
<ul>
<li>1 = Never smoked</li>
<li>2 = Former smoker</li>
<li>3 = Current smoker</li>
<li>Blank = missing</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of smoking status</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>SMOKE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks good, nothing to do here.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-17" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-17-tab">
<p>Alcohol use since last visit</p>
<ul>
<li>0 = None</li>
<li>1 = 1 to 3 drinks/week</li>
<li>2 = 4 to 13 drinks/week</li>
<li>3 = More than 13 drinks/week</li>
<li>Blank = Missing</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of drinking group</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>DKGRP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks good, nothing to do here.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-18" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-18-tab">
<p>Took heroin or other opiates since last visit?</p>
<ul>
<li>1 = No</li>
<li>2 = Yes</li>
<li>-9 = Not specified in form</li>
<li>Blank = Missing</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of heroin or opiate use</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>HEROPIATE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>HEROPIATE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">1552</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">66</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Not Specified</td>
<td style="text-align: right;">20</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Only 20 visits where participants did not specify drinking frequency on their form.</p>
<p>Let’s correct those to be NA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert values of insufficient data to NA for heroin or opiate use</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>HEROPIATE[data_2<span class="sc">$</span>HEROPIATE <span class="sc">==</span> <span class="st">"Not Specified"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop empty levels</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>HEROPIATE <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(data_2<span class="sc">$</span>HEROPIATE)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of heroin or opiate use</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>HEROPIATE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks good. <code>HEROPIATE</code> is now cleaned!</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-19" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-19-tab">
<p>Took/used drugs with a needle since last visit?</p>
<ul>
<li>1 = No</li>
<li>2 = Yes</li>
<li>Blank = Missing</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of intravenous drug use</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>IDU))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks good. Nothing to do here</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-20" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-20-tab">
<p>Adherence to meds taken since last visit</p>
<ul>
<li>1 = 100%</li>
<li>2 = 95-99%</li>
<li>3 = 75-94%</li>
<li>4 &lt;75%</li>
<li>Blank = Missing</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create bar plot of adherence</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>ADH))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>ADH))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">100%</td>
<td style="text-align: right;">504</td>
</tr>
<tr class="even">
<td style="text-align: left;">95-99%</td>
<td style="text-align: right;">474</td>
</tr>
<tr class="odd">
<td style="text-align: left;">75-94%</td>
<td style="text-align: right;">102</td>
</tr>
<tr class="even">
<td style="text-align: left;">&lt;75%</td>
<td style="text-align: right;">21</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>VERY interesting. I was thinking that 100% vs 95-99% adherence was an arbitrary difference to choose to divide groups on, and was actually planning to merge the two. However, this shows why the experimenters likely made that decision: both groups have close to the same amount of observations (~500)&gt; That’s really good to know.</p>
<p>We could still play with the idea of simplifying this into two groups: &gt;= 95% and &lt; 95%. We will revisit that in the model selection.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-21" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-21-tab">
<p>Race</p>
<ul>
<li>1 = White, non-Hispanic</li>
<li>2 = White, Hispanic</li>
<li>3 = Black, non-Hispanic</li>
<li>4 = Black, Hispanic</li>
<li>5 = American Indian or Alaskan Native</li>
<li>6 = Asian or Pacific Islander</li>
<li>7 = Other 8 = Other Hispanic (created for 2001-03 new recruits)</li>
<li>Blank = Missing</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of race</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>RACE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>RACE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: right;">1020</td>
</tr>
<tr class="even">
<td style="text-align: left;">White, Hispanic</td>
<td style="text-align: right;">57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Black, non-Hispanic</td>
<td style="text-align: right;">474</td>
</tr>
<tr class="even">
<td style="text-align: left;">Black, Hispanic</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">American Indian or Alaskan Native</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Asian or Pacific Islander</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other Hispanic</td>
<td style="text-align: right;">18</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>This all looks coded properly. As is a common thing I am seeing, we have a predominant proportion of participants who are white, non-Hispanic. The data set might be large enough that we can use race as a covariate.</p>
<p>It might be worth dummy coding as white vs non white and see if there are any differences. That’s not the main focus of this project though so I will leave that to if I have extra time at the end.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-22" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-22-tab">
<p>Baseline or earliest reported education (highest grade or level)</p>
<ul>
<li>1 = 8th grade or less</li>
<li>2 = 9,10, or 11th grade</li>
<li>3 = 12th grade</li>
<li>4 = At least one year college but no degree</li>
<li>5 = Four years college / got degree</li>
<li>6 = Some graduate work</li>
<li>7 = Post-graduate degree</li>
<li>Blank = Missing</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of education at baseline</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>EDUCBAS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>EDUCBAS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">8th grade or less</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">9,10, or 11th grade</td>
<td style="text-align: right;">138</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12th grade</td>
<td style="text-align: right;">225</td>
</tr>
<tr class="even">
<td style="text-align: left;">At least one year college but no degree</td>
<td style="text-align: right;">585</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Four years college or got degree</td>
<td style="text-align: right;">324</td>
</tr>
<tr class="even">
<td style="text-align: left;">Some graduate work</td>
<td style="text-align: right;">129</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Post-graduate degree</td>
<td style="text-align: right;">237</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>This all checks out. And it looks like there are enough participants in each group (except for 8th grade or less) to run analyses with this variable. It will be interesting to see what relationships arise, as I expect there to be a strong association between education and HIV exposure.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-23" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-23-tab">
<p>HIV Serostatus</p>
<ul>
<li>0 = Negative</li>
<li>1 = Positive</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking that all patients are HIV pos</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(data_2<span class="sc">$</span>hivpos))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>All patients in this data set are HIV+</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-24" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-24-tab">
<p>Age at visit</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram for age</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_2<span class="sc">$</span>age)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot for age</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_2<span class="sc">$</span>age)</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_2<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Nice and normally distributed, how we like it.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-25" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-25-tab">
<p>Take ART at visit</p>
<ul>
<li>0 = NO</li>
<li>1 = YES</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of antiretroviral therapy</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>ART))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>ART))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">550</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1100</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>I’m not too sure how useful this variable will be. It just means there were some visits where patients were not given ART, I suppose. But most visits had participants receiving ART.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-26" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-26-tab">
<p>Ever took ART.</p>
<ul>
<li>0 = NO</li>
<li>1 = YES</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of everART</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>everART))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>everART))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">550</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1100</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>This has the exact same split as <code>ART</code>. Which makes me think they are exactly the same values for each participant</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if everART and ART are identical</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(data_2<span class="sc">$</span>everART <span class="sc">==</span> data_2<span class="sc">$</span>ART)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Yup, this is either an accidental duplicate of <code>ART</code>, or there is no distinction of significance between the two. What exactly does “Ever took ART” (the explanation provided by the data dictionary) mean? Was this taken at baseline?</p>
<p>Either way looks like we’re not using this variable.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-27" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-27-tab">
<p>Hard drug use (either injection drugs or illicit heroin/opiate use) since last visit</p>
<ul>
<li>0 = No</li>
<li>1 = Yes</li>
<li>Blank = Missing</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot of hard drug use category</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>hard_drugs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print table</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_2<span class="sc">$</span>hard_drugs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">1452</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">198</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>There were 198 visits where participants had used hard_drugs since the last visit.</p>
<p>This variable looks good. We will just have to do some dummy coding to create the categories the researchers were interested in.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
<div id="tabset-2-28" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-28-tab">
<p>For the CONSORT diagram, we just removed:</p>
<p>38 visits where patients did not report income.</p>
<p>X BMI values that were missing and y values that were improbable.</p>
<p>137 visits with insufficient data for a HBP diagnosis</p>
<p>881 visits with insufficient data for a DIAB diagnosis.</p>
<p>507 visits with insufficient data for a LIV34 diagnosis</p>
<p>1068 visits with insuffcient data for a kidney disease diagnosis</p>
<p>3 visits with insuffiient data for FRP diagnosis</p>
<p>357 visits with insufficient data for FP diagnosis</p>
<p>718 visits with insufficent data for dyslipidemia diagnosis</p>
<p>X visits with missing values for CESD</p>
<p>20 visits where heroin or opiate use was not specified</p>
<p>COME BACK TO THIS BECAUSE i THINK I NEED TO COME BACK AND DELETE OUTLIERS.</p>
<p><a href="#Clean_IVs">Back to top of tabset</a></p>
</div>
</div>
</div>
<p>:::</p>
</section>
</section>
<section id="missingness-ii" class="level1">
<h1>Missingness II</h1>
<p>We first examined missingness before performing data cleaning just to get a sense of the data set.</p>
<p>Let’s compare what our missingness looked like pre- and post-data cleaning.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missingness for pre-cleaned data</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missingness for post-cleaned data</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(data_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-88-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The order for missingness has changed, now with <code>KID</code> at the top, followed by <code>DIAB</code>, <code>LDL</code>, <code>TRIG</code>, and <code>DYSLIP</code>.</p>
<p><code>TCHOL</code>, <code>LIV34</code>, and <code>income</code> are further behind, with levels of missingness that may be salvageable (~30%).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missingness for pre-cleaned dataset</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missingness for post-cleaned dataset</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(data_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-89-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>And for good measure let’s now examine missingness in the wide form data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new wideform data set for first 2 years of study              </span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>data_wide_2 <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(data_2, <span class="at">id_cols =</span> newid, <span class="at">names_from =</span> years, <span class="at">values_from =</span> <span class="sc">-</span><span class="fu">c</span>(newid, years))</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missing values in the wideform data set</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(data_wide_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There are no real trends that become apparent when looking at this plot for the wideform data set.</p>
<p>To summarize, it appears that diagnoses that were determined by algorithm (such as <code>KID</code>, <code>DIAB</code>, <code>DYSLIP</code>, and <code>LIV34</code>, often had insufficient data to make a diagnosis, so perhaps this is an issue with those algorithms. Additionally, lab measurements of <code>LDL</code> and <code>TRIG</code> seem to have been too onerous for participants to have had collected. Maybe they opted out of those tests, or maybe the tests were only ordered under certain circumstances.</p>
<p>These would be valuable questions to bring forth to the PI. But for now it appear as if we won’t be able to use these variables.</p>
<p>We may want to impute <code>income</code>, <code>LIV34</code>, and <code>TCHOL</code>, as these have missingness of 24%, 31%, and 32%, respectively.</p>
<section id="variables-with-minimal-missing-data-5-that-can-be-disregarded-without-affecting-analysis-integrity" class="level4">
<h4 class="anchored" data-anchor-id="variables-with-minimal-missing-data-5-that-can-be-disregarded-without-affecting-analysis-integrity">Variables with minimal missing data (&lt;5%) that can be disregarded without affecting analysis integrity</h4>
<ul>
<li><code>AGG_MENT</code></li>
<li><code>AGG_PHYS</code></li>
<li><code>HASH_V</code></li>
<li><code>HASHF</code></li>
<li><code>FRP</code></li>
<li><code>SMOKE</code></li>
<li><code>DKGRP</code></li>
<li><code>HEROPIATE</code></li>
<li><code>IDU</code></li>
<li><code>LEU3N</code></li>
<li><code>VLOAD</code></li>
<li><code>ADH</code></li>
<li><code>EDUCBASE</code></li>
<li><code>AGE</code></li>
<li><code>ART</code></li>
<li><code>years</code></li>
<li><code>hard-drugs</code></li>
</ul>
</section>
<section id="variables-with-moderate-missing-data-5-20-that-necessitate-intervention" class="level4">
<h4 class="anchored" data-anchor-id="variables-with-moderate-missing-data-5-20-that-necessitate-intervention">Variables with moderate missing data (5-20%) that necessitate intervention</h4>
<ul>
<li><code>BMI</code></li>
<li><code>HBP</code></li>
</ul>
</section>
<section id="variables-with-20-missing-data-that-are-edge-cases-and-may-require-exclusion-or-imputation" class="level4">
<h4 class="anchored" data-anchor-id="variables-with-20-missing-data-that-are-edge-cases-and-may-require-exclusion-or-imputation">Variables with &gt;20% missing data that are edge cases and may require exclusion or imputation</h4>
<ul>
<li><code>TCHOL</code></li>
<li><code>income</code></li>
<li><code>LIV34</code></li>
</ul>
</section>
<section id="variables-with-an-excess-of-missing-data-40-that-necessitate-exclusion-from-the-analysis" class="level4">
<h4 class="anchored" data-anchor-id="variables-with-an-excess-of-missing-data-40-that-necessitate-exclusion-from-the-analysis">Variables with an excess of missing data (&gt;40%) that necessitate exclusion from the analysis</h4>
<ul>
<li><code>LDL</code></li>
<li><code>TRIG</code></li>
<li><code>DIAB</code></li>
<li><code>KID</code></li>
<li><code>DYSLIP</code></li>
</ul>
</section>
</section>
<section id="Variable_Creation" class="level1">
<h1>Variable Creation</h1>
<p>Here we will create the variables necessary for the analysis.</p>
<p>Since we cleaned the longform data set, let’s go ahead and re-transpose it to update the wide form data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new wideform data set for first 2 years of study              </span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>data_wide_2 <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(data_2, <span class="at">id_cols =</span> newid, <span class="at">names_from =</span> years, <span class="at">values_from =</span> <span class="sc">-</span><span class="fu">c</span>(newid, years))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Outcome Variable Change Scores</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Hard Drug Use Groups</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Adherence Groups</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">Race Groups</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">Education Groups</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Here we will create our change scores for our dependent variables <code>LEU3N</code>, <code>VLOAD</code>, <code>AGG_MENT</code>, and <code>AGG_PHYS</code> to assess treatment response to ART. For <code>VLOAD</code> we will create change scores off the log transformed values.</p>
<p>Change scores are calculated as:</p>
<p><span class="math display">\[
y_{2year} - y_{baseline} = y_{change}
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Change scores are coded such that:</p>
<ul>
<li><p>For viral load, higher numbers are less desirable. Negative numbers signify a decrease in viral load over time, which is favorable.</p></li>
<li><p>For CD4+ T Cell count, higher numbers are more desirable. Negative numbers signify a decrease in leukocytes over time, which is not favorable.</p></li>
<li><p>For aggregate mental and physical QOL score, higher numbers signify an increase in mental/physical health from baseline. Negative values signify a decrease.</p></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create change scores for outcome variables</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>VLOAD_log_CHANGE <span class="ot">&lt;-</span> data_wide_2<span class="sc">$</span>VLOAD_log_2 <span class="sc">-</span> data_wide_2<span class="sc">$</span>VLOAD_log_0</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>LEU3N_CHANGE <span class="ot">&lt;-</span> data_wide_2<span class="sc">$</span>LEU3N_2 <span class="sc">-</span> data_wide_2<span class="sc">$</span>LEU3N_0</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>AGG_MENT_CHANGE <span class="ot">&lt;-</span> data_wide_2<span class="sc">$</span>AGG_MENT_2 <span class="sc">-</span> data_wide_2<span class="sc">$</span>AGG_MENT_0</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>AGG_PHYS_CHANGE <span class="ot">&lt;-</span> data_wide_2<span class="sc">$</span>AGG_PHYS_2 <span class="sc">-</span> data_wide_2<span class="sc">$</span>AGG_PHYS_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s perform internal consistency checks to make sure those calculations were performed correctly, as well as reexamine the distributions of the change score for each variable.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Log Viral Load Change</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">CD4+ T Cell Count Change</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Aggregate Mental QOL Change</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Aggregate Physical QOL Change</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only variables related to change scores to double check we performed calculation correctly.</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(VLOAD_log_0, VLOAD_log_2, VLOAD_log_CHANGE)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(filtered_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">VLOAD_log_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">VLOAD_log_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">VLOAD_log_CHANGE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">11.532856</td>
<td style="text-align: right;">4.094345</td>
<td style="text-align: right;">-7.438511</td>
</tr>
<tr class="even">
<td style="text-align: right;">9.002209</td>
<td style="text-align: right;">3.871201</td>
<td style="text-align: right;">-5.131008</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8.294439</td>
<td style="text-align: right;">3.314519</td>
<td style="text-align: right;">-4.979919</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.606650</td>
<td style="text-align: right;">3.295837</td>
<td style="text-align: right;">-3.310813</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.046548</td>
<td style="text-align: right;">6.039064</td>
<td style="text-align: right;">-5.007484</td>
</tr>
<tr class="even">
<td style="text-align: right;">9.664278</td>
<td style="text-align: right;">3.979682</td>
<td style="text-align: right;">-5.684596</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The computation for change score was performed correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create hist for vload log change score</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_wide_2<span class="sc">$</span>VLOAD_log_CHANGE)</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot for vload log change score</span></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_wide_2<span class="sc">$</span>VLOAD_log_CHANGE)</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_wide_2<span class="sc">$</span>VLOAD_log_CHANGE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks like we have 1 outlier there that we should catch with the jackknife residuals after we fit the model, but <code>VLOAD_log_CHANGE</code> looks normally distributed!</p>
<p><a href="#Variable_Creation">Top of Tabset</a></p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only variables related to change scores to double check we performed calculation correctly.</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(LEU3N_0, LEU3N_2, LEU3N_CHANGE)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(filtered_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">LEU3N_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LEU3N_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LEU3N_CHANGE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">104.1659</td>
<td style="text-align: right;">345.4010</td>
<td style="text-align: right;">241.23505</td>
</tr>
<tr class="even">
<td style="text-align: right;">257.8278</td>
<td style="text-align: right;">263.0693</td>
<td style="text-align: right;">5.24147</td>
</tr>
<tr class="odd">
<td style="text-align: right;">563.1223</td>
<td style="text-align: right;">405.1816</td>
<td style="text-align: right;">-157.94073</td>
</tr>
<tr class="even">
<td style="text-align: right;">110.4218</td>
<td style="text-align: right;">179.6409</td>
<td style="text-align: right;">69.21912</td>
</tr>
<tr class="odd">
<td style="text-align: right;">252.6634</td>
<td style="text-align: right;">59.6219</td>
<td style="text-align: right;">-193.04149</td>
</tr>
<tr class="even">
<td style="text-align: right;">634.1246</td>
<td style="text-align: right;">893.4328</td>
<td style="text-align: right;">259.30816</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The computation for change score was performed correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create hist for CD4+ T Cell change score</span></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_wide_2<span class="sc">$</span>LEU3N_CHANGE)</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot for CD4+ T Cell change score</span></span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_wide_2<span class="sc">$</span>LEU3N_CHANGE)</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_wide_2<span class="sc">$</span>LEU3N_CHANGE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>CD4+ T Cell count change score looks normally distributed, with 1 or 2 outliers that we can examine the leverage and influence of.</p>
<p><a href="#Variable_Creation">Top of Tabset</a></p>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only variables related to change scores to double check we performed calculation correctly.</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(AGG_MENT_0, AGG_MENT_2, AGG_MENT_CHANGE)</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(filtered_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG_MENT_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG_MENT_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG_MENT_CHANGE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">44.90710</td>
<td style="text-align: right;">59.65136</td>
<td style="text-align: right;">14.7442634</td>
</tr>
<tr class="even">
<td style="text-align: right;">46.34190</td>
<td style="text-align: right;">45.41483</td>
<td style="text-align: right;">-0.9270733</td>
</tr>
<tr class="odd">
<td style="text-align: right;">40.22337</td>
<td style="text-align: right;">41.70079</td>
<td style="text-align: right;">1.4774173</td>
</tr>
<tr class="even">
<td style="text-align: right;">42.90638</td>
<td style="text-align: right;">52.68223</td>
<td style="text-align: right;">9.7758533</td>
</tr>
<tr class="odd">
<td style="text-align: right;">56.42904</td>
<td style="text-align: right;">66.50629</td>
<td style="text-align: right;">10.0772432</td>
</tr>
<tr class="even">
<td style="text-align: right;">59.74437</td>
<td style="text-align: right;">50.26010</td>
<td style="text-align: right;">-9.4842722</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The computation for change score was performed correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create hist for aggregate mental QOL change score</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_wide_2<span class="sc">$</span>AGG_MENT_CHANGE, <span class="at">breaks =</span> <span class="dv">24</span>)</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot for aggregate mental QOL change score</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_wide_2<span class="sc">$</span>AGG_MENT_CHANGE)</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_wide_2<span class="sc">$</span>AGG_MENT_CHANGE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That looks more normally distributed now, and our sample size is very large so we can also count on the central limit theorem to help us with the assumption of normality.</p>
<p><a href="#Variable_Creation">Top of Tabset</a></p>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only variables related to change scores to double check we performed calculation correctly.</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(AGG_PHYS_0, AGG_PHYS_2, AGG_PHYS_CHANGE)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(filtered_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG_PHYS_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG_PHYS_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGG_PHYS_CHANGE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">52.52557</td>
<td style="text-align: right;">48.54453</td>
<td style="text-align: right;">-3.9810371</td>
</tr>
<tr class="even">
<td style="text-align: right;">27.92331</td>
<td style="text-align: right;">37.32204</td>
<td style="text-align: right;">9.3987247</td>
</tr>
<tr class="odd">
<td style="text-align: right;">60.06970</td>
<td style="text-align: right;">58.51450</td>
<td style="text-align: right;">-1.5551943</td>
</tr>
<tr class="even">
<td style="text-align: right;">50.78850</td>
<td style="text-align: right;">51.50533</td>
<td style="text-align: right;">0.7168277</td>
</tr>
<tr class="odd">
<td style="text-align: right;">43.75671</td>
<td style="text-align: right;">18.82350</td>
<td style="text-align: right;">-24.9332115</td>
</tr>
<tr class="even">
<td style="text-align: right;">56.86261</td>
<td style="text-align: right;">55.95668</td>
<td style="text-align: right;">-0.9059311</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The computation for change score was performed correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plotting area: 1 row, 2 columns</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create hist for aggregate physical  QOL change score</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_wide_2<span class="sc">$</span>AGG_PHYS_CHANGE, <span class="at">breaks =</span> <span class="dv">24</span>)</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create qqplot for aggregate physical QOL change score</span></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_wide_2<span class="sc">$</span>AGG_PHYS_CHANGE)</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_wide_2<span class="sc">$</span>AGG_PHYS_CHANGE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Aggregate physical QOL change score appears more normally distributed now.</p>
<p><a href="#Variable_Creation">Top of Tabset</a></p>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<p>After computing the change scores, our outcome variables are now normally distributed and we can move forward with using them in models!</p>
<p><a href="#Variable_Creation">Top of Tabset</a></p>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>We need to make dummy codes for our hard drug use groups.</p>
<p>The criteria outlined by the researchers are as follows:</p>
<ul>
<li><u>Never User:</u> No drug use reported at 0, 1, or 2 years</li>
<li><u>Previous User:</u> Drug use reported at 0 or 1 years, but not 2 years</li>
<li><u>Current User:</u> Drug use reported at 2 years</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Drug Use Classification</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Drug Use Group</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>First we will create dummy codes for whether a patient was a never, previous, or current hard drug user.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dummy code for current drug users (those who used at year 2)</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>current_drug <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_wide_2<span class="sc">$</span>hard_drugs_2 <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>) </span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dummy code for previous drug users (those who used at years 0 or 1, but not 2)</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>previous_drug <span class="ot">&lt;-</span> <span class="fu">ifelse</span>((data_wide_2<span class="sc">$</span>hard_drugs_1 <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">|</span> data_wide_2<span class="sc">$</span>hard_drugs_0 <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">&amp;</span> data_wide_2<span class="sc">$</span>hard_drugs_2 <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dummy code for never drug users (did not use at years 0, 1, or 2)</span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>never_drug <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_wide_2<span class="sc">$</span>hard_drugs_1 <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">&amp;</span> data_wide_2<span class="sc">$</span>hard_drugs_0 <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">&amp;</span> data_wide_2<span class="sc">$</span>hard_drugs_2 <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And perform some internal consistency checks to ensure we coded that correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Double check our criteria worked as intended</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, hard_drugs_0, hard_drugs_1, hard_drugs_2, never_drug, previous_drug, current_drug)</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(filtered_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">newid</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">hard_drugs_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">hard_drugs_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">hard_drugs_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">never_drug</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">previous_drug</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">current_drug</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Double check no overlapping group assignments (such as a current AND previous drug user)</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>no_overlap <span class="ot">&lt;-</span> <span class="fu">apply</span>(data_wide_2[, <span class="fu">c</span>(<span class="st">"never_drug"</span>, <span class="st">"previous_drug"</span>, <span class="st">"current_drug"</span>)], <span class="dv">1</span>, sum) <span class="sc">&lt;=</span> <span class="dv">1</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>all_no_overlap <span class="ot">&lt;-</span> <span class="fu">all</span>(no_overlap)</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print result</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (all_no_overlap) {</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"No overlapping group assignments"</span>)</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"There are overlapping group assignments in some rows"</span>)</span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "No overlapping group assignments"</code></pre>
</div>
</div>
<p>Great, that looks like we coded it properly and there are no overlaps between drug use conditions (e.g.&nbsp;there are no current drug users who are also previous drug users).</p>
<p><a href="#Variable_Creation">Top of Tabset</a></p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Now we will use those dummy codes to make a variable for which group each patient was in</p>
<ul>
<li>0: Never User</li>
<li>1: Previous User</li>
<li>2: Current User</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a single variable for drug use group</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_wide_2<span class="sc">$</span>never_drug <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>, </span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">ifelse</span>(data_wide_2<span class="sc">$</span>previous_drug <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">ifelse</span>(data_wide_2<span class="sc">$</span>current_drug <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>)))</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor this new variable and label it too</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp,</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Never User"</span>, <span class="st">"Previous User"</span>, <span class="st">"Current User"</span>))</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Label the new variable for better output</span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp) <span class="ot">&lt;-</span> <span class="st">"Hard Drug Use Group"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And perform an internal consistency check to make sure there are no overlapping group assignments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Double check our criteria worked as intended</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, hard_drugs_0, hard_drugs_1, hard_drugs_2, hard_drugs_grp)</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(filtered_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">newid</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">hard_drugs_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">hard_drugs_1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">hard_drugs_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">hard_drugs_grp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Previous User</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Previous User</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Current User</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Previous User</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Current User</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Current User</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Let’s do a final check for how many patients we have in each group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print categories</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Never User</td>
<td style="text-align: right;">444</td>
</tr>
<tr class="even">
<td style="text-align: left;">Previous User</td>
<td style="text-align: right;">46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Current User</td>
<td style="text-align: right;">60</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Looks good, we can now move forward with analyses using the <code>hard_drgs_grp</code> variable!</p>
<p><a href="#Variable_Creation">Top of Tabset</a></p>
</div>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p>The experimenters coded adherence with 4 levels:</p>
<ul>
<li>1: 100%</li>
<li>2: 95-99%</li>
<li>3: 75-94%</li>
<li>4: &lt;75%</li>
<li>Blank = Missing</li>
</ul>
<p>However, it may be also be useful to think of adherence in terms of high vs.&nbsp;low adherence.</p>
<p>Let’s go ahead and create a new category for patients that had:</p>
<ul>
<li>High: 95% - 100%</li>
<li>Low: &lt; 95%</li>
</ul>
<p>We will be using adherence at year 2 for these categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new groups based on high vs low adherence (based on adherence at 2 years)</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGH <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_wide_2<span class="sc">$</span>ADH_2 <span class="sc">==</span> <span class="st">"100%"</span> <span class="sc">|</span> data_wide_2<span class="sc">$</span>ADH_2 <span class="sc">==</span> <span class="st">"95-99%"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_LOW <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_wide_2<span class="sc">$</span>ADH_2 <span class="sc">==</span> <span class="st">"75-94%"</span> <span class="sc">|</span> data_wide_2<span class="sc">$</span>ADH_2 <span class="sc">==</span> <span class="st">"&lt;75%%"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a variable for high vs low adherence</span></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_wide_2<span class="sc">$</span>ADH_LOW <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">ifelse</span>(data_wide_2<span class="sc">$</span>ADH_HIGH <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="cn">NA</span>))</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor this new variable and label it too</span></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW,</span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low Adherence"</span>, <span class="st">"High Adherence"</span>))</span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Label the new variable for better output</span></span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW) <span class="ot">&lt;-</span> <span class="st">"Adherence Level"</span></span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop empty levels</span></span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s perform a consistency check to make sure that coding worked as intended.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Double check our criteria worked as intended</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, ADH_2, ADH_HIGHVSLOW)</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(filtered_data, <span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">newid</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ADH_2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ADH_HIGHVSLOW</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">95-99%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">95-99%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">95-99%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">95-99%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">95-99%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">95-99%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: left;">75-94%</td>
<td style="text-align: left;">Low Adherence</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: left;">95-99%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: left;">75-94%</td>
<td style="text-align: left;">Low Adherence</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td style="text-align: left;">95-99%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: left;">95-99%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">High Adherence</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: left;">75-94%</td>
<td style="text-align: left;">Low Adherence</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Looks great, now we have a new variable <code>ADH_HIGHVSLOW</code> to compare how high and low adherence to the medication regiment since the last visit impacts outcomes.</p>
<p><a href="#Variable_Creation">Top of Tabset</a></p>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<p>First let’s examine how many patients of each race we have.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get number of patients of each race</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_wide_2<span class="sc">$</span>RACE_0))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: right;">340</td>
</tr>
<tr class="even">
<td style="text-align: left;">White, Hispanic</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Black, non-Hispanic</td>
<td style="text-align: right;">158</td>
</tr>
<tr class="even">
<td style="text-align: left;">Black, Hispanic</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">American Indian or Alaskan Native</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Asian or Pacific Islander</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other Hispanic</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>We have a very low number of patients in the minority race categories.</p>
<p>It may be informative to see how outcomes differ based on white vs non-white, as our sample is predominantly white and there is otherwise not enough patients in each category to use race as a meaningful variable.</p>
<p>Let’s create a variable that captures this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dummy variable for race, white vs non-white</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>RACE_WHITEYN <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(data_wide_2<span class="sc">$</span>RACE_0), <span class="cn">NA</span>, </span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(data_wide_2<span class="sc">$</span>RACE_0 <span class="sc">==</span> <span class="st">"White, non-Hispanic"</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor this new variable and label it too</span></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>RACE_WHITEYN <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_wide_2<span class="sc">$</span>RACE_WHITEYN,</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Non-White"</span>, <span class="st">"White"</span>))</span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Label the new variable for better output</span></span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>RACE_WHITEYN) <span class="ot">&lt;-</span> <span class="st">"Race"</span></span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Double check our criteria worked as intended</span></span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, RACE_0, RACE_WHITEYN)</span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print</span></span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(filtered_data, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">newid</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RACE_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RACE_WHITEYN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Black, non-Hispanic</td>
<td style="text-align: left;">Non-White</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">Other Hispanic</td>
<td style="text-align: left;">Non-White</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">White, non-Hispanic</td>
<td style="text-align: left;">White</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">Black, non-Hispanic</td>
<td style="text-align: left;">Non-White</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Our dummy coding was performed correctly.</p>
<p>Let’s see what our counts looks like now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check counts for each category in the new whiteYN variable.</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data_wide_2<span class="sc">$</span>RACE_WHITEYN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Non-White     White 
      186       340 </code></pre>
</div>
</div>
<p>We have 186 non-white participants and 340 white participants.</p>
<p><a href="#Variable_Creation">Top of Tabset</a></p>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get number patients in each education tier</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_wide_2<span class="sc">$</span>EDUCBAS_0))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Var1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">8th grade or less</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">9,10, or 11th grade</td>
<td style="text-align: right;">46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12th grade</td>
<td style="text-align: right;">75</td>
</tr>
<tr class="even">
<td style="text-align: left;">At least one year college but no degree</td>
<td style="text-align: right;">195</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Four years college or got degree</td>
<td style="text-align: right;">108</td>
</tr>
<tr class="even">
<td style="text-align: left;">Some graduate work</td>
<td style="text-align: right;">43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Post-graduate degree</td>
<td style="text-align: right;">79</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Education at baseline is currently coded as a categorical variable with 7 levels. It may be more helpful to classify education as a bivariate variable of college vs no college.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new dummy variable for college vs no college</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>EDUC_COLLEGE <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(data_wide_2<span class="sc">$</span>EDUCBAS_0), <span class="cn">NA</span>, </span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(data_wide_2<span class="sc">$</span>EDUCBAS_0 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"At least one year college but no degree"</span>, </span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>                                                                       <span class="st">"Four years college or got degree"</span>, </span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>                                                                       <span class="st">"Some graduate work"</span>, </span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>                                                                       <span class="st">"Post-graduate degree"</span>), <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor new variable</span></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>EDUC_COLLEGE <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_wide_2<span class="sc">$</span>EDUC_COLLEGE,</span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No College"</span>, <span class="st">"College"</span>))</span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Label the new variable for better output</span></span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>EDUC_COLLEGE) <span class="ot">&lt;-</span> <span class="st">"College Status"</span></span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Double check our criteria worked as intended</span></span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, EDUCBAS_0, EDUC_COLLEGE)</span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty print</span></span>
<span id="cb171-21"><a href="#cb171-21" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(filtered_data, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">newid</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EDUCBAS_0</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EDUC_COLLEGE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">At least one year college but no degree</td>
<td style="text-align: left;">College</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">9,10, or 11th grade</td>
<td style="text-align: left;">No College</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">Post-graduate degree</td>
<td style="text-align: left;">College</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">Four years college or got degree</td>
<td style="text-align: left;">College</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Post-graduate degree</td>
<td style="text-align: left;">College</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">Some graduate work</td>
<td style="text-align: left;">College</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">Four years college or got degree</td>
<td style="text-align: left;">College</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">At least one year college but no degree</td>
<td style="text-align: left;">College</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">Post-graduate degree</td>
<td style="text-align: left;">College</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">9,10, or 11th grade</td>
<td style="text-align: left;">No College</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get number of patients in each category</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data_wide_2<span class="sc">$</span>EDUC_COLLEGE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
No College    College 
       125        425 </code></pre>
</div>
</div>
<p>Looks good, we have 125 patients with no college, and 425 with at least some college.</p>
<p><a href="#Variable_Creation">Top of Tabset</a></p>
</div>
</div>
</div>
</section>
<section id="Descriptives" class="level1">
<h1>Descriptive Statistics</h1>
<p>Here we will acquire the descriptive statistics of our data set and create Table 1. Code modified from <a href="https://cran.r-project.org/web/packages/table1/vignettes/table1-examples.html">cran.r-project.org</a></p>
<p>Please note: These descriptive statistics are based on the cleaned data set, and will be different from the original data (e.g.&nbsp;<code>income</code> values of “Do not wish to answer” have been recoded as missing values).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create labels for variables to make the names of each variable more professional in outputs</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>AGG_MENT_0) <span class="ot">&lt;-</span> <span class="st">"Aggregate Mental QOL Score"</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>AGG_PHYS_0) <span class="ot">&lt;-</span> <span class="st">"Aggregate Physical QOL Score"</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>HASHF_0) <span class="ot">&lt;-</span> <span class="st">"Hash/Marijuana Use"</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>HASHV_0) <span class="ot">&lt;-</span> <span class="st">"Frequency of Hash/Marijuana Use"</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>income_0) <span class="ot">&lt;-</span> <span class="st">"Income"</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>HBP_0) <span class="ot">&lt;-</span> <span class="st">"High Blood Pressure"</span></span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>DIAB_0) <span class="ot">&lt;-</span> <span class="st">"Diabetes"</span></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>LIV34_0) <span class="ot">&lt;-</span> <span class="st">"Liver Disease Stage 3/4"</span></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>KID_0) <span class="ot">&lt;-</span><span class="st">"Kidney Disease"</span></span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>FRP_0) <span class="ot">&lt;-</span> <span class="st">"Frailty Related Phenotype"</span></span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>FP_0) <span class="ot">&lt;-</span> <span class="st">"Fraily Phenotype"</span></span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>BMI_0) <span class="ot">&lt;-</span> <span class="st">"BMI"</span></span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>TCHOL_0) <span class="ot">&lt;-</span> <span class="st">"Total Cholesterol"</span></span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>TRIG_0) <span class="ot">&lt;-</span> <span class="st">"Triglycerides"</span></span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>LDL_0) <span class="ot">&lt;-</span> <span class="st">"LDL"</span></span>
<span id="cb174-17"><a href="#cb174-17" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>DYSLIP_0) <span class="sc">&lt;</span> <span class="st">"Dyslipidemia"</span></span>
<span id="cb174-18"><a href="#cb174-18" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>SMOKE_0) <span class="sc">&lt;</span> <span class="st">"Smoking Status"</span></span>
<span id="cb174-19"><a href="#cb174-19" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>CESD_0) <span class="ot">&lt;-</span> <span class="st">"CESD Depression Score"</span></span>
<span id="cb174-20"><a href="#cb174-20" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>SMOKE_0) <span class="sc">&lt;</span> <span class="st">"Smoking Status"</span></span>
<span id="cb174-21"><a href="#cb174-21" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>DKGRP_0) <span class="ot">&lt;-</span> <span class="st">"Drinking Group"</span></span>
<span id="cb174-22"><a href="#cb174-22" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>HEROPIATE_0) <span class="ot">&lt;-</span> <span class="st">"Heroin or Opiate Use"</span></span>
<span id="cb174-23"><a href="#cb174-23" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>IDU_0) <span class="ot">&lt;-</span> <span class="st">"Intravenous Drug Usage"</span></span>
<span id="cb174-24"><a href="#cb174-24" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>LEU3N_0) <span class="ot">&lt;-</span> <span class="st">"CD4+ T Cell Count"</span></span>
<span id="cb174-25"><a href="#cb174-25" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>VLOAD_log_0) <span class="ot">&lt;-</span> <span class="st">"Log Viral Load"</span></span>
<span id="cb174-26"><a href="#cb174-26" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>ADH_1) <span class="ot">&lt;-</span> <span class="st">"Adherence to Treatment Regimen at Year 1"</span></span>
<span id="cb174-27"><a href="#cb174-27" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>ADH_2) <span class="ot">&lt;-</span> <span class="st">"Adherence to Treatment Regimen at Year 2"</span></span>
<span id="cb174-28"><a href="#cb174-28" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>RACE_0) <span class="ot">&lt;-</span> <span class="st">"Race"</span></span>
<span id="cb174-29"><a href="#cb174-29" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>EDUCBAS_0) <span class="ot">&lt;-</span> <span class="st">"Education at Baseline"</span></span>
<span id="cb174-30"><a href="#cb174-30" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>hivpos_0) <span class="ot">&lt;-</span> <span class="st">"HIV Serostatus"</span></span>
<span id="cb174-31"><a href="#cb174-31" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>age_0) <span class="ot">&lt;-</span> <span class="st">"Age"</span></span>
<span id="cb174-32"><a href="#cb174-32" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>ART_0) <span class="ot">&lt;-</span> <span class="st">"Antiretroviral Therapy"</span></span>
<span id="cb174-33"><a href="#cb174-33" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>hard_drugs_0) <span class="ot">&lt;-</span> <span class="st">"Hard Drug Usage"</span></span>
<span id="cb174-34"><a href="#cb174-34" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>AGG_MENT_CHANGE) <span class="ot">&lt;-</span> <span class="st">"Aggregate Mental QOL Change Score"</span></span>
<span id="cb174-35"><a href="#cb174-35" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>AGG_PHYS_CHANGE) <span class="ot">&lt;-</span> <span class="st">"Aggregate Physical QOL Change Score"</span></span>
<span id="cb174-36"><a href="#cb174-36" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>VLOAD_log_CHANGE) <span class="ot">&lt;-</span> <span class="st">"Log Viral Load Change Score"</span></span>
<span id="cb174-37"><a href="#cb174-37" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(data_wide_2<span class="sc">$</span>LEU3N_CHANGE) <span class="ot">&lt;-</span> <span class="st">"CD4+ T Cell Count Change Score"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Table 1 for the wideform data set,stratified by adherence group</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> <span class="fu">table1</span>(<span class="sc">~</span>AGG_MENT_0 <span class="sc">+</span> AGG_PHYS_0 <span class="sc">+</span>  HASHV_0 <span class="sc">+</span> HASHF_0 <span class="sc">+</span> income_0 <span class="sc">+</span> BMI_0 <span class="sc">+</span> HBP_0 <span class="sc">+</span> DIAB_0 <span class="sc">+</span> LIV34_0 <span class="sc">+</span> KID_0 <span class="sc">+</span> FRP_0 <span class="sc">+</span> FP_0 <span class="sc">+</span> TCHOL_0 <span class="sc">+</span> TRIG_0 <span class="sc">+</span> LDL_0 <span class="sc">+</span> DYSLIP_0 <span class="sc">+</span> CESD_0 <span class="sc">+</span> SMOKE_0 <span class="sc">+</span> DKGRP_0 <span class="sc">+</span> HEROPIATE_0 <span class="sc">+</span> IDU_0 <span class="sc">+</span> LEU3N_0 <span class="sc">+</span>  VLOAD_log_0 <span class="sc">+</span> ADH_1 <span class="sc">+</span> ADH_2 <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span>  RACE_WHITEYN <span class="sc">+</span> EDUC_COLLEGE <span class="sc">+</span> age_0 <span class="sc">+</span> AGG_MENT_CHANGE <span class="sc">+</span> AGG_PHYS_CHANGE <span class="sc">+</span> VLOAD_log_CHANGE <span class="sc">+</span> LEU3N_CHANGE <span class="sc">+</span> hard_drugs_grp <span class="sc">|</span> ADH_2, <span class="at">data =</span> data_wide_2, <span class="at">caption =</span> <span class="st">"Descriptive Statistics at Baseline"</span>, <span class="at">overall =</span> <span class="fu">c</span>(<span class="at">left=</span><span class="st">"Total"</span>))</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="Rtable1">
<table class="Rtable1 caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Descriptive Statistics at Baseline</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th class="rowlabel firstrow lastrow" data-quarto-table-cell-role="th"></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">Total<br>
<span class="stratn">(N=550)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">100%<br>
<span class="stratn">(N=228)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">95-99%<br>
<span class="stratn">(N=267)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">75-94%<br>
<span class="stratn">(N=43)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">&lt;75%<br>
<span class="stratn">(N=12)</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowlabel firstrow">Aggregate Mental QOL Score</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>45.2 (13.4)</td>
<td>46.4 (12.8)</td>
<td>44.0 (14.1)</td>
<td>44.6 (11.7)</td>
<td>50.6 (13.5)</td>
</tr>
<tr class="odd">
<td class="rowlabel">Median [Min, Max]</td>
<td>48.6 [7.23, 69.8]</td>
<td>49.5 [7.23, 69.8]</td>
<td>48.1 [9.85, 63.3]</td>
<td>43.9 [15.4, 63.5]</td>
<td>51.7 [14.5, 69.5]</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">1 (0.2%)</td>
<td class="lastrow">1 (0.4%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Aggregate Physical QOL Score</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>50.8 (9.15)</td>
<td>50.2 (9.11)</td>
<td>51.3 (9.38)</td>
<td>52.7 (7.20)</td>
<td>45.5 (8.92)</td>
</tr>
<tr class="odd">
<td class="rowlabel">Median [Min, Max]</td>
<td>53.2 [19.2, 69.7]</td>
<td>52.9 [19.2, 69.0]</td>
<td>53.6 [20.4, 69.7]</td>
<td>54.2 [37.6, 65.6]</td>
<td>46.4 [24.5, 59.1]</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">1 (0.2%)</td>
<td class="lastrow">1 (0.4%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Frequency of Hash/Marijuana Use</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">No</td>
<td>329 (59.8%)</td>
<td>135 (59.2%)</td>
<td>157 (58.8%)</td>
<td>30 (69.8%)</td>
<td>7 (58.3%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Yes</td>
<td class="lastrow">221 (40.2%)</td>
<td class="lastrow">93 (40.8%)</td>
<td class="lastrow">110 (41.2%)</td>
<td class="lastrow">13 (30.2%)</td>
<td class="lastrow">5 (41.7%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Hash/Marijuana Use</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Never</td>
<td>281 (51.1%)</td>
<td>112 (49.1%)</td>
<td>127 (47.6%)</td>
<td>36 (83.7%)</td>
<td>6 (50.0%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Daily</td>
<td>43 (7.8%)</td>
<td>22 (9.6%)</td>
<td>18 (6.7%)</td>
<td>2 (4.7%)</td>
<td>1 (8.3%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">Weekly</td>
<td>67 (12.2%)</td>
<td>24 (10.5%)</td>
<td>38 (14.2%)</td>
<td>1 (2.3%)</td>
<td>4 (33.3%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Monthly</td>
<td>46 (8.4%)</td>
<td>19 (8.3%)</td>
<td>24 (9.0%)</td>
<td>3 (7.0%)</td>
<td>0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">Less Often</td>
<td>71 (12.9%)</td>
<td>32 (14.0%)</td>
<td>38 (14.2%)</td>
<td>1 (2.3%)</td>
<td>0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">42 (7.6%)</td>
<td class="lastrow">19 (8.3%)</td>
<td class="lastrow">22 (8.2%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">1 (8.3%)</td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Income</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Less than $10,000</td>
<td>91 (16.5%)</td>
<td>39 (17.1%)</td>
<td>41 (15.4%)</td>
<td>5 (11.6%)</td>
<td>6 (50.0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">$10,000-$19,999</td>
<td>52 (9.5%)</td>
<td>15 (6.6%)</td>
<td>29 (10.9%)</td>
<td>8 (18.6%)</td>
<td>0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel">$20,000-$29,999</td>
<td>63 (11.5%)</td>
<td>23 (10.1%)</td>
<td>31 (11.6%)</td>
<td>9 (20.9%)</td>
<td>0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">$30,000-$39,999</td>
<td>60 (10.9%)</td>
<td>22 (9.6%)</td>
<td>31 (11.6%)</td>
<td>5 (11.6%)</td>
<td>2 (16.7%)</td>
</tr>
<tr class="even">
<td class="rowlabel">$40,000-$49,999</td>
<td>41 (7.5%)</td>
<td>20 (8.8%)</td>
<td>17 (6.4%)</td>
<td>3 (7.0%)</td>
<td>1 (8.3%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">$50,000-$59,999</td>
<td>72 (13.1%)</td>
<td>33 (14.5%)</td>
<td>33 (12.4%)</td>
<td>5 (11.6%)</td>
<td>1 (8.3%)</td>
</tr>
<tr class="even">
<td class="rowlabel">$60,000 or more</td>
<td>29 (5.3%)</td>
<td>18 (7.9%)</td>
<td>9 (3.4%)</td>
<td>2 (4.7%)</td>
<td>0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">142 (25.8%)</td>
<td class="lastrow">58 (25.4%)</td>
<td class="lastrow">76 (28.5%)</td>
<td class="lastrow">6 (14.0%)</td>
<td class="lastrow">2 (16.7%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">BMI</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Mean (SD)</td>
<td>25.0 (3.98)</td>
<td>25.5 (3.93)</td>
<td>24.8 (4.11)</td>
<td>24.0 (3.32)</td>
<td>24.8 (2.72)</td>
</tr>
<tr class="even">
<td class="rowlabel">Median [Min, Max]</td>
<td>24.5 [16.5, 38.7]</td>
<td>24.9 [16.5, 38.4]</td>
<td>24.1 [17.5, 38.7]</td>
<td>23.8 [18.6, 35.4]</td>
<td>25.3 [19.1, 29.5]</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">18 (3.3%)</td>
<td class="lastrow">7 (3.1%)</td>
<td class="lastrow">5 (1.9%)</td>
<td class="lastrow">6 (14.0%)</td>
<td class="lastrow">0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">High Blood Pressure</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">No</td>
<td>375 (68.2%)</td>
<td>140 (61.4%)</td>
<td>199 (74.5%)</td>
<td>28 (65.1%)</td>
<td>8 (66.7%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Yes</td>
<td>121 (22.0%)</td>
<td>62 (27.2%)</td>
<td>42 (15.7%)</td>
<td>13 (30.2%)</td>
<td>4 (33.3%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">No, based on data trajectory</td>
<td>5 (0.9%)</td>
<td>4 (1.8%)</td>
<td>1 (0.4%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Yes, based on data trajectory</td>
<td>1 (0.2%)</td>
<td>1 (0.4%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">48 (8.7%)</td>
<td class="lastrow">21 (9.2%)</td>
<td class="lastrow">25 (9.4%)</td>
<td class="lastrow">2 (4.7%)</td>
<td class="lastrow">0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Diabetes</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">No</td>
<td>201 (36.5%)</td>
<td>96 (42.1%)</td>
<td>87 (32.6%)</td>
<td>13 (30.2%)</td>
<td>5 (41.7%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Yes</td>
<td>20 (3.6%)</td>
<td>6 (2.6%)</td>
<td>5 (1.9%)</td>
<td>9 (20.9%)</td>
<td>0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">No, based on data trajectory</td>
<td>29 (5.3%)</td>
<td>15 (6.6%)</td>
<td>13 (4.9%)</td>
<td>0 (0%)</td>
<td>1 (8.3%)</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">300 (54.5%)</td>
<td class="lastrow">111 (48.7%)</td>
<td class="lastrow">162 (60.7%)</td>
<td class="lastrow">21 (48.8%)</td>
<td class="lastrow">6 (50.0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Liver Disease Stage 3/4</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">No</td>
<td>359 (65.3%)</td>
<td>153 (67.1%)</td>
<td>171 (64.0%)</td>
<td>28 (65.1%)</td>
<td>7 (58.3%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">Yes</td>
<td>24 (4.4%)</td>
<td>8 (3.5%)</td>
<td>14 (5.2%)</td>
<td>2 (4.7%)</td>
<td>0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">167 (30.4%)</td>
<td class="lastrow">67 (29.4%)</td>
<td class="lastrow">82 (30.7%)</td>
<td class="lastrow">13 (30.2%)</td>
<td class="lastrow">5 (41.7%)</td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Kidney Disease</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">No</td>
<td>138 (25.1%)</td>
<td>57 (25.0%)</td>
<td>69 (25.8%)</td>
<td>9 (20.9%)</td>
<td>3 (25.0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">Yes</td>
<td>29 (5.3%)</td>
<td>8 (3.5%)</td>
<td>16 (6.0%)</td>
<td>5 (11.6%)</td>
<td>0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel">No, based on data trajectory</td>
<td>8 (1.5%)</td>
<td>4 (1.8%)</td>
<td>4 (1.5%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">375 (68.2%)</td>
<td class="lastrow">159 (69.7%)</td>
<td class="lastrow">178 (66.7%)</td>
<td class="lastrow">29 (67.4%)</td>
<td class="lastrow">9 (75.0%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Frailty Related Phenotype</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">No</td>
<td>524 (95.3%)</td>
<td>217 (95.2%)</td>
<td>254 (95.1%)</td>
<td>43 (100%)</td>
<td>10 (83.3%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Yes</td>
<td>25 (4.5%)</td>
<td>10 (4.4%)</td>
<td>13 (4.9%)</td>
<td>0 (0%)</td>
<td>2 (16.7%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">1 (0.2%)</td>
<td class="lastrow">1 (0.4%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Fraily Phenotype</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">No</td>
<td>408 (74.2%)</td>
<td>167 (73.2%)</td>
<td>199 (74.5%)</td>
<td>36 (83.7%)</td>
<td>6 (50.0%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Yes</td>
<td>19 (3.5%)</td>
<td>4 (1.8%)</td>
<td>15 (5.6%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">123 (22.4%)</td>
<td class="lastrow">57 (25.0%)</td>
<td class="lastrow">53 (19.9%)</td>
<td class="lastrow">7 (16.3%)</td>
<td class="lastrow">6 (50.0%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Total Cholesterol</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Mean (SD)</td>
<td>167 (37.4)</td>
<td>168 (36.7)</td>
<td>166 (39.2)</td>
<td>161 (33.5)</td>
<td>172 (25.0)</td>
</tr>
<tr class="even">
<td class="rowlabel">Median [Min, Max]</td>
<td>165 [58.0, 288]</td>
<td>166 [97.0, 288]</td>
<td>161 [58.0, 264]</td>
<td>153 [98.0, 220]</td>
<td>185 [136, 205]</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">175 (31.8%)</td>
<td class="lastrow">63 (27.6%)</td>
<td class="lastrow">94 (35.2%)</td>
<td class="lastrow">13 (30.2%)</td>
<td class="lastrow">5 (41.7%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Triglycerides</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Mean (SD)</td>
<td>158 (155)</td>
<td>164 (173)</td>
<td>164 (152)</td>
<td>101 (47.5)</td>
<td>113 (15.0)</td>
</tr>
<tr class="even">
<td class="rowlabel">Median [Min, Max]</td>
<td>120 [33.0, 1260]</td>
<td>124 [38.0, 1260]</td>
<td>122 [33.0, 1220]</td>
<td>83.0 [47.0, 264]</td>
<td>123 [89.0, 123]</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">287 (52.2%)</td>
<td class="lastrow">109 (47.8%)</td>
<td class="lastrow">151 (56.6%)</td>
<td class="lastrow">21 (48.8%)</td>
<td class="lastrow">6 (50.0%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">LDL</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Mean (SD)</td>
<td>102 (61.0)</td>
<td>107 (84.4)</td>
<td>98.5 (34.8)</td>
<td>98.4 (23.8)</td>
<td>110 (16.9)</td>
</tr>
<tr class="even">
<td class="rowlabel">Median [Min, Max]</td>
<td>96.0 [5.00, 704]</td>
<td>94.0 [41.0, 704]</td>
<td>94.5 [5.00, 174]</td>
<td>92.0 [66.0, 149]</td>
<td>111 [84.0, 137]</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">274 (49.8%)</td>
<td class="lastrow">107 (46.9%)</td>
<td class="lastrow">143 (53.6%)</td>
<td class="lastrow">18 (41.9%)</td>
<td class="lastrow">6 (50.0%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">DYSLIP_0</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">No</td>
<td>89 (16.2%)</td>
<td>37 (16.2%)</td>
<td>36 (13.5%)</td>
<td>12 (27.9%)</td>
<td>4 (33.3%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Yes</td>
<td>225 (40.9%)</td>
<td>112 (49.1%)</td>
<td>97 (36.3%)</td>
<td>13 (30.2%)</td>
<td>3 (25.0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">No, based on data trajectory</td>
<td>5 (0.9%)</td>
<td>3 (1.3%)</td>
<td>2 (0.7%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Yes, based on data trajectory</td>
<td>5 (0.9%)</td>
<td>3 (1.3%)</td>
<td>2 (0.7%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">226 (41.1%)</td>
<td class="lastrow">73 (32.0%)</td>
<td class="lastrow">130 (48.7%)</td>
<td class="lastrow">18 (41.9%)</td>
<td class="lastrow">5 (41.7%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">CESD Depression Score</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Mean (SD)</td>
<td>14.3 (11.6)</td>
<td>13.2 (11.5)</td>
<td>15.0 (11.8)</td>
<td>15.5 (10.8)</td>
<td>14.4 (12.6)</td>
</tr>
<tr class="even">
<td class="rowlabel">Median [Min, Max]</td>
<td>11.0 [0, 51.0]</td>
<td>10.0 [0, 51.0]</td>
<td>12.0 [0, 48.0]</td>
<td>16.0 [0, 33.0]</td>
<td>14.0 [0, 44.0]</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">16 (2.9%)</td>
<td class="lastrow">4 (1.8%)</td>
<td class="lastrow">9 (3.4%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">3 (25.0%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">SMOKE_0</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Never Smoked</td>
<td>143 (26.0%)</td>
<td>48 (21.1%)</td>
<td>81 (30.3%)</td>
<td>9 (20.9%)</td>
<td>5 (41.7%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Former Smoker</td>
<td>180 (32.7%)</td>
<td>77 (33.8%)</td>
<td>90 (33.7%)</td>
<td>11 (25.6%)</td>
<td>2 (16.7%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Current Smoker</td>
<td class="lastrow">227 (41.3%)</td>
<td class="lastrow">103 (45.2%)</td>
<td class="lastrow">96 (36.0%)</td>
<td class="lastrow">23 (53.5%)</td>
<td class="lastrow">5 (41.7%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Drinking Group</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">None</td>
<td>129 (23.5%)</td>
<td>53 (23.2%)</td>
<td>62 (23.2%)</td>
<td>10 (23.3%)</td>
<td>4 (33.3%)</td>
</tr>
<tr class="even">
<td class="rowlabel">1-3 drinks/week</td>
<td>267 (48.5%)</td>
<td>115 (50.4%)</td>
<td>126 (47.2%)</td>
<td>22 (51.2%)</td>
<td>4 (33.3%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">4-13 drinks/week</td>
<td>116 (21.1%)</td>
<td>47 (20.6%)</td>
<td>60 (22.5%)</td>
<td>6 (14.0%)</td>
<td>3 (25.0%)</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">&gt;13 drinks/week</td>
<td class="lastrow">38 (6.9%)</td>
<td class="lastrow">13 (5.7%)</td>
<td class="lastrow">19 (7.1%)</td>
<td class="lastrow">5 (11.6%)</td>
<td class="lastrow">1 (8.3%)</td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Heroin or Opiate Use</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">No</td>
<td>501 (91.1%)</td>
<td>211 (92.5%)</td>
<td>238 (89.1%)</td>
<td>41 (95.3%)</td>
<td>11 (91.7%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">Yes</td>
<td>24 (4.4%)</td>
<td>8 (3.5%)</td>
<td>14 (5.2%)</td>
<td>2 (4.7%)</td>
<td>0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">25 (4.5%)</td>
<td class="lastrow">9 (3.9%)</td>
<td class="lastrow">15 (5.6%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">1 (8.3%)</td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Intravenous Drug Usage</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">No</td>
<td>484 (88.0%)</td>
<td>194 (85.1%)</td>
<td>235 (88.0%)</td>
<td>43 (100%)</td>
<td>12 (100%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Yes</td>
<td class="lastrow">66 (12.0%)</td>
<td class="lastrow">34 (14.9%)</td>
<td class="lastrow">32 (12.0%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">CD4+ T Cell Count</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Mean (SD)</td>
<td>381 (204)</td>
<td>371 (206)</td>
<td>395 (206)</td>
<td>363 (190)</td>
<td>343 (181)</td>
</tr>
<tr class="even">
<td class="rowlabel">Median [Min, Max]</td>
<td>363 [10.9, 1220]</td>
<td>350 [10.9, 1070]</td>
<td>397 [10.9, 1220]</td>
<td>341 [90.9, 1020]</td>
<td>363 [21.9, 553]</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">8 (1.5%)</td>
<td class="lastrow">2 (0.9%)</td>
<td class="lastrow">6 (2.2%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Log Viral Load</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Mean (SD)</td>
<td>10.4 (2.09)</td>
<td>10.1 (2.18)</td>
<td>10.7 (1.99)</td>
<td>9.73 (1.75)</td>
<td>10.5 (2.91)</td>
</tr>
<tr class="even">
<td class="rowlabel">Median [Min, Max]</td>
<td>10.3 [0.546, 19.1]</td>
<td>10.3 [0.546, 18.2]</td>
<td>10.3 [3.30, 19.1]</td>
<td>9.73 [7.00, 13.2]</td>
<td>11.0 [2.20, 13.6]</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">9 (1.6%)</td>
<td class="lastrow">2 (0.9%)</td>
<td class="lastrow">7 (2.6%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Adherence to Treatment Regimen at Year 1</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">100%</td>
<td>275 (50.0%)</td>
<td>161 (70.6%)</td>
<td>95 (35.6%)</td>
<td>16 (37.2%)</td>
<td>3 (25.0%)</td>
</tr>
<tr class="even">
<td class="rowlabel">95-99%</td>
<td>207 (37.6%)</td>
<td>59 (25.9%)</td>
<td>134 (50.2%)</td>
<td>8 (18.6%)</td>
<td>6 (50.0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">75-94%</td>
<td>59 (10.7%)</td>
<td>7 (3.1%)</td>
<td>34 (12.7%)</td>
<td>17 (39.5%)</td>
<td>1 (8.3%)</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">&lt;75%</td>
<td class="lastrow">9 (1.6%)</td>
<td class="lastrow">1 (0.4%)</td>
<td class="lastrow">4 (1.5%)</td>
<td class="lastrow">2 (4.7%)</td>
<td class="lastrow">2 (16.7%)</td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Adherence to Treatment Regimen at Year 2</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">100%</td>
<td>228 (41.5%)</td>
<td>228 (100%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">95-99%</td>
<td>267 (48.5%)</td>
<td>0 (0%)</td>
<td>267 (100%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel">75-94%</td>
<td>43 (7.8%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>43 (100%)</td>
<td>0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">&lt;75%</td>
<td class="lastrow">12 (2.2%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">12 (100%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">ADH_HIGHVSLOW</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Low Adherence</td>
<td>43 (7.8%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>43 (100%)</td>
<td>0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel">High Adherence</td>
<td>495 (90.0%)</td>
<td>228 (100%)</td>
<td>267 (100%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">12 (2.2%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">12 (100%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Race</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Non-White</td>
<td>186 (33.8%)</td>
<td>79 (34.6%)</td>
<td>77 (28.8%)</td>
<td>28 (65.1%)</td>
<td>2 (16.7%)</td>
</tr>
<tr class="even">
<td class="rowlabel">White</td>
<td>340 (61.8%)</td>
<td>142 (62.3%)</td>
<td>176 (65.9%)</td>
<td>15 (34.9%)</td>
<td>7 (58.3%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">24 (4.4%)</td>
<td class="lastrow">7 (3.1%)</td>
<td class="lastrow">14 (5.2%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">3 (25.0%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">College Status</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">No College</td>
<td>125 (22.7%)</td>
<td>57 (25.0%)</td>
<td>52 (19.5%)</td>
<td>10 (23.3%)</td>
<td>6 (50.0%)</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">College</td>
<td class="lastrow">425 (77.3%)</td>
<td class="lastrow">171 (75.0%)</td>
<td class="lastrow">215 (80.5%)</td>
<td class="lastrow">33 (76.7%)</td>
<td class="lastrow">6 (50.0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Age</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>43.4 (8.80)</td>
<td>45.2 (9.05)</td>
<td>42.0 (8.53)</td>
<td>44.1 (8.13)</td>
<td>39.9 (5.88)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Median [Min, Max]</td>
<td class="lastrow">43.0 [20.0, 73.0]</td>
<td class="lastrow">45.0 [24.0, 73.0]</td>
<td class="lastrow">42.0 [20.0, 65.0]</td>
<td class="lastrow">45.0 [24.0, 61.0]</td>
<td class="lastrow">38.5 [31.0, 52.0]</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Aggregate Mental QOL Change Score</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Mean (SD)</td>
<td>2.13 (12.3)</td>
<td>3.49 (10.9)</td>
<td>1.65 (13.2)</td>
<td>-2.29 (11.9)</td>
<td>3.20 (14.0)</td>
</tr>
<tr class="even">
<td class="rowlabel">Median [Min, Max]</td>
<td>1.31 [-38.2, 41.1]</td>
<td>2.13 [-23.3, 38.3]</td>
<td>1.07 [-33.4, 41.1]</td>
<td>-0.229 [-38.2, 23.0]</td>
<td>0.362 [-15.8, 38.2]</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">7 (1.3%)</td>
<td class="lastrow">2 (0.9%)</td>
<td class="lastrow">4 (1.5%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">1 (8.3%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Aggregate Physical QOL Change Score</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Mean (SD)</td>
<td>-1.86 (8.51)</td>
<td>-2.63 (9.18)</td>
<td>-0.501 (7.88)</td>
<td>-6.29 (7.48)</td>
<td>-1.41 (5.02)</td>
</tr>
<tr class="even">
<td class="rowlabel">Median [Min, Max]</td>
<td>-1.54 [-37.7, 32.1]</td>
<td>-1.92 [-37.7, 32.1]</td>
<td>-0.714 [-23.0, 28.8]</td>
<td>-7.17 [-19.4, 10.6]</td>
<td>-0.0956 [-10.7, 5.46]</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">7 (1.3%)</td>
<td class="lastrow">2 (0.9%)</td>
<td class="lastrow">4 (1.5%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">1 (8.3%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Log Viral Load Change Score</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Mean (SD)</td>
<td>-6.10 (2.87)</td>
<td>-6.20 (2.52)</td>
<td>-6.39 (2.83)</td>
<td>-4.44 (3.31)</td>
<td>-3.94 (4.93)</td>
</tr>
<tr class="even">
<td class="rowlabel">Median [Min, Max]</td>
<td>-6.35 [-12.8, 7.59]</td>
<td>-6.26 [-12.6, 1.86]</td>
<td>-6.66 [-12.8, 2.69]</td>
<td>-5.37 [-10.3, 1.21]</td>
<td>-5.98 [-11.5, 7.59]</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">18 (3.3%)</td>
<td class="lastrow">7 (3.1%)</td>
<td class="lastrow">10 (3.7%)</td>
<td class="lastrow">1 (2.3%)</td>
<td class="lastrow">0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">CD4+ T Cell Count Change Score</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Mean (SD)</td>
<td>161 (189)</td>
<td>134 (201)</td>
<td>188 (182)</td>
<td>119 (134)</td>
<td>210 (186)</td>
</tr>
<tr class="even">
<td class="rowlabel">Median [Min, Max]</td>
<td>169 [-510, 1270]</td>
<td>150 [-510, 626]</td>
<td>196 [-318, 1270]</td>
<td>111 [-112, 339]</td>
<td>256 [-37.1, 487]</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">18 (3.3%)</td>
<td class="lastrow">8 (3.5%)</td>
<td class="lastrow">10 (3.7%)</td>
<td class="lastrow">0 (0%)</td>
<td class="lastrow">0 (0%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Hard Drug Use Group</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Never User</td>
<td>444 (80.7%)</td>
<td>186 (81.6%)</td>
<td>213 (79.8%)</td>
<td>33 (76.7%)</td>
<td>12 (100%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Previous User</td>
<td>46 (8.4%)</td>
<td>26 (11.4%)</td>
<td>14 (5.2%)</td>
<td>6 (14.0%)</td>
<td>0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Current User</td>
<td class="lastrow">60 (10.9%)</td>
<td class="lastrow">16 (7.0%)</td>
<td class="lastrow">40 (15.0%)</td>
<td class="lastrow">4 (9.3%)</td>
<td class="lastrow">0 (0%)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="correlation-matrix" class="level1">
<h1>Correlation Matrix</h1>
<p>First we will begin by making a correlation matrix to assess whether any of our IVs are related to each other (multicollinearity). This will also inform which variables to incorporate into the final model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's clean our output by making a trimmed dataset excluding extaneous variables</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>data_for_matrix <span class="ot">&lt;-</span> <span class="fu">select</span>(data_2, <span class="sc">-</span>newid, <span class="sc">-</span>ART, <span class="sc">-</span>everART, <span class="sc">-</span>LEU3N_log, <span class="sc">-</span>LEU3N_yeojohnson, <span class="sc">-</span>LEU3N_boxcox, <span class="sc">-</span>LEU3N_orderNorm, <span class="sc">-</span> LEU3N_standard, <span class="sc">-</span>AGG_MENT_orderNorm, <span class="sc">-</span>AGG_MENT_orderNorm, <span class="sc">-</span>BMI_outlier, <span class="sc">-</span>CESD_sqrt, <span class="sc">-</span>hivpos, <span class="sc">-</span>AGG_PHYS_orderNorm, <span class="sc">-</span> LIV34)</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We factored our variables at the start. To make a correlation matrix we must reconvert those back to numeric</span></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>data_for_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(data_for_matrix, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.factor</span>(x)) <span class="fu">as.numeric</span>(x) <span class="cf">else</span> x))</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a correlation matrix with all variables of the trimmed data set</span></span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_for_matrix, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the matrix</span></span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(correlation_matrix, <span class="at">method =</span> <span class="st">"circle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There are a host of strong correlations in our data set.</p>
<section id="precision-variables" class="level3">
<h3 class="anchored" data-anchor-id="precision-variables">Precision Variables</h3>
<p><code>CESD</code> has a strong negative associated with <code>AGG_MENT</code>, which makes perfect sense. Those who are are more depressed will have lower mental health scores. <code>CESD</code> will have to be included as a precision variable for any analysis with <code>AGG_MENT</code> as the outcome variable.</p>
<p><code>FRP</code> and <code>FP</code> are strongly negatively associated with <code>AGG_PHYS</code>. This also makes perfect sense: Those who are frail will have lower overall physical health scores. They are both highly correlated though and essentially measure the same thing. One will have to be dropped.</p>
</section>
<section id="mutlicollinearity-issues" class="level3">
<h3 class="anchored" data-anchor-id="mutlicollinearity-issues">Mutlicollinearity Issues</h3>
<p><code>EDUCBASE</code> is strongly associated with <code>income</code>, <code>RACE</code>, <code>SMOKE</code>, and weakly correlated with <code>TCHOL</code>, <code>LDL</code>, and <code>VLOAD_log</code>.</p>
<p><code>Hard_drugs</code> is highly correlated with <code>HEROPIATE</code> and <code>IDU</code>, which makes perfect sense, as they are all basically the same thing.</p>
<p>We appear to have notable multicollinearity between <code>DYSLIP</code> and <code>TCHOL</code>, <code>LDL</code>, and <code>TRIG</code>. This makes sense because all these variables are highly related (dyslipidemia is abnormal levels of fats in the blood). This is interesting because these variables are where a lot of our missingness occured.</p>
<p>We also have some possible multicollinearity to be aware of between <code>KID</code>, <code>HBP</code>, and <code>DIAB</code>.</p>
<p>Let’s clean this up a bit and remove unneccessary variables.</p>
</section>
<section id="removing-superfluous-variables" class="level2">
<h2 class="anchored" data-anchor-id="removing-superfluous-variables">Removing Superfluous Variables</h2>
<p>We previously determined that <code>LDL</code>, <code>TRIG</code>, <code>DIAB</code>, <code>KID</code>, and <code>DYSLIP</code> had excessive missing values (&gt;40%).</p>
<p>Now that we have seen that they are not strongly related to the outcome variables, we can be assured that we can safely remove them with no need for imputation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop variables with excessive missing values from the wideform data set</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> data_2 <span class="sc">%&gt;%</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>LDL, <span class="sc">-</span>TRIG, <span class="sc">-</span>DIAB, <span class="sc">-</span>KID, <span class="sc">-</span>DYSLIP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>FRP</code> and <code>FP</code> are both precision variables for <code>AGG_PHYS</code>, but highly correlated to each other.</p>
<p><code>FP</code> has more missing values (22%) than <code>FRP</code>(~0%), and will thus be dropped.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop FP</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> data_2 <span class="sc">%&gt;%</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>FP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>EDUCBASE</code> is highly correlated with <code>income</code>, <code>TCHOL</code>, <code>SMOKE</code>, and <code>RACE</code>.</p>
<p><code>income</code> has 27% missing values and thus will be dropped from further analysis.</p>
<p><code>TCHOL</code> has 32% missing values and will thus be dropped.</p>
<p><code>SMOKE</code> and <code>RACE</code> will be dropped to avoid issues of multicollinearity, and <code>EDUCBASE</code> used as the covariate of choice.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop income, total cholesterol, smoke, and race</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> data_2 <span class="sc">%&gt;%</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>income, <span class="sc">-</span>TCHOL, <span class="sc">-</span>SMOKE, <span class="sc">-</span>RACE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>Hard_drugs</code> is highly correlated with <code>HEROPIATE</code> and <code>IDU</code>.</p>
<p><code>Hard_drugs</code> is our main independent variable of interest and thus we drop <code>HEROPIATE</code> and <code>IDU</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop income, total cholesterol, smoke, and race</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> data_2 <span class="sc">%&gt;%</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>HEROPIATE, <span class="sc">-</span>IDU)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>HBP</code> is lightly correlated with <code>age</code> and <code>BMI</code>. Let’s drop it to avoid multicollinearity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop high blood pressure.</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> data_2 <span class="sc">%&gt;%</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>HBP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="correlation-matrix-redux" class="level2">
<h2 class="anchored" data-anchor-id="correlation-matrix-redux">Correlation Matrix Redux</h2>
<p>Let’s take another look at that correlation matrix now that we have cleaned up our data set to remove variables with excessive missing values and issues of multicollinearity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's clean our output by making a trimmed dataset excluding extraneous variables</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>data_for_matrix <span class="ot">&lt;-</span> <span class="fu">select</span>(data_wide_2, AGG_MENT_CHANGE, AGG_PHYS_CHANGE, LEU3N_CHANGE, VLOAD_log_CHANGE, BMI_2, FRP_2, CESD_2, DKGRP_2, ADH_2, ADH_HIGHVSLOW, EDUC_COLLEGE, age_2, hard_drugs_grp)</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We factored our variables at the start. To make a correlation matrix we must reconvert those back to numeric</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>data_for_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(data_for_matrix, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.factor</span>(x)) <span class="fu">as.numeric</span>(x) <span class="cf">else</span> x))</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a correlation matrix with all variables of the trimmed data set</span></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_for_matrix, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the matrix</span></span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(correlation_matrix, <span class="at">method =</span> <span class="st">"circle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-121-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looking MUCH better! Here we can see some potentially strong relationships emerge.</p>
<ul>
<li><p><code>CESD</code> as mentioned will be included as a precision variable for <code>AGG_MENT</code></p></li>
<li><p><code>FRP</code> as mentioned will be included as a precision variable for <code>AGG_PHYS</code></p></li>
<li><p><code>EDUCBASE</code> looks like it will be a predictor for all outcome variables except <code>AGG_MENT</code></p></li>
<li><p><code>BMI</code> appears to have a weak correlation with all outcome variables and will likely be included in the final models.</p></li>
<li><p><code>age</code> also looks weakly correlated to all outcome variables except <code>VLOAD_log</code></p></li>
</ul>
<p>Let’s run some individual regression and assess these relationships more closely.</p>
<p>p-values of &lt; 0.1 will be considered for the final models.</p>
</section>
</section>
<section id="EDA" class="level1">
<h1>Interactive Variable Selection</h1>
<p>Here I will plot the data and perform a number of simple linear regressions to examine relationships between variables in order to determine which covariates to include in the model.</p>
<p>Remember that:</p>
<ul>
<li><p>For viral load, higher numbers are less desirable. Negative numbers signify a decrease in viral load over time, which is favorable.</p></li>
<li><p>For CD4+ T Cell count, higher numbers are more desirable. Negative numbers signify a decrease in leukocytes over time, and which is not favorable.</p></li>
<li><p>For aggregate mental and physical QOL score, higher numbers signify an increase in mental/physical health from baseline. Negative values signify a decrease.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Log Viral Load</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">CD4+ T Cell Count</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">Aggregate Mental QOL Change</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false">Aggregate Physical QOL Change</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>Let’s focus first on a model predicting Log Viral Load change.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">PEV - Hard Drug Use</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Adherence</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Adherence High vs Low</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">BMI</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" role="tab" aria-controls="tabset-6-5" aria-selected="false">College Education</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-6" role="tab" aria-controls="tabset-6-6" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Let’s begin by seeing if there appears to be a difference in log viral load change based on hard drug use, the primary explanatory variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of log viral load change by hard drug use group</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> hard_drugs_grp, <span class="at">y =</span> VLOAD_log_CHANGE, <span class="at">fill =</span> hard_drugs_grp)) <span class="sc">+</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Log Viral Load Change by Hard Drug Use Group"</span>,</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drug Use Group"</span>,</span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Log Viral Load Change"</span>) <span class="sc">+</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Hard Drug Use Group"</span>))</span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-fede012363575af4b37f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-fede012363575af4b37f">{"x":{"data":[{"x":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"y":[-8.880251716873909,-10.046822813143443,-7.7976472770017278,-5.3020603526147685,-9.8970669845450043,-5.0349493657471109,-9.4331895942655688,-3.0716397836196414,-7.1903530195067731,-6.2283055255457889,-5.1012769050813667,-5.9346507095254051,-6.4149923031450005,-3.4609732478024764,-7.4244906783007156,-8.3672337162074477,-9.0877610470911918,-8.1306502153137217,-5.7240136432225412,-5.8696802137937993,-9.390409393716844,-9.7440227778850996,-7.3166905495819545,-1.2185900265692808,-6.4863481964122007,null,-6.943583958061641,-0.86416752365779104,null,-5.7365722974791922,-10.208973933444895,null,-6.760616993547754,-5.3442104681919034,-7.2885094074478376,-10.978572915216239,-1.360911273677484,-1.2102270409582925,null,-2.6468751443520038,-6.9395389031573904,-6.3789393381815689,-7.2232956795623142,1.6464703896099264,-3.0101639310935253,-12.819976495077048,-5.9339041660852896,-7.7546134822602042,-6.6979597448723149,-6.4544120906295088,-8.2935395100077933,-7.9216372234896628,-7.7872855993379746,null,-7.0094760123717759,-4.2142146871476136,-6.0387937630183242,-8.5603758260033711,-9.0888988665586297,-10.295634232554216,-8.5450604842301967,-9.8238798692733695,-5.5768956247488548,-6.6438212809246311,-7.9858343877351379,-2.8636918937136313,-8.8908861405240653,-7.0875821439673565,-7.8088646885488169,-6.6840216344918915,-7.3403024562430641,0.075266558523210847,-6.0282785202306979,-0.77936321587174362,-10.252823129088098,-4.8385849136752288,-5.9646683153330731,-7.8932667351706947,-9.7844506060620571,-9.0884397801821173,-6.4388177479183994,-5.1036918541550609,-1.5613319024873782,-7.3641171743078431,-6.9916609610971641,-5.1529185993423914,7.5906717707256259,-7.0935232709421694,-10.670732883772994,-6.0590259090871168,-9.5198980849454031,-8.0143357371170456,-7.7456572195632116,-9.376166058969984,-5.5978241894865839,-6.7842083244525222,-6.8329290998598182,-6.1858422088040284,-8.9164389994798015,null,-9.4936660942987263,-6.3780644582173407,null,-10.727290118974054,-10.322444567115177,-6.2755606522941152,-6.4315861854509873,-8.8773819546547657,-1.108815672905104,-1.5920643574326299,-6.9584177292680929,-5.9856125272304181,-3.8282157438152451,-8.6730224617208389,-6.5942180136434203,-7.6530204136446702,-6.2241916582198584,-5.5919820036111272,-10.344252977181865,-9.9774414311854027,-7.2679021607972754,-6.5767227656567435,-8.371126415281454,-10.255596634226441,-6.9482106368157384,-6.200270510557071,-6.1627137136791816,0.79028345105091802,-0.64531974020172456,-0.39757599583222625,-10.489912179174006,-6.1278945320668949,-6.6380260284309216,-2.3095564214195505,-6.6628281862784249,-8.6189018296881663,-12.557284906493749,-8.6259202918273559,-9.4829101396593778,null,-6.1562916216493146,1.2399793253564235,0.17381433098669419,-6.9290274142576767,null,-6.0266069278059353,-6.0709435100831577,-6.4346059664790181,-6.2932744427827121,-6.1284493135159481,-5.7855331244916375,-6.1167376605381225,2.6877125258998236,-7.4669539915367267,-10.675462087141881,-3.3881965694849034,-4.3209230675362837,-7.2955089051805295,-3.8483729783516902,-3.8506974989100606,-7.9042914129180604,-6.4873034285656495,-7.0054263061555844,-9.0672779891343449,-1.6580556182086923,-9.7149307831899687,-5.0889182124902987,-6.4419979406178536,-6.5709669922302236,-9.9796744846033203,-10.565149225950112,-7.2816076490089499,-7.4280325653148864,-10.261341628454899,-5.1168553671471511,-4.8313181746808072,-1.2307159011196322,-8.5331102847749509,-5.7850132878285017,-5.2869926506541054,-8.4276747783322943,-5.9375414193168528,-1.3215273468932409,-8.766718983893373,-6.1553170464655285,-5.3887873809275266,-8.59955138359161,-9.8440692340931282,0.38253806678875257,-6.0686141630553552,-6.0052022758144439,-4.7377434229007394,-5.8607862234658654,-7.8887095241665053,-9.7811026830221497,-7.4831317356673557,-8.1839392997743126,-8.7472220752407921,-6.0011678268177855,0.83129751904076254,-7.1259045613879568,-1.7089959052698216,-4.4299453390931722,null,-11.47870154267398,null,-8.9039057873309719,-4.6671589300300722,null,-5.2337788454104652,-3.8657514061403262,-5.8533473220584913,-7.7150197808382943,-9.015098564193293,-6.5200941150431913,-7.4896043990798837,-10.823753705276431,-2.320066666513104,1.8607523407150066,-8.1184779786948944,-3.088409638510007,-6.3551766836461336,-7.9727218623706584,-7.8583774674960196,-10.014203079617417,1.5328782264151304,0.29059675026253196,-9.6771514103227538,-5.5957661562989358,-2.2008884919167517,-10.168447913722499,-1.7549985731827231,-5.449310893897108,-10.647684247771764,-5.8126700960901836,null,-7.3957055413311981,-8.3195692582577774,-8.8273214525722903,-8.8353092033113256,-5.3133599080808036,-6.534728888423456,null,-2.3402096507349697,-5.9808798805114005,-5.9115683988882122,-6.9136203983396776,-8.128816948101349,-4.6954678239688725,-5.2425820881770644,-6.2783874028562554,-5.7335523141466034,-5.9221792951206931,-10.667232981941609,-10.532229536403737,-6.3231363188740701,-9.358932776026009,-7.0206870601362805,-6.1892969029288594,-8.7745449140601846,-6.0042743878357809,-4.9835189384727627,-7.8204030192293192,-6.8973535419126861,-3.2019448180288057,-8.5242350062052843,-5.102357778593781,-10.538666579740848,null,-4.7999142625803461,-7.5194551199652437,-8.8692106393729127,-1.5523392161302239,-6.9577735673464618,-7.8755626136419989,-6.1915100470463837,-9.7731700374384118,-3.7640946641259569,-1.7115742001755301,-3.6362665026456629,-10.413489594008064,-9.4062891412166127,-1.2211324247967212,-7.2354132738503765,-8.9074369801747117,-8.4399233025915716,-2.4887349203681044,-3.8468514309204886,-8.7492251237758527,-8.1007465777642906,-7.9451302581790566,-5.2634713932910646,-3.9756652917339013,-5.9159324844512096,-1.689724790633262,-8.1507827285579726,-1.5813471968877995,-6.9482156912503665,-5.8896964479113105,1.5639755383573428,-10.766757182095056,-8.4907932130151202,-9.1200764384274002,-4.5983824957341586,-2.5212742939588746,-5.9842860655730545,-7.5558353561727731,-11.16407695728096,-6.1985926233748989,-7.894749698601645,-10.900491536449458,-7.5781966220064438,-3.6967813462392254,-4.9328847008241636,-6.3586072557915747,-6.1783251070043113,-6.6635866868620344,-8.6656747709934443,-5.1002868605492662,-7.6290038892626173,-4.6512355528313378,-8.2034865089210633,-6.2312342479837639,-8.0118072911289477,-8.0706099923240071,-1.368825499464938,-4.5992913556009833,-3.4202221821885876,-5.9961786341088423,-9.8096660260421906,-6.0384312132909574,-7.487131676524287,-7.2340053791068915,-4.220000136618264,-3.0465906907874816,-6.2569244859848219,-6.4559844179974615,-7.4162047485951916,-2.8170931306670646,-9.2761536484496325,-9.3351504864044283,-3.9785781254031569,-4.0567150158627365,-1.5923145322326206,-7.9510445724708791,-4.8552838937488101,-5.5204877635487701,-5.9967683194180665,-6.0552667999451284,-5.6090138146620543,-5.9082187985047145,-6.5366586589724189,-6.2308164559568242,-10.117431776637613,null,-8.7739417170980936,-9.4241215662134259,-6.0471672508083918,-5.9906427847544936,-5.1166507676361279,-1.7093192624385942,-6.0417237932248717,-8.0786208188014541,-6.7841176934117211,-7.2744218070485225,-4.1026843326928368,-6.3007857946632431,-5.1181252482069111,-6.0887298572397164,-10.05079316513185,-5.3674702252363531,-7.2686015109896811,-4.3307333402863311,-1.1085361266159559,-6.1656860106576081,-8.9611736357527363,-7.9447758116436065,-4.8410115600426034,-8.330033721260655,-3.8656394360096513,-2.1464510957109706,-5.2087572894628407,-8.2405848098115726,-8.6162146576875553,-7.9414088669253946,-5.6314487275915113,null,-9.2580530327167416,-10.309519166628519,-7.302143624578056,-8.4156428680652553,-6.725533717188517,-1.9328380674879604,-5.8948021644287305,-9.3434043476861302,-7.1327970275794268,-7.0177881952887233,-1.9339550579344387,-1.5918782737427843,-6.1463793070944917,-7.1915896996695352,-5.7659920741497128,-5.1135208746272003,-1.7089536301531112,-7.0788946269164725,-8.1383378064105329,-6.7796887664436829,-7.3390180799114422,-5.269574897682384,-5.0283442278770281,-5.1277759048687033,-5.9334304192863385,-10.088542549563275,-6.3919171133926014,-0.46984634585264118,-5.0368779616224018,-1.108904377361366,-6.3526070606819394,-7.8416988032355741,-7.7630921681859526,-4.8373919250972905,-5.6315816983631652,-8.9928572408023228,-4.2228887921233911,-6.4505919361667488,-3.5440303154321429,-7.805320669745587,-8.0014098438764716,-8.6483189149600896,null,-10.213579145316011,-0.70358650921211918,-0.52973532426064729,-8.1782751493484369,-6.8140438205415084,-1.9276070180127673,-6.9839558719146906,-8.1898381554132307,-3.9882396270175988,-6.9968402817251132,-5.9624516248702673,-1.5919360143527328,-5.7980600305788634,-5.5890256343427547],"hoverinfo":"y","type":"box","fillcolor":"rgba(179,226,205,0.5)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"Never User","legendgroup":"Never User","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"y":[-7.4385109729035142,-5.131007567374521,-10.9029146632829,-3.3108133201938861,-0.47837414990182658,-12.001526951951009,-6.433999940015263,-12.001545356294434,-7.4724027218589404,-0.47835967711390914,-6.620073206530356,0.03351772403776998,-6.8832576473817362,-6.455369453850988,-10.846243739717833,-0.47836528696875824,-7.5815235886023409,-4.288349735724541,-5.5057010168159319,0.011398954950745832,-3.8071914503750892,-7.5624950005136622,-10.497449555174734,-5.5033586622961561,-7.4057505576647413,-0.47836090458855551,-6.5225372958096663,-7.4385109729035142,-5.1519378314456654,-10.615229523407615,-5.3428657428091046,0.033037807231843352,-10.866862231914796,-3.7612001156935624,-5.4446415809713127,-12.694683334725006,-0.47836754570787221,-5.3423342519648109,-6.9521821965238377,-4.2878216131878411,0.012317927323547195,0.035362490282300207,-0.47837876546197577,-3.4698037050190518,-5.5679750683772999,0.034892249265875641],"hoverinfo":"y","type":"box","fillcolor":"rgba(253,205,172,0.5)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"Previous User","legendgroup":"Previous User","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"y":[-4.9610889394427922,-8.1166019012241879,-7.9555080349096716,-7.1749795095315214,-4.7011811800590921,-4.0026225699346911,-3.6299647209962576,-6.6942446687320354,-4.7086391023788066,-6.8520238384177805,-4.7379796031878829,-4.7219244368375657,-5.6845964796331643,-6.6638622236540179,-7.0735194632774565,-7.2237696737009536,-6.7466054515275617,-7.703338703682661,-7.1158528720910752,-5.0373668155626277,-8.1074790690186589,-5.8561872704121631,-6.5516516004116969,-4.0405750613537856,-5.0121836151477073,-4.7237872713443112,-3.6294301812600622,-4.9868399875094331,-6.9917407494433217,-6.9853951016881517,1.2116378959612533,-6.6358371883764269,-4.7061153607563773,-7.00033446027523,-3.8581963260714209,-4.006714038087857,-4.9799190683554242,-7.4634427678718307,-6.802331269245113,-3.8547656513243771,-7.9384633891228882,-5.8151250619915746,-3.6443821415561573,-8.4530172711976732,-4.0491147192474264,-5.0164478256409417,-7.925157512224704,-8.9191142490725746,-4.7237770626965654,-4.7429671446989223,-3.6371282600222372,-3.6324552116412159,-3.6524065483908306,-5.0074843471507071,-6.3510443587393448,-4.7078846700533212,-5.8034213899740328,-4.721917631431352,-5.2503004325974949,1.2109771441290835],"hoverinfo":"y","type":"box","fillcolor":"rgba(203,213,232,0.5)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"Current User","legendgroup":"Current User","showlegend":true,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Boxplot of Log Viral Load Change by Hard Drug Use Group","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,3.6000000000000001],"tickmode":"array","ticktext":["Never User","Previous User","Current User"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["Never User","Previous User","Current User"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Hard Drug Use Group","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-13.840508908367182,8.6112041840157598],"tickmode":"array","ticktext":["-10","-5","0","5"],"tickvals":[-10,-5,1.7763568394002505e-15,5.0000000000000018],"categoryorder":"array","categoryarray":["-10","-5","0","5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Log Viral Load Change","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Hard Drug Use Group","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"3d3838f83a25":{"x":{},"y":{},"fill":{},"type":"box"}},"cur_data":"3d3838f83a25","visdat":{"3d3838f83a25":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>There may be a difference between log viral load change and hard drug use group, especially between never users and previous users. Visually, it appears that that never use group had more of a decrease in log viral load over 2 years compared to the previous and current drug use groups.</p>
<p>Let’s run the regression to see if this relationship is statistically significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting log vload change by hard drug use group with never user as the reference group</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> hard_drugs_grp, <span class="at">data =</span> data_wide_2)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.3943 -1.8308 -0.1623  1.1985 13.8651 

Coefficients:
                            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)                  -6.2744     0.1381 -45.433 &lt;0.0000000000000002 ***
hard_drugs_grpPrevious User   0.9740     0.4424   2.202              0.0281 *  
hard_drugs_grpCurrent User    0.7866     0.3930   2.001              0.0459 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.85 on 529 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.01487,   Adjusted R-squared:  0.01114 
F-statistic: 3.991 on 2 and 529 DF,  p-value: 0.01903</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gather p-values of the model</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[,<span class="dv">4</span>] <span class="co"># This line selects the fourth column of the resulting coefficients table from summary(model), which is the p-values</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Bonferroni correction </span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare adjusted p-values to unadjusted p-values</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>p_comparison <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p_values, p_adjusted)</span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(p_comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_values</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">0.0281096</td>
<td style="text-align: right;">0.0843289</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">0.0458647</td>
<td style="text-align: right;">0.1375942</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Change the reference level to previous users and re-run the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to previous user</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting log vload change by hard drug use group, with previous users as the reference group</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> hard_drugs_grp, <span class="at">data =</span> data_wide_2)</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.3943 -1.8308 -0.1623  1.1985 13.8651 

Coefficients:
                           Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)                 -5.3004     0.4203 -12.612 &lt;0.0000000000000002 ***
hard_drugs_grpNever User    -0.9740     0.4424  -2.202              0.0281 *  
hard_drugs_grpCurrent User  -0.1874     0.5586  -0.335              0.7374    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.85 on 529 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.01487,   Adjusted R-squared:  0.01114 
F-statistic: 3.991 on 2 and 529 DF,  p-value: 0.01903</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Bonferroni correction</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[,<span class="dv">4</span>] <span class="co"># This line selects the fourth column of the resulting coefficients table from summary(model), which is the p-values</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Bonferroni correction </span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare adjusted p-values to unadjusted p-values</span></span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>p_comparison <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p_values, p_adjusted)</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(p_comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_values</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">0.0281096</td>
<td style="text-align: right;">0.0843289</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">0.7373866</td>
<td style="text-align: right;">1.0000000</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The overall model is significant (F<sub>(2,529)</sub>= 3.991, p = 0.01903). The group comparisons were not significant after applying Bonferroni correction however (all p-adjusted &gt; 0.05). They may be significant after including precision variables or confounders, and thus we continue with the analysis and include <code>hard_drugs_group</code> as the PEV.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>The researchers are interested in if treatment response between the drug use groups can be explained by differences in adherence to the HAART treatment regimen.</p>
<p>The first step toward investigating this is to examine if there is a relationship between adherence and treatment response, starting with log viral load change.</p>
<p>We can examine this by plotting the average log viral loads each year by adherence group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clear out that one participant that had an adherence value at year 0, which is a data entry error.</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>ADH[data_2<span class="sc">$</span>years <span class="sc">==</span> <span class="dv">0</span>]<span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get means for each year</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> data_2 <span class="sc">%&gt;%</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADH, years) <span class="sc">%&gt;%</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_VLOAD_log =</span> <span class="fu">mean</span>(VLOAD_log, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ADH'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> years, <span class="at">y =</span> Average_VLOAD_log, <span class="at">color =</span> ADH)) <span class="sc">+</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="co"># Line plot</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Add points for clarity</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Log Viral Load Change by Adherence Group Over 2 Years"</span>,</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Log Viral Load Change"</span>,</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Adherence Group"</span>) <span class="sc">+</span></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>       <span class="co"># Clean theme</span></span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)  <span class="co"># Nice color palette for groups</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-126-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Indeed we can see that, across the first 2 years of the study, as adherence decreased, average log viral load increased!</p>
<p>That is, groups with higher adherence had a smaller increase in log viral load over 2 years compared to those with lower adherence. This is evidence that the ART treatment is efficacious in reducing viral load!</p>
<p>Let’s examine that relationship with boxplots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of log viral load change by adherence group</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> ADH_2, <span class="at">y =</span> VLOAD_log_CHANGE, <span class="at">fill =</span> ADH_2)) <span class="sc">+</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Log Viral Load Change by Adherence at Year 2"</span>,</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Adherence at year 2"</span>,</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Log Viral Load Change"</span>) <span class="sc">+</span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Adherence Group"</span>))</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-61c23d6870aa0c76d5b7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-61c23d6870aa0c76d5b7">{"x":{"data":[{"x":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"y":[-7.4385109729035142,-5.131007567374521,-4.9799190683554242,-8.9164389994798015,-5.0074843471507071,1.2399793253564235,null,-7.4724027218589404,-8.5242350062052843,-6.0266069278059353,-10.309519166628519,-6.4346059664790181,-6.8832576473817362,-4.7219244368375657,-6.0052022758144439,-6.1167376605381225,-5.8607862234658654,-4.288349735724541,-10.846243739717833,-9.7731700374384118,-4.3209230675362837,-7.5624950005136622,-5.5057010168159319,-6.7466054515275617,-4.7011811800590921,-6.534728888423456,-7.2354132738503765,-9.0672779891343449,-1.6580556182086923,-5.0121836151477073,-6.5225372958096663,-4.7237872713443112,-6.5709669922302236,-5.9334304192863385,-5.3428657428091046,-8.2935395100077933,-7.4280325653148864,-7.4057505576647413,-5.4446415809713127,-5.0373668155626277,-6.7842083244525222,-4.2142146871476136,1.5639755383573428,-5.6315816983631652,-8.4907932130151202,-6.1562916216493146,-6.433999940015263,-4.7078846700533212,-5.9842860655730545,-7.5558353561727731,-3.7612001156935624,-6.1985926233748989,-7.894749698601645,-6.0686141630553552,-1.5920643574326299,-4.7377434229007394,-10.208973933444895,-3.8282157438152451,-6.1783251070043113,-10.252823129088098,-4.8385849136752288,-5.9646683153330731,-7.6290038892626173,-10.344252977181865,-5.0349493657471109,-7.7872855993379746,-6.943583958061641,null,-10.255596634226441,1.6464703896099264,-5.1529185993423914,-4.6671589300300722,-7.0935232709421694,-10.670732883772994,-3.8657514061403262,-7.3166905495819545,-8.0143357371170456,-7.7456572195632116,-9.376166058969984,-5.5978241894865839,-8.6189018296881663,-12.557284906493749,-9.0877610470911918,-9.4829101396593778,-9.0888988665586297,-3.088409638510007,-7.9727218623706584,-8.880251716873909,-5.5768956247488548,-10.322444567115177,-6.2755606522941152,-5.0164478256409417,-5.5957661562989358,-1.108815672905104,null,-7.7976472770017278,-3.6967813462392254,-4.9328847008241636,-8.6730224617208389,-6.5942180136434203,-7.2885094074478376,-6.2241916582198584,-3.4609732478024764,-5.9221792951206931,-10.046822813143443,-9.0884397801821173,null,-8.371126415281454,-6.9521821965238377,-6.9482106368157384,-3.0101639310935253,-6.1627137136791816,0.79028345105091802,-0.64531974020172456,-6.2783874028562554,-5.7335523141466034,-7.805320669745587,-6.1656860106576081,-4.7061153607563773,-8.8908861405240653,-6.3526070606819394,-6.4559844179974615,-6.8329290998598182,-4.2878216131878411,-6.0042743878357809,-5.2087572894628407,-7.8204030192293192,-7.9414088669253946,-3.2019448180288057,-3.8071914503750892,-5.102357778593781,-6.620073206530356,null,-4.7999142625803461,-6.455369453850988,-4.7086391023788066,-6.9584177292680929,-1.7549985731827231,-7.4669539915367267,-10.675462087141881,-7.4831317356673557,-8.6656747709934443,-6.4544120906295088,-3.9756652917339013,-5.9159324844512096,-9.9774414311854027,-8.2034865089210633,-4.4299453390931722,-8.9074369801747117,-8.4399233025915716,-2.4887349203681044,-5.0889182124902987,-6.4419979406178536,-8.1007465777642906,-6.0384312132909574,-8.766718983893373,-6.9290274142576767,-10.866862231914796,-10.261341628454899,-5.1168553671471511,-7.4896043990798837,-1.108904377361366,-6.5366586589724189,1.8607523407150066,-4.5992913556009833,-6.8140438205415084,-5.8126700960901836,-1.3215273468932409,-7.6530204136446702,-6.0471672508083918,-9.5198980849454031,-5.9967683194180665,-9.015098564193293,-5.6090138146620543,-5.9082187985047145,-8.0706099923240071,-1.368825499464938,-7.5815235886023409,-5.1181252482069111,-5.9961786341088423,-9.4241215662134259,-5.3674702252363531,-7.487131676524287,-5.6314487275915113,-1.1085361266159559,-8.0014098438764716,-5.3133599080808036,null,-8.1507827285579726,-6.725533717188517,-6.7841176934117211,-4.721917631431352,-7.3390180799114422,-5.1519378314456654,-6.1915100470463837,-6.4505919361667488,-5.5679750683772999,1.5328782264151304,-6.3919171133926014,-6.2569244859848219,-6.3231363188740701,-3.0465906907874816,-2.3402096507349697,-10.05079316513185,-7.2744218070485225,null,-7.1327970275794268,-3.5440303154321429,-8.1898381554132307,-4.7237770626965654,-4.3307333402863311,-5.2503004325974949,-5.5033586622961561,-5.1277759048687033,-6.0887298572397164,-8.128816948101349,-3.8468514309204886,-5.5204877635487701,-1.689724790633262,-2.5212742939588746,-10.565149225950112,-7.4385109729035142,-5.3423342519648109,-10.088542549563275,-6.3007857946632431,-6.9853951016881517,-5.0283442278770281,-9.8096660260421906],"hoverinfo":"y","type":"box","fillcolor":"rgba(179,226,205,0.5)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"100%","legendgroup":"100%","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"y":[-5.9375414193168528,-3.8547656513243771,-8.6259202918273559,-7.4634427678718307,-7.1903530195067731,-5.7850132878285017,-9.4936660942987263,-6.6942446687320354,-6.8520238384177805,-5.1012769050813667,-8.5603758260033711,-6.0282785202306979,-5.7365722974791922,-9.8440692340931282,-3.6299647209962576,null,-8.7745449140601846,-6.0387937630183242,-9.390409393716844,2.6877125258998236,-7.8932667351706947,-6.3551766836461336,-6.3510443587393448,-9.6771514103227538,-6.4388177479183994,-10.497449555174734,-1.2307159011196322,-7.0206870601362805,-3.8656394360096513,-5.9856125272304181,-0.47836754570787221,-4.9835189384727627,-3.8483729783516902,-7.2955089051805295,-9.7844506060620571,-1.2102270409582925,-1.7089959052698216,-6.0709435100831577,-7.925157512224704,-6.9395389031573904,-5.7855331244916375,-8.8692106393729127,-0.47836528696875824,null,-0.77936321587174362,-5.6845964796331643,null,-5.5919820036111272,-1.7115742001755301,-3.6362665026456629,-10.413489594008064,-6.2312342479837639,-6.4873034285656495,-9.8970669845450043,-7.8416988032355741,-8.5331102847749509,-10.9029146632829,-10.766757182095056,-8.4276747783322943,-5.8151250619915746,-8.7472220752407921,-6.9917407494433217,-10.727290118974054,-7.9216372234896628,-11.16407695728096,-12.694683334725006,-7.0875821439673565,-7.8088646885488169,-7.5781966220064438,-1.5523392161302239,-6.9577735673464618,-7.8887095241665053,-9.1200764384274002,-8.1166019012241879,-10.978572915216239,-5.1002868605492662,-8.59955138359161,0.83129751904076254,-3.4698037050190518,-0.47836090458855551,-6.3789393381815689,-7.9555080349096716,-8.3672337162074477,-9.7440227778850996,-8.9039057873309719,-3.3881965694849034,-1.9339550579344387,-7.9451302581790566,-6.6979597448723149,-6.0011678268177855,-1.2185900265692808,-10.532229536403737,-4.7379796031878829,-0.86416752365779104,-10.823753705276431,-2.320066666513104,-6.1858422088040284,-8.1184779786948944,null,-7.1749795095315214,-6.3780644582173407,-7.8583774674960196,-3.6443821415561573,-0.47835967711390914,-6.4863481964122007,-6.0552667999451284,-8.8773819546547657,-8.1306502153137217,-10.168447913722499,-6.2283055255457889,-5.449310893897108,-10.647684247771764,-4.0567150158627365,-9.4331895942655688,-6.6635866868620344,-3.7640946641259569,-8.8273214525722903,-8.8353092033113256,-7.9042914129180604,-8.0786208188014541,-5.1036918541550609,-5.3020603526147685,-4.1026843326928368,-6.9916609610971641,-6.200270510557071,-9.7811026830221497,-5.8696802137937993,-5.2337788454104652,-7.2686015109896811,-7.7150197808382943,-7.2816076490089499,-6.6380260284309216,-2.8636918937136313,-4.8313181746808072,-9.358932776026009,-8.330033721260655,-10.615229523407615,-2.1464510957109706,-3.3108133201938861,-8.2405848098115726,-8.6162146576875553,-6.8973535419126861,-10.014203079617417,null,-7.9858343877351379,-10.538666579740848,-4.0026225699346911,-6.2932744427827121,-6.1284493135159481,-1.9328380674879604,-5.8948021644287305,-9.3434043476861302,-8.7739417170980936,-7.0177881952887233,null,-8.1839392997743126,-6.1463793070944917,-7.703338703682661,-4.6512355528313378,-9.4062891412166127,-1.2211324247967212,-7.0054263061555844,-7.2232956795623142,-7.3641171743078431,-4.0405750613537856,-5.7240136432225412,-5.9339041660852896,-5.2425820881770644,-3.6324552116412159,-5.8533473220584913,-7.2340053791068915,-7.1158528720910752,-8.9611736357527363,-7.9447758116436065,-1.5813471968877995,-4.7429671446989223,-5.8896964479113105,-5.8034213899740328,-6.802331269245113,-8.9928572408023228,-4.2228887921233911,-9.8238798692733695,-12.001545356294434,-6.1553170464655285,-6.6358371883764269,-8.6483189149600896,null,-10.213579145316011,-10.900491536449458,-0.52973532426064729,-7.3403024562430641,0.075266558523210847,-6.3586072557915747,-6.9839558719146906,-3.6524065483908306,-7.3957055413311981,-6.9968402817251132,-5.1166507676361279,-1.7093192624385942,-7.1259045613879568,-5.5890256343427547,-8.0118072911289477,-1.5613319024873782,-8.1383378064105329,null,-3.4202221821885876,-12.819976495077048,-3.6294301812600622,-7.7546134822602042,-6.0590259090871168,-10.489912179174006,-6.6438212809246311,-5.9346507095254051,-5.0368779616224018,-7.00033446027523,-7.4162047485951916,-6.5516516004116969,-9.2761536484496325,-8.9191142490725746,-3.9785781254031569,-0.47837414990182658,-1.5923145322326206,-7.9510445724708791,-4.8552838937488101,-5.2634713932910646,0.29059675026253196,-3.8581963260714209,-5.8561872704121631,-2.2008884919167517,-4.006714038087857,-6.2308164559568242,-10.117431776637613,null,-7.8755626136419989,-4.6954678239688725,-6.6638622236540179,-1.5918782737427843,-4.0491147192474264,null,-10.667232981941609,-5.1135208746272003,-6.5767227656567435,-7.4244906783007156,-7.5194551199652437,-7.7630921681859526,-6.9136203983396776,-5.269574897682384,-12.001526951951009,-7.9384633891228882,-4.5983824957341586,-3.9882396270175988,-0.47837876546197577,-9.2580530327167416,-8.7492251237758527,-5.7980600305788634,-4.8410115600426034,-8.1074790690186589,-8.4530172711976732,-4.8373919250972905,-7.2237696737009536,-1.9276070180127673,-7.0735194632774565,-3.6371282600222372,-8.4156428680652553,-1.7089536301531112,-9.7149307831899687,-8.1782751493484369],"hoverinfo":"y","type":"box","fillcolor":"rgba(253,205,172,0.5)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"95-99%","legendgroup":"95-99%","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"y":[-0.39757599583222625,1.2109771441290835,-4.220000136618264,-6.9482156912503665,-6.6628281862784249,-3.8506974989100606,-6.5200941150431913,-3.0716397836196414,-8.3195692582577774,-5.9624516248702673,-4.9610889394427922,-5.7659920741497128,-1.5919360143527328,-7.302143624578056,-5.9808798805114005,-2.8170931306670646,0.011398954950745832,-6.1892969029288594,-6.1278945320668949,-6.4149923031450005,-7.1915896996695352,-4.9868399875094331,-9.9796744846033203,0.012317927323547195,-7.0094760123717759,-0.46984634585264118,-2.3095564214195505,0.03351772403776998,-5.2869926506541054,-10.295634232554216,-6.6840216344918915,null,1.2116378959612533,0.033037807231843352,-8.5450604842301967,0.17381433098669419,-7.2679021607972754,-5.9906427847544936,-5.3887873809275266,-5.3442104681919034,-9.3351504864044283,0.035362490282300207,0.034892249265875641],"hoverinfo":"y","type":"box","fillcolor":"rgba(203,213,232,0.5)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"75-94%","legendgroup":"75-94%","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[4,4,4,4,4,4,4,4,4,4,4,4],"y":[-11.47870154267398,-0.70358650921211918,-7.0788946269164725,-6.760616993547754,-6.4315861854509873,-5.9115683988882122,7.5906717707256259,-1.360911273677484,-6.7796887664436829,-6.0417237932248717,-2.6468751443520038,0.38253806678875257],"hoverinfo":"y","type":"box","fillcolor":"rgba(244,202,228,0.5)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"<75%","legendgroup":"<75%","showlegend":true,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Boxplot of Log Viral Load Change by Adherence at Year 2","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,4.5999999999999996],"tickmode":"array","ticktext":["100%","95-99%","75-94%","<75%"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["100%","95-99%","75-94%","<75%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Adherence at year 2","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-13.840508908367182,8.6112041840157598],"tickmode":"array","ticktext":["-10","-5","0","5"],"tickvals":[-10,-5,1.7763568394002505e-15,5.0000000000000018],"categoryorder":"array","categoryarray":["-10","-5","0","5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Log Viral Load Change","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Adherence Group","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"3d38327258e":{"x":{},"y":{},"fill":{},"type":"box"}},"cur_data":"3d38327258e","visdat":{"3d38327258e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This relationship is reflected in the boxplots: Groups with high adherence had a greater decrease in log viral load over 2 years compared to those with low adherence.</p>
<p>Let’s run the regression to ensure this difference is statistically significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting log vload change by adherence group at year 2, with the 100% adherence group as the reference level</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> ADH_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VLOAD_log_CHANGE ~ ADH_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5436 -1.8009 -0.2425  1.4695 11.5258 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)  -6.2038     0.1890 -32.828 &lt; 0.0000000000000002 ***
ADH_295-99%  -0.1826     0.2577  -0.709             0.478868    
ADH_275-94%   1.7649     0.4729   3.732             0.000211 ***
ADH_2&lt;75%     2.2687     0.8327   2.724             0.006655 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.809 on 528 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.04483,   Adjusted R-squared:  0.0394 
F-statistic: 8.261 on 3 and 528 DF,  p-value: 0.00002225</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Bonferroni correction</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[,<span class="dv">4</span>] <span class="co"># This line selects the fourth column of the resulting coefficients table from summary(model), which is the p-values</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Bonferroni correction </span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare adjusted p-values to unadjusted p-values</span></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>p_comparison <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p_values, p_adjusted)</span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(p_comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_values</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_295-99%</td>
<td style="text-align: right;">0.4788680</td>
<td style="text-align: right;">1.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ADH_275-94%</td>
<td style="text-align: right;">0.0002105</td>
<td style="text-align: right;">0.0008421</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_2&lt;75%</td>
<td style="text-align: right;">0.0066551</td>
<td style="text-align: right;">0.0266202</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Change the reference level to the 75-94% group and re-run the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to 75-94%</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_2 <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_2, <span class="at">ref =</span> <span class="st">"75-94%"</span>)</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting log vload change by adherence group at year 2, with the 75-94% group as the reference level</span></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> ADH_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VLOAD_log_CHANGE ~ ADH_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5436 -1.8009 -0.2425  1.4695 11.5258 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)  -4.4389     0.4335 -10.240 &lt; 0.0000000000000002 ***
ADH_2100%    -1.7649     0.4729  -3.732             0.000211 ***
ADH_295-99%  -1.9475     0.4676  -4.165            0.0000363 ***
ADH_2&lt;75%     0.5038     0.9196   0.548             0.584022    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.809 on 528 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.04483,   Adjusted R-squared:  0.0394 
F-statistic: 8.261 on 3 and 528 DF,  p-value: 0.00002225</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Bonferroni correction</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[,<span class="dv">4</span>] <span class="co"># This line selects the fourth column of the resulting coefficients table from summary(model), which is the p-values</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Bonferroni correction </span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare adjusted p-values to unadjusted p-values</span></span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a>p_comparison <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p_values, p_adjusted)</span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(p_comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_values</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_2100%</td>
<td style="text-align: right;">0.0002105</td>
<td style="text-align: right;">0.0008421</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ADH_295-99%</td>
<td style="text-align: right;">0.0000363</td>
<td style="text-align: right;">0.0001454</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_2&lt;75%</td>
<td style="text-align: right;">0.5840224</td>
<td style="text-align: right;">1.0000000</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The overall model is significant (F~(3, 528)~= 8.261, p &lt; .0001).</p>
<p>Looking at the between-group comparisons, the 100% group is statistically different from the 75-95% group (p-adjusted &lt; 0.0001) and the &lt;75% group (p-adjusted = 0.0266).</p>
<p>The 75-95% group is significantly different from the 95-99% group (p-adjusted &lt;0.0001).</p>
<p>The 100% and 95-99% group were not significantly different from each other (p-adjusted &gt; .05), and the 75-95% and &lt;75% groups were not significantly different from each other (p-adjusted &gt; 0.5).</p>
<p>In other words, there is no difference between the two highest adherence groups from each other, and between the two lowest adherence groups from each other, providing strong evidence for grouping these levels together and separating based on high vs low adherence.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the above findings, there is no difference between the two highest adherence level groups from each other, and the two lowest adherence level groups from each other.</p>
<p>Therefore, analyses moving forward will only make comparisons between high vs low adherence for ease of interpretation.</p>
</div>
</div>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<p>Based on the plots and regression results from looking at adherence group and log viral load, there is no difference between the two highest adherence level groups from each other, and the two lowest adherence level groups from each other.</p>
<p>Therefore, it is more prudent to collapse this variable and make comparisons only between high adherence (95-100%) and low adherence (&lt;95%) groups</p>
<p>Let’s examine change in log viral load based on these criteria.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out NA values</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>data_no_na <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ADH_HIGHVSLOW))</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of log viral load change by adherence group</span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_no_na, <span class="fu">aes</span>(<span class="at">x =</span> ADH_HIGHVSLOW, <span class="at">y =</span> VLOAD_log_CHANGE, <span class="at">fill =</span> ADH_HIGHVSLOW)) <span class="sc">+</span></span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Log Viral Load Change by Adherence at Year 2"</span>,</span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Adherence Level"</span>,</span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Log Viral Load Change"</span>) <span class="sc">+</span></span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Adherence Group"</span>))</span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-209c9a47451e7718c83b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-209c9a47451e7718c83b">{"x":{"data":[{"x":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"y":[-6.4149923031450005,-6.5200941150431913,-5.9906427847544936,-5.7659920741497128,-4.9610889394427922,-6.1278945320668949,-3.8506974989100606,0.033037807231843352,0.011398954950745832,-10.295634232554216,-6.1892969029288594,-7.1915896996695352,1.2109771441290835,-4.9868399875094331,-6.6840216344918915,-4.220000136618264,1.2116378959612533,-5.3442104681919034,-9.9796744846033203,-0.39757599583222625,-3.0716397836196414,-6.6628281862784249,-2.3095564214195505,-7.2679021607972754,0.03351772403776998,-5.9808798805114005,null,-8.3195692582577774,-5.2869926506541054,0.17381433098669419,-0.46984634585264118,-8.5450604842301967,-7.302143624578056,-2.8170931306670646,-5.3887873809275266,-9.3351504864044283,-6.9482156912503665,-7.0094760123717759,0.034892249265875641,0.035362490282300207,-1.5919360143527328,0.012317927323547195,-5.9624516248702673],"hoverinfo":"y","type":"box","fillcolor":"rgba(179,226,205,0.5)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"Low Adherence","legendgroup":"Low Adherence","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"y":[-7.4385109729035142,-5.131007567374521,-4.9799190683554242,-3.3108133201938861,-5.0074843471507071,-5.6845964796331643,-8.1166019012241879,-12.001545356294434,-6.9917407494433217,-0.47835967711390914,null,-4.0026225699346911,-6.8832576473817362,-4.7219244368375657,-7.4669539915367267,-3.6299647209962576,-6.8520238384177805,-4.288349735724541,-10.846243739717833,null,-5.8151250619915746,-7.5624950005136622,-5.5057010168159319,-6.7466054515275617,-4.7011811800590921,-6.3510443587393448,-10.497449555174734,-7.9555080349096716,-0.47836528696875824,-4.0405750613537856,-6.5225372958096663,-4.7237872713443112,-3.6294301812600622,-7.1749795095315214,-5.3428657428091046,-8.5331102847749509,-7.1158528720910752,-7.4057505576647413,-5.4446415809713127,-5.0373668155626277,-4.7379796031878829,-6.6942446687320354,-10.9029146632829,-7.4634427678718307,-0.47836754570787221,-3.8547656513243771,-6.433999940015263,-4.7078846700533212,-3.6443821415561573,-6.6358371883764269,-3.7612001156935624,-7.3403024562430641,-7.925157512224704,-7.8088646885488169,-9.7811026830221497,-6.2283055255457889,0.075266558523210847,-7.1903530195067731,-0.77936321587174362,-10.252823129088098,-4.8385849136752288,-5.9646683153330731,-7.8932667351706947,-5.1012769050813667,-5.0349493657471109,-1.7089959052698216,-6.943583958061641,-5.3020603526147685,-8.3672337162074477,1.6464703896099264,-9.7440227778850996,-5.7240136432225412,-7.0935232709421694,-9.376166058969984,-6.6979597448723149,-7.3166905495819545,-8.0143357371170456,-5.9346507095254051,-2.8636918937136313,-9.8970669845450043,-4.2142146871476136,-9.0877610470911918,-8.5603758260033711,-9.0888988665586297,-10.322444567115177,-9.390409393716844,-8.880251716873909,-5.5768956247488548,-6.6438212809246311,-6.4863481964122007,-8.8773819546547657,-8.1306502153137217,-1.5920643574326299,-7.7976472770017278,-10.208973933444895,null,-9.4331895942655688,-7.2885094074478376,-10.344252977181865,-3.4609732478024764,-1.2102270409582925,-10.046822813143443,-8.371126415281454,null,-7.4244906783007156,-6.1627137136791816,-6.9482106368157384,-3.0101639310935253,-12.819976495077048,-5.8696802137937993,-0.64531974020172456,-6.6380260284309216,-10.489912179174006,-1.2185900265692808,-7.9216372234896628,-7.0206870601362805,-8.8908861405240653,-0.86416752365779104,-12.557284906493749,-8.6259202918273559,-5.7850132878285017,-8.9164389994798015,-6.1562916216493146,null,null,-7.4724027218589404,-10.727290118974054,-7.9858343877351379,-6.0709435100831577,-6.4346059664790181,-6.9395389031573904,-6.9577735673464618,-5.7365722974791922,-6.1167376605381225,2.6877125258998236,-4.3209230675362837,-7.2955089051805295,-3.3881965694849034,-10.978572915216239,-3.8483729783516902,-6.4873034285656495,-7.7872855993379746,-6.4388177479183994,-6.3789393381815689,-7.2232956795623142,-7.3641171743078431,-9.7149307831899687,-5.0889182124902987,-5.9339041660852896,-7.7546134822602042,-7.2816076490089499,-6.4544120906295088,-8.2935395100077933,-7.4280325653148864,-10.261341628454899,-5.1168553671471511,-5.6315816983631652,-1.2307159011196322,-6.0387937630183242,1.5639755383573428,-9.1200764384274002,-8.4276747783322943,-5.9375414193168528,-9.8238798692733695,-8.766718983893373,-6.1553170464655285,-12.694683334725006,-8.59955138359161,-9.8440692340931282,-7.0875821439673565,-6.0686141630553552,-6.0052022758144439,-6.1783251070043113,-5.8607862234658654,-6.0282785202306979,-5.1002868605492662,-7.4831317356673557,-8.1839392997743126,-8.7472220752407921,-6.0011678268177855,-9.7844506060620571,-9.0884397801821173,-6.2312342479837639,-5.1036918541550609,-1.5613319024873782,-10.255596634226441,-6.9916609610971641,-5.1529185993423914,-5.1519378314456654,-10.670732883772994,-6.0590259090871168,-9.5198980849454031,-7.7150197808382943,-7.7456572195632116,-2.320066666513104,-5.5978241894865839,-6.7842083244525222,-6.8329290998598182,-6.1858422088040284,-9.4829101396593778,null,-9.4936660942987263,-6.3780644582173407,null,-6.9290274142576767,-5.6090138146620543,-6.2755606522941152,-5.0164478256409417,-5.5957661562989358,-1.108815672905104,-10.168447913722499,-6.9584177292680929,-5.9856125272304181,-3.8282157438152451,-8.6730224617208389,-6.5942180136434203,-7.6530204136446702,-6.2241916582198584,-5.5919820036111272,null,-9.9774414311854027,-3.4698037050190518,-6.5767227656567435,-6.9136203983396776,-4.1026843326928368,-6.200270510557071,-6.9853951016881517,0.79028345105091802,-5.2425820881770644,-6.2783874028562554,-5.7335523141466034,-8.9611736357527363,-6.3231363188740701,-10.532229536403737,-8.330033721260655,-8.6189018296881663,-2.1464510957109706,-6.0042743878357809,-8.7745449140601846,-7.8204030192293192,-4.9835189384727627,1.2399793253564235,-8.5242350062052843,-3.2019448180288057,-10.309519166628519,-6.0266069278059353,-10.538666579740848,null,-6.2932744427827121,-6.1284493135159481,-5.7855331244916375,-1.5523392161302239,-6.1915100470463837,-7.8755626136419989,-10.675462087141881,-9.7731700374384118,-5.1135208746272003,-10.413489594008064,-3.6362665026456629,-1.2211324247967212,-7.9042914129180604,-8.9074369801747117,-7.0054263061555844,-9.0672779891343449,-1.6580556182086923,-5.0121836151477073,-3.8468514309204886,-6.4419979406178536,-6.5709669922302236,-7.9451302581790566,-10.565149225950112,-5.0368779616224018,-5.9159324844512096,-1.689724790633262,-8.1507827285579726,-4.8313181746808072,-4.2878216131878411,-0.47837876546197577,-5.8034213899740328,-10.766757182095056,-8.4907932130151202,-3.5440303154321429,-1.3215273468932409,-2.5212742939588746,-8.4530172711976732,-7.5558353561727731,-11.16407695728096,-0.52973532426064729,-10.900491536449458,-7.5781966220064438,-4.7377434229007394,-7.0735194632774565,-7.8887095241665053,-3.9882396270175988,-6.6635866868620344,-8.6656747709934443,-4.6512355528313378,-7.6290038892626173,0.83129751904076254,-7.1259045613879568,-0.47836090458855551,-4.4299453390931722,null,null,-8.9039057873309719,-4.6671589300300722,null,-5.2337788454104652,-3.8657514061403262,-5.8533473220584913,-3.0465906907874816,-9.015098564193293,-6.4559844179974615,-7.4896043990798837,-10.823753705276431,-9.2761536484496325,1.8607523407150066,-8.1184779786948944,-3.088409638510007,-6.3551766836461336,-7.9727218623706584,-7.8583774674960196,-10.014203079617417,1.5328782264151304,0.29059675026253196,-9.6771514103227538,-5.9082187985047145,-2.2008884919167517,-4.006714038087857,-1.7549985731827231,-5.449310893897108,-10.647684247771764,-5.8126700960901836,null,-7.3957055413311981,-5.1166507676361279,-8.8273214525722903,-8.8353092033113256,-5.3133599080808036,-6.534728888423456,-7.5815235886023409,-2.3402096507349697,-6.9521821965238377,-4.721917631431352,-10.05079316513185,-8.128816948101349,-4.6954678239688725,-8.1007465777642906,-7.2686015109896811,-4.3307333402863311,-5.9221792951206931,-10.667232981941609,-4.8410115600426034,-6.5516516004116969,-9.358932776026009,-8.9191142490725746,-3.8656394360096513,-0.47837414990182658,-8.6162146576875553,-8.2405848098115726,-4.0491147192474264,-6.8973535419126861,-5.6314487275915113,-6.620073206530356,-5.102357778593781,-8.4156428680652553,-6.725533717188517,-4.7999142625803461,-7.5194551199652437,-8.8692106393729127,-5.8948021644287305,-9.3434043476861302,-7.1327970275794268,-1.5918782737427843,-1.9339550579344387,-3.7640946641259569,-1.7115742001755301,-1.7093192624385942,-1.7089536301531112,-9.4062891412166127,-7.3390180799114422,-7.2354132738503765,-5.0283442278770281,-8.4399233025915716,-2.4887349203681044,-5.269574897682384,-8.7492251237758527,-6.0384312132909574,-3.6324552116412159,-5.2634713932910646,-3.9756652917339013,-4.7429671446989223,-7.7630921681859526,-7.00033446027523,-1.5813471968877995,-7.8416988032355741,-5.8896964479113105,-6.4505919361667488,-3.9785781254031569,-8.9928572408023228,-4.2228887921233911,-4.5983824957341586,null,-5.9842860655730545,-10.866862231914796,-8.6483189149600896,-6.1985926233748989,-7.894749698601645,-1.9276070180127673,-3.6967813462392254,-4.9328847008241636,-6.3586072557915747,-6.9839558719146906,-8.1898381554132307,-6.0471672508083918,-5.7980600305788634,-8.1074790690186589,-6.1656860106576081,-8.2034865089210633,-5.5890256343427547,-8.0118072911289477,-8.0706099923240071,-1.368825499464938,-4.5992913556009833,-3.4202221821885876,-5.9961786341088423,-9.8096660260421906,-5.5679750683772999,-7.487131676524287,-7.2340053791068915,-5.5204877635487701,-4.7061153607563773,-6.2569244859848219,-5.8561872704121631,-7.4162047485951916,-10.615229523407615,-12.001526951951009,-5.2087572894628407,null,-4.0567150158627365,-1.5923145322326206,-7.9510445724708791,-4.8552838937488101,-7.703338703682661,-5.9967683194180665,-6.0552667999451284,-6.7841176934117211,-8.1782751493484369,-6.5366586589724189,-6.2308164559568242,-10.117431776637613,-6.0887298572397164,-8.7739417170980936,-9.4241215662134259,-6.3919171133926014,-6.1463793070944917,-1.1085361266159559,-1.108904377361366,-8.0786208188014541,-7.9447758116436065,-7.2744218070485225,-4.8373919250972905,-6.3007857946632431,-5.1181252482069111,-7.9384633891228882,-5.9334304192863385,-5.3674702252363531,-7.9414088669253946,-5.5033586622961561,null,-9.2580530327167416,-6.3526070606819394,-4.7237770626965654,-4.7086391023788066,-8.1383378064105329,-6.802331269245113,-3.6371282600222372,-7.2237696737009536,-5.3423342519648109,-7.0177881952887233,-6.9968402817251132,-8.0014098438764716,-6.455369453850988,-5.2503004325974949,-10.213579145316011,-7.4385109729035142,-7.805320669745587,-5.1277759048687033,-1.9328380674879604,-10.088542549563275,-6.8140438205415084,-6.6638622236540179,-3.8071914503750892,-3.8581963260714209,-3.6524065483908306],"hoverinfo":"y","type":"box","fillcolor":"rgba(253,205,172,0.5)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"High Adherence","legendgroup":"High Adherence","showlegend":true,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Boxplot of Log Viral Load Change by Adherence at Year 2","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["Low Adherence","High Adherence"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["Low Adherence","High Adherence"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Adherence Level","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-13.595360946125892,3.463096976948667],"tickmode":"array","ticktext":["-10","-5","0"],"tickvals":[-10,-5,0],"categoryorder":"array","categoryarray":["-10","-5","0"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Log Viral Load Change","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Adherence Group","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"3d384c4e97":{"x":{},"y":{},"fill":{},"type":"box"}},"cur_data":"3d384c4e97","visdat":{"3d384c4e97":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Indeed, this plot is simpler and encapsulates the true relationships better!</p>
<p>The high adherence group had a greater decrease in log viral load over 2 years compared to the low adherence group.</p>
<p>Let’s perform the linear regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting log vload change by adherence group at year 2</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VLOAD_log_CHANGE ~ ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.5180 -1.8005 -0.1537  1.4615  8.9897 

Coefficients:
                            Estimate Std. Error t value             Pr(&gt;|t|)
(Intercept)                  -4.4389     0.4236 -10.479 &lt; 0.0000000000000002
ADH_HIGHVSLOWHigh Adherence  -1.8631     0.4418  -4.217            0.0000292
                               
(Intercept)                 ***
ADH_HIGHVSLOWHigh Adherence ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.745 on 518 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.03319,   Adjusted R-squared:  0.03132 
F-statistic: 17.78 on 1 and 518 DF,  p-value: 0.00002922</code></pre>
</div>
</div>
<p>The overall model is statistically significant (F<sub>(1,518)</sub>= 17.78, p &lt; 0.0001). On average, those in the high adherence group have a mean change in log viral load that is 1.86 log copies/mL (or 72.44 copies/mL) lower than those in the low adherence group</p>
<p><code>ADH_HIGHVSLOW</code> will absolutely be included in the final model for <code>VLOAD_log</code>.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<p>The correlation matrix reveals a relationship between BMI and each outcome variable. Let’s examine this relationship more closely.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of log vload change by BMI at baseline</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> BMI_0, <span class="at">y =</span> VLOAD_log_CHANGE, <span class="at">color =</span> BMI_0)) <span class="sc">+</span> </span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log Viral Load Change by BMI at Baseline"</span>,</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Log Viral Load Change"</span>,</span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"BMI at Baseline"</span>) <span class="sc">+</span> </span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)</span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot interactive</span></span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-d579c4ed09f2ccd3ea16" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d579c4ed09f2ccd3ea16">{"x":{"data":[{"x":[24.717559090000002,26.669360149999999,28.590848210000001,20.364513250000002,22.269860099999999,23.221658479999999,24.716879779999999,28.85804285,19.910766840000001,20.59908544,18.55779905,20.415883860000001,22.594786710000001,24.76099529,23.504980719999999,28.497813749999999,22.401980519999999,25.57984025,30.283562889999999,null,29.381398149999999,26.463931469999999,28.181149080000001,29.87478411,22.418650370000002,22.951714460000002,30.835604929999999,21.285015680000001,21.267300890000001,18.08698609,23.955868779999999,23.504366340000001,27.30225751,23.014031840000001,23.52290082,null,29.935707369999999,22.386996880000002,28.108278819999999,28.066689839999999,22.78103647,23.359948939999999,28.82353861,20.66837323,19.577684260000002,21.11509934,21.727143640000001,22.565496830000001,28.226216099999998,24.184745629999998,25.973183240000001,null,29.642022699999998,25.22083056,22.56627048,35.633011609999997,26.12902076,32.350382699999997,34.258444429999997,24.865273479999999,22.385352180000002,28.318000319999999,24.375597020000001,30.85484314,24.770034259999999,18.585619380000001,29.15438597,22.955177549999998,31.63990141,24.167772039999999,19.15583397,24.684720469999998,23.82667665,25.391190129999998,27.428419439999999,25.602158889999998,23.95181972,22.668678740000001,29.401735760000001,29.52729025,33.15458521,26.322058080000001,21.422303429999999,26.615772509999999,27.972252309999998,20.976975729999999,30.588276910000001,16.495330259999999,24.746385969999999,23.424574839999998,22.87218979,24.094824500000001,27.913991849999999,18.906459380000001,23.7976645,35.718392909999999,25.159155640000002,null,23.177619839999998,22.368732720000001,27.179001970000002,22.479034290000001,25.071229840000001,20.30380546,32.734807240000002,35.425191499999997,35.49820897,27.45211252,25.46359593,27.989676169999999,22.376534119999999,23.741357879999999,25.304319670000002,26.423977709999999,25.77774977,23.849269509999999,21.53702251,24.364319470000002,24.446395750000001,28.003292479999999,23.365542980000001,21.88186932,24.141370080000002,25.82638438,22.190055520000001,21.57987116,18.827353819999999,20.102907600000002,23.97946439,24.681831899999999,null,28.954110029999999,28.189867979999999,21.85539897,27.628655930000001,23.59116852,null,25.377663250000001,20.36829577,27.079136290000001,18.360931260000001,19.51273759,26.101822819999999,23.608739289999999,null,27.54451151,20.216029689999999,23.14054788,19.166276910000001,33.619866780000002,20.864799730000001,24.538818729999999,34.228886670000001,23.680840069999999,24.2125348,25.65908357,35.881334979999998,38.436748039999998,28.10798986,18.976309369999999,21.48903344,22.954563409999999,22.93735174,30.438229,23.776907529999999,19.614767130000001,25.542304250000001,28.500984750000001,32.501798780000001,21.709719239999998,25.440435050000001,17.66341311,18.858083799999999,25.843179240000001,29.38705517,18.317541949999999,24.421936599999999,37.58512107,24.924668499999999,23.424832859999999,25.55884588,18.88270687,23.064244819999999,22.805985329999999,29.502773399999999,21.206956529999999,20.739823810000001,23.34598785,28.33548351,null,26.018265,28.19027415,24.312538480000001,26.72543366,21.661210820000001,21.896288139999999,24.69690104,25.944721229999999,29.250181040000001,24.32759472,32.074330240000002,25.571236240000001,28.32349769,30.922688969999999,25.938923939999999,null,29.020276540000001,20.75599528,20.645741350000002,24.384561309999999,23.354173939999999,24.254963660000001,28.891431440000002,23.651867330000002,27.695788960000002,26.013721749999998,22.143399469999999,25.152331199999999,20.697462120000001,22.718942299999998,25.400777250000001,25.604923580000001,24.729985509999999,22.3928242,23.84878776,25.85164786,19.767741579999999,26.93885028,23.231233140000001,22.175179450000002,19.063013089999998,25.05480785,28.271421310000001,26.32620528,37.37963439,23.529012120000001,35.288523499999997,21.44542332,22.584806390000001,18.144981059999999,21.636299770000001,30.113155299999999,23.6590749,25.331188900000001,30.60311183,21.80724292,23.153856650000002,24.83487379,25.111924940000002,20.02774432,22.616527479999998,19.006117010000001,22.257975940000001,null,28.106526479999999,22.083940040000002,24.69868898,29.629378760000002,28.578618809999998,26.996081019999998,23.777730160000001,23.101673510000001,20.987880990000001,23.580403969999999,31.06014858,30.568793880000001,28.850301989999998,38.708937329999998,22.7304256,27.366505709999998,21.860692319999998,22.05304516,32.139172549999998,26.25423631,22.06320565,17.5358944,18.540265260000002,26.95299322,26.577966790000001,24.27905878,23.549151649999999,19.366132,25.961633339999999,23.7266333,22.770672480000002,25.656998529999999,27.005851830000001,25.368978510000002,29.010765469999999,24.60383289,24.675577789999998,24.32571536,24.510091070000001,29.209103930000001,26.1744865,29.480145350000001,30.255786000000001,23.600735190000002,20.915759730000001,23.5157256,25.254019280000001,23.314773899999999,27.573215340000001,21.955160549999999,22.17556961,24.07525364,30.607054219999998,21.05077563,18.22014879,24.146964759999999,25.475213190000002,null,23.564487889999999,20.865166259999999,18.591857319999999,29.319174960000002,21.090858040000001,20.103351230000001,18.878678359999999,28.584526260000001,29.735504169999999,28.525134300000001,24.432476510000001,24.912210949999999,24.531048779999999,21.65341643,23.919217419999999,21.869848149999999,19.220589650000001,22.587458789999999,23.247360069999999,20.07202448,21.717914159999999,21.597789760000001,null,23.01872358,19.965016989999999,22.860948759999999,27.941899379999999,23.790497240000001,29.3673979,26.393652230000001,32.606241939999997,20.750302510000001,19.50064695,24.760699729999999,22.928629690000001,24.48358245,null,33.400870130000001,21.584317129999999,24.166634420000001,28.467045450000001,34.878982399999998,34.533793629999998,24.048613799999998,26.391898130000001,23.791304700000001,22.800627039999998,27.30905534,24.44143042,31.464218150000001,25.445743539999999,23.183769569999999,23.542340530000001,25.977290530000001,27.92746348,27.689511209999999,26.95672034,24.796680120000001,23.39881244,23.323803999999999,24.44466894,35.371992159999998,26.7731843,29.538457040000001,28.673896039999999,28.52450554,20.15646916,18.239467099999999,29.833288849999999,22.56970944,32.41562948,26.93869492,22.02286217,26.394836130000002,28.70382437,23.87602562,22.850318810000001,28.290771800000002,22.247427999999999,26.322309480000001,26.80377975,27.726961360000001,22.931203379999999,28.603695420000001,28.316859860000001,30.378196089999999,22.56134312,21.04230531,24.90941192,22.18449055,34.651193370000001,28.576911389999999,26.467038670000001,24.687434669999998,30.311987949999999,22.720186429999998,27.917959570000001,33.633683349999998,24.521657099999999,36.704505920000003,30.442800999999999,20.730598789999998,19.553201730000001,27.747408740000001,27.274660220000001,26.786038229999999,25.380783170000001,26.03265918,24.903707449999999,24.381684180000001,27.384002120000002,20.879528749999999,null,23.22717608,26.760907159999999,26.00852587,20.11871958,25.526639459999998,28.178917559999999,20.03680683,26.789730479999999,24.64588711,23.04176554,22.70943166,23.657500939999998,29.828728819999998,27.164527329999999,25.763874739999999,23.299700949999998,21.390541330000001,18.39350091,24.133419079999999,24.288729719999999,20.575271369999999,22.134421360000001,28.4865362,18.543541529999999,23.588651370000001,24.9376593,23.626988189999999,25.69833642,22.434163739999999,27.22044022,29.005674859999999,28.325923589999999,27.479161130000001,27.036359879999999,26.45697354,30.610425759999998,24.229554629999999,26.948374319999999,24.796221259999999,22.4237857,30.449913639999998,18.425217799999999,25.706616400000001,21.830709649999999,24.519326289999999,29.547889489999999,25.850744089999999,25.686250879999999,17.0602828,27.857611219999999,null,27.578887160000001,28.372641260000002,29.483446260000001,26.435850760000001,23.978494080000001,23.400251860000001,17.952500879999999,18.55379739,23.214242729999999,31.150669820000001,20.33425424,20.662133870000002,20.68446355,23.28507974,19.524795430000001,17.995331010000001,26.308922809999999,20.61568634,23.53074544,23.279980720000001,21.410228350000001,33.088671269999999,33.802083949999997,28.054505200000001,23.410022550000001,23.642534900000001,22.441401800000001,null,24.654127259999999,28.585655429999999,30.183401199999999,23.23885881,28.727655219999999,19.629540739999999,25.02714667,20.16700359,21.399781149999999,29.666484029999999,22.47205207,26.105693720000001,18.003075760000002,28.497372980000002,null,27.133126189999999,27.733990200000001,28.016243790000001,26.97149478,24.903493260000001,23.993612339999999,19.298459050000002,19.653060450000002,23.154604890000002,29.368567680000002,20.963422250000001,24.002792400000001,19.721216760000001,25.082012110000001,20.03681036,21.17168895,27.172571309999999,18.387116599999999,22.127219199999999,23.244155660000001,20.273890909999999,30.079349180000001,31.28557421,28.001075740000001,23.36116453,25.427770779999999,24.25708435,null,22.878951170000001,24.173621820000001,29.039068159999999],"y":[-7.4385109729035142,-5.131007567374521,-4.9799190683554242,-3.3108133201938861,-5.0074843471507071,-5.6845964796331643,-8.1166019012241879,-12.001545356294434,-6.9917407494433217,-0.47835967711390914,1.2109771441290835,-4.0026225699346911,-6.8832576473817362,-4.7219244368375657,-4.9610889394427922,-3.6299647209962576,-6.8520238384177805,-4.288349735724541,-10.846243739717833,0.011398954950745832,-5.8151250619915746,-7.5624950005136622,-5.5057010168159319,-6.7466054515275617,-4.7011811800590921,-6.3510443587393448,-10.497449555174734,-7.9555080349096716,-0.47836528696875824,-4.0405750613537856,-6.5225372958096663,-4.7237872713443112,-3.6294301812600622,-7.1749795095315214,-5.3428657428091046,0.033037807231843352,-7.1158528720910752,-7.4057505576647413,-5.4446415809713127,-5.0373668155626277,-4.7379796031878829,-6.6942446687320354,-10.9029146632829,-7.4634427678718307,-0.47836754570787221,-3.8547656513243771,-6.433999940015263,-4.7078846700533212,-3.6443821415561573,-6.6358371883764269,-3.7612001156935624,0.03351772403776998,-7.925157512224704,-7.8088646885488169,-6.6840216344918915,-6.2283055255457889,0.075266558523210847,-7.1903530195067731,-0.77936321587174362,-10.252823129088098,-4.8385849136752288,-5.9646683153330731,-7.8932667351706947,-5.1012769050813667,-5.0349493657471109,-1.7089959052698216,-6.943583958061641,-5.3020603526147685,-8.3672337162074477,1.6464703896099264,-9.7440227778850996,-5.7240136432225412,-7.0935232709421694,-3.0716397836196414,-6.6979597448723149,-7.3166905495819545,-8.0143357371170456,-5.9346507095254051,-2.8636918937136313,-2.6468751443520038,-9.8970669845450043,-4.2142146871476136,-9.0877610470911918,-8.5603758260033711,-9.0888988665586297,-10.295634232554216,-9.390409393716844,-8.880251716873909,-5.5768956247488548,-6.6438212809246311,-6.4863481964122007,-6.4315861854509873,-8.8773819546547657,-8.1306502153137217,-1.5920643574326299,-7.7976472770017278,-10.208973933444895,null,-6.760616993547754,-9.4331895942655688,-7.2885094074478376,-6.4149923031450005,-3.4609732478024764,-1.2102270409582925,-10.046822813143443,-7.2679021607972754,null,-7.4244906783007156,-5.9808798805114005,-6.9482106368157384,-3.0101639310935253,-12.819976495077048,-5.8696802137937993,-0.64531974020172456,-0.39757599583222625,-10.489912179174006,-1.2185900265692808,-7.9216372234896628,-2.3095564214195505,-8.8908861405240653,-0.86416752365779104,-12.557284906493749,-8.6259202918273559,-5.7850132878285017,-8.9164389994798015,-6.1562916216493146,-8.5450604842301967,null,-7.4724027218589404,-10.727290118974054,-7.9858343877351379,-6.0709435100831577,-6.4346059664790181,-6.9395389031573904,null,-5.7365722974791922,-6.1167376605381225,2.6877125258998236,-7.4669539915367267,-5.3442104681919034,-3.3881965694849034,-10.978572915216239,-1.360911273677484,-3.8483729783516902,null,-7.7872855993379746,-6.4388177479183994,-6.3789393381815689,-7.2232956795623142,-7.3641171743078431,-9.7149307831899687,-5.0889182124902987,-5.9339041660852896,-7.7546134822602042,-9.9796744846033203,-6.4544120906295088,-8.2935395100077933,-7.4280325653148864,-10.261341628454899,-5.1168553671471511,-7.0094760123717759,-1.2307159011196322,-6.0387937630183242,1.5639755383573428,-5.2869926506541054,-8.4276747783322943,-5.9375414193168528,-9.8238798692733695,-8.766718983893373,-6.1553170464655285,-5.3887873809275266,-8.59955138359161,-9.8440692340931282,-7.0875821439673565,-6.0686141630553552,-6.0052022758144439,-7.3403024562430641,-5.8607862234658654,-6.0282785202306979,-9.7811026830221497,-7.4831317356673557,-8.1839392997743126,-8.7472220752407921,-6.0011678268177855,-9.7844506060620571,-9.0884397801821173,-6.2312342479837639,-5.1036918541550609,-1.5613319024873782,-10.255596634226441,-6.9916609610971641,-5.1529185993423914,7.5906717707256259,-5.1519378314456654,-10.670732883772994,-6.0590259090871168,-9.5198980849454031,-7.7150197808382943,-7.7456572195632116,-9.376166058969984,-5.5978241894865839,-6.7842083244525222,-6.8329290998598182,-6.1858422088040284,-9.4829101396593778,null,-9.4936660942987263,-6.3780644582173407,null,-6.9290274142576767,-10.322444567115177,-6.2755606522941152,-5.0164478256409417,-5.5957661562989358,-1.108815672905104,-10.168447913722499,-6.9584177292680929,-5.9856125272304181,-3.8282157438152451,-8.6730224617208389,-6.5942180136434203,-7.6530204136446702,-6.2241916582198584,-5.5919820036111272,-10.344252977181865,-9.9774414311854027,-3.4698037050190518,-6.5767227656567435,-8.371126415281454,-4.1026843326928368,-5.9115683988882122,-6.200270510557071,-6.1627137136791816,0.79028345105091802,-5.2425820881770644,-6.2783874028562554,-5.7335523141466034,-6.1278945320668949,-6.6380260284309216,-10.532229536403737,-6.6628281862784249,-8.6189018296881663,-7.0206870601362805,-6.1892969029288594,-8.7745449140601846,null,-4.9835189384727627,1.2399793253564235,0.17381433098669419,-3.2019448180288057,null,-6.0266069278059353,-10.538666579740848,null,-6.2932744427827121,-6.1284493135159481,-5.7855331244916375,-1.5523392161302239,-6.9577735673464618,-7.8755626136419989,-10.675462087141881,-9.7731700374384118,-4.3209230675362837,-7.2955089051805295,-3.6362665026456629,-3.8506974989100606,-7.9042914129180604,-6.4873034285656495,-7.0054263061555844,-9.0672779891343449,-1.6580556182086923,-5.0121836151477073,-3.8468514309204886,-6.4419979406178536,-6.5709669922302236,-7.9451302581790566,-10.565149225950112,-7.2816076490089499,-5.9159324844512096,-1.689724790633262,-8.1507827285579726,-4.8313181746808072,-6.9482156912503665,-8.5331102847749509,-5.8034213899740328,-10.766757182095056,-8.4907932130151202,-9.1200764384274002,-1.3215273468932409,-2.5212742939588746,-8.4530172711976732,-7.5558353561727731,-11.16407695728096,-12.694683334725006,0.38253806678875257,-10.900491536449458,-7.5781966220064438,-4.7377434229007394,-7.0735194632774565,-7.8887095241665053,-6.1783251070043113,-6.6635866868620344,-8.6656747709934443,-5.1002868605492662,-7.6290038892626173,0.83129751904076254,-7.1259045613879568,-0.47836090458855551,-4.4299453390931722,null,-11.47870154267398,null,-8.9039057873309719,-4.6671589300300722,null,-5.2337788454104652,-3.8657514061403262,-5.8533473220584913,1.2116378959612533,-9.015098564193293,-6.5200941150431913,-7.4896043990798837,-10.823753705276431,-2.320066666513104,1.8607523407150066,-8.1184779786948944,-3.088409638510007,-6.3551766836461336,-7.9727218623706584,-7.8583774674960196,-10.014203079617417,1.5328782264151304,0.29059675026253196,-9.6771514103227538,-5.6090138146620543,-2.2008884919167517,-4.006714038087857,-1.7549985731827231,-5.449310893897108,-10.647684247771764,-5.8126700960901836,null,-7.3957055413311981,-8.3195692582577774,-8.8273214525722903,-8.8353092033113256,-5.3133599080808036,-6.534728888423456,null,-2.3402096507349697,-6.9521821965238377,-4.721917631431352,-6.9136203983396776,-8.128816948101349,-4.6954678239688725,-4.9868399875094331,-7.2686015109896811,-4.3307333402863311,-5.9221792951206931,-10.667232981941609,-8.9611736357527363,-6.3231363188740701,-9.358932776026009,-8.330033721260655,-3.8656394360096513,-2.1464510957109706,-6.0042743878357809,-8.2405848098115726,-7.8204030192293192,-6.8973535419126861,-5.6314487275915113,-8.5242350062052843,-5.102357778593781,-10.309519166628519,-7.302143624578056,-4.7999142625803461,-7.5194551199652437,-8.8692106393729127,-5.8948021644287305,-9.3434043476861302,-7.1327970275794268,-6.1915100470463837,-1.9339550579344387,-3.7640946641259569,-1.7115742001755301,-7.1915896996695352,-10.413489594008064,-9.4062891412166127,-1.2211324247967212,-7.2354132738503765,-8.9074369801747117,-8.4399233025915716,-2.4887349203681044,-5.269574897682384,-8.7492251237758527,-8.1007465777642906,-3.6324552116412159,-5.2634713932910646,-3.9756652917339013,-0.46984634585264118,-5.0368779616224018,-7.00033446027523,-1.5813471968877995,-7.8416988032355741,-5.8896964479113105,-4.2878216131878411,-5.6315816983631652,-8.9928572408023228,-4.2228887921233911,-4.5983824957341586,-3.5440303154321429,-5.9842860655730545,-10.866862231914796,-8.6483189149600896,-6.1985926233748989,-7.894749698601645,-0.70358650921211918,-0.52973532426064729,-3.6967813462392254,-4.9328847008241636,-6.3586072557915747,-6.9839558719146906,-8.1898381554132307,-3.9882396270175988,0.012317927323547195,-5.9624516248702673,-4.6512355528313378,-8.2034865089210633,-5.5890256343427547,-8.0118072911289477,-8.0706099923240071,-1.368825499464938,-4.5992913556009833,-3.4202221821885876,-5.9961786341088423,-9.8096660260421906,-6.0384312132909574,-7.487131676524287,-7.2340053791068915,-4.220000136618264,-3.0465906907874816,-6.2569244859848219,-6.4559844179974615,-7.4162047485951916,-2.8170931306670646,-9.2761536484496325,-9.3351504864044283,-3.9785781254031569,-4.0567150158627365,-1.5923145322326206,-7.9510445724708791,-4.8552838937488101,-5.5204877635487701,-5.9967683194180665,-6.0552667999451284,-5.8561872704121631,-5.9082187985047145,-6.5366586589724189,-6.2308164559568242,-10.117431776637613,null,-8.7739417170980936,-9.4241215662134259,-6.0471672508083918,-5.9906427847544936,-5.1166507676361279,-1.7093192624385942,-6.0417237932248717,-8.0786208188014541,-6.7841176934117211,-7.2744218070485225,-7.5815235886023409,-6.3007857946632431,-5.1181252482069111,-6.0887298572397164,-10.05079316513185,-5.3674702252363531,-5.5679750683772999,-6.9853951016881517,-1.1085361266159559,-6.1656860106576081,-4.7061153607563773,-7.9447758116436065,-4.8410115600426034,-6.5516516004116969,-10.615229523407615,-8.9191142490725746,-5.2087572894628407,-0.47837414990182658,-8.6162146576875553,-7.9414088669253946,-4.0491147192474264,null,-9.2580530327167416,-6.620073206530356,-4.7237770626965654,-8.4156428680652553,-6.725533717188517,-1.9328380674879604,-3.6371282600222372,-7.2237696737009536,-5.3423342519648109,-7.0177881952887233,0.034892249265875641,-1.5918782737427843,-6.1463793070944917,-7.703338703682661,-5.7659920741497128,-5.1135208746272003,-1.7089536301531112,-7.0788946269164725,-8.1383378064105329,-6.7796887664436829,-7.3390180799114422,-7.4385109729035142,-5.0283442278770281,-5.1277759048687033,-5.9334304192863385,-10.088542549563275,-6.3919171133926014,-5.5033586622961561,-5.2503004325974949,-1.108904377361366,-6.3526070606819394,-4.7429671446989223,-7.7630921681859526,-4.8373919250972905,-6.802331269245113,-12.001526951951009,-7.9384633891228882,-6.4505919361667488,-0.47837876546197577,-7.805320669745587,-8.0014098438764716,-3.8581963260714209,null,-10.213579145316011,-6.455369453850988,-4.7086391023788066,-8.1782751493484369,-6.8140438205415084,-1.9276070180127673,-3.6524065483908306,-6.6638622236540179,-3.8071914503750892,-6.9968402817251132,0.035362490282300207,-1.5919360143527328,-5.7980600305788634,-8.1074790690186589],"text":["BMI_0: 24.71756<br />VLOAD_log_CHANGE:  -7.43851097<br />BMI_0: 24.71756","BMI_0: 26.66936<br />VLOAD_log_CHANGE:  -5.13100757<br />BMI_0: 26.66936","BMI_0: 28.59085<br />VLOAD_log_CHANGE:  -4.97991907<br />BMI_0: 28.59085","BMI_0: 20.36451<br />VLOAD_log_CHANGE:  -3.31081332<br />BMI_0: 20.36451","BMI_0: 22.26986<br />VLOAD_log_CHANGE:  -5.00748435<br />BMI_0: 22.26986","BMI_0: 23.22166<br />VLOAD_log_CHANGE:  -5.68459648<br />BMI_0: 23.22166","BMI_0: 24.71688<br />VLOAD_log_CHANGE:  -8.11660190<br />BMI_0: 24.71688","BMI_0: 28.85804<br />VLOAD_log_CHANGE: -12.00154536<br />BMI_0: 28.85804","BMI_0: 19.91077<br />VLOAD_log_CHANGE:  -6.99174075<br />BMI_0: 19.91077","BMI_0: 20.59909<br />VLOAD_log_CHANGE:  -0.47835968<br />BMI_0: 20.59909","BMI_0: 18.55780<br />VLOAD_log_CHANGE:   1.21097714<br />BMI_0: 18.55780","BMI_0: 20.41588<br />VLOAD_log_CHANGE:  -4.00262257<br />BMI_0: 20.41588","BMI_0: 22.59479<br />VLOAD_log_CHANGE:  -6.88325765<br />BMI_0: 22.59479","BMI_0: 24.76100<br />VLOAD_log_CHANGE:  -4.72192444<br />BMI_0: 24.76100","BMI_0: 23.50498<br />VLOAD_log_CHANGE:  -4.96108894<br />BMI_0: 23.50498","BMI_0: 28.49781<br />VLOAD_log_CHANGE:  -3.62996472<br />BMI_0: 28.49781","BMI_0: 22.40198<br />VLOAD_log_CHANGE:  -6.85202384<br />BMI_0: 22.40198","BMI_0: 25.57984<br />VLOAD_log_CHANGE:  -4.28834974<br />BMI_0: 25.57984","BMI_0: 30.28356<br />VLOAD_log_CHANGE: -10.84624374<br />BMI_0: 30.28356","BMI_0:       NA<br />VLOAD_log_CHANGE:   0.01139895<br />BMI_0:       NA","BMI_0: 29.38140<br />VLOAD_log_CHANGE:  -5.81512506<br />BMI_0: 29.38140","BMI_0: 26.46393<br />VLOAD_log_CHANGE:  -7.56249500<br />BMI_0: 26.46393","BMI_0: 28.18115<br />VLOAD_log_CHANGE:  -5.50570102<br />BMI_0: 28.18115","BMI_0: 29.87478<br />VLOAD_log_CHANGE:  -6.74660545<br />BMI_0: 29.87478","BMI_0: 22.41865<br />VLOAD_log_CHANGE:  -4.70118118<br />BMI_0: 22.41865","BMI_0: 22.95171<br />VLOAD_log_CHANGE:  -6.35104436<br />BMI_0: 22.95171","BMI_0: 30.83560<br />VLOAD_log_CHANGE: -10.49744956<br />BMI_0: 30.83560","BMI_0: 21.28502<br />VLOAD_log_CHANGE:  -7.95550803<br />BMI_0: 21.28502","BMI_0: 21.26730<br />VLOAD_log_CHANGE:  -0.47836529<br />BMI_0: 21.26730","BMI_0: 18.08699<br />VLOAD_log_CHANGE:  -4.04057506<br />BMI_0: 18.08699","BMI_0: 23.95587<br />VLOAD_log_CHANGE:  -6.52253730<br />BMI_0: 23.95587","BMI_0: 23.50437<br />VLOAD_log_CHANGE:  -4.72378727<br />BMI_0: 23.50437","BMI_0: 27.30226<br />VLOAD_log_CHANGE:  -3.62943018<br />BMI_0: 27.30226","BMI_0: 23.01403<br />VLOAD_log_CHANGE:  -7.17497951<br />BMI_0: 23.01403","BMI_0: 23.52290<br />VLOAD_log_CHANGE:  -5.34286574<br />BMI_0: 23.52290","BMI_0:       NA<br />VLOAD_log_CHANGE:   0.03303781<br />BMI_0:       NA","BMI_0: 29.93571<br />VLOAD_log_CHANGE:  -7.11585287<br />BMI_0: 29.93571","BMI_0: 22.38700<br />VLOAD_log_CHANGE:  -7.40575056<br />BMI_0: 22.38700","BMI_0: 28.10828<br />VLOAD_log_CHANGE:  -5.44464158<br />BMI_0: 28.10828","BMI_0: 28.06669<br />VLOAD_log_CHANGE:  -5.03736682<br />BMI_0: 28.06669","BMI_0: 22.78104<br />VLOAD_log_CHANGE:  -4.73797960<br />BMI_0: 22.78104","BMI_0: 23.35995<br />VLOAD_log_CHANGE:  -6.69424467<br />BMI_0: 23.35995","BMI_0: 28.82354<br />VLOAD_log_CHANGE: -10.90291466<br />BMI_0: 28.82354","BMI_0: 20.66837<br />VLOAD_log_CHANGE:  -7.46344277<br />BMI_0: 20.66837","BMI_0: 19.57768<br />VLOAD_log_CHANGE:  -0.47836755<br />BMI_0: 19.57768","BMI_0: 21.11510<br />VLOAD_log_CHANGE:  -3.85476565<br />BMI_0: 21.11510","BMI_0: 21.72714<br />VLOAD_log_CHANGE:  -6.43399994<br />BMI_0: 21.72714","BMI_0: 22.56550<br />VLOAD_log_CHANGE:  -4.70788467<br />BMI_0: 22.56550","BMI_0: 28.22622<br />VLOAD_log_CHANGE:  -3.64438214<br />BMI_0: 28.22622","BMI_0: 24.18475<br />VLOAD_log_CHANGE:  -6.63583719<br />BMI_0: 24.18475","BMI_0: 25.97318<br />VLOAD_log_CHANGE:  -3.76120012<br />BMI_0: 25.97318","BMI_0:       NA<br />VLOAD_log_CHANGE:   0.03351772<br />BMI_0:       NA","BMI_0: 29.64202<br />VLOAD_log_CHANGE:  -7.92515751<br />BMI_0: 29.64202","BMI_0: 25.22083<br />VLOAD_log_CHANGE:  -7.80886469<br />BMI_0: 25.22083","BMI_0: 22.56627<br />VLOAD_log_CHANGE:  -6.68402163<br />BMI_0: 22.56627","BMI_0: 35.63301<br />VLOAD_log_CHANGE:  -6.22830553<br />BMI_0: 35.63301","BMI_0: 26.12902<br />VLOAD_log_CHANGE:   0.07526656<br />BMI_0: 26.12902","BMI_0: 32.35038<br />VLOAD_log_CHANGE:  -7.19035302<br />BMI_0: 32.35038","BMI_0: 34.25844<br />VLOAD_log_CHANGE:  -0.77936322<br />BMI_0: 34.25844","BMI_0: 24.86527<br />VLOAD_log_CHANGE: -10.25282313<br />BMI_0: 24.86527","BMI_0: 22.38535<br />VLOAD_log_CHANGE:  -4.83858491<br />BMI_0: 22.38535","BMI_0: 28.31800<br />VLOAD_log_CHANGE:  -5.96466832<br />BMI_0: 28.31800","BMI_0: 24.37560<br />VLOAD_log_CHANGE:  -7.89326674<br />BMI_0: 24.37560","BMI_0: 30.85484<br />VLOAD_log_CHANGE:  -5.10127691<br />BMI_0: 30.85484","BMI_0: 24.77003<br />VLOAD_log_CHANGE:  -5.03494937<br />BMI_0: 24.77003","BMI_0: 18.58562<br />VLOAD_log_CHANGE:  -1.70899591<br />BMI_0: 18.58562","BMI_0: 29.15439<br />VLOAD_log_CHANGE:  -6.94358396<br />BMI_0: 29.15439","BMI_0: 22.95518<br />VLOAD_log_CHANGE:  -5.30206035<br />BMI_0: 22.95518","BMI_0: 31.63990<br />VLOAD_log_CHANGE:  -8.36723372<br />BMI_0: 31.63990","BMI_0: 24.16777<br />VLOAD_log_CHANGE:   1.64647039<br />BMI_0: 24.16777","BMI_0: 19.15583<br />VLOAD_log_CHANGE:  -9.74402278<br />BMI_0: 19.15583","BMI_0: 24.68472<br />VLOAD_log_CHANGE:  -5.72401364<br />BMI_0: 24.68472","BMI_0: 23.82668<br />VLOAD_log_CHANGE:  -7.09352327<br />BMI_0: 23.82668","BMI_0: 25.39119<br />VLOAD_log_CHANGE:  -3.07163978<br />BMI_0: 25.39119","BMI_0: 27.42842<br />VLOAD_log_CHANGE:  -6.69795974<br />BMI_0: 27.42842","BMI_0: 25.60216<br />VLOAD_log_CHANGE:  -7.31669055<br />BMI_0: 25.60216","BMI_0: 23.95182<br />VLOAD_log_CHANGE:  -8.01433574<br />BMI_0: 23.95182","BMI_0: 22.66868<br />VLOAD_log_CHANGE:  -5.93465071<br />BMI_0: 22.66868","BMI_0: 29.40174<br />VLOAD_log_CHANGE:  -2.86369189<br />BMI_0: 29.40174","BMI_0: 29.52729<br />VLOAD_log_CHANGE:  -2.64687514<br />BMI_0: 29.52729","BMI_0: 33.15459<br />VLOAD_log_CHANGE:  -9.89706698<br />BMI_0: 33.15459","BMI_0: 26.32206<br />VLOAD_log_CHANGE:  -4.21421469<br />BMI_0: 26.32206","BMI_0: 21.42230<br />VLOAD_log_CHANGE:  -9.08776105<br />BMI_0: 21.42230","BMI_0: 26.61577<br />VLOAD_log_CHANGE:  -8.56037583<br />BMI_0: 26.61577","BMI_0: 27.97225<br />VLOAD_log_CHANGE:  -9.08889887<br />BMI_0: 27.97225","BMI_0: 20.97698<br />VLOAD_log_CHANGE: -10.29563423<br />BMI_0: 20.97698","BMI_0: 30.58828<br />VLOAD_log_CHANGE:  -9.39040939<br />BMI_0: 30.58828","BMI_0: 16.49533<br />VLOAD_log_CHANGE:  -8.88025172<br />BMI_0: 16.49533","BMI_0: 24.74639<br />VLOAD_log_CHANGE:  -5.57689562<br />BMI_0: 24.74639","BMI_0: 23.42457<br />VLOAD_log_CHANGE:  -6.64382128<br />BMI_0: 23.42457","BMI_0: 22.87219<br />VLOAD_log_CHANGE:  -6.48634820<br />BMI_0: 22.87219","BMI_0: 24.09482<br />VLOAD_log_CHANGE:  -6.43158619<br />BMI_0: 24.09482","BMI_0: 27.91399<br />VLOAD_log_CHANGE:  -8.87738195<br />BMI_0: 27.91399","BMI_0: 18.90646<br />VLOAD_log_CHANGE:  -8.13065022<br />BMI_0: 18.90646","BMI_0: 23.79766<br />VLOAD_log_CHANGE:  -1.59206436<br />BMI_0: 23.79766","BMI_0: 35.71839<br />VLOAD_log_CHANGE:  -7.79764728<br />BMI_0: 35.71839","BMI_0: 25.15916<br />VLOAD_log_CHANGE: -10.20897393<br />BMI_0: 25.15916","BMI_0:       NA<br />VLOAD_log_CHANGE:           NA<br />BMI_0:       NA","BMI_0: 23.17762<br />VLOAD_log_CHANGE:  -6.76061699<br />BMI_0: 23.17762","BMI_0: 22.36873<br />VLOAD_log_CHANGE:  -9.43318959<br />BMI_0: 22.36873","BMI_0: 27.17900<br />VLOAD_log_CHANGE:  -7.28850941<br />BMI_0: 27.17900","BMI_0: 22.47903<br />VLOAD_log_CHANGE:  -6.41499230<br />BMI_0: 22.47903","BMI_0: 25.07123<br />VLOAD_log_CHANGE:  -3.46097325<br />BMI_0: 25.07123","BMI_0: 20.30381<br />VLOAD_log_CHANGE:  -1.21022704<br />BMI_0: 20.30381","BMI_0: 32.73481<br />VLOAD_log_CHANGE: -10.04682281<br />BMI_0: 32.73481","BMI_0: 35.42519<br />VLOAD_log_CHANGE:  -7.26790216<br />BMI_0: 35.42519","BMI_0: 35.49821<br />VLOAD_log_CHANGE:           NA<br />BMI_0: 35.49821","BMI_0: 27.45211<br />VLOAD_log_CHANGE:  -7.42449068<br />BMI_0: 27.45211","BMI_0: 25.46360<br />VLOAD_log_CHANGE:  -5.98087988<br />BMI_0: 25.46360","BMI_0: 27.98968<br />VLOAD_log_CHANGE:  -6.94821064<br />BMI_0: 27.98968","BMI_0: 22.37653<br />VLOAD_log_CHANGE:  -3.01016393<br />BMI_0: 22.37653","BMI_0: 23.74136<br />VLOAD_log_CHANGE: -12.81997650<br />BMI_0: 23.74136","BMI_0: 25.30432<br />VLOAD_log_CHANGE:  -5.86968021<br />BMI_0: 25.30432","BMI_0: 26.42398<br />VLOAD_log_CHANGE:  -0.64531974<br />BMI_0: 26.42398","BMI_0: 25.77775<br />VLOAD_log_CHANGE:  -0.39757600<br />BMI_0: 25.77775","BMI_0: 23.84927<br />VLOAD_log_CHANGE: -10.48991218<br />BMI_0: 23.84927","BMI_0: 21.53702<br />VLOAD_log_CHANGE:  -1.21859003<br />BMI_0: 21.53702","BMI_0: 24.36432<br />VLOAD_log_CHANGE:  -7.92163722<br />BMI_0: 24.36432","BMI_0: 24.44640<br />VLOAD_log_CHANGE:  -2.30955642<br />BMI_0: 24.44640","BMI_0: 28.00329<br />VLOAD_log_CHANGE:  -8.89088614<br />BMI_0: 28.00329","BMI_0: 23.36554<br />VLOAD_log_CHANGE:  -0.86416752<br />BMI_0: 23.36554","BMI_0: 21.88187<br />VLOAD_log_CHANGE: -12.55728491<br />BMI_0: 21.88187","BMI_0: 24.14137<br />VLOAD_log_CHANGE:  -8.62592029<br />BMI_0: 24.14137","BMI_0: 25.82638<br />VLOAD_log_CHANGE:  -5.78501329<br />BMI_0: 25.82638","BMI_0: 22.19006<br />VLOAD_log_CHANGE:  -8.91643900<br />BMI_0: 22.19006","BMI_0: 21.57987<br />VLOAD_log_CHANGE:  -6.15629162<br />BMI_0: 21.57987","BMI_0: 18.82735<br />VLOAD_log_CHANGE:  -8.54506048<br />BMI_0: 18.82735","BMI_0: 20.10291<br />VLOAD_log_CHANGE:           NA<br />BMI_0: 20.10291","BMI_0: 23.97946<br />VLOAD_log_CHANGE:  -7.47240272<br />BMI_0: 23.97946","BMI_0: 24.68183<br />VLOAD_log_CHANGE: -10.72729012<br />BMI_0: 24.68183","BMI_0:       NA<br />VLOAD_log_CHANGE:  -7.98583439<br />BMI_0:       NA","BMI_0: 28.95411<br />VLOAD_log_CHANGE:  -6.07094351<br />BMI_0: 28.95411","BMI_0: 28.18987<br />VLOAD_log_CHANGE:  -6.43460597<br />BMI_0: 28.18987","BMI_0: 21.85540<br />VLOAD_log_CHANGE:  -6.93953890<br />BMI_0: 21.85540","BMI_0: 27.62866<br />VLOAD_log_CHANGE:           NA<br />BMI_0: 27.62866","BMI_0: 23.59117<br />VLOAD_log_CHANGE:  -5.73657230<br />BMI_0: 23.59117","BMI_0:       NA<br />VLOAD_log_CHANGE:  -6.11673766<br />BMI_0:       NA","BMI_0: 25.37766<br />VLOAD_log_CHANGE:   2.68771253<br />BMI_0: 25.37766","BMI_0: 20.36830<br />VLOAD_log_CHANGE:  -7.46695399<br />BMI_0: 20.36830","BMI_0: 27.07914<br />VLOAD_log_CHANGE:  -5.34421047<br />BMI_0: 27.07914","BMI_0: 18.36093<br />VLOAD_log_CHANGE:  -3.38819657<br />BMI_0: 18.36093","BMI_0: 19.51274<br />VLOAD_log_CHANGE: -10.97857292<br />BMI_0: 19.51274","BMI_0: 26.10182<br />VLOAD_log_CHANGE:  -1.36091127<br />BMI_0: 26.10182","BMI_0: 23.60874<br />VLOAD_log_CHANGE:  -3.84837298<br />BMI_0: 23.60874","BMI_0:       NA<br />VLOAD_log_CHANGE:           NA<br />BMI_0:       NA","BMI_0: 27.54451<br />VLOAD_log_CHANGE:  -7.78728560<br />BMI_0: 27.54451","BMI_0: 20.21603<br />VLOAD_log_CHANGE:  -6.43881775<br />BMI_0: 20.21603","BMI_0: 23.14055<br />VLOAD_log_CHANGE:  -6.37893934<br />BMI_0: 23.14055","BMI_0: 19.16628<br />VLOAD_log_CHANGE:  -7.22329568<br />BMI_0: 19.16628","BMI_0: 33.61987<br />VLOAD_log_CHANGE:  -7.36411717<br />BMI_0: 33.61987","BMI_0: 20.86480<br />VLOAD_log_CHANGE:  -9.71493078<br />BMI_0: 20.86480","BMI_0: 24.53882<br />VLOAD_log_CHANGE:  -5.08891821<br />BMI_0: 24.53882","BMI_0: 34.22889<br />VLOAD_log_CHANGE:  -5.93390417<br />BMI_0: 34.22889","BMI_0: 23.68084<br />VLOAD_log_CHANGE:  -7.75461348<br />BMI_0: 23.68084","BMI_0: 24.21253<br />VLOAD_log_CHANGE:  -9.97967448<br />BMI_0: 24.21253","BMI_0: 25.65908<br />VLOAD_log_CHANGE:  -6.45441209<br />BMI_0: 25.65908","BMI_0: 35.88133<br />VLOAD_log_CHANGE:  -8.29353951<br />BMI_0: 35.88133","BMI_0: 38.43675<br />VLOAD_log_CHANGE:  -7.42803257<br />BMI_0: 38.43675","BMI_0: 28.10799<br />VLOAD_log_CHANGE: -10.26134163<br />BMI_0: 28.10799","BMI_0: 18.97631<br />VLOAD_log_CHANGE:  -5.11685537<br />BMI_0: 18.97631","BMI_0: 21.48903<br />VLOAD_log_CHANGE:  -7.00947601<br />BMI_0: 21.48903","BMI_0: 22.95456<br />VLOAD_log_CHANGE:  -1.23071590<br />BMI_0: 22.95456","BMI_0: 22.93735<br />VLOAD_log_CHANGE:  -6.03879376<br />BMI_0: 22.93735","BMI_0: 30.43823<br />VLOAD_log_CHANGE:   1.56397554<br />BMI_0: 30.43823","BMI_0: 23.77691<br />VLOAD_log_CHANGE:  -5.28699265<br />BMI_0: 23.77691","BMI_0: 19.61477<br />VLOAD_log_CHANGE:  -8.42767478<br />BMI_0: 19.61477","BMI_0: 25.54230<br />VLOAD_log_CHANGE:  -5.93754142<br />BMI_0: 25.54230","BMI_0: 28.50098<br />VLOAD_log_CHANGE:  -9.82387987<br />BMI_0: 28.50098","BMI_0: 32.50180<br />VLOAD_log_CHANGE:  -8.76671898<br />BMI_0: 32.50180","BMI_0: 21.70972<br />VLOAD_log_CHANGE:  -6.15531705<br />BMI_0: 21.70972","BMI_0: 25.44044<br />VLOAD_log_CHANGE:  -5.38878738<br />BMI_0: 25.44044","BMI_0: 17.66341<br />VLOAD_log_CHANGE:  -8.59955138<br />BMI_0: 17.66341","BMI_0: 18.85808<br />VLOAD_log_CHANGE:  -9.84406923<br />BMI_0: 18.85808","BMI_0: 25.84318<br />VLOAD_log_CHANGE:  -7.08758214<br />BMI_0: 25.84318","BMI_0: 29.38706<br />VLOAD_log_CHANGE:  -6.06861416<br />BMI_0: 29.38706","BMI_0: 18.31754<br />VLOAD_log_CHANGE:  -6.00520228<br />BMI_0: 18.31754","BMI_0: 24.42194<br />VLOAD_log_CHANGE:  -7.34030246<br />BMI_0: 24.42194","BMI_0: 37.58512<br />VLOAD_log_CHANGE:  -5.86078622<br />BMI_0: 37.58512","BMI_0: 24.92467<br />VLOAD_log_CHANGE:  -6.02827852<br />BMI_0: 24.92467","BMI_0: 23.42483<br />VLOAD_log_CHANGE:  -9.78110268<br />BMI_0: 23.42483","BMI_0: 25.55885<br />VLOAD_log_CHANGE:  -7.48313174<br />BMI_0: 25.55885","BMI_0: 18.88271<br />VLOAD_log_CHANGE:  -8.18393930<br />BMI_0: 18.88271","BMI_0: 23.06424<br />VLOAD_log_CHANGE:  -8.74722208<br />BMI_0: 23.06424","BMI_0: 22.80599<br />VLOAD_log_CHANGE:  -6.00116783<br />BMI_0: 22.80599","BMI_0: 29.50277<br />VLOAD_log_CHANGE:  -9.78445061<br />BMI_0: 29.50277","BMI_0: 21.20696<br />VLOAD_log_CHANGE:  -9.08843978<br />BMI_0: 21.20696","BMI_0: 20.73982<br />VLOAD_log_CHANGE:  -6.23123425<br />BMI_0: 20.73982","BMI_0: 23.34599<br />VLOAD_log_CHANGE:  -5.10369185<br />BMI_0: 23.34599","BMI_0: 28.33548<br />VLOAD_log_CHANGE:  -1.56133190<br />BMI_0: 28.33548","BMI_0:       NA<br />VLOAD_log_CHANGE: -10.25559663<br />BMI_0:       NA","BMI_0: 26.01826<br />VLOAD_log_CHANGE:  -6.99166096<br />BMI_0: 26.01826","BMI_0: 28.19027<br />VLOAD_log_CHANGE:  -5.15291860<br />BMI_0: 28.19027","BMI_0: 24.31254<br />VLOAD_log_CHANGE:   7.59067177<br />BMI_0: 24.31254","BMI_0: 26.72543<br />VLOAD_log_CHANGE:  -5.15193783<br />BMI_0: 26.72543","BMI_0: 21.66121<br />VLOAD_log_CHANGE: -10.67073288<br />BMI_0: 21.66121","BMI_0: 21.89629<br />VLOAD_log_CHANGE:  -6.05902591<br />BMI_0: 21.89629","BMI_0: 24.69690<br />VLOAD_log_CHANGE:  -9.51989808<br />BMI_0: 24.69690","BMI_0: 25.94472<br />VLOAD_log_CHANGE:  -7.71501978<br />BMI_0: 25.94472","BMI_0: 29.25018<br />VLOAD_log_CHANGE:  -7.74565722<br />BMI_0: 29.25018","BMI_0: 24.32759<br />VLOAD_log_CHANGE:  -9.37616606<br />BMI_0: 24.32759","BMI_0: 32.07433<br />VLOAD_log_CHANGE:  -5.59782419<br />BMI_0: 32.07433","BMI_0: 25.57124<br />VLOAD_log_CHANGE:  -6.78420832<br />BMI_0: 25.57124","BMI_0: 28.32350<br />VLOAD_log_CHANGE:  -6.83292910<br />BMI_0: 28.32350","BMI_0: 30.92269<br />VLOAD_log_CHANGE:  -6.18584221<br />BMI_0: 30.92269","BMI_0: 25.93892<br />VLOAD_log_CHANGE:  -9.48291014<br />BMI_0: 25.93892","BMI_0:       NA<br />VLOAD_log_CHANGE:           NA<br />BMI_0:       NA","BMI_0: 29.02028<br />VLOAD_log_CHANGE:  -9.49366609<br />BMI_0: 29.02028","BMI_0: 20.75600<br />VLOAD_log_CHANGE:  -6.37806446<br />BMI_0: 20.75600","BMI_0: 20.64574<br />VLOAD_log_CHANGE:           NA<br />BMI_0: 20.64574","BMI_0: 24.38456<br />VLOAD_log_CHANGE:  -6.92902741<br />BMI_0: 24.38456","BMI_0: 23.35417<br />VLOAD_log_CHANGE: -10.32244457<br />BMI_0: 23.35417","BMI_0: 24.25496<br />VLOAD_log_CHANGE:  -6.27556065<br />BMI_0: 24.25496","BMI_0: 28.89143<br />VLOAD_log_CHANGE:  -5.01644783<br />BMI_0: 28.89143","BMI_0: 23.65187<br />VLOAD_log_CHANGE:  -5.59576616<br />BMI_0: 23.65187","BMI_0: 27.69579<br />VLOAD_log_CHANGE:  -1.10881567<br />BMI_0: 27.69579","BMI_0: 26.01372<br />VLOAD_log_CHANGE: -10.16844791<br />BMI_0: 26.01372","BMI_0: 22.14340<br />VLOAD_log_CHANGE:  -6.95841773<br />BMI_0: 22.14340","BMI_0: 25.15233<br />VLOAD_log_CHANGE:  -5.98561253<br />BMI_0: 25.15233","BMI_0: 20.69746<br />VLOAD_log_CHANGE:  -3.82821574<br />BMI_0: 20.69746","BMI_0: 22.71894<br />VLOAD_log_CHANGE:  -8.67302246<br />BMI_0: 22.71894","BMI_0: 25.40078<br />VLOAD_log_CHANGE:  -6.59421801<br />BMI_0: 25.40078","BMI_0: 25.60492<br />VLOAD_log_CHANGE:  -7.65302041<br />BMI_0: 25.60492","BMI_0: 24.72999<br />VLOAD_log_CHANGE:  -6.22419166<br />BMI_0: 24.72999","BMI_0: 22.39282<br />VLOAD_log_CHANGE:  -5.59198200<br />BMI_0: 22.39282","BMI_0: 23.84879<br />VLOAD_log_CHANGE: -10.34425298<br />BMI_0: 23.84879","BMI_0: 25.85165<br />VLOAD_log_CHANGE:  -9.97744143<br />BMI_0: 25.85165","BMI_0: 19.76774<br />VLOAD_log_CHANGE:  -3.46980371<br />BMI_0: 19.76774","BMI_0: 26.93885<br />VLOAD_log_CHANGE:  -6.57672277<br />BMI_0: 26.93885","BMI_0: 23.23123<br />VLOAD_log_CHANGE:  -8.37112642<br />BMI_0: 23.23123","BMI_0: 22.17518<br />VLOAD_log_CHANGE:  -4.10268433<br />BMI_0: 22.17518","BMI_0: 19.06301<br />VLOAD_log_CHANGE:  -5.91156840<br />BMI_0: 19.06301","BMI_0: 25.05481<br />VLOAD_log_CHANGE:  -6.20027051<br />BMI_0: 25.05481","BMI_0: 28.27142<br />VLOAD_log_CHANGE:  -6.16271371<br />BMI_0: 28.27142","BMI_0: 26.32621<br />VLOAD_log_CHANGE:   0.79028345<br />BMI_0: 26.32621","BMI_0: 37.37963<br />VLOAD_log_CHANGE:  -5.24258209<br />BMI_0: 37.37963","BMI_0: 23.52901<br />VLOAD_log_CHANGE:  -6.27838740<br />BMI_0: 23.52901","BMI_0: 35.28852<br />VLOAD_log_CHANGE:  -5.73355231<br />BMI_0: 35.28852","BMI_0: 21.44542<br />VLOAD_log_CHANGE:  -6.12789453<br />BMI_0: 21.44542","BMI_0: 22.58481<br />VLOAD_log_CHANGE:  -6.63802603<br />BMI_0: 22.58481","BMI_0: 18.14498<br />VLOAD_log_CHANGE: -10.53222954<br />BMI_0: 18.14498","BMI_0: 21.63630<br />VLOAD_log_CHANGE:  -6.66282819<br />BMI_0: 21.63630","BMI_0: 30.11316<br />VLOAD_log_CHANGE:  -8.61890183<br />BMI_0: 30.11316","BMI_0: 23.65907<br />VLOAD_log_CHANGE:  -7.02068706<br />BMI_0: 23.65907","BMI_0: 25.33119<br />VLOAD_log_CHANGE:  -6.18929690<br />BMI_0: 25.33119","BMI_0: 30.60311<br />VLOAD_log_CHANGE:  -8.77454491<br />BMI_0: 30.60311","BMI_0: 21.80724<br />VLOAD_log_CHANGE:           NA<br />BMI_0: 21.80724","BMI_0: 23.15386<br />VLOAD_log_CHANGE:  -4.98351894<br />BMI_0: 23.15386","BMI_0: 24.83487<br />VLOAD_log_CHANGE:   1.23997933<br />BMI_0: 24.83487","BMI_0: 25.11192<br />VLOAD_log_CHANGE:   0.17381433<br />BMI_0: 25.11192","BMI_0: 20.02774<br />VLOAD_log_CHANGE:  -3.20194482<br />BMI_0: 20.02774","BMI_0: 22.61653<br />VLOAD_log_CHANGE:           NA<br />BMI_0: 22.61653","BMI_0: 19.00612<br />VLOAD_log_CHANGE:  -6.02660693<br />BMI_0: 19.00612","BMI_0: 22.25798<br />VLOAD_log_CHANGE: -10.53866658<br />BMI_0: 22.25798","BMI_0:       NA<br />VLOAD_log_CHANGE:           NA<br />BMI_0:       NA","BMI_0: 28.10653<br />VLOAD_log_CHANGE:  -6.29327444<br />BMI_0: 28.10653","BMI_0: 22.08394<br />VLOAD_log_CHANGE:  -6.12844931<br />BMI_0: 22.08394","BMI_0: 24.69869<br />VLOAD_log_CHANGE:  -5.78553312<br />BMI_0: 24.69869","BMI_0: 29.62938<br />VLOAD_log_CHANGE:  -1.55233922<br />BMI_0: 29.62938","BMI_0: 28.57862<br />VLOAD_log_CHANGE:  -6.95777357<br />BMI_0: 28.57862","BMI_0: 26.99608<br />VLOAD_log_CHANGE:  -7.87556261<br />BMI_0: 26.99608","BMI_0: 23.77773<br />VLOAD_log_CHANGE: -10.67546209<br />BMI_0: 23.77773","BMI_0: 23.10167<br />VLOAD_log_CHANGE:  -9.77317004<br />BMI_0: 23.10167","BMI_0: 20.98788<br />VLOAD_log_CHANGE:  -4.32092307<br />BMI_0: 20.98788","BMI_0: 23.58040<br />VLOAD_log_CHANGE:  -7.29550891<br />BMI_0: 23.58040","BMI_0: 31.06015<br />VLOAD_log_CHANGE:  -3.63626650<br />BMI_0: 31.06015","BMI_0: 30.56879<br />VLOAD_log_CHANGE:  -3.85069750<br />BMI_0: 30.56879","BMI_0: 28.85030<br />VLOAD_log_CHANGE:  -7.90429141<br />BMI_0: 28.85030","BMI_0: 38.70894<br />VLOAD_log_CHANGE:  -6.48730343<br />BMI_0: 38.70894","BMI_0: 22.73043<br />VLOAD_log_CHANGE:  -7.00542631<br />BMI_0: 22.73043","BMI_0: 27.36651<br />VLOAD_log_CHANGE:  -9.06727799<br />BMI_0: 27.36651","BMI_0: 21.86069<br />VLOAD_log_CHANGE:  -1.65805562<br />BMI_0: 21.86069","BMI_0: 22.05305<br />VLOAD_log_CHANGE:  -5.01218362<br />BMI_0: 22.05305","BMI_0: 32.13917<br />VLOAD_log_CHANGE:  -3.84685143<br />BMI_0: 32.13917","BMI_0: 26.25424<br />VLOAD_log_CHANGE:  -6.44199794<br />BMI_0: 26.25424","BMI_0: 22.06321<br />VLOAD_log_CHANGE:  -6.57096699<br />BMI_0: 22.06321","BMI_0: 17.53589<br />VLOAD_log_CHANGE:  -7.94513026<br />BMI_0: 17.53589","BMI_0: 18.54027<br />VLOAD_log_CHANGE: -10.56514923<br />BMI_0: 18.54027","BMI_0: 26.95299<br />VLOAD_log_CHANGE:  -7.28160765<br />BMI_0: 26.95299","BMI_0: 26.57797<br />VLOAD_log_CHANGE:  -5.91593248<br />BMI_0: 26.57797","BMI_0: 24.27906<br />VLOAD_log_CHANGE:  -1.68972479<br />BMI_0: 24.27906","BMI_0: 23.54915<br />VLOAD_log_CHANGE:  -8.15078273<br />BMI_0: 23.54915","BMI_0: 19.36613<br />VLOAD_log_CHANGE:  -4.83131817<br />BMI_0: 19.36613","BMI_0: 25.96163<br />VLOAD_log_CHANGE:  -6.94821569<br />BMI_0: 25.96163","BMI_0: 23.72663<br />VLOAD_log_CHANGE:  -8.53311028<br />BMI_0: 23.72663","BMI_0: 22.77067<br />VLOAD_log_CHANGE:  -5.80342139<br />BMI_0: 22.77067","BMI_0: 25.65700<br />VLOAD_log_CHANGE: -10.76675718<br />BMI_0: 25.65700","BMI_0: 27.00585<br />VLOAD_log_CHANGE:  -8.49079321<br />BMI_0: 27.00585","BMI_0: 25.36898<br />VLOAD_log_CHANGE:  -9.12007644<br />BMI_0: 25.36898","BMI_0: 29.01077<br />VLOAD_log_CHANGE:  -1.32152735<br />BMI_0: 29.01077","BMI_0: 24.60383<br />VLOAD_log_CHANGE:  -2.52127429<br />BMI_0: 24.60383","BMI_0: 24.67558<br />VLOAD_log_CHANGE:  -8.45301727<br />BMI_0: 24.67558","BMI_0: 24.32572<br />VLOAD_log_CHANGE:  -7.55583536<br />BMI_0: 24.32572","BMI_0: 24.51009<br />VLOAD_log_CHANGE: -11.16407696<br />BMI_0: 24.51009","BMI_0: 29.20910<br />VLOAD_log_CHANGE: -12.69468333<br />BMI_0: 29.20910","BMI_0: 26.17449<br />VLOAD_log_CHANGE:   0.38253807<br />BMI_0: 26.17449","BMI_0: 29.48015<br />VLOAD_log_CHANGE: -10.90049154<br />BMI_0: 29.48015","BMI_0: 30.25579<br />VLOAD_log_CHANGE:  -7.57819662<br />BMI_0: 30.25579","BMI_0: 23.60074<br />VLOAD_log_CHANGE:  -4.73774342<br />BMI_0: 23.60074","BMI_0: 20.91576<br />VLOAD_log_CHANGE:  -7.07351946<br />BMI_0: 20.91576","BMI_0: 23.51573<br />VLOAD_log_CHANGE:  -7.88870952<br />BMI_0: 23.51573","BMI_0: 25.25402<br />VLOAD_log_CHANGE:  -6.17832511<br />BMI_0: 25.25402","BMI_0: 23.31477<br />VLOAD_log_CHANGE:  -6.66358669<br />BMI_0: 23.31477","BMI_0: 27.57322<br />VLOAD_log_CHANGE:  -8.66567477<br />BMI_0: 27.57322","BMI_0: 21.95516<br />VLOAD_log_CHANGE:  -5.10028686<br />BMI_0: 21.95516","BMI_0: 22.17557<br />VLOAD_log_CHANGE:  -7.62900389<br />BMI_0: 22.17557","BMI_0: 24.07525<br />VLOAD_log_CHANGE:   0.83129752<br />BMI_0: 24.07525","BMI_0: 30.60705<br />VLOAD_log_CHANGE:  -7.12590456<br />BMI_0: 30.60705","BMI_0: 21.05078<br />VLOAD_log_CHANGE:  -0.47836090<br />BMI_0: 21.05078","BMI_0: 18.22015<br />VLOAD_log_CHANGE:  -4.42994534<br />BMI_0: 18.22015","BMI_0: 24.14696<br />VLOAD_log_CHANGE:           NA<br />BMI_0: 24.14696","BMI_0: 25.47521<br />VLOAD_log_CHANGE: -11.47870154<br />BMI_0: 25.47521","BMI_0:       NA<br />VLOAD_log_CHANGE:           NA<br />BMI_0:       NA","BMI_0: 23.56449<br />VLOAD_log_CHANGE:  -8.90390579<br />BMI_0: 23.56449","BMI_0: 20.86517<br />VLOAD_log_CHANGE:  -4.66715893<br />BMI_0: 20.86517","BMI_0: 18.59186<br />VLOAD_log_CHANGE:           NA<br />BMI_0: 18.59186","BMI_0: 29.31917<br />VLOAD_log_CHANGE:  -5.23377885<br />BMI_0: 29.31917","BMI_0: 21.09086<br />VLOAD_log_CHANGE:  -3.86575141<br />BMI_0: 21.09086","BMI_0: 20.10335<br />VLOAD_log_CHANGE:  -5.85334732<br />BMI_0: 20.10335","BMI_0: 18.87868<br />VLOAD_log_CHANGE:   1.21163790<br />BMI_0: 18.87868","BMI_0: 28.58453<br />VLOAD_log_CHANGE:  -9.01509856<br />BMI_0: 28.58453","BMI_0: 29.73550<br />VLOAD_log_CHANGE:  -6.52009412<br />BMI_0: 29.73550","BMI_0: 28.52513<br />VLOAD_log_CHANGE:  -7.48960440<br />BMI_0: 28.52513","BMI_0: 24.43248<br />VLOAD_log_CHANGE: -10.82375371<br />BMI_0: 24.43248","BMI_0: 24.91221<br />VLOAD_log_CHANGE:  -2.32006667<br />BMI_0: 24.91221","BMI_0: 24.53105<br />VLOAD_log_CHANGE:   1.86075234<br />BMI_0: 24.53105","BMI_0: 21.65342<br />VLOAD_log_CHANGE:  -8.11847798<br />BMI_0: 21.65342","BMI_0: 23.91922<br />VLOAD_log_CHANGE:  -3.08840964<br />BMI_0: 23.91922","BMI_0: 21.86985<br />VLOAD_log_CHANGE:  -6.35517668<br />BMI_0: 21.86985","BMI_0: 19.22059<br />VLOAD_log_CHANGE:  -7.97272186<br />BMI_0: 19.22059","BMI_0: 22.58746<br />VLOAD_log_CHANGE:  -7.85837747<br />BMI_0: 22.58746","BMI_0: 23.24736<br />VLOAD_log_CHANGE: -10.01420308<br />BMI_0: 23.24736","BMI_0: 20.07202<br />VLOAD_log_CHANGE:   1.53287823<br />BMI_0: 20.07202","BMI_0: 21.71791<br />VLOAD_log_CHANGE:   0.29059675<br />BMI_0: 21.71791","BMI_0: 21.59779<br />VLOAD_log_CHANGE:  -9.67715141<br />BMI_0: 21.59779","BMI_0:       NA<br />VLOAD_log_CHANGE:  -5.60901381<br />BMI_0:       NA","BMI_0: 23.01872<br />VLOAD_log_CHANGE:  -2.20088849<br />BMI_0: 23.01872","BMI_0: 19.96502<br />VLOAD_log_CHANGE:  -4.00671404<br />BMI_0: 19.96502","BMI_0: 22.86095<br />VLOAD_log_CHANGE:  -1.75499857<br />BMI_0: 22.86095","BMI_0: 27.94190<br />VLOAD_log_CHANGE:  -5.44931089<br />BMI_0: 27.94190","BMI_0: 23.79050<br />VLOAD_log_CHANGE: -10.64768425<br />BMI_0: 23.79050","BMI_0: 29.36740<br />VLOAD_log_CHANGE:  -5.81267010<br />BMI_0: 29.36740","BMI_0: 26.39365<br />VLOAD_log_CHANGE:           NA<br />BMI_0: 26.39365","BMI_0: 32.60624<br />VLOAD_log_CHANGE:  -7.39570554<br />BMI_0: 32.60624","BMI_0: 20.75030<br />VLOAD_log_CHANGE:  -8.31956926<br />BMI_0: 20.75030","BMI_0: 19.50065<br />VLOAD_log_CHANGE:  -8.82732145<br />BMI_0: 19.50065","BMI_0: 24.76070<br />VLOAD_log_CHANGE:  -8.83530920<br />BMI_0: 24.76070","BMI_0: 22.92863<br />VLOAD_log_CHANGE:  -5.31335991<br />BMI_0: 22.92863","BMI_0: 24.48358<br />VLOAD_log_CHANGE:  -6.53472889<br />BMI_0: 24.48358","BMI_0:       NA<br />VLOAD_log_CHANGE:           NA<br />BMI_0:       NA","BMI_0: 33.40087<br />VLOAD_log_CHANGE:  -2.34020965<br />BMI_0: 33.40087","BMI_0: 21.58432<br />VLOAD_log_CHANGE:  -6.95218220<br />BMI_0: 21.58432","BMI_0: 24.16663<br />VLOAD_log_CHANGE:  -4.72191763<br />BMI_0: 24.16663","BMI_0: 28.46705<br />VLOAD_log_CHANGE:  -6.91362040<br />BMI_0: 28.46705","BMI_0: 34.87898<br />VLOAD_log_CHANGE:  -8.12881695<br />BMI_0: 34.87898","BMI_0: 34.53379<br />VLOAD_log_CHANGE:  -4.69546782<br />BMI_0: 34.53379","BMI_0: 24.04861<br />VLOAD_log_CHANGE:  -4.98683999<br />BMI_0: 24.04861","BMI_0: 26.39190<br />VLOAD_log_CHANGE:  -7.26860151<br />BMI_0: 26.39190","BMI_0: 23.79130<br />VLOAD_log_CHANGE:  -4.33073334<br />BMI_0: 23.79130","BMI_0: 22.80063<br />VLOAD_log_CHANGE:  -5.92217930<br />BMI_0: 22.80063","BMI_0: 27.30906<br />VLOAD_log_CHANGE: -10.66723298<br />BMI_0: 27.30906","BMI_0: 24.44143<br />VLOAD_log_CHANGE:  -8.96117364<br />BMI_0: 24.44143","BMI_0: 31.46422<br />VLOAD_log_CHANGE:  -6.32313632<br />BMI_0: 31.46422","BMI_0: 25.44574<br />VLOAD_log_CHANGE:  -9.35893278<br />BMI_0: 25.44574","BMI_0: 23.18377<br />VLOAD_log_CHANGE:  -8.33003372<br />BMI_0: 23.18377","BMI_0: 23.54234<br />VLOAD_log_CHANGE:  -3.86563944<br />BMI_0: 23.54234","BMI_0: 25.97729<br />VLOAD_log_CHANGE:  -2.14645110<br />BMI_0: 25.97729","BMI_0: 27.92746<br />VLOAD_log_CHANGE:  -6.00427439<br />BMI_0: 27.92746","BMI_0: 27.68951<br />VLOAD_log_CHANGE:  -8.24058481<br />BMI_0: 27.68951","BMI_0: 26.95672<br />VLOAD_log_CHANGE:  -7.82040302<br />BMI_0: 26.95672","BMI_0: 24.79668<br />VLOAD_log_CHANGE:  -6.89735354<br />BMI_0: 24.79668","BMI_0: 23.39881<br />VLOAD_log_CHANGE:  -5.63144873<br />BMI_0: 23.39881","BMI_0: 23.32380<br />VLOAD_log_CHANGE:  -8.52423501<br />BMI_0: 23.32380","BMI_0: 24.44467<br />VLOAD_log_CHANGE:  -5.10235778<br />BMI_0: 24.44467","BMI_0: 35.37199<br />VLOAD_log_CHANGE: -10.30951917<br />BMI_0: 35.37199","BMI_0: 26.77318<br />VLOAD_log_CHANGE:  -7.30214362<br />BMI_0: 26.77318","BMI_0: 29.53846<br />VLOAD_log_CHANGE:  -4.79991426<br />BMI_0: 29.53846","BMI_0: 28.67390<br />VLOAD_log_CHANGE:  -7.51945512<br />BMI_0: 28.67390","BMI_0: 28.52451<br />VLOAD_log_CHANGE:  -8.86921064<br />BMI_0: 28.52451","BMI_0: 20.15647<br />VLOAD_log_CHANGE:  -5.89480216<br />BMI_0: 20.15647","BMI_0: 18.23947<br />VLOAD_log_CHANGE:  -9.34340435<br />BMI_0: 18.23947","BMI_0: 29.83329<br />VLOAD_log_CHANGE:  -7.13279703<br />BMI_0: 29.83329","BMI_0: 22.56971<br />VLOAD_log_CHANGE:  -6.19151005<br />BMI_0: 22.56971","BMI_0: 32.41563<br />VLOAD_log_CHANGE:  -1.93395506<br />BMI_0: 32.41563","BMI_0: 26.93869<br />VLOAD_log_CHANGE:  -3.76409466<br />BMI_0: 26.93869","BMI_0: 22.02286<br />VLOAD_log_CHANGE:  -1.71157420<br />BMI_0: 22.02286","BMI_0: 26.39484<br />VLOAD_log_CHANGE:  -7.19158970<br />BMI_0: 26.39484","BMI_0: 28.70382<br />VLOAD_log_CHANGE: -10.41348959<br />BMI_0: 28.70382","BMI_0: 23.87603<br />VLOAD_log_CHANGE:  -9.40628914<br />BMI_0: 23.87603","BMI_0: 22.85032<br />VLOAD_log_CHANGE:  -1.22113242<br />BMI_0: 22.85032","BMI_0: 28.29077<br />VLOAD_log_CHANGE:  -7.23541327<br />BMI_0: 28.29077","BMI_0: 22.24743<br />VLOAD_log_CHANGE:  -8.90743698<br />BMI_0: 22.24743","BMI_0: 26.32231<br />VLOAD_log_CHANGE:  -8.43992330<br />BMI_0: 26.32231","BMI_0: 26.80378<br />VLOAD_log_CHANGE:  -2.48873492<br />BMI_0: 26.80378","BMI_0: 27.72696<br />VLOAD_log_CHANGE:  -5.26957490<br />BMI_0: 27.72696","BMI_0: 22.93120<br />VLOAD_log_CHANGE:  -8.74922512<br />BMI_0: 22.93120","BMI_0: 28.60370<br />VLOAD_log_CHANGE:  -8.10074658<br />BMI_0: 28.60370","BMI_0: 28.31686<br />VLOAD_log_CHANGE:  -3.63245521<br />BMI_0: 28.31686","BMI_0: 30.37820<br />VLOAD_log_CHANGE:  -5.26347139<br />BMI_0: 30.37820","BMI_0: 22.56134<br />VLOAD_log_CHANGE:  -3.97566529<br />BMI_0: 22.56134","BMI_0: 21.04231<br />VLOAD_log_CHANGE:  -0.46984635<br />BMI_0: 21.04231","BMI_0: 24.90941<br />VLOAD_log_CHANGE:  -5.03687796<br />BMI_0: 24.90941","BMI_0: 22.18449<br />VLOAD_log_CHANGE:  -7.00033446<br />BMI_0: 22.18449","BMI_0: 34.65119<br />VLOAD_log_CHANGE:  -1.58134720<br />BMI_0: 34.65119","BMI_0: 28.57691<br />VLOAD_log_CHANGE:  -7.84169880<br />BMI_0: 28.57691","BMI_0: 26.46704<br />VLOAD_log_CHANGE:  -5.88969645<br />BMI_0: 26.46704","BMI_0: 24.68743<br />VLOAD_log_CHANGE:  -4.28782161<br />BMI_0: 24.68743","BMI_0: 30.31199<br />VLOAD_log_CHANGE:  -5.63158170<br />BMI_0: 30.31199","BMI_0: 22.72019<br />VLOAD_log_CHANGE:  -8.99285724<br />BMI_0: 22.72019","BMI_0: 27.91796<br />VLOAD_log_CHANGE:  -4.22288879<br />BMI_0: 27.91796","BMI_0: 33.63368<br />VLOAD_log_CHANGE:  -4.59838250<br />BMI_0: 33.63368","BMI_0: 24.52166<br />VLOAD_log_CHANGE:  -3.54403032<br />BMI_0: 24.52166","BMI_0: 36.70451<br />VLOAD_log_CHANGE:  -5.98428607<br />BMI_0: 36.70451","BMI_0: 30.44280<br />VLOAD_log_CHANGE: -10.86686223<br />BMI_0: 30.44280","BMI_0: 20.73060<br />VLOAD_log_CHANGE:  -8.64831891<br />BMI_0: 20.73060","BMI_0: 19.55320<br />VLOAD_log_CHANGE:  -6.19859262<br />BMI_0: 19.55320","BMI_0: 27.74741<br />VLOAD_log_CHANGE:  -7.89474970<br />BMI_0: 27.74741","BMI_0: 27.27466<br />VLOAD_log_CHANGE:  -0.70358651<br />BMI_0: 27.27466","BMI_0: 26.78604<br />VLOAD_log_CHANGE:  -0.52973532<br />BMI_0: 26.78604","BMI_0: 25.38078<br />VLOAD_log_CHANGE:  -3.69678135<br />BMI_0: 25.38078","BMI_0: 26.03266<br />VLOAD_log_CHANGE:  -4.93288470<br />BMI_0: 26.03266","BMI_0: 24.90371<br />VLOAD_log_CHANGE:  -6.35860726<br />BMI_0: 24.90371","BMI_0: 24.38168<br />VLOAD_log_CHANGE:  -6.98395587<br />BMI_0: 24.38168","BMI_0: 27.38400<br />VLOAD_log_CHANGE:  -8.18983816<br />BMI_0: 27.38400","BMI_0: 20.87953<br />VLOAD_log_CHANGE:  -3.98823963<br />BMI_0: 20.87953","BMI_0:       NA<br />VLOAD_log_CHANGE:   0.01231793<br />BMI_0:       NA","BMI_0: 23.22718<br />VLOAD_log_CHANGE:  -5.96245162<br />BMI_0: 23.22718","BMI_0: 26.76091<br />VLOAD_log_CHANGE:  -4.65123555<br />BMI_0: 26.76091","BMI_0: 26.00853<br />VLOAD_log_CHANGE:  -8.20348651<br />BMI_0: 26.00853","BMI_0: 20.11872<br />VLOAD_log_CHANGE:  -5.58902563<br />BMI_0: 20.11872","BMI_0: 25.52664<br />VLOAD_log_CHANGE:  -8.01180729<br />BMI_0: 25.52664","BMI_0: 28.17892<br />VLOAD_log_CHANGE:  -8.07060999<br />BMI_0: 28.17892","BMI_0: 20.03681<br />VLOAD_log_CHANGE:  -1.36882550<br />BMI_0: 20.03681","BMI_0: 26.78973<br />VLOAD_log_CHANGE:  -4.59929136<br />BMI_0: 26.78973","BMI_0: 24.64589<br />VLOAD_log_CHANGE:  -3.42022218<br />BMI_0: 24.64589","BMI_0: 23.04177<br />VLOAD_log_CHANGE:  -5.99617863<br />BMI_0: 23.04177","BMI_0: 22.70943<br />VLOAD_log_CHANGE:  -9.80966603<br />BMI_0: 22.70943","BMI_0: 23.65750<br />VLOAD_log_CHANGE:  -6.03843121<br />BMI_0: 23.65750","BMI_0: 29.82873<br />VLOAD_log_CHANGE:  -7.48713168<br />BMI_0: 29.82873","BMI_0: 27.16453<br />VLOAD_log_CHANGE:  -7.23400538<br />BMI_0: 27.16453","BMI_0: 25.76387<br />VLOAD_log_CHANGE:  -4.22000014<br />BMI_0: 25.76387","BMI_0: 23.29970<br />VLOAD_log_CHANGE:  -3.04659069<br />BMI_0: 23.29970","BMI_0: 21.39054<br />VLOAD_log_CHANGE:  -6.25692449<br />BMI_0: 21.39054","BMI_0: 18.39350<br />VLOAD_log_CHANGE:  -6.45598442<br />BMI_0: 18.39350","BMI_0: 24.13342<br />VLOAD_log_CHANGE:  -7.41620475<br />BMI_0: 24.13342","BMI_0: 24.28873<br />VLOAD_log_CHANGE:  -2.81709313<br />BMI_0: 24.28873","BMI_0: 20.57527<br />VLOAD_log_CHANGE:  -9.27615365<br />BMI_0: 20.57527","BMI_0: 22.13442<br />VLOAD_log_CHANGE:  -9.33515049<br />BMI_0: 22.13442","BMI_0: 28.48654<br />VLOAD_log_CHANGE:  -3.97857813<br />BMI_0: 28.48654","BMI_0: 18.54354<br />VLOAD_log_CHANGE:  -4.05671502<br />BMI_0: 18.54354","BMI_0: 23.58865<br />VLOAD_log_CHANGE:  -1.59231453<br />BMI_0: 23.58865","BMI_0: 24.93766<br />VLOAD_log_CHANGE:  -7.95104457<br />BMI_0: 24.93766","BMI_0: 23.62699<br />VLOAD_log_CHANGE:  -4.85528389<br />BMI_0: 23.62699","BMI_0: 25.69834<br />VLOAD_log_CHANGE:  -5.52048776<br />BMI_0: 25.69834","BMI_0: 22.43416<br />VLOAD_log_CHANGE:  -5.99676832<br />BMI_0: 22.43416","BMI_0: 27.22044<br />VLOAD_log_CHANGE:  -6.05526680<br />BMI_0: 27.22044","BMI_0: 29.00567<br />VLOAD_log_CHANGE:  -5.85618727<br />BMI_0: 29.00567","BMI_0: 28.32592<br />VLOAD_log_CHANGE:  -5.90821880<br />BMI_0: 28.32592","BMI_0: 27.47916<br />VLOAD_log_CHANGE:  -6.53665866<br />BMI_0: 27.47916","BMI_0: 27.03636<br />VLOAD_log_CHANGE:  -6.23081646<br />BMI_0: 27.03636","BMI_0: 26.45697<br />VLOAD_log_CHANGE: -10.11743178<br />BMI_0: 26.45697","BMI_0: 30.61043<br />VLOAD_log_CHANGE:           NA<br />BMI_0: 30.61043","BMI_0: 24.22955<br />VLOAD_log_CHANGE:  -8.77394172<br />BMI_0: 24.22955","BMI_0: 26.94837<br />VLOAD_log_CHANGE:  -9.42412157<br />BMI_0: 26.94837","BMI_0: 24.79622<br />VLOAD_log_CHANGE:  -6.04716725<br />BMI_0: 24.79622","BMI_0: 22.42379<br />VLOAD_log_CHANGE:  -5.99064278<br />BMI_0: 22.42379","BMI_0: 30.44991<br />VLOAD_log_CHANGE:  -5.11665077<br />BMI_0: 30.44991","BMI_0: 18.42522<br />VLOAD_log_CHANGE:  -1.70931926<br />BMI_0: 18.42522","BMI_0: 25.70662<br />VLOAD_log_CHANGE:  -6.04172379<br />BMI_0: 25.70662","BMI_0: 21.83071<br />VLOAD_log_CHANGE:  -8.07862082<br />BMI_0: 21.83071","BMI_0: 24.51933<br />VLOAD_log_CHANGE:  -6.78411769<br />BMI_0: 24.51933","BMI_0: 29.54789<br />VLOAD_log_CHANGE:  -7.27442181<br />BMI_0: 29.54789","BMI_0: 25.85074<br />VLOAD_log_CHANGE:  -7.58152359<br />BMI_0: 25.85074","BMI_0: 25.68625<br />VLOAD_log_CHANGE:  -6.30078579<br />BMI_0: 25.68625","BMI_0: 17.06028<br />VLOAD_log_CHANGE:  -5.11812525<br />BMI_0: 17.06028","BMI_0: 27.85761<br />VLOAD_log_CHANGE:  -6.08872986<br />BMI_0: 27.85761","BMI_0:       NA<br />VLOAD_log_CHANGE: -10.05079317<br />BMI_0:       NA","BMI_0: 27.57889<br />VLOAD_log_CHANGE:  -5.36747023<br />BMI_0: 27.57889","BMI_0: 28.37264<br />VLOAD_log_CHANGE:  -5.56797507<br />BMI_0: 28.37264","BMI_0: 29.48345<br />VLOAD_log_CHANGE:  -6.98539510<br />BMI_0: 29.48345","BMI_0: 26.43585<br />VLOAD_log_CHANGE:  -1.10853613<br />BMI_0: 26.43585","BMI_0: 23.97849<br />VLOAD_log_CHANGE:  -6.16568601<br />BMI_0: 23.97849","BMI_0: 23.40025<br />VLOAD_log_CHANGE:  -4.70611536<br />BMI_0: 23.40025","BMI_0: 17.95250<br />VLOAD_log_CHANGE:  -7.94477581<br />BMI_0: 17.95250","BMI_0: 18.55380<br />VLOAD_log_CHANGE:  -4.84101156<br />BMI_0: 18.55380","BMI_0: 23.21424<br />VLOAD_log_CHANGE:  -6.55165160<br />BMI_0: 23.21424","BMI_0: 31.15067<br />VLOAD_log_CHANGE: -10.61522952<br />BMI_0: 31.15067","BMI_0: 20.33425<br />VLOAD_log_CHANGE:  -8.91911425<br />BMI_0: 20.33425","BMI_0: 20.66213<br />VLOAD_log_CHANGE:  -5.20875729<br />BMI_0: 20.66213","BMI_0: 20.68446<br />VLOAD_log_CHANGE:  -0.47837415<br />BMI_0: 20.68446","BMI_0: 23.28508<br />VLOAD_log_CHANGE:  -8.61621466<br />BMI_0: 23.28508","BMI_0: 19.52480<br />VLOAD_log_CHANGE:  -7.94140887<br />BMI_0: 19.52480","BMI_0: 17.99533<br />VLOAD_log_CHANGE:  -4.04911472<br />BMI_0: 17.99533","BMI_0: 26.30892<br />VLOAD_log_CHANGE:           NA<br />BMI_0: 26.30892","BMI_0: 20.61569<br />VLOAD_log_CHANGE:  -9.25805303<br />BMI_0: 20.61569","BMI_0: 23.53075<br />VLOAD_log_CHANGE:  -6.62007321<br />BMI_0: 23.53075","BMI_0: 23.27998<br />VLOAD_log_CHANGE:  -4.72377706<br />BMI_0: 23.27998","BMI_0: 21.41023<br />VLOAD_log_CHANGE:  -8.41564287<br />BMI_0: 21.41023","BMI_0: 33.08867<br />VLOAD_log_CHANGE:  -6.72553372<br />BMI_0: 33.08867","BMI_0: 33.80208<br />VLOAD_log_CHANGE:  -1.93283807<br />BMI_0: 33.80208","BMI_0: 28.05451<br />VLOAD_log_CHANGE:  -3.63712826<br />BMI_0: 28.05451","BMI_0: 23.41002<br />VLOAD_log_CHANGE:  -7.22376967<br />BMI_0: 23.41002","BMI_0: 23.64253<br />VLOAD_log_CHANGE:  -5.34233425<br />BMI_0: 23.64253","BMI_0: 22.44140<br />VLOAD_log_CHANGE:  -7.01778820<br />BMI_0: 22.44140","BMI_0:       NA<br />VLOAD_log_CHANGE:   0.03489225<br />BMI_0:       NA","BMI_0: 24.65413<br />VLOAD_log_CHANGE:  -1.59187827<br />BMI_0: 24.65413","BMI_0: 28.58566<br />VLOAD_log_CHANGE:  -6.14637931<br />BMI_0: 28.58566","BMI_0: 30.18340<br />VLOAD_log_CHANGE:  -7.70333870<br />BMI_0: 30.18340","BMI_0: 23.23886<br />VLOAD_log_CHANGE:  -5.76599207<br />BMI_0: 23.23886","BMI_0: 28.72766<br />VLOAD_log_CHANGE:  -5.11352087<br />BMI_0: 28.72766","BMI_0: 19.62954<br />VLOAD_log_CHANGE:  -1.70895363<br />BMI_0: 19.62954","BMI_0: 25.02715<br />VLOAD_log_CHANGE:  -7.07889463<br />BMI_0: 25.02715","BMI_0: 20.16700<br />VLOAD_log_CHANGE:  -8.13833781<br />BMI_0: 20.16700","BMI_0: 21.39978<br />VLOAD_log_CHANGE:  -6.77968877<br />BMI_0: 21.39978","BMI_0: 29.66648<br />VLOAD_log_CHANGE:  -7.33901808<br />BMI_0: 29.66648","BMI_0: 22.47205<br />VLOAD_log_CHANGE:  -7.43851097<br />BMI_0: 22.47205","BMI_0: 26.10569<br />VLOAD_log_CHANGE:  -5.02834423<br />BMI_0: 26.10569","BMI_0: 18.00308<br />VLOAD_log_CHANGE:  -5.12777590<br />BMI_0: 18.00308","BMI_0: 28.49737<br />VLOAD_log_CHANGE:  -5.93343042<br />BMI_0: 28.49737","BMI_0:       NA<br />VLOAD_log_CHANGE: -10.08854255<br />BMI_0:       NA","BMI_0: 27.13313<br />VLOAD_log_CHANGE:  -6.39191711<br />BMI_0: 27.13313","BMI_0: 27.73399<br />VLOAD_log_CHANGE:  -5.50335866<br />BMI_0: 27.73399","BMI_0: 28.01624<br />VLOAD_log_CHANGE:  -5.25030043<br />BMI_0: 28.01624","BMI_0: 26.97149<br />VLOAD_log_CHANGE:  -1.10890438<br />BMI_0: 26.97149","BMI_0: 24.90349<br />VLOAD_log_CHANGE:  -6.35260706<br />BMI_0: 24.90349","BMI_0: 23.99361<br />VLOAD_log_CHANGE:  -4.74296714<br />BMI_0: 23.99361","BMI_0: 19.29846<br />VLOAD_log_CHANGE:  -7.76309217<br />BMI_0: 19.29846","BMI_0: 19.65306<br />VLOAD_log_CHANGE:  -4.83739193<br />BMI_0: 19.65306","BMI_0: 23.15460<br />VLOAD_log_CHANGE:  -6.80233127<br />BMI_0: 23.15460","BMI_0: 29.36857<br />VLOAD_log_CHANGE: -12.00152695<br />BMI_0: 29.36857","BMI_0: 20.96342<br />VLOAD_log_CHANGE:  -7.93846339<br />BMI_0: 20.96342","BMI_0: 24.00279<br />VLOAD_log_CHANGE:  -6.45059194<br />BMI_0: 24.00279","BMI_0: 19.72122<br />VLOAD_log_CHANGE:  -0.47837877<br />BMI_0: 19.72122","BMI_0: 25.08201<br />VLOAD_log_CHANGE:  -7.80532067<br />BMI_0: 25.08201","BMI_0: 20.03681<br />VLOAD_log_CHANGE:  -8.00140984<br />BMI_0: 20.03681","BMI_0: 21.17169<br />VLOAD_log_CHANGE:  -3.85819633<br />BMI_0: 21.17169","BMI_0: 27.17257<br />VLOAD_log_CHANGE:           NA<br />BMI_0: 27.17257","BMI_0: 18.38712<br />VLOAD_log_CHANGE: -10.21357915<br />BMI_0: 18.38712","BMI_0: 22.12722<br />VLOAD_log_CHANGE:  -6.45536945<br />BMI_0: 22.12722","BMI_0: 23.24416<br />VLOAD_log_CHANGE:  -4.70863910<br />BMI_0: 23.24416","BMI_0: 20.27389<br />VLOAD_log_CHANGE:  -8.17827515<br />BMI_0: 20.27389","BMI_0: 30.07935<br />VLOAD_log_CHANGE:  -6.81404382<br />BMI_0: 30.07935","BMI_0: 31.28557<br />VLOAD_log_CHANGE:  -1.92760702<br />BMI_0: 31.28557","BMI_0: 28.00108<br />VLOAD_log_CHANGE:  -3.65240655<br />BMI_0: 28.00108","BMI_0: 23.36116<br />VLOAD_log_CHANGE:  -6.66386222<br />BMI_0: 23.36116","BMI_0: 25.42777<br />VLOAD_log_CHANGE:  -3.80719145<br />BMI_0: 25.42777","BMI_0: 24.25708<br />VLOAD_log_CHANGE:  -6.99684028<br />BMI_0: 24.25708","BMI_0:       NA<br />VLOAD_log_CHANGE:   0.03536249<br />BMI_0:       NA","BMI_0: 22.87895<br />VLOAD_log_CHANGE:  -1.59193601<br />BMI_0: 22.87895","BMI_0: 24.17362<br />VLOAD_log_CHANGE:  -5.79806003<br />BMI_0: 24.17362","BMI_0: 29.03907<br />VLOAD_log_CHANGE:  -8.10747907<br />BMI_0: 29.03907"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":["rgba(42,89,129,1)","rgba(48,100,144,1)","rgba(54,112,160,1)","rgba(30,64,95,1)","rgba(35,75,110,1)","rgba(38,80,117,1)","rgba(42,89,129,1)","rgba(55,114,162,1)","rgba(28,61,92,1)","rgba(30,65,97,1)","rgba(25,54,82,1)","rgba(30,64,96,1)","rgba(36,77,112,1)","rgba(42,89,129,1)","rgba(39,82,119,1)","rgba(54,112,159,1)","rgba(35,75,111,1)","rgba(45,94,136,1)","rgba(59,123,174,1)","rgba(127,127,127,1)","rgba(56,117,167,1)","rgba(47,99,143,1)","rgba(53,110,157,1)","rgba(58,120,171,1)","rgba(35,76,111,1)","rgba(37,79,115,1)","rgba(61,126,179,1)","rgba(32,69,102,1)","rgba(32,69,102,1)","rgba(23,51,78,1)","rgba(40,84,123,1)","rgba(39,82,119,1)","rgba(50,104,150,1)","rgba(37,79,115,1)","rgba(39,82,119,1)","rgba(127,127,127,1)","rgba(58,120,171,1)","rgba(35,75,111,1)","rgba(52,109,156,1)","rgba(52,109,156,1)","rgba(37,78,114,1)","rgba(38,81,118,1)","rgba(55,114,162,1)","rgba(30,66,97,1)","rgba(27,60,89,1)","rgba(32,68,101,1)","rgba(33,72,106,1)","rgba(36,76,112,1)","rgba(53,110,157,1)","rgba(41,86,125,1)","rgba(46,96,139,1)","rgba(127,127,127,1)","rgba(57,119,169,1)","rgba(44,92,133,1)","rgba(36,76,112,1)","rgba(76,157,220,1)","rgba(46,97,140,1)","rgba(65,136,192,1)","rgba(72,148,208,1)","rgba(43,90,130,1)","rgba(35,75,111,1)","rgba(53,110,158,1)","rgba(41,87,126,1)","rgba(61,126,179,1)","rgba(42,89,129,1)","rgba(25,54,82,1)","rgba(56,116,165,1)","rgba(37,79,115,1)","rgba(63,131,186,1)","rgba(41,86,124,1)","rgba(26,57,86,1)","rgba(42,89,129,1)","rgba(40,84,122,1)","rgba(44,93,134,1)","rgba(50,105,151,1)","rgba(45,94,136,1)","rgba(40,84,123,1)","rgba(36,77,113,1)","rgba(56,117,167,1)","rgba(57,118,168,1)","rgba(68,141,198,1)","rgba(47,98,142,1)","rgba(33,70,103,1)","rgba(48,100,144,1)","rgba(52,108,155,1)","rgba(31,67,100,1)","rgba(60,125,177,1)","rgba(19,43,67,1)","rgba(42,89,129,1)","rgba(38,81,119,1)","rgba(37,78,114,1)","rgba(40,85,124,1)","rgba(52,108,154,1)","rgba(26,56,84,1)","rgba(39,83,122,1)","rgba(76,157,221,1)","rgba(43,91,132,1)","rgba(127,127,127,1)","rgba(38,80,117,1)","rgba(35,75,110,1)","rgba(50,104,149,1)","rgba(36,76,111,1)","rgba(43,91,132,1)","rgba(29,64,95,1)","rgba(67,138,195,1)","rgba(75,155,218,1)","rgba(76,156,219,1)","rgba(50,105,151,1)","rgba(44,93,135,1)","rgba(52,108,155,1)","rgba(35,75,110,1)","rgba(39,83,121,1)","rgba(44,92,133,1)","rgba(47,99,142,1)","rgba(45,95,137,1)","rgba(40,84,122,1)","rgba(33,71,104,1)","rgba(41,87,126,1)","rgba(41,87,127,1)","rgba(52,109,155,1)","rgba(38,81,118,1)","rgba(34,72,107,1)","rgba(40,85,124,1)","rgba(45,95,138,1)","rgba(35,74,109,1)","rgba(33,71,104,1)","rgba(25,55,84,1)","rgba(29,62,93,1)","rgba(40,85,123,1)","rgba(42,89,128,1)","rgba(127,127,127,1)","rgba(55,114,163,1)","rgba(53,110,157,1)","rgba(34,72,106,1)","rgba(51,106,152,1)","rgba(39,82,120,1)","rgba(127,127,127,1)","rgba(44,93,134,1)","rgba(30,64,95,1)","rgba(49,103,148,1)","rgba(24,53,80,1)","rgba(27,59,89,1)","rgba(46,97,140,1)","rgba(39,82,120,1)","rgba(127,127,127,1)","rgba(51,106,151,1)","rgba(29,63,94,1)","rgba(38,80,116,1)","rgba(26,57,86,1)","rgba(70,144,202,1)","rgba(31,67,99,1)","rgba(42,88,127,1)","rgba(71,148,208,1)","rgba(39,83,121,1)","rgba(41,86,125,1)","rgba(45,94,136,1)","rgba(77,158,222,1)","rgba(85,175,245,1)","rgba(52,109,156,1)","rgba(26,56,85,1)","rgba(33,70,104,1)","rgba(37,79,115,1)","rgba(37,79,115,1)","rgba(59,124,175,1)","rgba(39,83,121,1)","rgba(28,60,90,1)","rgba(45,94,135,1)","rgba(54,112,159,1)","rgba(66,137,193,1)","rgba(33,71,105,1)","rgba(44,93,135,1)","rgba(22,49,75,1)","rgba(25,56,84,1)","rgba(45,96,138,1)","rgba(56,117,167,1)","rgba(24,53,80,1)","rgba(41,87,126,1)","rgba(82,170,237,1)","rgba(43,90,130,1)","rgba(38,81,119,1)","rgba(45,94,135,1)","rgba(25,56,84,1)","rgba(37,79,116,1)","rgba(37,78,114,1)","rgba(57,118,168,1)","rgba(32,69,102,1)","rgba(31,66,98,1)","rgba(38,81,118,1)","rgba(53,111,158,1)","rgba(127,127,127,1)","rgba(46,97,139,1)","rgba(53,110,157,1)","rgba(41,86,126,1)","rgba(48,101,145,1)","rgba(33,71,105,1)","rgba(34,73,107,1)","rgba(42,89,129,1)","rgba(46,96,139,1)","rgba(56,116,165,1)","rgba(41,87,126,1)","rgba(65,134,189,1)","rgba(45,94,136,1)","rgba(53,111,158,1)","rgba(61,127,179,1)","rgba(46,96,138,1)","rgba(127,127,127,1)","rgba(55,115,164,1)","rgba(31,66,98,1)","rgba(30,65,97,1)","rgba(41,87,126,1)","rgba(38,81,118,1)","rgba(41,86,125,1)","rgba(55,114,163,1)","rgba(39,83,120,1)","rgba(51,107,153,1)","rgba(46,97,139,1)","rgba(35,74,109,1)","rgba(43,91,132,1)","rgba(31,66,98,1)","rgba(36,77,113,1)","rgba(44,93,134,1)","rgba(45,94,136,1)","rgba(42,89,129,1)","rgba(35,75,111,1)","rgba(40,84,122,1)","rgba(46,96,138,1)","rgba(28,61,91,1)","rgba(49,102,147,1)","rgba(38,80,117,1)","rgba(35,74,109,1)","rgba(26,57,86,1)","rgba(43,91,131,1)","rgba(53,110,157,1)","rgba(47,98,142,1)","rgba(82,168,235,1)","rgba(39,82,119,1)","rgba(75,154,217,1)","rgba(33,70,103,1)","rgba(36,76,112,1)","rgba(23,52,79,1)","rgba(33,71,105,1)","rgba(58,122,173,1)","rgba(39,83,120,1)","rgba(44,93,134,1)","rgba(60,125,177,1)","rgba(34,72,106,1)","rgba(38,80,117,1)","rgba(43,90,130,1)","rgba(43,91,132,1)","rgba(29,62,93,1)","rgba(36,77,112,1)","rgba(26,56,85,1)","rgba(35,75,110,1)","rgba(127,127,127,1)","rgba(52,109,156,1)","rgba(34,74,108,1)","rgba(42,89,129,1)","rgba(57,119,169,1)","rgba(54,112,160,1)","rgba(49,102,147,1)","rgba(39,83,121,1)","rgba(37,79,116,1)","rgba(31,67,100,1)","rgba(39,82,120,1)","rgba(61,127,181,1)","rgba(60,124,176,1)","rgba(55,114,162,1)","rgba(86,177,247,1)","rgba(36,77,113,1)","rgba(50,105,150,1)","rgba(34,72,107,1)","rgba(34,73,108,1)","rgba(65,134,190,1)","rgba(47,98,141,1)","rgba(34,73,108,1)","rgba(22,48,74,1)","rgba(25,54,82,1)","rgba(49,102,147,1)","rgba(48,100,144,1)","rgba(41,86,125,1)","rgba(39,82,120,1)","rgba(27,58,88,1)","rgba(46,96,139,1)","rgba(39,83,121,1)","rgba(36,78,114,1)","rgba(45,94,136,1)","rgba(49,103,147,1)","rgba(44,93,134,1)","rgba(55,115,164,1)","rgba(42,88,128,1)","rgba(42,89,128,1)","rgba(41,87,126,1)","rgba(42,88,127,1)","rgba(56,116,165,1)","rgba(46,98,140,1)","rgba(57,118,167,1)","rgba(59,122,174,1)","rgba(39,82,120,1)","rgba(31,67,99,1)","rgba(39,82,119,1)","rgba(44,92,133,1)","rgba(38,81,118,1)","rgba(51,106,152,1)","rgba(34,73,107,1)","rgba(35,74,109,1)","rgba(40,85,124,1)","rgba(60,125,177,1)","rgba(32,68,100,1)","rgba(24,52,79,1)","rgba(40,86,124,1)","rgba(44,93,135,1)","rgba(127,127,127,1)","rgba(39,82,120,1)","rgba(31,67,99,1)","rgba(25,54,82,1)","rgba(56,117,166,1)","rgba(32,68,101,1)","rgba(29,62,93,1)","rgba(25,56,84,1)","rgba(54,112,160,1)","rgba(57,119,170,1)","rgba(54,112,160,1)","rgba(41,87,127,1)","rgba(43,90,130,1)","rgba(42,88,127,1)","rgba(33,71,105,1)","rgba(40,84,122,1)","rgba(34,72,107,1)","rgba(26,58,87,1)","rgba(36,76,112,1)","rgba(38,80,117,1)","rgba(29,62,93,1)","rgba(33,72,105,1)","rgba(33,71,105,1)","rgba(127,127,127,1)","rgba(37,79,115,1)","rgba(28,62,92,1)","rgba(37,78,114,1)","rgba(52,108,155,1)","rgba(39,83,121,1)","rgba(56,117,166,1)","rgba(47,99,142,1)","rgba(66,137,194,1)","rgba(31,66,98,1)","rgba(27,59,89,1)","rgba(42,89,129,1)","rgba(37,78,115,1)","rgba(41,88,127,1)","rgba(127,127,127,1)","rgba(69,142,201,1)","rgba(33,71,104,1)","rgba(41,86,124,1)","rgba(53,111,159,1)","rgba(74,152,213,1)","rgba(72,150,210,1)","rgba(40,85,123,1)","rgba(47,99,142,1)","rgba(39,83,121,1)","rgba(37,78,114,1)","rgba(50,104,150,1)","rgba(41,87,127,1)","rgba(63,130,184,1)","rgba(44,93,135,1)","rgba(38,80,117,1)","rgba(39,82,120,1)","rgba(46,96,139,1)","rgba(52,108,155,1)","rgba(51,107,153,1)","rgba(49,102,147,1)","rgba(42,89,129,1)","rgba(38,81,118,1)","rgba(38,81,118,1)","rgba(41,87,127,1)","rgba(75,155,218,1)","rgba(48,101,145,1)","rgba(57,118,168,1)","rgba(54,113,161,1)","rgba(54,112,160,1)","rgba(29,63,94,1)","rgba(24,52,80,1)","rgba(58,120,170,1)","rgba(36,76,112,1)","rgba(66,136,192,1)","rgba(49,102,147,1)","rgba(34,73,108,1)","rgba(47,99,142,1)","rgba(54,113,161,1)","rgba(40,84,122,1)","rgba(37,78,114,1)","rgba(53,110,158,1)","rgba(35,75,110,1)","rgba(47,98,142,1)","rgba(48,101,145,1)","rgba(51,107,153,1)","rgba(37,78,115,1)","rgba(54,112,160,1)","rgba(53,110,158,1)","rgba(59,123,175,1)","rgba(36,76,112,1)","rgba(32,68,100,1)","rgba(43,90,130,1)","rgba(35,74,109,1)","rgba(73,150,211,1)","rgba(54,112,160,1)","rgba(47,99,143,1)","rgba(42,89,129,1)","rgba(59,123,174,1)","rgba(36,77,113,1)","rgba(52,108,155,1)","rgba(70,144,203,1)","rgba(42,88,127,1)","rgba(79,164,229,1)","rgba(60,124,175,1)","rgba(31,66,98,1)","rgba(27,59,89,1)","rgba(51,107,153,1)","rgba(50,104,149,1)","rgba(48,101,145,1)","rgba(44,93,134,1)","rgba(46,97,139,1)","rgba(43,90,130,1)","rgba(41,87,126,1)","rgba(50,105,150,1)","rgba(31,67,99,1)","rgba(127,127,127,1)","rgba(38,80,117,1)","rgba(48,101,145,1)","rgba(46,97,139,1)","rgba(29,63,93,1)","rgba(45,94,135,1)","rgba(53,110,157,1)","rgba(29,62,93,1)","rgba(48,101,145,1)","rgba(42,88,128,1)","rgba(37,79,116,1)","rgba(36,77,113,1)","rgba(39,83,120,1)","rgba(58,120,170,1)","rgba(49,103,148,1)","rgba(45,95,137,1)","rgba(38,81,118,1)","rgba(33,70,103,1)","rgba(24,53,81,1)","rgba(40,85,124,1)","rgba(41,86,125,1)","rgba(30,65,97,1)","rgba(35,74,109,1)","rgba(53,112,159,1)","rgba(25,54,82,1)","rgba(39,82,120,1)","rgba(43,90,131,1)","rgba(39,82,120,1)","rgba(45,95,137,1)","rgba(36,76,111,1)","rgba(50,104,149,1)","rgba(55,115,163,1)","rgba(53,111,158,1)","rgba(50,105,151,1)","rgba(49,103,147,1)","rgba(47,99,143,1)","rgba(60,125,177,1)","rgba(41,86,125,1)","rgba(49,102,147,1)","rgba(42,89,129,1)","rgba(35,76,111,1)","rgba(60,124,175,1)","rgba(24,53,81,1)","rgba(45,95,137,1)","rgba(34,72,106,1)","rgba(42,88,127,1)","rgba(57,118,168,1)","rgba(46,96,138,1)","rgba(45,95,136,1)","rgba(21,46,71,1)","rgba(52,108,154,1)","rgba(127,127,127,1)","rgba(51,106,152,1)","rgba(53,111,158,1)","rgba(57,118,167,1)","rgba(47,99,142,1)","rgba(40,85,123,1)","rgba(38,81,118,1)","rgba(23,51,77,1)","rgba(25,54,82,1)","rgba(38,80,117,1)","rgba(62,128,181,1)","rgba(30,64,95,1)","rgba(30,66,97,1)","rgba(31,66,98,1)","rgba(38,81,118,1)","rgba(27,59,89,1)","rgba(23,51,78,1)","rgba(47,98,141,1)","rgba(30,65,97,1)","rgba(39,82,119,1)","rgba(38,80,117,1)","rgba(33,70,103,1)","rgba(68,140,198,1)","rgba(70,145,204,1)","rgba(52,109,156,1)","rgba(38,81,119,1)","rgba(39,83,120,1)","rgba(36,76,111,1)","rgba(127,127,127,1)","rgba(42,89,128,1)","rgba(54,112,160,1)","rgba(59,122,173,1)","rgba(38,80,117,1)","rgba(54,113,161,1)","rgba(28,60,90,1)","rgba(43,91,131,1)","rgba(29,63,94,1)","rgba(33,70,103,1)","rgba(57,119,169,1)","rgba(36,76,111,1)","rgba(46,97,140,1)","rgba(23,51,78,1)","rgba(54,112,159,1)","rgba(127,127,127,1)","rgba(49,103,148,1)","rgba(51,107,153,1)","rgba(52,109,155,1)","rgba(49,102,147,1)","rgba(43,90,130,1)","rgba(40,85,123,1)","rgba(27,58,87,1)","rgba(28,60,90,1)","rgba(38,80,117,1)","rgba(56,117,166,1)","rgba(31,67,100,1)","rgba(40,85,123,1)","rgba(28,60,90,1)","rgba(43,91,132,1)","rgba(29,62,93,1)","rgba(32,68,101,1)","rgba(49,104,148,1)","rgba(24,53,81,1)","rgba(35,74,109,1)","rgba(38,80,117,1)","rgba(29,63,95,1)","rgba(58,121,172,1)","rgba(62,129,183,1)","rgba(52,109,155,1)","rgba(38,81,118,1)","rgba(44,93,134,1)","rgba(41,86,125,1)","rgba(127,127,127,1)","rgba(37,78,114,1)","rgba(41,86,124,1)","rgba(55,115,164,1)"],"opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":["rgba(42,89,129,1)","rgba(48,100,144,1)","rgba(54,112,160,1)","rgba(30,64,95,1)","rgba(35,75,110,1)","rgba(38,80,117,1)","rgba(42,89,129,1)","rgba(55,114,162,1)","rgba(28,61,92,1)","rgba(30,65,97,1)","rgba(25,54,82,1)","rgba(30,64,96,1)","rgba(36,77,112,1)","rgba(42,89,129,1)","rgba(39,82,119,1)","rgba(54,112,159,1)","rgba(35,75,111,1)","rgba(45,94,136,1)","rgba(59,123,174,1)","rgba(127,127,127,1)","rgba(56,117,167,1)","rgba(47,99,143,1)","rgba(53,110,157,1)","rgba(58,120,171,1)","rgba(35,76,111,1)","rgba(37,79,115,1)","rgba(61,126,179,1)","rgba(32,69,102,1)","rgba(32,69,102,1)","rgba(23,51,78,1)","rgba(40,84,123,1)","rgba(39,82,119,1)","rgba(50,104,150,1)","rgba(37,79,115,1)","rgba(39,82,119,1)","rgba(127,127,127,1)","rgba(58,120,171,1)","rgba(35,75,111,1)","rgba(52,109,156,1)","rgba(52,109,156,1)","rgba(37,78,114,1)","rgba(38,81,118,1)","rgba(55,114,162,1)","rgba(30,66,97,1)","rgba(27,60,89,1)","rgba(32,68,101,1)","rgba(33,72,106,1)","rgba(36,76,112,1)","rgba(53,110,157,1)","rgba(41,86,125,1)","rgba(46,96,139,1)","rgba(127,127,127,1)","rgba(57,119,169,1)","rgba(44,92,133,1)","rgba(36,76,112,1)","rgba(76,157,220,1)","rgba(46,97,140,1)","rgba(65,136,192,1)","rgba(72,148,208,1)","rgba(43,90,130,1)","rgba(35,75,111,1)","rgba(53,110,158,1)","rgba(41,87,126,1)","rgba(61,126,179,1)","rgba(42,89,129,1)","rgba(25,54,82,1)","rgba(56,116,165,1)","rgba(37,79,115,1)","rgba(63,131,186,1)","rgba(41,86,124,1)","rgba(26,57,86,1)","rgba(42,89,129,1)","rgba(40,84,122,1)","rgba(44,93,134,1)","rgba(50,105,151,1)","rgba(45,94,136,1)","rgba(40,84,123,1)","rgba(36,77,113,1)","rgba(56,117,167,1)","rgba(57,118,168,1)","rgba(68,141,198,1)","rgba(47,98,142,1)","rgba(33,70,103,1)","rgba(48,100,144,1)","rgba(52,108,155,1)","rgba(31,67,100,1)","rgba(60,125,177,1)","rgba(19,43,67,1)","rgba(42,89,129,1)","rgba(38,81,119,1)","rgba(37,78,114,1)","rgba(40,85,124,1)","rgba(52,108,154,1)","rgba(26,56,84,1)","rgba(39,83,122,1)","rgba(76,157,221,1)","rgba(43,91,132,1)","rgba(127,127,127,1)","rgba(38,80,117,1)","rgba(35,75,110,1)","rgba(50,104,149,1)","rgba(36,76,111,1)","rgba(43,91,132,1)","rgba(29,64,95,1)","rgba(67,138,195,1)","rgba(75,155,218,1)","rgba(76,156,219,1)","rgba(50,105,151,1)","rgba(44,93,135,1)","rgba(52,108,155,1)","rgba(35,75,110,1)","rgba(39,83,121,1)","rgba(44,92,133,1)","rgba(47,99,142,1)","rgba(45,95,137,1)","rgba(40,84,122,1)","rgba(33,71,104,1)","rgba(41,87,126,1)","rgba(41,87,127,1)","rgba(52,109,155,1)","rgba(38,81,118,1)","rgba(34,72,107,1)","rgba(40,85,124,1)","rgba(45,95,138,1)","rgba(35,74,109,1)","rgba(33,71,104,1)","rgba(25,55,84,1)","rgba(29,62,93,1)","rgba(40,85,123,1)","rgba(42,89,128,1)","rgba(127,127,127,1)","rgba(55,114,163,1)","rgba(53,110,157,1)","rgba(34,72,106,1)","rgba(51,106,152,1)","rgba(39,82,120,1)","rgba(127,127,127,1)","rgba(44,93,134,1)","rgba(30,64,95,1)","rgba(49,103,148,1)","rgba(24,53,80,1)","rgba(27,59,89,1)","rgba(46,97,140,1)","rgba(39,82,120,1)","rgba(127,127,127,1)","rgba(51,106,151,1)","rgba(29,63,94,1)","rgba(38,80,116,1)","rgba(26,57,86,1)","rgba(70,144,202,1)","rgba(31,67,99,1)","rgba(42,88,127,1)","rgba(71,148,208,1)","rgba(39,83,121,1)","rgba(41,86,125,1)","rgba(45,94,136,1)","rgba(77,158,222,1)","rgba(85,175,245,1)","rgba(52,109,156,1)","rgba(26,56,85,1)","rgba(33,70,104,1)","rgba(37,79,115,1)","rgba(37,79,115,1)","rgba(59,124,175,1)","rgba(39,83,121,1)","rgba(28,60,90,1)","rgba(45,94,135,1)","rgba(54,112,159,1)","rgba(66,137,193,1)","rgba(33,71,105,1)","rgba(44,93,135,1)","rgba(22,49,75,1)","rgba(25,56,84,1)","rgba(45,96,138,1)","rgba(56,117,167,1)","rgba(24,53,80,1)","rgba(41,87,126,1)","rgba(82,170,237,1)","rgba(43,90,130,1)","rgba(38,81,119,1)","rgba(45,94,135,1)","rgba(25,56,84,1)","rgba(37,79,116,1)","rgba(37,78,114,1)","rgba(57,118,168,1)","rgba(32,69,102,1)","rgba(31,66,98,1)","rgba(38,81,118,1)","rgba(53,111,158,1)","rgba(127,127,127,1)","rgba(46,97,139,1)","rgba(53,110,157,1)","rgba(41,86,126,1)","rgba(48,101,145,1)","rgba(33,71,105,1)","rgba(34,73,107,1)","rgba(42,89,129,1)","rgba(46,96,139,1)","rgba(56,116,165,1)","rgba(41,87,126,1)","rgba(65,134,189,1)","rgba(45,94,136,1)","rgba(53,111,158,1)","rgba(61,127,179,1)","rgba(46,96,138,1)","rgba(127,127,127,1)","rgba(55,115,164,1)","rgba(31,66,98,1)","rgba(30,65,97,1)","rgba(41,87,126,1)","rgba(38,81,118,1)","rgba(41,86,125,1)","rgba(55,114,163,1)","rgba(39,83,120,1)","rgba(51,107,153,1)","rgba(46,97,139,1)","rgba(35,74,109,1)","rgba(43,91,132,1)","rgba(31,66,98,1)","rgba(36,77,113,1)","rgba(44,93,134,1)","rgba(45,94,136,1)","rgba(42,89,129,1)","rgba(35,75,111,1)","rgba(40,84,122,1)","rgba(46,96,138,1)","rgba(28,61,91,1)","rgba(49,102,147,1)","rgba(38,80,117,1)","rgba(35,74,109,1)","rgba(26,57,86,1)","rgba(43,91,131,1)","rgba(53,110,157,1)","rgba(47,98,142,1)","rgba(82,168,235,1)","rgba(39,82,119,1)","rgba(75,154,217,1)","rgba(33,70,103,1)","rgba(36,76,112,1)","rgba(23,52,79,1)","rgba(33,71,105,1)","rgba(58,122,173,1)","rgba(39,83,120,1)","rgba(44,93,134,1)","rgba(60,125,177,1)","rgba(34,72,106,1)","rgba(38,80,117,1)","rgba(43,90,130,1)","rgba(43,91,132,1)","rgba(29,62,93,1)","rgba(36,77,112,1)","rgba(26,56,85,1)","rgba(35,75,110,1)","rgba(127,127,127,1)","rgba(52,109,156,1)","rgba(34,74,108,1)","rgba(42,89,129,1)","rgba(57,119,169,1)","rgba(54,112,160,1)","rgba(49,102,147,1)","rgba(39,83,121,1)","rgba(37,79,116,1)","rgba(31,67,100,1)","rgba(39,82,120,1)","rgba(61,127,181,1)","rgba(60,124,176,1)","rgba(55,114,162,1)","rgba(86,177,247,1)","rgba(36,77,113,1)","rgba(50,105,150,1)","rgba(34,72,107,1)","rgba(34,73,108,1)","rgba(65,134,190,1)","rgba(47,98,141,1)","rgba(34,73,108,1)","rgba(22,48,74,1)","rgba(25,54,82,1)","rgba(49,102,147,1)","rgba(48,100,144,1)","rgba(41,86,125,1)","rgba(39,82,120,1)","rgba(27,58,88,1)","rgba(46,96,139,1)","rgba(39,83,121,1)","rgba(36,78,114,1)","rgba(45,94,136,1)","rgba(49,103,147,1)","rgba(44,93,134,1)","rgba(55,115,164,1)","rgba(42,88,128,1)","rgba(42,89,128,1)","rgba(41,87,126,1)","rgba(42,88,127,1)","rgba(56,116,165,1)","rgba(46,98,140,1)","rgba(57,118,167,1)","rgba(59,122,174,1)","rgba(39,82,120,1)","rgba(31,67,99,1)","rgba(39,82,119,1)","rgba(44,92,133,1)","rgba(38,81,118,1)","rgba(51,106,152,1)","rgba(34,73,107,1)","rgba(35,74,109,1)","rgba(40,85,124,1)","rgba(60,125,177,1)","rgba(32,68,100,1)","rgba(24,52,79,1)","rgba(40,86,124,1)","rgba(44,93,135,1)","rgba(127,127,127,1)","rgba(39,82,120,1)","rgba(31,67,99,1)","rgba(25,54,82,1)","rgba(56,117,166,1)","rgba(32,68,101,1)","rgba(29,62,93,1)","rgba(25,56,84,1)","rgba(54,112,160,1)","rgba(57,119,170,1)","rgba(54,112,160,1)","rgba(41,87,127,1)","rgba(43,90,130,1)","rgba(42,88,127,1)","rgba(33,71,105,1)","rgba(40,84,122,1)","rgba(34,72,107,1)","rgba(26,58,87,1)","rgba(36,76,112,1)","rgba(38,80,117,1)","rgba(29,62,93,1)","rgba(33,72,105,1)","rgba(33,71,105,1)","rgba(127,127,127,1)","rgba(37,79,115,1)","rgba(28,62,92,1)","rgba(37,78,114,1)","rgba(52,108,155,1)","rgba(39,83,121,1)","rgba(56,117,166,1)","rgba(47,99,142,1)","rgba(66,137,194,1)","rgba(31,66,98,1)","rgba(27,59,89,1)","rgba(42,89,129,1)","rgba(37,78,115,1)","rgba(41,88,127,1)","rgba(127,127,127,1)","rgba(69,142,201,1)","rgba(33,71,104,1)","rgba(41,86,124,1)","rgba(53,111,159,1)","rgba(74,152,213,1)","rgba(72,150,210,1)","rgba(40,85,123,1)","rgba(47,99,142,1)","rgba(39,83,121,1)","rgba(37,78,114,1)","rgba(50,104,150,1)","rgba(41,87,127,1)","rgba(63,130,184,1)","rgba(44,93,135,1)","rgba(38,80,117,1)","rgba(39,82,120,1)","rgba(46,96,139,1)","rgba(52,108,155,1)","rgba(51,107,153,1)","rgba(49,102,147,1)","rgba(42,89,129,1)","rgba(38,81,118,1)","rgba(38,81,118,1)","rgba(41,87,127,1)","rgba(75,155,218,1)","rgba(48,101,145,1)","rgba(57,118,168,1)","rgba(54,113,161,1)","rgba(54,112,160,1)","rgba(29,63,94,1)","rgba(24,52,80,1)","rgba(58,120,170,1)","rgba(36,76,112,1)","rgba(66,136,192,1)","rgba(49,102,147,1)","rgba(34,73,108,1)","rgba(47,99,142,1)","rgba(54,113,161,1)","rgba(40,84,122,1)","rgba(37,78,114,1)","rgba(53,110,158,1)","rgba(35,75,110,1)","rgba(47,98,142,1)","rgba(48,101,145,1)","rgba(51,107,153,1)","rgba(37,78,115,1)","rgba(54,112,160,1)","rgba(53,110,158,1)","rgba(59,123,175,1)","rgba(36,76,112,1)","rgba(32,68,100,1)","rgba(43,90,130,1)","rgba(35,74,109,1)","rgba(73,150,211,1)","rgba(54,112,160,1)","rgba(47,99,143,1)","rgba(42,89,129,1)","rgba(59,123,174,1)","rgba(36,77,113,1)","rgba(52,108,155,1)","rgba(70,144,203,1)","rgba(42,88,127,1)","rgba(79,164,229,1)","rgba(60,124,175,1)","rgba(31,66,98,1)","rgba(27,59,89,1)","rgba(51,107,153,1)","rgba(50,104,149,1)","rgba(48,101,145,1)","rgba(44,93,134,1)","rgba(46,97,139,1)","rgba(43,90,130,1)","rgba(41,87,126,1)","rgba(50,105,150,1)","rgba(31,67,99,1)","rgba(127,127,127,1)","rgba(38,80,117,1)","rgba(48,101,145,1)","rgba(46,97,139,1)","rgba(29,63,93,1)","rgba(45,94,135,1)","rgba(53,110,157,1)","rgba(29,62,93,1)","rgba(48,101,145,1)","rgba(42,88,128,1)","rgba(37,79,116,1)","rgba(36,77,113,1)","rgba(39,83,120,1)","rgba(58,120,170,1)","rgba(49,103,148,1)","rgba(45,95,137,1)","rgba(38,81,118,1)","rgba(33,70,103,1)","rgba(24,53,81,1)","rgba(40,85,124,1)","rgba(41,86,125,1)","rgba(30,65,97,1)","rgba(35,74,109,1)","rgba(53,112,159,1)","rgba(25,54,82,1)","rgba(39,82,120,1)","rgba(43,90,131,1)","rgba(39,82,120,1)","rgba(45,95,137,1)","rgba(36,76,111,1)","rgba(50,104,149,1)","rgba(55,115,163,1)","rgba(53,111,158,1)","rgba(50,105,151,1)","rgba(49,103,147,1)","rgba(47,99,143,1)","rgba(60,125,177,1)","rgba(41,86,125,1)","rgba(49,102,147,1)","rgba(42,89,129,1)","rgba(35,76,111,1)","rgba(60,124,175,1)","rgba(24,53,81,1)","rgba(45,95,137,1)","rgba(34,72,106,1)","rgba(42,88,127,1)","rgba(57,118,168,1)","rgba(46,96,138,1)","rgba(45,95,136,1)","rgba(21,46,71,1)","rgba(52,108,154,1)","rgba(127,127,127,1)","rgba(51,106,152,1)","rgba(53,111,158,1)","rgba(57,118,167,1)","rgba(47,99,142,1)","rgba(40,85,123,1)","rgba(38,81,118,1)","rgba(23,51,77,1)","rgba(25,54,82,1)","rgba(38,80,117,1)","rgba(62,128,181,1)","rgba(30,64,95,1)","rgba(30,66,97,1)","rgba(31,66,98,1)","rgba(38,81,118,1)","rgba(27,59,89,1)","rgba(23,51,78,1)","rgba(47,98,141,1)","rgba(30,65,97,1)","rgba(39,82,119,1)","rgba(38,80,117,1)","rgba(33,70,103,1)","rgba(68,140,198,1)","rgba(70,145,204,1)","rgba(52,109,156,1)","rgba(38,81,119,1)","rgba(39,83,120,1)","rgba(36,76,111,1)","rgba(127,127,127,1)","rgba(42,89,128,1)","rgba(54,112,160,1)","rgba(59,122,173,1)","rgba(38,80,117,1)","rgba(54,113,161,1)","rgba(28,60,90,1)","rgba(43,91,131,1)","rgba(29,63,94,1)","rgba(33,70,103,1)","rgba(57,119,169,1)","rgba(36,76,111,1)","rgba(46,97,140,1)","rgba(23,51,78,1)","rgba(54,112,159,1)","rgba(127,127,127,1)","rgba(49,103,148,1)","rgba(51,107,153,1)","rgba(52,109,155,1)","rgba(49,102,147,1)","rgba(43,90,130,1)","rgba(40,85,123,1)","rgba(27,58,87,1)","rgba(28,60,90,1)","rgba(38,80,117,1)","rgba(56,117,166,1)","rgba(31,67,100,1)","rgba(40,85,123,1)","rgba(28,60,90,1)","rgba(43,91,132,1)","rgba(29,62,93,1)","rgba(32,68,101,1)","rgba(49,104,148,1)","rgba(24,53,81,1)","rgba(35,74,109,1)","rgba(38,80,117,1)","rgba(29,63,95,1)","rgba(58,121,172,1)","rgba(62,129,183,1)","rgba(52,109,155,1)","rgba(38,81,118,1)","rgba(44,93,134,1)","rgba(41,86,125,1)","rgba(127,127,127,1)","rgba(37,78,114,1)","rgba(41,86,124,1)","rgba(55,115,164,1)"]}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[20],"y":[-10],"name":"bc810c3fb99177b7dbffe1495df825c5","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#132B43"],[0.003344481605351184,"#132B44"],[0.0066889632107023679,"#132C44"],[0.010033444816053552,"#142C45"],[0.013377926421404736,"#142D45"],[0.016722408026755918,"#142D46"],[0.020066889632106944,"#142D46"],[0.023411371237458126,"#142E47"],[0.026755852842809312,"#152E47"],[0.030100334448160494,"#152F48"],[0.033444816053511676,"#152F48"],[0.036789297658862866,"#152F49"],[0.040133779264214048,"#153049"],[0.04347826086956523,"#16304A"],[0.046822742474916412,"#16304A"],[0.050167224080267601,"#16314B"],[0.053511705685618784,"#16314B"],[0.056856187290969966,"#16324C"],[0.060200668896321148,"#17324D"],[0.063545150501672171,"#17324D"],[0.066889632107023353,"#17334E"],[0.070234113712374549,"#17334E"],[0.073578595317725731,"#17344F"],[0.076923076923076913,"#18344F"],[0.080267558528428096,"#183450"],[0.083612040133779278,"#183550"],[0.08695652173913046,"#183551"],[0.090301003344481642,"#183651"],[0.093645484949832825,"#193652"],[0.096989966555184021,"#193652"],[0.10033444816053504,"#193753"],[0.10367892976588622,"#193754"],[0.1070234113712374,"#193854"],[0.1103678929765886,"#1A3855"],[0.11371237458193978,"#1A3955"],[0.11705685618729096,"#1A3956"],[0.12040133779264214,"#1A3956"],[0.12374581939799333,"#1A3A57"],[0.12709030100334451,"#1B3A57"],[0.1304347826086957,"#1B3B58"],[0.13377926421404687,"#1B3B59"],[0.13712374581939807,"#1B3B59"],[0.14046822742474924,"#1C3C5A"],[0.14381270903010043,"#1C3C5A"],[0.14715719063545146,"#1C3D5B"],[0.15050167224080263,"#1C3D5B"],[0.15384615384615383,"#1C3D5C"],[0.157190635451505,"#1D3E5C"],[0.16053511705685619,"#1D3E5D"],[0.16387959866220736,"#1D3F5D"],[0.16722408026755856,"#1D3F5E"],[0.17056856187290975,"#1D3F5F"],[0.17391304347826092,"#1E405F"],[0.17725752508361212,"#1E4060"],[0.18060200668896315,"#1E4160"],[0.18394648829431431,"#1E4161"],[0.18729096989966551,"#1E4261"],[0.19063545150501668,"#1F4262"],[0.19397993311036787,"#1F4263"],[0.19732441471571904,"#1F4363"],[0.20066889632107024,"#1F4364"],[0.20401337792642141,"#1F4464"],[0.2073578595317726,"#204465"],[0.2107023411371238,"#204465"],[0.21404682274247497,"#204566"],[0.21739130434782616,"#204566"],[0.22073578595317733,"#214667"],[0.22408026755852853,"#214668"],[0.2274247491638797,"#214768"],[0.23076923076923073,"#214769"],[0.23411371237458192,"#214769"],[0.23745819397993309,"#22486A"],[0.24080267558528429,"#22486A"],[0.24414715719063546,"#22496B"],[0.24749163879598665,"#22496C"],[0.25083612040133785,"#224A6C"],[0.25418060200668902,"#234A6D"],[0.25752508361204018,"#234A6D"],[0.26086956521739124,"#234B6E"],[0.26421404682274241,"#234B6E"],[0.26755852842809358,"#244C6F"],[0.2709030100334448,"#244C70"],[0.27424749163879597,"#244C70"],[0.27759197324414714,"#244D71"],[0.28093645484949831,"#244D71"],[0.28428093645484953,"#254E72"],[0.2876254180602007,"#254E72"],[0.29096989966555187,"#254F73"],[0.29431438127090309,"#254F74"],[0.29765886287625426,"#254F74"],[0.30100334448160543,"#265075"],[0.3043478260869566,"#265075"],[0.30769230769230782,"#265176"],[0.31103678929765882,"#265176"],[0.31438127090300999,"#275277"],[0.31772575250836121,"#275278"],[0.32107023411371238,"#275278"],[0.32441471571906355,"#275379"],[0.32775919732441472,"#275379"],[0.33110367892976594,"#28547A"],[0.33444816053511711,"#28547B"],[0.33779264214046828,"#28557B"],[0.3411371237458195,"#28557C"],[0.34448160535117051,"#28567C"],[0.34782608695652167,"#29567D"],[0.3511705685618729,"#29567D"],[0.35451505016722407,"#29577E"],[0.35785953177257523,"#29577F"],[0.3612040133779264,"#2A587F"],[0.36454849498327763,"#2A5880"],[0.3678929765886288,"#2A5980"],[0.37123745819397996,"#2A5981"],[0.37458193979933119,"#2A5982"],[0.37792642140468236,"#2B5A82"],[0.38127090301003352,"#2B5A83"],[0.38461538461538469,"#2B5B83"],[0.38795986622073592,"#2B5B84"],[0.39130434782608708,"#2C5C85"],[0.39464882943143825,"#2C5C85"],[0.39799331103678931,"#2C5D86"],[0.40133779264214048,"#2C5D86"],[0.40468227424749165,"#2C5D87"],[0.40802675585284282,"#2D5E87"],[0.41137123745819404,"#2D5E88"],[0.41471571906354521,"#2D5F89"],[0.41806020066889621,"#2D5F89"],[0.42140468227424743,"#2E608A"],[0.4247491638795986,"#2E608A"],[0.42809364548494977,"#2E618B"],[0.43143812709030099,"#2E618C"],[0.43478260869565216,"#2E618C"],[0.43812709030100333,"#2F628D"],[0.4414715719063545,"#2F628D"],[0.44481605351170572,"#2F638E"],[0.44816053511705689,"#2F638F"],[0.45150501672240806,"#30648F"],[0.45484949832775928,"#306490"],[0.45819397993311045,"#306590"],[0.46153846153846162,"#306591"],[0.46488294314381279,"#306592"],[0.46822742474916401,"#316692"],[0.47157190635451518,"#316693"],[0.47491638795986635,"#316793"],[0.47826086956521752,"#316794"],[0.48160535117056857,"#326895"],[0.48494983277591974,"#326895"],[0.48829431438127091,"#326996"],[0.49163879598662213,"#326996"],[0.4949832775919733,"#326997"],[0.49832775919732447,"#336A98"],[0.50167224080267547,"#336A98"],[0.50501672240802664,"#336B99"],[0.50836120401337792,"#336B99"],[0.51170568561872909,"#346C9A"],[0.51505016722408026,"#346C9B"],[0.51839464882943143,"#346D9B"],[0.52173913043478259,"#346D9C"],[0.52508361204013376,"#346E9D"],[0.52842809364548493,"#356E9D"],[0.53177257525083621,"#356E9E"],[0.53511705685618738,"#356F9E"],[0.53846153846153855,"#356F9F"],[0.54180602006688972,"#3670A0"],[0.54515050167224088,"#3670A0"],[0.54849498327759205,"#3671A1"],[0.55183946488294322,"#3671A1"],[0.5551839464882945,"#3772A2"],[0.55852842809364567,"#3772A3"],[0.56187290969899661,"#3773A3"],[0.56521739130434789,"#3773A4"],[0.56856187290969906,"#3773A4"],[0.57190635451505023,"#3874A5"],[0.5752508361204014,"#3874A6"],[0.57859531772575257,"#3875A6"],[0.58193979933110362,"#3875A7"],[0.58528428093645479,"#3976A8"],[0.58862876254180596,"#3976A8"],[0.59197324414715713,"#3977A9"],[0.5953177257525083,"#3977A9"],[0.59866220735785958,"#3978AA"],[0.60200668896321075,"#3A78AB"],[0.60535117056856191,"#3A79AB"],[0.60869565217391308,"#3A79AC"],[0.61204013377926425,"#3A79AC"],[0.61538461538461542,"#3B7AAD"],[0.61872909698996659,"#3B7AAE"],[0.62207357859531787,"#3B7BAE"],[0.62541806020066903,"#3B7BAF"],[0.6287625418060202,"#3C7CB0"],[0.63210702341137137,"#3C7CB0"],[0.63545150501672254,"#3C7DB1"],[0.63879598662207371,"#3C7DB1"],[0.64214046822742477,"#3C7EB2"],[0.64548494983277593,"#3D7EB3"],[0.6488294314381271,"#3D7FB3"],[0.65217391304347827,"#3D7FB4"],[0.65551839464882944,"#3D7FB5"],[0.65886287625418072,"#3E80B5"],[0.66220735785953189,"#3E80B6"],[0.66555183946488283,"#3E81B6"],[0.66889632107023411,"#3E81B7"],[0.67224080267558528,"#3F82B8"],[0.67558528428093645,"#3F82B8"],[0.67892976588628762,"#3F83B9"],[0.68227424749163879,"#3F83BA"],[0.68561872909698995,"#4084BA"],[0.68896321070234112,"#4084BB"],[0.6923076923076924,"#4085BB"],[0.69565217391304357,"#4085BC"],[0.69899665551839474,"#4086BD"],[0.70234113712374591,"#4186BD"],[0.70568561872909707,"#4186BE"],[0.70903010033444824,"#4187BF"],[0.71237458193979941,"#4187BF"],[0.71571906354515069,"#4288C0"],[0.71906354515050186,"#4288C1"],[0.72240802675585269,"#4289C1"],[0.7257525083612042,"#4289C2"],[0.72909698996655503,"#438AC2"],[0.73244147157190653,"#438AC3"],[0.73578595317725748,"#438BC4"],[0.73913043478260898,"#438BC4"],[0.74247491638795982,"#438CC5"],[0.74581939799331132,"#448CC6"],[0.74916387959866215,"#448DC6"],[0.75250836120401365,"#448DC7"],[0.75585284280936449,"#448EC8"],[0.75919732441471577,"#458EC8"],[0.76254180602006694,"#458FC9"],[0.76588628762541811,"#458FC9"],[0.76923076923076927,"#458FCA"],[0.77257525083612044,"#4690CB"],[0.77591973244147161,"#4690CB"],[0.77926421404682278,"#4691CC"],[0.78260869565217406,"#4691CD"],[0.78595317725752523,"#4792CD"],[0.78929765886287639,"#4792CE"],[0.79264214046822756,"#4793CF"],[0.79598662207357873,"#4793CF"],[0.79933110367892957,"#4894D0"],[0.80267558528428107,"#4894D0"],[0.80602006688963201,"#4895D1"],[0.80936454849498352,"#4895D2"],[0.81270903010033435,"#4896D2"],[0.81605351170568585,"#4996D3"],[0.81939799331103669,"#4997D4"],[0.82274247491638819,"#4997D4"],[0.82608695652173902,"#4998D5"],[0.82943143812709053,"#4A98D6"],[0.83277591973244147,"#4A99D6"],[0.83612040133779264,"#4A99D7"],[0.83946488294314381,"#4A9AD8"],[0.84280936454849498,"#4B9AD8"],[0.84615384615384615,"#4B9BD9"],[0.84949832775919731,"#4B9BDA"],[0.85284280936454859,"#4B9BDA"],[0.85618729096989976,"#4C9CDB"],[0.85953177257525093,"#4C9CDB"],[0.8628762541806021,"#4C9DDC"],[0.86622073578595327,"#4C9DDD"],[0.86956521739130443,"#4D9EDD"],[0.8729096989966556,"#4D9EDE"],[0.87625418060200688,"#4D9FDF"],[0.87959866220735805,"#4D9FDF"],[0.88294314381270889,"#4DA0E0"],[0.88628762541806039,"#4EA0E1"],[0.88963210702341122,"#4EA1E1"],[0.89297658862876272,"#4EA1E2"],[0.89632107023411367,"#4EA2E3"],[0.89966555183946517,"#4FA2E3"],[0.90301003344481601,"#4FA3E4"],[0.90635451505016751,"#4FA3E5"],[0.90969899665551834,"#4FA4E5"],[0.91304347826086985,"#50A4E6"],[0.91638795986622068,"#50A5E7"],[0.91973244147157196,"#50A5E7"],[0.92307692307692313,"#50A6E8"],[0.9264214046822743,"#51A6E8"],[0.92976588628762546,"#51A7E9"],[0.93311036789297663,"#51A7EA"],[0.9364548494983278,"#51A8EA"],[0.93979933110367897,"#52A8EB"],[0.94314381270903014,"#52A9EC"],[0.94648829431438142,"#52A9EC"],[0.94983277591973259,"#52AAED"],[0.95317725752508375,"#53AAEE"],[0.95652173913043492,"#53ABEE"],[0.95986622073578576,"#53ABEF"],[0.96321070234113726,"#53ACF0"],[0.96655518394648821,"#54ACF0"],[0.96989966555183971,"#54ADF1"],[0.97324414715719054,"#54ADF2"],[0.97658862876254204,"#54AEF2"],[0.97993311036789288,"#55AEF3"],[0.98327759197324438,"#55AFF4"],[0.98662207357859522,"#55AFF4"],[0.98996655518394672,"#55B0F5"],[0.99331103678929766,"#56B0F6"],[0.99665551839464916,"#56B1F6"],[1,"#56B1F7"]],"colorbar":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"thickness":23.039999999999996,"title":"BMI_0","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickmode":"array","ticktext":["20","25","30","35"],"tickvals":[0.15891206569286517,0.38324903706495006,0.60758600843703503,0.83192297980912],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Log Viral Load Change by BMI at Baseline","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[15.3846499065,39.819617683499999],"tickmode":"array","ticktext":["20","25","30","35"],"tickvals":[20,25,30,35],"categoryorder":"array","categoryarray":["20","25","30","35"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"BMI at Baseline","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-13.840508908367182,8.6112041840157598],"tickmode":"array","ticktext":["-10","-5","0","5"],"tickvals":[-10,-5,1.7763568394002505e-15,5.0000000000000018],"categoryorder":"array","categoryarray":["-10","-5","0","5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Log Viral Load Change","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"BMI_0","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"3d3831822d67":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"3d3831822d67","visdat":{"3d3831822d67":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>That does not look like a very strong association.</p>
<p>Let’s run a regression to see if there is any kind of linear relationship in there.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a linear regression predicting log viral load change by BMI at baseline</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> BMI_0, <span class="at">data =</span> data_wide_2)</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine model summary</span></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VLOAD_log_CHANGE ~ BMI_0, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.7201 -1.8086 -0.2408  1.3031 13.7112 

Coefficients:
            Estimate Std. Error t value        Pr(&gt;|t|)    
(Intercept) -5.24278    0.78749  -6.658 0.0000000000711 ***
BMI_0       -0.03610    0.03108  -1.162           0.246    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.804 on 518 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.002598,  Adjusted R-squared:  0.0006722 
F-statistic: 1.349 on 1 and 518 DF,  p-value: 0.246</code></pre>
</div>
</div>
<p><code>BMI</code> is not a significant predictor of log viral load change (p = 0.246) and will not be included in the final model.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-6-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-5-tab">
<p>Based on the correlation matrix, <code>EDUC_COLLEGE</code> appears to be significantly associated with our outcome variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of log vload change by college education</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> EDUC_COLLEGE, <span class="at">y =</span> VLOAD_log_CHANGE, <span class="at">fill =</span> EDUC_COLLEGE)) <span class="sc">+</span> </span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log Viral Load Change by College Education"</span>,</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Log Viral Load Change"</span>,</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"College Education"</span>) <span class="sc">+</span> </span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-135-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There appears to be a difference in log viral load change based on college education. Remember that this is on a logarithmic scale, so the real differences will be much more pronounced, even if the differences seem small here!</p>
<p>Let’s run the regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a linear regression predicting log viral load change by college education</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> EDUC_COLLEGE, <span class="at">data =</span> data_wide_2)</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine model summary</span></span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VLOAD_log_CHANGE ~ EDUC_COLLEGE, data = data_wide_2)

Residuals:
   Min     1Q Median     3Q    Max 
-6.518 -1.738 -0.351  1.345 12.995 

Coefficients:
                    Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)          -5.4045     0.2608 -20.726 &lt; 0.0000000000000002 ***
EDUC_COLLEGECollege  -0.8979     0.2959  -3.034              0.00253 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.845 on 530 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.01707,   Adjusted R-squared:  0.01522 
F-statistic: 9.204 on 1 and 530 DF,  p-value: 0.002533</code></pre>
</div>
</div>
<p>The overall model is significant F<sub>(1,530)</sub>= 9.204, p = 0.002533). On average, those with a college educaton had change in viral load that was 0.8979 log copies/mL (or 7.9 copies/mL) than those who did not have a college education.</p>
<p><code>EDUC_COLLEGE</code> is a significant predictor of log viral load change and should be included in the final model.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-6-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-6-tab">
<p>Based on the results of the exploratory data analysis, the variables that will be included in the final model for <code>VLOAD_log_CHANGE</code> are <code>hard_drug_grp</code>, <code>ADH_HIGHLOW</code>, and <code>EDUC_COLLEGE</code>.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<p>Now let’s examine relationships for the model predicting CD4+ T Cell Count</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">PEV - Hard Drug Use</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Adherence High vs Low</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">BMI</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">Frailty Related Phenotype</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-5" role="tab" aria-controls="tabset-7-5" aria-selected="false">College Education</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-6" role="tab" aria-controls="tabset-7-6" aria-selected="false">CESD Depression</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-7" role="tab" aria-controls="tabset-7-7" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>Let’s see if there is a a difference in CD4+ T Cell count based on hard drug use, the primary explanatory variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change the reference cateory to Never User</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of CD4+ T Cell count change by hard drug use group</span></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> hard_drugs_grp, <span class="at">y =</span> LEU3N_CHANGE, <span class="at">fill =</span> hard_drugs_grp)) <span class="sc">+</span></span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of CD4+ T Cell Count Change by Hard Drug Use Group"</span>,</span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drug Use Group"</span>,</span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"CD4+ T Cell Count Change"</span>) <span class="sc">+</span></span>
<span id="cb216-12"><a href="#cb216-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Hard Drug Use Group"</span>))</span>
<span id="cb216-13"><a href="#cb216-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-14"><a href="#cb216-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c5a631cdebd29b0b9a16" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c5a631cdebd29b0b9a16">{"x":{"data":[{"x":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"y":[-510.19032010000001,242.24552449999999,null,-127.2159317,199.32462599999997,312.85610339999994,171.64086040000001,6.3988714999999985,160.01892319999999,274.35576190000006,227.49673999999999,-40.451193899999993,-41.75440279999998,115.52520749999996,325.65166049999993,154.22603830000003,178.45966349999998,251.18368059999997,74.010905100000002,195.73678069999994,457.94252130000001,51.51440310000001,202.81095679999999,100.76504750000004,103.99756940000002,null,21.777354599999967,149.74091029999994,null,683.37082829999997,247.46783311999999,null,483.77205760000004,207.10072170000001,570.91391550000003,306.18409921,40.142532129999999,228.1449404,null,-7.713551300000006,100.00024789999998,171.95281809999997,209.49949820000006,106.9839546,315.97269200000005,-42.811120700000004,280.82198319999998,147.55443869999999,-149.58830999999998,121.14582410000003,-99.75718489999997,545.65129610000008,493.05532760000006,-12.121374199999991,248.89341710000002,-107.06269939999993,-57.03089940000001,158.66705480000002,15.577022199999988,88.959152689999996,18.956906599999996,360.35384950000002,403.20572189999996,251.37473959999994,60.530387099999984,76.488931900000011,475.33135279999999,-21.155062100000009,15.477332999999931,92.247799400000019,103.48798789999998,-47.41280549999999,44.18345219999992,-129.94904130000003,-5.0260815999999977,325.43721520000003,219.36869180000002,1268.5390324999998,478.56042069999995,436.61874230000001,210.22883189999999,488.28429169999998,51.617124700000005,-32.338009800000009,311.45791989999998,214.66159500000003,3.6253998999999908,24.020087899999965,446.13677250000001,-8.1511756899999952,37.539505899999995,271.85598449999998,60.603296819999983,28.970130900000072,158.55215079999999,-14.347824600000081,164.2516971,269.11625839999999,237.29431380000005,395.03573940000001,264.15652519999998,66.858049700000009,84.374585449999998,215.62328290000002,195.84221310000001,237.05473059999997,278.26578749999999,191.02829349999996,12.27566539999998,152.28598479999999,163.28565400000002,343.12586221999999,129.16011499999996,221.71825029999997,185.78258819999996,205.05918100000002,114.34246360000003,14.420559799999978,491.99678390000003,224.73535510000002,246.9052896,175.7129415,147.00938150000002,622.40100800000005,171.55180029999997,31.797324199999991,92.136901199999983,-31.231190400000003,96.917047450000013,-67.470034199999986,-91.295460900000023,210.10315969999999,345.76487839999999,161.93075449999998,143.1298362,223.0615603,413.24404120000003,381.22377760000001,29.625890100000049,-37.353353200000015,-13.5986501,-39.999437000000057,-53.369608930000012,119.26856119999997,null,153.23349659999997,101.35243850000001,125.8729922,973.60409490000006,93.335446999999931,null,455.24717599999997,-112.65655390000001,226.85086129999996,125.44151973000001,11.766449900000055,231.76097909999999,282.29294019999998,395.2648787,-4.9056456999999796,159.77176309999993,219.14695030000001,473.7998738,-47.937009199999977,301.7445568,237.83151169999996,183.0124222,303.8258479000001,263.23382030000005,-52.430581399999994,609.10845749999999,-32.163377700000069,88.020345499999962,216.68128691999999,56.956503599999962,264.3947612,-9.4500907999999981,80.503395699999999,94.138886600000035,-112.17440899999997,-126.5045452,11.62678509999995,197.97265519999996,313.65965519999997,29.497119899999973,120.96091250000001,229.67106000000001,208.62856962000001,-37.140079899999989,190.27438480000001,60.046049600000003,192.9092182,-3.7026684999999588,-46.991042500000049,59.67497620000006,72.436958199999992,410.75858569999991,324.80344349999996,368.29830830000003,327.36572919999998,18.718245200000013,242.37076870000004,-54.671882399999959,null,233.15945650000003,null,340.20581887000003,98.531508400000035,null,231.99194120000004,59.204167869999992,245.62149039999997,36.490280900000016,221.07282959999998,200.0730787,603.94797400000004,456.93890500000003,268.52402759999995,283.86494219999997,136.8966734,133.34832610000001,128.86368419999997,260.17778420000002,347.39226769999999,157.29614180000004,-114.20246945,57.081977800000004,131.14917940000001,73.229117899999991,52.000621699999954,399.02002340000007,449.12943109999998,89.744924699999956,430.17767800000001,133.63538189999997,null,487.39087789999996,112.00153899999998,136.76546830000007,30.430720400000013,-205.72839049999993,386.3793687000001,null,-72.359772999999961,77.631021099999998,364.64482019999991,392.18396669999998,249.76145600000007,288.16020200000003,105.04222440000001,212.96859579999997,253.68112499999998,186.72276050000002,107.94085121000001,311.54054080000003,181.56445169999995,184.5516796,133.91140769999998,90.893247099999968,9.6318195999999716,13.218813300000079,-39.389819100000011,69.753940100000023,246.89430039999999,188.88384990999998,256.59017410000001,-208.39643460000002,290.81528500000002,null,-117.74709129999997,57.356566499999985,87.558693099999971,-159.78537949999998,57.234685500000012,296.29134559999994,309.08487459999998,46.418269399999986,246.50115859999994,-30.943820039999991,94.925795899999969,348.33444907000001,341.85431560000006,352.27732330000003,343.07664610000006,309.71715740000002,-55.247500500000001,14.474987600000002,148.22283280000002,303.92081070000006,249.04344070000002,342.1382916,103.9338395,520.02841969999997,162.37658240000002,333.13894999999991,135.08378889999994,-61.49609849999996,-19.868758299999996,191.99675179999997,307.42302379999995,83.694335599999931,333.09152799999998,252.70110149999999,67.579719899999986,-109.47280469999998,391.50667049999998,150.93261910000007,219.9266963,27.196030229999991,288.39106290000001,266.32394630000005,352.23355490000006,298.77635700000002,198.33216200000001,146.42268239999999,-477.88681539999999,160.62179480000009,177.44715969999999,173.17778500000003,53.080104799999958,36.053787599999993,106.70734630000004,200.761392,-318.4551295,513.23597610000002,86.407031129999993,92.419395099999974,153.10081509999998,294.9777684,169.58884219000001,-84.0638352,172.31155741000001,470.15547349999997,179.41564260000001,280.52885900000001,217.16163129999995,246.13556545,null,111.35007390000001,183.89353449999999,339.09664750000002,71.731153900000038,329.1402372,26.935082300000033,372.38742910000002,129.31482859999994,389.56681076000001,null,128.09461770000001,-76.678283399999998,254.72653049999997,206.58942249999996,344.03963479999999,363.0292058,null,264.92644210000003,490.85020350000002,258.20187199999998,96.030284800000004,226.68748849999997,240.52814480000001,281.20165769999994,252.79346770000001,488.97544960000005,241.47320440000004,246.45341669999999,128.5747422,54.802824299999997,229.99196810000001,626.33828620000008,203.81502899999998,251.70516270000002,105.182683,10.551132900000027,216.65112729999998,168.12428390000002,341.11346150000003,256.03079729999996,300.30181840000006,373.98039180000001,143.8377054,53.511798899999974,543.18349430000012,343.20961561000001,258.44465389999999,191.0343148,null,133.69499509999991,308.28223210000004,187.30940069999997,304.02975079999999,30.670817499999998,165.10445230000005,58.173190449999993,257.32699160000004,22.687411999999995,222.78557810000001,167.24229439999999,24.365751100000011,127.1921724,317.84105509999995,97.799023899999952,229.8117566,242.95056720000002,282.17068619999998,243.83009819999998,486.88434340000003,236.87309939999994,124.96345200000007,127.47919430000002,59.659212499999967,286.88758830000006,624.83472370000004,209.87498780000004,179.62793450000004,329.27378269999997,15.741739900000027,217.32802839999999,375.03666050000004,345.42632560000004,255.17282930000005,-119.96668139999997,304.84167959999996,284.6078488,56.615924499999949,107.01009119999998,343.42162973000001,257.30853519999999,59.34714855,null,137.17580839999994,112.21638960000001,145.92977050000002,304.81137210000003,27.793178099999977,166.21334200000001,222.8496591,87.580499000000032,49.086132000000021,219.433854,256.45947910000001,30.781672499999956,125.57246359999999,89.134033999999986],"hoverinfo":"y","type":"box","fillcolor":"rgba(179,226,205,0.5)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"Never User","legendgroup":"Never User","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"y":[241.23504639999999,5.241470100000015,405.28067399999998,69.219119300000003,-125.64356194000001,406.83881689999998,-223.68461109999998,392.5761377,240.18031530000002,-117.41617557000001,-198.06690500000002,305.97956409999995,-219.25523329999999,-222.4941432,216.23491025000001,-126.40313538000001,226.08675740000001,142.42841909999999,67.780245400000013,308.24154970000006,137.12724809999997,222.49382680000002,410.024856,49.153983100000005,215.298024,-118.57426233,-196.47677779999998,210.0947041,4.8688235000000191,414.99506159999999,145.87305530000003,301.16188460000001,218.26121988,130.63228179999999,54.268604700000026,392.73349030000008,-123.37908565999999,141.53414299999997,-216.54030690000002,141.52831319999996,305.04508060000001,308.87742739999999,-125.00905657,69.294922800000009,67.378013100000032,302.84951879999994],"hoverinfo":"y","type":"box","fillcolor":"rgba(253,205,172,0.5)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"Previous User","legendgroup":"Previous User","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"y":[-64.464980499999967,477.44281690000003,-4.5511821000000054,204.34216140000007,-194.09989331,15.126131099999995,361.8202642,256.9580203999999,-267.67374480000007,188.15740060000007,-177.77702683000001,-195.54275799999994,259.30815749999999,217.73369830000001,-9.4716999999999985,200.23311079999996,-265.90944920000004,247.51453600000013,247.63977099999988,-210.91766580000001,251.65530070000011,250.05414399999995,257.0346469000001,9.5842407000000094,-188.92123940000002,-206.56196349999993,358.6569586999999,-64.587896200000046,-11.25988719999998,-264.08499939999996,-8.6372708000000102,222.08553050000006,-187.97017510999999,190.00018730000005,22.025349919999996,15.764253599999989,-157.9407296,25.914776200000006,256.3775776,21.011336220000004,26.924772399999995,247.51265310000008,353.13376130000006,478.23580089999996,12.497106900000006,-152.53263270000002,253.2047781,-3.0696341999999959,-204.99757460000001,-181.86904843999997,357.79414430000008,359.20153549999998,355.77298560000008,-193.04149113,261.50560680000001,-268.95923619999996,255.09508849999997,-196.54800169999999,-209.2530989,-8.861818000000028],"hoverinfo":"y","type":"box","fillcolor":"rgba(203,213,232,0.5)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"Current User","legendgroup":"Current User","showlegend":true,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":48.949771689497723},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Boxplot of CD4+ T Cell Count Change by Hard Drug Use Group","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,3.6000000000000001],"tickmode":"array","ticktext":["Never User","Previous User","Current User"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["Never User","Previous User","Current User"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Hard Drug Use Group","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-599.12678773000005,1357.4755001299998],"tickmode":"array","ticktext":["-500","0","500","1000"],"tickvals":[-500,0,500.00000000000011,1000.0000000000001],"categoryorder":"array","categoryarray":["-500","0","500","1000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"CD4+ T Cell Count Change","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Hard Drug Use Group","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"3d383eb3153b":{"x":{},"y":{},"fill":{},"type":"box"}},"cur_data":"3d383eb3153b","visdat":{"3d383eb3153b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Previous and current hard drug users may have low CD4+ T Cell count compared to never users.</p>
<p>Let’s run the regression to see if this relationship is statistically significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting CD4+ T Cell count change by hard drug use group with never user as the reference group</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> hard_drugs_grp, <span class="at">data =</span> data_wide_2)</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ hard_drugs_grp, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-689.95 -121.80   -5.32  117.15 1088.77 

Coefficients:
                            Estimate Std. Error t value             Pr(&gt;|t|)
(Intercept)                  179.764      8.962  20.060 &lt; 0.0000000000000002
hard_drugs_grpPrevious User  -65.463     28.706  -2.280                0.023
hard_drugs_grpCurrent User  -119.467     25.505  -4.684           0.00000358
                               
(Intercept)                 ***
hard_drugs_grpPrevious User *  
hard_drugs_grpCurrent User  ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 185 on 529 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.0453,    Adjusted R-squared:  0.04169 
F-statistic: 12.55 on 2 and 529 DF,  p-value: 0.000004732</code></pre>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gather p-values of the model</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[,<span class="dv">4</span>] <span class="co"># This line selects the fourth column of the resulting coefficients table from summary(model), which is the p-values</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Bonferroni correction </span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare adjusted p-values to unadjusted p-values</span></span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>p_comparison <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p_values, p_adjusted)</span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(p_comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_values</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">0.0229783</td>
<td style="text-align: right;">0.0689350</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">0.0000036</td>
<td style="text-align: right;">0.0000107</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Change the reference group to previous users and re-run the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change the reference category to Previous User</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting CD4+ T Cell count change by hard drug use group with previous user as the reference group</span></span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> hard_drugs_grp, <span class="at">data =</span> data_wide_2)</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ hard_drugs_grp, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-689.95 -121.80   -5.32  117.15 1088.77 

Coefficients:
                           Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)                  114.30      27.27   4.191 0.0000325 ***
hard_drugs_grpNever User      65.46      28.71   2.280     0.023 *  
hard_drugs_grpCurrent User   -54.00      36.25  -1.490     0.137    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 185 on 529 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.0453,    Adjusted R-squared:  0.04169 
F-statistic: 12.55 on 2 and 529 DF,  p-value: 0.000004732</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gather p-values of the model</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[,<span class="dv">4</span>] <span class="co"># This line selects the fourth column of the resulting coefficients table from summary(model), which is the p-values</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Bonferroni correction </span></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare adjusted p-values to unadjusted p-values</span></span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>p_comparison <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p_values, p_adjusted)</span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(p_comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_values</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0000325</td>
<td style="text-align: right;">0.0000975</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">0.0229783</td>
<td style="text-align: right;">0.0689350</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">0.1368567</td>
<td style="text-align: right;">0.4105702</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The overall model is statistically significant F<sub>(2,529)</sub> = 12.55, p &lt; 0.0001). On average current drug users have a change in CD4+ T cell count that is 119.467 cells lower than never drug users (p-adjusted &lt; 0.0001). The other between group comparisons were not significant (p-adjusted &gt; 0.05).</p>
<p><code>hard_drug_grp</code> will be included as a predictor in the final model for <code>LEU3N</code>.</p>
<p><a href="#EDA">Top of tabset</a></p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>For ease of mind, let’s plot our average <code>LEU3N</code> values each year by adherence group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get means for each year</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> data_2 <span class="sc">%&gt;%</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADH, years) <span class="sc">%&gt;%</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_LEU3N =</span> <span class="fu">mean</span>(LEU3N, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ADH'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> years, <span class="at">y =</span> Average_LEU3N, <span class="at">color =</span> ADH)) <span class="sc">+</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="co"># Line plot</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Add points for clarity</span></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average CD4+ T Cell Count change by Adherence Group Over 2 Years"</span>,</span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average CD4+ T Cell Count"</span>,</span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Adherence Group"</span>) <span class="sc">+</span></span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>       <span class="co"># Clean theme</span></span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)  <span class="co"># Nice color palette for groups</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-140-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We have the same relation we did with log viral load, where higher adherence groups tend to have better outcomes (higher average CD4+ T Cell count in this case). The &lt;75% has a pretty high average CD4+ T cell count, but I think we can chalk this up to variance due to a smaller sample size. We still see the general trend that both high adherence groups are performing better than both low adherence groups, and we can safely collapse these categories into high adherence (95-100%) and low adherence (&lt;95%) groups.</p>
<p>Let’s examine change in CD4+ T Cell count based on high vs low adherence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of CD4+ T Cell count change by adherence group</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_no_na, <span class="fu">aes</span>(<span class="at">x =</span> ADH_HIGHVSLOW, <span class="at">y =</span> LEU3N_CHANGE, <span class="at">fill =</span> ADH_HIGHVSLOW)) <span class="sc">+</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of CD4+ T Cell Count Change by Adherence at Year 2"</span>,</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Adherence Level"</span>,</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"CD4+ T Cell Count Change"</span>) <span class="sc">+</span></span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Adherence Group"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-141-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It appears that the high adherence group may have a slightly higher gain in CD4+ T Cells over 2 years (its pretty close though).</p>
<p>Let’s run a regression to see if this is statistically significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting CD4+ T Cell count change by adherence group at year 2</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE<span class="sc">~</span> ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-673.33 -114.72    7.43  101.39 1105.40 

Coefficients:
                            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)                   119.03      28.80   4.134 0.0000417 ***
ADH_HIGHVSLOWHigh Adherence    44.11      30.07   1.467     0.143    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 188.8 on 518 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.004138,  Adjusted R-squared:  0.002215 
F-statistic: 2.152 on 1 and 518 DF,  p-value: 0.143</code></pre>
</div>
</div>
<p>The overall model is not significant (F<sub>(1,518)</sub>= 2.152, p = 0.143).</p>
<p>Just for sanity’s sake let’s run that with our uncollapsed adherence categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting CD4+ T Cell count change by adherence group at year 2</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE<span class="sc">~</span> ADH_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ ADH_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-644.02 -120.62   11.55  112.13 1080.31 

Coefficients:
            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)   119.03      28.54   4.170 0.0000356 ***
ADH_2100%      14.80      31.21   0.474    0.6356    
ADH_295-99%    69.20      30.84   2.244    0.0253 *  
ADH_2&lt;75%      91.08      61.11   1.490    0.1367    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 187.2 on 528 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.02414,   Adjusted R-squared:  0.01859 
F-statistic: 4.353 on 3 and 528 DF,  p-value: 0.004829</code></pre>
</div>
</div>
<p>The overall model is significant (F~(3, 528)~, = 4.353, p = 0.0048). However, none of those between group comparisons are significant after Bonferroni correction.</p>
<p>So no matter how you run it, adherence is not related to CD4+ T Cell count.</p>
<p>We will still include <code>ADH_HIGHLOW</code> as a covariate in the final model for <code>LEU3N_CHANGE</code>, since it was a confounder in the model predicting <code>VLOAD_log_CHANGE</code>, and new relationships may become apparent if it is included in this model.</p>
<p><a href="#EDA">Top of tabset</a></p>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>The correlation matrix reveals a potential relationship between BMI and each CD4+ T Cell count.</p>
<p>Let’s assess.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of CD4+ T Cell Count change by BMI at baseline</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> BMI_0, <span class="at">y =</span> LEU3N_CHANGE, <span class="at">color =</span> BMI_0)) <span class="sc">+</span> </span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"CD4+ T Cell Count Change by BMI at Baseline"</span>,</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"CD4+ T Cell Count Change"</span>,</span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"BMI at Baseline"</span>) <span class="sc">+</span> </span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 31 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-144-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There does not appear to be a strong relationship between BMI and CD4+ T Cell count change.</p>
<p>We perform the regression to double check.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a linear regression predicting CD4+ T Cell count change by BMI at baseline</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> BMI_0, <span class="at">data =</span> data_wide_2)</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine model summary</span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ BMI_0, data = data_wide_2)

Residuals:
   Min     1Q Median     3Q    Max 
-636.8 -116.7    4.1  108.2 1114.8 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)   69.771     52.140   1.338    0.181  
BMI_0          3.443      2.059   1.673    0.095 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 185.9 on 517 degrees of freedom
  (31 observations deleted due to missingness)
Multiple R-squared:  0.005382,  Adjusted R-squared:  0.003458 
F-statistic: 2.798 on 1 and 517 DF,  p-value: 0.09501</code></pre>
</div>
</div>
<p>Let’s plot the regression line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of CD4+ T Cell Count change by BMI at baseline</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> BMI_0, <span class="at">y =</span> LEU3N_CHANGE, <span class="at">color =</span> BMI_0)) <span class="sc">+</span> </span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"CD4+ T Cell Count Change by BMI at Baseline"</span>,</span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"CD4+ T Cell Count Change"</span>,</span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"BMI at Baseline"</span>) <span class="sc">+</span> </span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 31 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation:
colour.
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 31 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-146-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The overall model is non-significant (F<sub>(1,517)</sub> = 2.798, p = 0.095). On average, every 1 unit increase in BMI is associated with a 0.0034 increase in CD4+ T Cell count. Though not significant, the model is below that p = 0.10 cutoff for potential covariates we established a priori. On average, every 1 unit increase in BMI is associated with a 0.0034 increase in CD4+ T Cell count.</p>
<p><code>BMI</code> will be included as a potential precision variable for the model predicting <code>LEU3N_CHANGE</code>.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<p>Fraily related phenotype was also correlated to CD4+ T Cell count in the correlation matrix.</p>
<p>Let’s assess that relationship.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out NA values</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>data_no_na <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(FRP_2))</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of CD4+ T Cell count change by frailty related phenotype at year 2</span></span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_no_na, <span class="fu">aes</span>(<span class="at">x =</span> FRP_2, <span class="at">y =</span> LEU3N_CHANGE, <span class="at">fill =</span> FRP_2)) <span class="sc">+</span></span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of CD4+ T Cell Count Change by Frailty Related Phenotype"</span>,</span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Frailty Related Phenotype"</span>,</span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"CD4+ T Cell Count Change"</span>) <span class="sc">+</span></span>
<span id="cb244-12"><a href="#cb244-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Frailty Related Phenotype"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-147-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It appears that those with a frailty related phenotype have a lower increase in CD4+ T Cell count over the 2 years of the study.</p>
<p>Let’s run a regression to see if that relationship is statistically significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting physical QOL change by Frailty Related Phenotype</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> FRP_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ FRP_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-677.29 -118.00   12.42  107.11 1101.44 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)  167.099      8.349  20.015 &lt; 0.0000000000000002 ***
FRP_2Yes    -124.046     36.323  -3.415             0.000687 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 187.1 on 528 degrees of freedom
  (20 observations deleted due to missingness)
Multiple R-squared:  0.02161,   Adjusted R-squared:  0.01976 
F-statistic: 11.66 on 1 and 528 DF,  p-value: 0.0006867</code></pre>
</div>
</div>
<p>The overall model is statistically significant (F<sub>1,528)</sub>= 11.66, p &lt; 0.0001). On average, those with a frailty related phenotype had a change in CD4+ T Cell count over 2 years that was 124.046 cells lower than those without a frailty related phenotype (p &lt; 0.0001).</p>
<p><code>FRP_2</code> will be included as a precision variable for the model predicting <code>LEU3N_CHANGE</code>.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-7-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-5-tab">
<p>College education did not look strongly related to CD4+ T Cell count change, but let’s run a simple regression just to make sure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of CD4+ T Cell count change by college education</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> EDUC_COLLEGE, <span class="at">y =</span> LEU3N_CHANGE, <span class="at">fill =</span> EDUC_COLLEGE)) <span class="sc">+</span> </span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"CD4+ T Cell Count Change by College Education"</span>,</span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"CD4+ T Cell Count Change"</span>,</span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"College Education"</span>) <span class="sc">+</span> </span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-149-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>They appear comparable, but there may be a slight difference. Run regression to be sure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting log vload change by college education</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> EDUC_COLLEGE, <span class="at">data =</span> data_wide_2)</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ EDUC_COLLEGE, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-679.89 -115.22    7.69  115.21 1098.84 

Coefficients:
                    Estimate Std. Error t value          Pr(&gt;|t|)    
(Intercept)           129.50      17.20   7.531 0.000000000000219 ***
EDUC_COLLEGECollege    40.20      19.54   2.057            0.0402 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 188.4 on 530 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.007921,  Adjusted R-squared:  0.006049 
F-statistic: 4.231 on 1 and 530 DF,  p-value: 0.04017</code></pre>
</div>
</div>
<p>The overall model is significant (F<sub>(1,530)</sub>= 4.231, p = 0.0401). On average, those with a college education had a change in CD4+ T cell count that was 40.20 cells higher than those without a college education.</p>
<p><code>EDUC_COLLEGE</code> will be included as a precision variable for the model predicting <code>LEU3N_CHANGE</code>.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-7-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-6-tab">
<p>Depression was lightly correlated to CD4+ T Cell Count based on the correlation matrix.</p>
<p>Let’s examine that relationship.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of CD4+ T Cell Count change by BMI at baseline</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> CESD_0, <span class="at">y =</span> LEU3N_CHANGE, <span class="at">color =</span> CESD_2)) <span class="sc">+</span> </span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"CD4+ T Cell Count Change by Depression at Year Two"</span>,</span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"CD4+ T Cell Count Change"</span>,</span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Depression at Year Two"</span>) <span class="sc">+</span> </span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 34 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-151-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a linear regression predicting CD4+ T Cell count change by depressions core</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> CESD_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine model summary</span></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ CESD_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-660.08 -116.87    1.12  112.37 1107.94 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept) 180.4992    12.6181  14.305 &lt;0.0000000000000002 ***
CESD_2       -1.5305     0.7445  -2.056              0.0403 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 189 on 525 degrees of freedom
  (23 observations deleted due to missingness)
Multiple R-squared:  0.007986,  Adjusted R-squared:  0.006096 
F-statistic: 4.226 on 1 and 525 DF,  p-value: 0.0403</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of CD4+ T Cell Count change by BMI at baseline</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> CESD_0, <span class="at">y =</span> LEU3N_CHANGE, <span class="at">color =</span> CESD_2)) <span class="sc">+</span> </span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"CD4+ T Cell Count Change by Depression at Year Two"</span>,</span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"CD4+ T Cell Count Change"</span>,</span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Depression at Year Two"</span>) <span class="sc">+</span> </span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 34 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation:
colour.
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 34 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-153-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The overall model is significant (F~(1, 525)~= 4.23, p = 0.0403). On average, every 1 point increase in CES-Depression score was associated with a 1.53 cell decrease in CD4+ T Cell count.</p>
<p>The association is very weak (R-squared = 0.0080), but we can still include it in the final model. It makes sense that people who are more depressed have fewer white blood cells, and we may as well account for this in the final model.</p>
<p><code>CESD_2</code> is will be included as a precision variable in the model predicting <code>LEU3N_CHANGE</code>.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-7-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-7-tab">
<p>Based on the results of the exploratory data analysis, the variables that will be included for consideration in the final model for <code>LEU3N_CHANGE</code> are <code>hard_drugs_grp</code>, <code>ADH_HIGHLOW</code>, <code>BMI_2</code>, <code>FRP_2</code>, and <code>EDUC_COLLEGE</code>, and <code>CESD_2</code>.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<p>Now let’s examine relationships for the model predicting aggregate mental QOL change.</p>
<p>The researchers are concerned that the a</p>
<p>They want to investigate how mental QOL is after 2 years. If there is a</p>
<p>We can also see if mental QOL differs by hard drug use grp and adherence, and any other covariates.</p>
<p>Does viral load predict mental QOL?</p>
<p>does LEU3n predict mental QOL?</p>
<p>Do I have to do something here concerning dropout?</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">PEV - Hard Drug Use</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Adherence</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">CESD - Depression</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false">Depression and Hard Drug Use</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>Let’s assess if mental QOL is related to the hard drug use categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of log viral load change by hard drug use group</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> hard_drugs_grp, <span class="at">y =</span> AGG_MENT_CHANGE, <span class="at">fill =</span> hard_drugs_grp)) <span class="sc">+</span></span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Mental QOL Change by Hard Drug Use Group"</span>,</span>
<span id="cb261-7"><a href="#cb261-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drug Use Group"</span>,</span>
<span id="cb261-8"><a href="#cb261-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Aggregate Mental QOL Change"</span>) <span class="sc">+</span></span>
<span id="cb261-9"><a href="#cb261-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Hard Drug Use Group"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-154-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There does not appear to be much of a difference in mental QOL by hard drug use groups.</p>
<p>Let’s run a regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting mental QOL change by hard drug use group</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp, <span class="at">data =</span> data_wide_2)</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-40.581  -6.092  -0.747   5.348  38.743 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                   2.546      1.809   1.407    0.160
hard_drugs_grpNever User     -0.157      1.902  -0.083    0.934
hard_drugs_grpCurrent User   -2.576      2.405  -1.071    0.285

Residual standard error: 12.27 on 540 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.003886,  Adjusted R-squared:  0.0001966 
F-statistic: 1.053 on 2 and 540 DF,  p-value: 0.3495</code></pre>
</div>
</div>
<p><code>hard_drugs_grp</code> is not a significant predictor of <code>AGG_MENT_CHANGE</code>.</p>
<p>This is interesting, because when we plot average mental QOL over 8 years by hard drug use, we can see a clear relationship</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get means for each year</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hard_drugs, years) <span class="sc">%&gt;%</span></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_agg_ment =</span> <span class="fu">mean</span>(AGG_MENT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'hard_drugs'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> years, <span class="at">y =</span> Average_agg_ment, <span class="at">color =</span> hard_drugs)) <span class="sc">+</span></span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="co"># Line plot</span></span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Add points for clarity</span></span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average mental QOL by Hard Drug Use Over 8 Years"</span>,</span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average mental QOL"</span>,</span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Hard Drug Use"</span>) <span class="sc">+</span></span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>       <span class="co"># Clean theme</span></span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)  <span class="co"># Nice color palette for groups</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-156-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Where those who did not use hard drugs since the last visit had higher mental QOL.</p>
<p>It seems that somewhere when we created our 3 hard drug use categories of never user, previous user, and current user, we lost some of this information.</p>
<p><code>hard_drg_group</code> will still be included as a potential covariate in case there is a confounding variable present.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>If adverse reactions from the HAART treatment negatively impacted patients, then we would expect to see the higher adherence groups having a smaller increase, or even decrease, in mental QOL compared to those in the low adherence groups.</p>
<p>Let’s first examine this by plotting the average mental QOL for each year by adherence group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get means for each year</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> data_2 <span class="sc">%&gt;%</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADH, years) <span class="sc">%&gt;%</span></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_AGG_MENT =</span> <span class="fu">mean</span>(AGG_MENT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ADH'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> years, <span class="at">y =</span> Average_AGG_MENT, <span class="at">color =</span> ADH)) <span class="sc">+</span></span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="co"># Line plot</span></span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Add points for clarity</span></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Mental QOL by Adherence Group Over 2 Years"</span>,</span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Mental QOL"</span>,</span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Adherence Group"</span>) <span class="sc">+</span></span>
<span id="cb272-9"><a href="#cb272-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>       <span class="co"># Clean theme</span></span>
<span id="cb272-10"><a href="#cb272-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)  <span class="co"># Nice color palette for groups</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-157-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This plot shows that, over the first 2 years, the &lt; 75% adherence group had the highest increase in mental QOL! This is the opposite of expected; you would expect the 100% adherence group to have the highest mental QOL if there were no adverse effects from the drug and it was improving QOL overall by decreasing HIV viral load.</p>
<p>However, the relationship looks different if we create this same plot over the entire 8 years of the study.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get means for each year</span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADH, years) <span class="sc">%&gt;%</span></span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_QOL =</span> <span class="fu">mean</span>(AGG_MENT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ADH'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> years, <span class="at">y =</span> Average_QOL, <span class="at">color =</span> ADH)) <span class="sc">+</span></span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="co"># Line plot</span></span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Add points for clarity</span></span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Mental QOL Score by Adherence Group Over 8 Years"</span>,</span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Mental QOL Score"</span>,</span>
<span id="cb277-8"><a href="#cb277-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Adherence Group"</span>) <span class="sc">+</span></span>
<span id="cb277-9"><a href="#cb277-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>       <span class="co"># Clean theme</span></span>
<span id="cb277-10"><a href="#cb277-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)  <span class="co"># Nice color palette for groups</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-158-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here we see the true relationship emerge! The 100% adherence group has the highest aggregate mental QOL score across the 8 years of the study, followed by the 95-99% adherence group, then the 75-94% and &lt;75% adherence groups trailing behind with fair amounts of year to year variation.</p>
<p>Could we calculate AUC and use that to answer the researchers’ question?</p>
<p>Therefore we can reasonably conclude that higher adherence is related to better overall mental QOL. Which would likely not be the case if the side effects of the drug were worse than the benefits from taking them.</p>
<p>Let’s examine these relationships with boxplots.</p>
<p>First looking at adherence split into four categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change reference group</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_2 <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_2, <span class="at">ref =</span> <span class="st">"100%"</span>)</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of mental QOL change by adherence group</span></span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> ADH_2, <span class="at">y =</span> AGG_MENT_CHANGE, <span class="at">fill =</span> ADH_2)) <span class="sc">+</span></span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Mental QOL Change by Adherence at Year 2"</span>,</span>
<span id="cb280-10"><a href="#cb280-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Adherence at year 2"</span>,</span>
<span id="cb280-11"><a href="#cb280-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mental QOL Change"</span>) <span class="sc">+</span></span>
<span id="cb280-12"><a href="#cb280-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Adherence Group"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-159-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>And then adherence split into two categories of high vs low.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out NA values</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>data_no_na <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ADH_HIGHVSLOW))</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of mental QOL change by adherence group</span></span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_no_na, <span class="fu">aes</span>(<span class="at">x =</span> ADH_HIGHVSLOW, <span class="at">y =</span> AGG_MENT_CHANGE, <span class="at">fill =</span> ADH_HIGHVSLOW)) <span class="sc">+</span></span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Mental QOL Change by Adherence at Year 2"</span>,</span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Adherence at year 2"</span>,</span>
<span id="cb282-11"><a href="#cb282-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mental QOL Change"</span>) <span class="sc">+</span></span>
<span id="cb282-12"><a href="#cb282-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Adherence Group"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-160-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This plot shows that there is a slight difference in aggregate mental QOL over the first 2 years of the study between the high and low adherence groups.</p>
<p>While not a perfect encapsulation of the true relationship between adherence and mental QOL over time, I believe this comparison adequately captures the differences between adherence groups we can see with our data visualizations.</p>
<p>Let’s perform a regression to see if this relationship is statistically significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting mental QOL change by adherence group</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-35.917  -6.161  -0.841   5.457  38.633 

Coefficients:
                            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)                   -2.286      1.859  -1.230   0.2194  
ADH_HIGHVSLOWHigh Adherence    4.785      1.939   2.468   0.0139 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.19 on 530 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.01136,   Adjusted R-squared:  0.009498 
F-statistic: 6.092 on 1 and 530 DF,  p-value: 0.0139</code></pre>
</div>
</div>
<p>Great! <code>ADH_HIGHLOW</code> is a significant predictor of mental QOL change over 2 years (F<sub>(1,530)</sub>= 6.092). On average, those who had high adherence to the treatment regiment had an aggregate mental QOL score that was 4.79 points higher than those who had low adherence (p = 0.0139).</p>
<p><code>ADH_HIGHLOW</code> will be included in the final model as a predictor of <code>AGG_MENT_CHANGE</code>.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<p>The only other variable that flagged as being associated with mental QOL was the CESD Depression score.</p>
<p>Let’s examine this relationship with a plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of mental QOL change score by depression at 2 years</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> CESD_2, <span class="at">y =</span> AGG_MENT_CHANGE, <span class="at">color =</span> CESD_2)) <span class="sc">+</span> </span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mental QOL Change by Depression at Baseline"</span>,</span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mental QOL Change "</span>,</span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Depression Score"</span>) <span class="sc">+</span> </span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 12 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-162-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There appears to be a negative linear relationship here. Let’s run the regression and fit the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a linear regression predicting mental QOL change by depression at baseline</span></span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> CESD_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine model summary</span></span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ CESD_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-32.125  -6.554  -1.727   5.389  39.519 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)  6.38166    0.77447   8.240 0.00000000000000133 ***
CESD_2      -0.33368    0.04625  -7.215 0.00000000000185341 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.77 on 536 degrees of freedom
  (12 observations deleted due to missingness)
Multiple R-squared:  0.08852,   Adjusted R-squared:  0.08682 
F-statistic: 52.05 on 1 and 536 DF,  p-value: 0.000000000001853</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of mental QOL change score by depression at baseline</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> CESD_2, <span class="at">y =</span> AGG_MENT_CHANGE, <span class="at">color =</span> CESD_2)) <span class="sc">+</span> </span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mental QOL Change by Depression at Baseline"</span>,</span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mental QOL Change "</span>,</span>
<span id="cb290-8"><a href="#cb290-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Depression Score"</span>) <span class="sc">+</span> </span>
<span id="cb290-9"><a href="#cb290-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 12 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation:
colour.
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 12 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-164-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Depression score is a significant predictor of mental QOL change over the first 2 years of treatment (F~(1, 536)~= 52.05). On average, a 1-point increase in depression score is associated with a 0.33 point decrease in mental QOL score (p &lt; 0.0001).</p>
<p><code>CESD_0</code> will be included as a precision variable in the model predicting <code>AGG_MENT_CHANGE</code></p>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<p>It appears that depression and hard drug use may be correlated based on the correlation matrix.</p>
<p>If so, we have potential confounding between hard drug use and depression. Maybe those who used hard drugs have worse QOL, but it’s because they are depressed. Or vice versa.</p>
<p>Let’s assess.</p>
<p>First we can plot depression by hard drug use group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of depression score at year 2 by hard drug use group</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> hard_drugs_grp, <span class="at">y =</span> CESD_2, <span class="at">fill =</span> hard_drugs_grp)) <span class="sc">+</span> </span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb295-5"><a href="#cb295-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Depression Score by Hard Drug Use Group"</span>,</span>
<span id="cb295-6"><a href="#cb295-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Depression Score "</span>,</span>
<span id="cb295-7"><a href="#cb295-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drug Use Group"</span>) <span class="sc">+</span> </span>
<span id="cb295-8"><a href="#cb295-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-165-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It appears that current and previous drug users have higher depression scores than those who never used drugs.</p>
<p>Let’s run a regression to see if that relationship is statistically significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Refactor to never users as reference group</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a linear regression predicting depression by hard drug use group</span></span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(CESD_2 <span class="sc">~</span> hard_drugs_grp, <span class="at">data =</span> data_wide_2)</span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine model summary</span></span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = CESD_2 ~ hard_drugs_grp, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.826  -8.533  -2.767   6.467  38.467 

Coefficients:
                            Estimate Std. Error t value             Pr(&gt;|t|)
(Intercept)                  11.5330     0.5137  22.451 &lt; 0.0000000000000002
hard_drugs_grpPrevious User   7.2931     1.6680   4.372            0.0000147
hard_drugs_grpCurrent User    5.2336     1.4814   3.533             0.000446
                               
(Intercept)                 ***
hard_drugs_grpPrevious User ***
hard_drugs_grpCurrent User  ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 10.76 on 542 degrees of freedom
  (5 observations deleted due to missingness)
Multiple R-squared:  0.05016,   Adjusted R-squared:  0.04666 
F-statistic: 14.31 on 2 and 542 DF,  p-value: 0.0000008765</code></pre>
</div>
</div>
<p>Hard drug use is a significant predictor of depression score (F~(2, 542)~= 14.31). On average, current hard drug users had depression scores that were 5.23 points higher than never hard drug users (p &lt; 0.0001), and previous hard drug users had depression scores that were 7.29 points higher than those who never used hard drugs (p &lt; 0.0001).</p>
<p><code>hard_drug_grp</code> will be included as a possible confounder for the relationship between depression and mental QOL. Or rather depression will be included as a possible confounder for the relationship between hard_drug_use and mental QOL.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
</div>
</div>
</div>
<div id="tabset-10-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<p>If the ART has a strong adverse effect on QOL, then we can expect those with high adherence to have worse QOL. Maybe.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Drug Use Groups</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Adherence</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">Frailty Related Phenotype</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false">CESD Depression</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-5" role="tab" aria-controls="tabset-9-5" aria-selected="false">CD4+ T Cell Count</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-6" role="tab" aria-controls="tabset-9-6" aria-selected="false">College Education</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-7" role="tab" aria-controls="tabset-9-7" aria-selected="false">Age</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-8" role="tab" aria-controls="tabset-9-8" aria-selected="false">BMI</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-9" role="tab" aria-controls="tabset-9-9" aria-selected="false">DKGRP</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>Let’s assess if physical QOL is related to the hard drug use categories by itself.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of aggregate physical QOL by hard drug use group</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> hard_drugs_grp, <span class="at">y =</span> AGG_PHYS_CHANGE, <span class="at">fill =</span> hard_drugs_grp)) <span class="sc">+</span></span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Aggregate Physical QOL by Hard Drug Use Group"</span>,</span>
<span id="cb299-7"><a href="#cb299-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drug Use Group"</span>,</span>
<span id="cb299-8"><a href="#cb299-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Aggregate Physical QOL Change"</span>) <span class="sc">+</span></span>
<span id="cb299-9"><a href="#cb299-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Hard Drug Use Group"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-167-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It looks like current hard drug users have a lower physical QOL score than never hard drug users.</p>
<p>Let’s run a regression to see if that difference is statistically significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting physical QOL change by hard drug use group</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> hard_drugs_grp, <span class="at">data =</span> data_wide_2)</span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-36.370  -3.818   0.689   4.380  33.402 

Coefficients:
                            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)                  -1.3010     0.4014  -3.241   0.00126 ** 
hard_drugs_grpPrevious User  -0.2510     1.3007  -0.193   0.84703    
hard_drugs_grpCurrent User   -4.8971     1.1553  -4.239 0.0000264 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.391 on 540 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.03232,   Adjusted R-squared:  0.02874 
F-statistic: 9.019 on 2 and 540 DF,  p-value: 0.0001403</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gather p-values of the model</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[,<span class="dv">4</span>] <span class="co"># This line selects the fourth column of the resulting coefficients table from summary(model), which is the p-values</span></span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Bonferroni correction </span></span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-7"><a href="#cb303-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare adjusted p-values to unadjusted p-values</span></span>
<span id="cb303-8"><a href="#cb303-8" aria-hidden="true" tabindex="-1"></a>p_comparison <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p_values, p_adjusted)</span>
<span id="cb303-9"><a href="#cb303-9" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(p_comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_values</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0012637</td>
<td style="text-align: right;">0.0037910</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">0.8470258</td>
<td style="text-align: right;">1.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">0.0000264</td>
<td style="text-align: right;">0.0000792</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Change the reference group to previous drug users and re-run the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel hard drug use to have the reference level as previous users</span></span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting physical QOL change by hard drug use group</span></span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> hard_drugs_grp, <span class="at">data =</span> data_wide_2)</span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb304-8"><a href="#cb304-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-36.370  -3.818   0.689   4.380  33.402 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)                  -1.552      1.237  -1.254   0.2102   
hard_drugs_grpNever User      0.251      1.301   0.193   0.8470   
hard_drugs_grpCurrent User   -4.646      1.644  -2.825   0.0049 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.391 on 540 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.03232,   Adjusted R-squared:  0.02874 
F-statistic: 9.019 on 2 and 540 DF,  p-value: 0.0001403</code></pre>
</div>
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gather p-values of the model</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[,<span class="dv">4</span>] <span class="co"># This line selects the fourth column of the resulting coefficients table from summary(model), which is the p-values</span></span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Bonferroni correction </span></span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-7"><a href="#cb306-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare adjusted p-values to unadjusted p-values</span></span>
<span id="cb306-8"><a href="#cb306-8" aria-hidden="true" tabindex="-1"></a>p_comparison <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p_values, p_adjusted)</span>
<span id="cb306-9"><a href="#cb306-9" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(p_comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_values</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.2102050</td>
<td style="text-align: right;">0.6306150</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">0.8470258</td>
<td style="text-align: right;">1.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">0.0048976</td>
<td style="text-align: right;">0.0146927</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Yes it is. Hard drug use is a significant predictor of physical QOL change over 2 years (F~(2, 540)~= 9.019). On average, current drug users have a physical QOL score that is 4.90 points lower than never drug users (p-adjusted = 0.0000792), and 4.65 points lower than previous drug users (p-adjusted = 0.0147).</p>
<p><code>hard_drug_group</code> will be included as a predictor of <code>AGG_PHYS_CHANGE</code>.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>If adverse reactions from the HAART treatment negatively impacted patients, then we would expect to see the higher adherence groups having a smaller increase, or even decrease, in physical QOL compared to those in the low adherence groups.</p>
<p>Let’s first examine this by plotting the average mental QOL for each year by adherence group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get means for each year</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> data_2 <span class="sc">%&gt;%</span></span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADH, years) <span class="sc">%&gt;%</span></span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_AGG_PHYS =</span> <span class="fu">mean</span>(AGG_PHYS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ADH'. You can override using the `.groups`
argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> years, <span class="at">y =</span> Average_AGG_PHYS, <span class="at">color =</span> ADH)) <span class="sc">+</span></span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="co"># Line plot</span></span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Add points for clarity</span></span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Physical QOL by Adherence Group Over 2 Years"</span>,</span>
<span id="cb309-6"><a href="#cb309-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb309-7"><a href="#cb309-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Physical QOL"</span>,</span>
<span id="cb309-8"><a href="#cb309-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Adherence Group"</span>) <span class="sc">+</span></span>
<span id="cb309-9"><a href="#cb309-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>       <span class="co"># Clean theme</span></span>
<span id="cb309-10"><a href="#cb309-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)  <span class="co"># Nice color palette for groups</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-172-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here we can see that the 2 highest adherence groups have the highest physical QOL scores, which tracks with what we would expect if the drugs were helping.</p>
<p>For good measure, let’s examine this relationship across the entire 8 years of the study.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of that value of 1 for adherence at baseline for patient 426</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ADH[data<span class="sc">$</span>years <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get means for each year</span></span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb312-6"><a href="#cb312-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADH, years) <span class="sc">%&gt;%</span></span>
<span id="cb312-7"><a href="#cb312-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_AGG_PHYS =</span> <span class="fu">mean</span>(AGG_PHYS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ADH'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> years, <span class="at">y =</span> Average_AGG_PHYS, <span class="at">color =</span> ADH)) <span class="sc">+</span></span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="co"># Line plot</span></span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Add points for clarity</span></span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Physical QOL Score by Adherence Group Over 8 Years"</span>,</span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Physical QOL Score"</span>,</span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Adherence Group"</span>) <span class="sc">+</span></span>
<span id="cb314-9"><a href="#cb314-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>       <span class="co"># Clean theme</span></span>
<span id="cb314-10"><a href="#cb314-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)  <span class="co"># Nice color palette for groups</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-173-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see a similiar relationship looking at the full 8 years of the study. You can visualize how the two highest adherence groups would have a greater AUC than the two lowest adherence groups.</p>
<p>Let’s examine these relationships with boxplots.</p>
<p>First looking at adherence split into four categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change reference group</span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_2 <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_2, <span class="at">ref =</span> <span class="st">"100%"</span>)</span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of physical QOL change by adherence group</span></span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> ADH_2, <span class="at">y =</span> AGG_PHYS_CHANGE, <span class="at">fill =</span> ADH_2)) <span class="sc">+</span></span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb317-7"><a href="#cb317-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb317-8"><a href="#cb317-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb317-9"><a href="#cb317-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Physical QOL Change by Adherence at Year 2"</span>,</span>
<span id="cb317-10"><a href="#cb317-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Adherence at year 2"</span>,</span>
<span id="cb317-11"><a href="#cb317-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Physical QOL Change"</span>) <span class="sc">+</span></span>
<span id="cb317-12"><a href="#cb317-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Adherence Group"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-174-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That doesn’t look as informative as our high vs low comparison should be.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out NA values</span></span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>data_no_na <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ADH_HIGHVSLOW))</span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of Physical QOL change by adherence group</span></span>
<span id="cb319-5"><a href="#cb319-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_no_na, <span class="fu">aes</span>(<span class="at">x =</span> ADH_HIGHVSLOW, <span class="at">y =</span> AGG_PHYS_CHANGE, <span class="at">fill =</span> ADH_HIGHVSLOW)) <span class="sc">+</span></span>
<span id="cb319-6"><a href="#cb319-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb319-7"><a href="#cb319-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb319-8"><a href="#cb319-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb319-9"><a href="#cb319-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Physical QOL Change by Adherence at Year 2"</span>,</span>
<span id="cb319-10"><a href="#cb319-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Adherence at year 2"</span>,</span>
<span id="cb319-11"><a href="#cb319-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Physical QOL Change"</span>) <span class="sc">+</span></span>
<span id="cb319-12"><a href="#cb319-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Adherence Group"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-175-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It appears that the high adherence group has a higher increase in physical quality of life compared to the low adherence groups.</p>
<p>Let’s run the regression to see if that difference is statistically significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting physical QOL change by adherence</span></span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb321-5"><a href="#cb321-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-36.187  -3.923   0.285   4.386  33.585 

Coefficients:
                            Estimate Std. Error t value   Pr(&gt;|t|)    
(Intercept)                   -6.292      1.293  -4.865 0.00000151 ***
ADH_HIGHVSLOWHigh Adherence    4.808      1.349   3.564   0.000399 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.481 on 530 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.0234,    Adjusted R-squared:  0.02156 
F-statistic:  12.7 on 1 and 530 DF,  p-value: 0.0003986</code></pre>
</div>
</div>
<p>The overall model is statistically significant (F<sub>(1,530)</sub>=12.7). On average, those with high adherence had a change in physical QOL score that was 4.81 points higher than those with low adherance. (p = 0.00399).</p>
<p><code>ADH_HIGHVSLOW</code> will be included as a predictor for <code>AGG_PHYS_CHANGE</code>.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<p>Frailty related phenotype was strongly correlated to pysical QOL change in the correlation matrix.</p>
<p>Let’s assess that relationship.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out NA values</span></span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>data_no_na <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(FRP_2))</span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of physical QOL change by frailty related phenotype at year 2</span></span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_no_na, <span class="fu">aes</span>(<span class="at">x =</span> FRP_2, <span class="at">y =</span> AGG_PHYS_CHANGE, <span class="at">fill =</span> FRP_2)) <span class="sc">+</span></span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb323-9"><a href="#cb323-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Physical QOL Change by Frailty Related Phenotype"</span>,</span>
<span id="cb323-10"><a href="#cb323-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Frailty Related Phenotype"</span>,</span>
<span id="cb323-11"><a href="#cb323-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Physical QOL Change"</span>) <span class="sc">+</span></span>
<span id="cb323-12"><a href="#cb323-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Frailty Related Phenotype"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-177-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There is a very strong association here: those with frailty related phenotype have a large decrease in physical QOL over 2 years compared to those without a frailty related phenotype, who seem to have barely had any decrease in physical QOL at all.</p>
<p>Let’s assess this relationship with a regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting physical QOL change by Frailty Related Phenotype</span></span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> FRP_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-4"><a href="#cb325-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb325-5"><a href="#cb325-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ FRP_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-32.310  -4.244   0.033   4.155  33.257 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)  -1.1567     0.3534  -3.273              0.00113 ** 
FRP_2Yes    -12.7908     1.5034  -8.508 &lt; 0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.004 on 541 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.118, Adjusted R-squared:  0.1164 
F-statistic: 72.39 on 1 and 541 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<p>The overall model is statistically significant (F<sub>(1,541)</sub> = 72.39. On average, those with a frailty related phenotype had a change in physical QOL that was 12.79 points lower than those without a frailty related phenotype (p &lt; .0001).</p>
<p><code>FRP_2</code> will be included as a precision variable for the full model predicting <code>AGG_PHYS_CHANGE</code>.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting physical QOL change by depression</span></span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> CESD_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ CESD_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-34.686  -4.073   0.441   4.064  33.074 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -0.89305    0.55793  -1.601   0.1100  
CESD_2      -0.08046    0.03332  -2.415   0.0161 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.479 on 536 degrees of freedom
  (12 observations deleted due to missingness)
Multiple R-squared:  0.01076,   Adjusted R-squared:  0.008917 
F-statistic: 5.831 on 1 and 536 DF,  p-value: 0.01608</code></pre>
</div>
</div>
<p>Is sig. but teeny tiny amount, not really needed.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-9-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting physical QOL change by CD4+ T Cell Count</span></span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> LEU3N_CHANGE, <span class="at">data =</span> data_wide_2)</span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb329-5"><a href="#cb329-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ LEU3N_CHANGE, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-31.014  -4.224   0.488   4.401  34.612 

Coefficients:
              Estimate Std. Error t value         Pr(&gt;|t|)    
(Intercept)  -3.359356   0.473393  -7.096 0.00000000000419 ***
LEU3N_CHANGE  0.009809   0.001915   5.122 0.00000042478834 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.27 on 523 degrees of freedom
  (25 observations deleted due to missingness)
Multiple R-squared:  0.04777,   Adjusted R-squared:  0.04595 
F-statistic: 26.24 on 1 and 523 DF,  p-value: 0.0000004248</code></pre>
</div>
</div>
<p>Is sig but that doesn’t even make sense cause that’s one of our outcome variables.</p>
<p>Unless we’re making this a complex model with multiple inputs.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-9-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting physical QOL change by college education</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> EDUC_COLLEGE, <span class="at">data =</span> data_wide_2)</span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ EDUC_COLLEGE, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-35.931  -3.829   0.399   4.384  33.840 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)          -2.2913     0.7713  -2.971   0.0031 **
EDUC_COLLEGECollege   0.5519     0.8759   0.630   0.5289   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.519 on 541 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.0007331, Adjusted R-squared:  -0.001114 
F-statistic: 0.3969 on 1 and 541 DF,  p-value: 0.5289</code></pre>
</div>
</div>
<p>Not sig baby. Don’t need to include.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
<div id="tabset-9-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting physical QOL change by age</span></span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> age_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ age_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-35.878  -3.815   0.415   4.429  33.808 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.56365    1.93354  -0.292    0.771
age_2       -0.02859    0.04177  -0.685    0.494

Residual standard error: 8.518 on 541 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.0008655, Adjusted R-squared:  -0.0009814 
F-statistic: 0.4686 on 1 and 541 DF,  p-value: 0.4939</code></pre>
</div>
</div>
<p>Not significant, <code>age</code> will not be included as a potential covariate for <code>AGG_PHYS_CHANGE</code>.</p>
</div>
<div id="tabset-9-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting physical QOL change by BMI</span></span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> BMI_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ BMI_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-34.798  -3.936   0.301   4.231  30.707 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept) -7.71132    2.43341  -3.169  0.00163 **
BMI_2        0.22983    0.09435   2.436  0.01522 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.237 on 469 degrees of freedom
  (79 observations deleted due to missingness)
Multiple R-squared:  0.01249,   Adjusted R-squared:  0.01039 
F-statistic: 5.934 on 1 and 469 DF,  p-value: 0.01522</code></pre>
</div>
</div>
<p><code>BMI</code> is a significant predictor of <code>AGG_PHYS_CHANGE</code> and will be included as a potential covariate.</p>
</div>
<div id="tabset-9-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-9-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression predicting physical QOL change by drinking group</span></span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> DKGRP_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine Summary</span></span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ DKGRP_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-33.762  -3.702   0.371   4.475  32.427 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              -2.7939     0.8265  -3.380 0.000777 ***
DKGRP_21-3 drinks/week    0.8123     0.9754   0.833 0.405323    
DKGRP_24-13 drinks/week   2.4679     1.1136   2.216 0.027106 *  
DKGRP_2&gt;13 drinks/week   -1.1151     1.7598  -0.634 0.526576    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.51 on 532 degrees of freedom
  (14 observations deleted due to missingness)
Multiple R-squared:  0.01353,   Adjusted R-squared:  0.007964 
F-statistic: 2.432 on 3 and 532 DF,  p-value: 0.06428</code></pre>
</div>
</div>
<p><code>DKGRP_2</code> has a p-value below the threshold we set of p = 0.10, and will be included as a potential covariate for <code>AGG_PHYS_CHANGE</code>.</p>
<p><a href="#EDA">Top of Tabset</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="Data_Analysis" class="level1">
<h1>Data Analysis</h1>
<p>Now we will perform the actual analyses. We will have one model for each of:</p>
<ul>
<li>Log Viral Load Change</li>
<li>CD4+ T Cell Count</li>
<li>Aggregate Mental QOL</li>
<li>Aggregate Physical QOL</li>
</ul>
<section id="log-viral-load-change-1" class="level2">
<h2 class="anchored" data-anchor-id="log-viral-load-change-1">Log Viral Load Change</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Full Model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Reduced Model - No Interaction</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">Confounding</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false">Visualizing Main Effects</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<p>As determined by <a href="#EDA">interactive variable selection</a>, the variables of interest for a model predicting <code>VLOAD_log_CHANGE</code> are <code>hard_drug_grp</code>, <code>ADH_HIGHVSLOW</code>, and <code>EDUC_COLLEGE</code>.</p>
<p>The researchers are interested in if differences in treatment response between the drug use groups can be explained by differences in adherence to the HAART regimen, so we will also include an interaction term between hard drug use group and adherence.</p>
<p>Thus the full model is:</p>
<pre><code>                                     ADD LATEX MATH SYNTAX HERE.
                                     </code></pre>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Model Selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">Interpretation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-4" role="tab" aria-controls="tabset-11-4" aria-selected="false">Visualizing the Interaction</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<p>Let’s run the regression for the full model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel reference group</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel reference group</span></span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb340-6"><a href="#cb340-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-7"><a href="#cb340-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the regression on log viral load change with the full model</span></span>
<span id="cb340-8"><a href="#cb340-8" aria-hidden="true" tabindex="-1"></a>model_VLOAD_full1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW <span class="sc">+</span> EDUC_COLLEGE, <span class="at">data =</span> data_wide_2)</span>
<span id="cb340-9"><a href="#cb340-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#refugeeswelcome</code></pre>
</div>
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine summary</span></span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_VLOAD_full1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.2508 -1.6120 -0.2134  1.1308  9.2569 

Coefficients:
                                                        Estimate Std. Error
(Intercept)                                              -4.9327     0.5241
hard_drugs_grpPrevious User                               5.8083     1.1857
hard_drugs_grpCurrent User                                3.4758     1.4138
ADH_HIGHVSLOWHigh Adherence                              -0.7876     0.4898
EDUC_COLLEGECollege                                      -0.8489     0.2955
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -5.8479     1.2773
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   -2.7430     1.4659
                                                        t value
(Intercept)                                              -9.412
hard_drugs_grpPrevious User                               4.898
hard_drugs_grpCurrent User                                2.458
ADH_HIGHVSLOWHigh Adherence                              -1.608
EDUC_COLLEGECollege                                      -2.872
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -4.578
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   -1.871
                                                                    Pr(&gt;|t|)
(Intercept)                                             &lt; 0.0000000000000002
hard_drugs_grpPrevious User                                       0.00000130
hard_drugs_grpCurrent User                                           0.01428
ADH_HIGHVSLOWHigh Adherence                                          0.10846
EDUC_COLLEGECollege                                                  0.00424
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence           0.00000589
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence               0.06189
                                                           
(Intercept)                                             ***
hard_drugs_grpPrevious User                             ***
hard_drugs_grpCurrent User                              *  
ADH_HIGHVSLOWHigh Adherence                                
EDUC_COLLEGECollege                                     ** 
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence ***
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.661 on 513 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1001,    Adjusted R-squared:  0.08956 
F-statistic:  9.51 on 6 and 513 DF,  p-value: 0.0000000006388</code></pre>
</div>
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(model_VLOAD_full1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Log Viral Load Change<br>
Score</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-4.93</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-5.96&nbsp;–&nbsp;-3.90</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">hard_drugs_grp: Previous<br>
User</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">5.81</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">3.48&nbsp;–&nbsp;8.14</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">hard_drugs_grp: Current<br>
User</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">3.48</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.70&nbsp;–&nbsp;6.25</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.014</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">ADH_HIGHVSLOW: High<br>
Adherence</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.79</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.75&nbsp;–&nbsp;0.17</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.108</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">College Status: College</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.85</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.43&nbsp;–&nbsp;-0.27</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.004</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-5.85</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-8.36&nbsp;–&nbsp;-3.34</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-2.74</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-5.62&nbsp;–&nbsp;0.14</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.062</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">520</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.100 / 0.090</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_VLOAD_full1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-4.9326626</td>
<td style="text-align: right;">0.5240675</td>
<td style="text-align: right;">-9.412266</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-5.9622450</td>
<td style="text-align: right;">-3.9030801</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">5.8083303</td>
<td style="text-align: right;">1.1857389</td>
<td style="text-align: right;">4.898490</td>
<td style="text-align: right;">0.0000013</td>
<td style="text-align: right;">0.0000091</td>
<td style="text-align: right;">3.4788288</td>
<td style="text-align: right;">8.1378317</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">3.4757907</td>
<td style="text-align: right;">1.4138375</td>
<td style="text-align: right;">2.458409</td>
<td style="text-align: right;">0.0142848</td>
<td style="text-align: right;">0.0999936</td>
<td style="text-align: right;">0.6981668</td>
<td style="text-align: right;">6.2534145</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-0.7876174</td>
<td style="text-align: right;">0.4898289</td>
<td style="text-align: right;">-1.607944</td>
<td style="text-align: right;">0.1084627</td>
<td style="text-align: right;">0.7592392</td>
<td style="text-align: right;">-1.7499349</td>
<td style="text-align: right;">0.1747001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EDUC_COLLEGECollege</td>
<td style="text-align: right;">-0.8489132</td>
<td style="text-align: right;">0.2955395</td>
<td style="text-align: right;">-2.872418</td>
<td style="text-align: right;">0.0042421</td>
<td style="text-align: right;">0.0296945</td>
<td style="text-align: right;">-1.4295299</td>
<td style="text-align: right;">-0.2682965</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-5.8479420</td>
<td style="text-align: right;">1.2773135</td>
<td style="text-align: right;">-4.578314</td>
<td style="text-align: right;">0.0000059</td>
<td style="text-align: right;">0.0000412</td>
<td style="text-align: right;">-8.3573508</td>
<td style="text-align: right;">-3.3385331</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-2.7429503</td>
<td style="text-align: right;">1.4659004</td>
<td style="text-align: right;">-1.871171</td>
<td style="text-align: right;">0.0618904</td>
<td style="text-align: right;">0.4332325</td>
<td style="text-align: right;">-5.6228568</td>
<td style="text-align: right;">0.1369561</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the VIFs</span></span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_VLOAD_full1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>there are higher-order terms (interactions) in this model
consider setting type = 'predictor'; see ?vif</code></pre>
</div>
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(vif_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GVIF</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GVIF^(1/(2*Df))</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grp</td>
<td style="text-align: right;">121.062588</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3.317054</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOW</td>
<td style="text-align: right;">1.307856</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.143615</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EDUC_COLLEGE</td>
<td style="text-align: right;">1.090681</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.044357</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grp:ADH_HIGHVSLOW</td>
<td style="text-align: right;">125.887538</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3.349621</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The overall model is highly significant (p &lt; 0.000001) and we’re getting some interesting significant relationships. It looks like all of our main variables and interaction term are significant. Multicollinearity for this model is not a concern.</p>
<p>For low adherence, previous and current drug users have a higher increase in log viral load change over 2 years compared to never hard drug users (p &gt; 0.05).</p>
<p>For never drug users, there is no difference in log viral load over 2 years in those with high adherence compared to those with low adherence (p = 0.11).</p>
<p>Let’s keep going.</p>
<p>Change the reference category to high adherence, to compare the impact of hard drug use groups for those with high adherence to the treatment regiment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel reference group</span></span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"High Adherence"</span>)</span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the regression on log viral load change with the full model</span></span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a>model_VLOAD_full2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW <span class="sc">+</span> EDUC_COLLEGE, <span class="at">data =</span> data_wide_2)</span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-7"><a href="#cb349-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine summary</span></span>
<span id="cb349-8"><a href="#cb349-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_VLOAD_full2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.2508 -1.6120 -0.2134  1.1308  9.2569 

Coefficients:
                                                       Estimate Std. Error
(Intercept)                                            -5.72028    0.27445
hard_drugs_grpPrevious User                            -0.03961    0.45829
hard_drugs_grpCurrent User                              0.73284    0.38167
ADH_HIGHVSLOWLow Adherence                              0.78762    0.48983
EDUC_COLLEGECollege                                    -0.84891    0.29554
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  5.84794    1.27731
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   2.74295    1.46590
                                                       t value
(Intercept)                                            -20.843
hard_drugs_grpPrevious User                             -0.086
hard_drugs_grpCurrent User                               1.920
ADH_HIGHVSLOWLow Adherence                               1.608
EDUC_COLLEGECollege                                     -2.872
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   4.578
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence    1.871
                                                                   Pr(&gt;|t|)    
(Intercept)                                            &lt; 0.0000000000000002 ***
hard_drugs_grpPrevious User                                         0.93116    
hard_drugs_grpCurrent User                                          0.05540 .  
ADH_HIGHVSLOWLow Adherence                                          0.10846    
EDUC_COLLEGECollege                                                 0.00424 ** 
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence           0.00000589 ***
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence               0.06189 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.661 on 513 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1001,    Adjusted R-squared:  0.08956 
F-statistic:  9.51 on 6 and 513 DF,  p-value: 0.0000000006388</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_VLOAD_full2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-5.7202799</td>
<td style="text-align: right;">0.2744497</td>
<td style="text-align: right;">-20.8427262</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-6.2594636</td>
<td style="text-align: right;">-5.1810963</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">-0.0396117</td>
<td style="text-align: right;">0.4582879</td>
<td style="text-align: right;">-0.0864341</td>
<td style="text-align: right;">0.9311551</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-0.9399637</td>
<td style="text-align: right;">0.8607403</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">0.7328404</td>
<td style="text-align: right;">0.3816725</td>
<td style="text-align: right;">1.9200766</td>
<td style="text-align: right;">0.0554024</td>
<td style="text-align: right;">0.3878167</td>
<td style="text-align: right;">-0.0169930</td>
<td style="text-align: right;">1.4826737</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">0.7876174</td>
<td style="text-align: right;">0.4898289</td>
<td style="text-align: right;">1.6079437</td>
<td style="text-align: right;">0.1084627</td>
<td style="text-align: right;">0.7592392</td>
<td style="text-align: right;">-0.1747001</td>
<td style="text-align: right;">1.7499349</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EDUC_COLLEGECollege</td>
<td style="text-align: right;">-0.8489132</td>
<td style="text-align: right;">0.2955395</td>
<td style="text-align: right;">-2.8724184</td>
<td style="text-align: right;">0.0042421</td>
<td style="text-align: right;">0.0296945</td>
<td style="text-align: right;">-1.4295299</td>
<td style="text-align: right;">-0.2682965</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">5.8479420</td>
<td style="text-align: right;">1.2773135</td>
<td style="text-align: right;">4.5783138</td>
<td style="text-align: right;">0.0000059</td>
<td style="text-align: right;">0.0000412</td>
<td style="text-align: right;">3.3385331</td>
<td style="text-align: right;">8.3573508</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">2.7429503</td>
<td style="text-align: right;">1.4659004</td>
<td style="text-align: right;">1.8711710</td>
<td style="text-align: right;">0.0618904</td>
<td style="text-align: right;">0.4332325</td>
<td style="text-align: right;">-0.1369561</td>
<td style="text-align: right;">5.6228568</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>At the high adherence levels, there is no difference between previous and current hard drug users and never hard drug users on log viral load change (p &gt; 0.05).</p>
<p>Change the reference categories to previous users and low adherence to compare the impact of hard drug use groups for those with low adherence to the treatment regiment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel reference group</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel reference group</span></span>
<span id="cb352-5"><a href="#cb352-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb352-6"><a href="#cb352-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-7"><a href="#cb352-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the regression on log viral load change with the full model</span></span>
<span id="cb352-8"><a href="#cb352-8" aria-hidden="true" tabindex="-1"></a>model_VLOAD_full3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW <span class="sc">+</span> EDUC_COLLEGE, <span class="at">data =</span> data_wide_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine summary</span></span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_VLOAD_full3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.2508 -1.6120 -0.2134  1.1308  9.2569 

Coefficients:
                                                       Estimate Std. Error
(Intercept)                                              0.8757     1.1260
hard_drugs_grpNever User                                -5.8083     1.1857
hard_drugs_grpCurrent User                              -2.3325     1.7242
ADH_HIGHVSLOWHigh Adherence                             -6.6356     1.1785
EDUC_COLLEGECollege                                     -0.8489     0.2955
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     5.8479     1.2773
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   3.1050     1.8278
                                                       t value     Pr(&gt;|t|)    
(Intercept)                                              0.778      0.43710    
hard_drugs_grpNever User                                -4.898 0.0000012967 ***
hard_drugs_grpCurrent User                              -1.353      0.17672    
ADH_HIGHVSLOWHigh Adherence                             -5.630 0.0000000297 ***
EDUC_COLLEGECollege                                     -2.872      0.00424 ** 
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     4.578 0.0000058885 ***
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   1.699      0.08997 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.661 on 513 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1001,    Adjusted R-squared:  0.08956 
F-statistic:  9.51 on 6 and 513 DF,  p-value: 0.0000000006388</code></pre>
</div>
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_VLOAD_full3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.8756677</td>
<td style="text-align: right;">1.1259682</td>
<td style="text-align: right;">0.777702</td>
<td style="text-align: right;">0.4371032</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-1.3364083</td>
<td style="text-align: right;">3.0877438</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">-5.8083303</td>
<td style="text-align: right;">1.1857389</td>
<td style="text-align: right;">-4.898490</td>
<td style="text-align: right;">0.0000013</td>
<td style="text-align: right;">0.0000091</td>
<td style="text-align: right;">-8.1378317</td>
<td style="text-align: right;">-3.4788288</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">-2.3325396</td>
<td style="text-align: right;">1.7242354</td>
<td style="text-align: right;">-1.352796</td>
<td style="text-align: right;">0.1767166</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-5.7199709</td>
<td style="text-align: right;">1.0548917</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-6.6355594</td>
<td style="text-align: right;">1.1785472</td>
<td style="text-align: right;">-5.630287</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000002</td>
<td style="text-align: right;">-8.9509321</td>
<td style="text-align: right;">-4.3201866</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EDUC_COLLEGECollege</td>
<td style="text-align: right;">-0.8489132</td>
<td style="text-align: right;">0.2955395</td>
<td style="text-align: right;">-2.872418</td>
<td style="text-align: right;">0.0042421</td>
<td style="text-align: right;">0.0296945</td>
<td style="text-align: right;">-1.4295299</td>
<td style="text-align: right;">-0.2682965</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">5.8479420</td>
<td style="text-align: right;">1.2773135</td>
<td style="text-align: right;">4.578314</td>
<td style="text-align: right;">0.0000059</td>
<td style="text-align: right;">0.0000412</td>
<td style="text-align: right;">3.3385331</td>
<td style="text-align: right;">8.3573508</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">3.1049916</td>
<td style="text-align: right;">1.8277854</td>
<td style="text-align: right;">1.698773</td>
<td style="text-align: right;">0.0899684</td>
<td style="text-align: right;">0.6297785</td>
<td style="text-align: right;">-0.4858737</td>
<td style="text-align: right;">6.6958570</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>At low adherence, there is a significant difference between previous and current drug users, with current drug users having a higher increase in log viral load over 2 years (p &lt; 0.0001).</p>
<p>For previous drug users, those with high adherence had less of an increase in log viral load over 2 years compared to those with low adherence (p &lt; 0.0001).</p>
<p>Change the reference group to previous drug users and high adherence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel reference group</span></span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-4"><a href="#cb356-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel reference group</span></span>
<span id="cb356-5"><a href="#cb356-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"High Adherence"</span>)</span>
<span id="cb356-6"><a href="#cb356-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-7"><a href="#cb356-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the regression on log viral load change with the full model</span></span>
<span id="cb356-8"><a href="#cb356-8" aria-hidden="true" tabindex="-1"></a>model_VLOAD_full4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW <span class="sc">+</span> EDUC_COLLEGE, <span class="at">data =</span> data_wide_2)</span>
<span id="cb356-9"><a href="#cb356-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-10"><a href="#cb356-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine summary</span></span>
<span id="cb356-11"><a href="#cb356-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_VLOAD_full4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.2508 -1.6120 -0.2134  1.1308  9.2569 

Coefficients:
                                                      Estimate Std. Error
(Intercept)                                           -5.75989    0.43709
hard_drugs_grpNever User                               0.03961    0.45829
hard_drugs_grpCurrent User                             0.77245    0.56988
ADH_HIGHVSLOWLow Adherence                             6.63556    1.17855
EDUC_COLLEGECollege                                   -0.84891    0.29554
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence   -5.84794    1.27731
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence -3.10499    1.82779
                                                      t value
(Intercept)                                           -13.178
hard_drugs_grpNever User                                0.086
hard_drugs_grpCurrent User                              1.355
ADH_HIGHVSLOWLow Adherence                              5.630
EDUC_COLLEGECollege                                    -2.872
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    -4.578
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence  -1.699
                                                                  Pr(&gt;|t|)    
(Intercept)                                           &lt; 0.0000000000000002 ***
hard_drugs_grpNever User                                           0.93116    
hard_drugs_grpCurrent User                                         0.17587    
ADH_HIGHVSLOWLow Adherence                                    0.0000000297 ***
EDUC_COLLEGECollege                                                0.00424 ** 
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence           0.0000058885 ***
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence              0.08997 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.661 on 513 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1001,    Adjusted R-squared:  0.08956 
F-statistic:  9.51 on 6 and 513 DF,  p-value: 0.0000000006388</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_VLOAD_full4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-5.7598916</td>
<td style="text-align: right;">0.4370859</td>
<td style="text-align: right;">-13.1779394</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-6.6185902</td>
<td style="text-align: right;">-4.9011931</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">0.0396117</td>
<td style="text-align: right;">0.4582879</td>
<td style="text-align: right;">0.0864341</td>
<td style="text-align: right;">0.9311551</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-0.8607403</td>
<td style="text-align: right;">0.9399637</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">0.7724521</td>
<td style="text-align: right;">0.5698803</td>
<td style="text-align: right;">1.3554637</td>
<td style="text-align: right;">0.1758663</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-0.3471342</td>
<td style="text-align: right;">1.8920383</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">6.6355594</td>
<td style="text-align: right;">1.1785472</td>
<td style="text-align: right;">5.6302871</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000002</td>
<td style="text-align: right;">4.3201866</td>
<td style="text-align: right;">8.9509321</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EDUC_COLLEGECollege</td>
<td style="text-align: right;">-0.8489132</td>
<td style="text-align: right;">0.2955395</td>
<td style="text-align: right;">-2.8724184</td>
<td style="text-align: right;">0.0042421</td>
<td style="text-align: right;">0.0296945</td>
<td style="text-align: right;">-1.4295299</td>
<td style="text-align: right;">-0.2682965</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">-5.8479420</td>
<td style="text-align: right;">1.2773135</td>
<td style="text-align: right;">-4.5783138</td>
<td style="text-align: right;">0.0000059</td>
<td style="text-align: right;">0.0000412</td>
<td style="text-align: right;">-8.3573508</td>
<td style="text-align: right;">-3.3385331</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">-3.1049916</td>
<td style="text-align: right;">1.8277854</td>
<td style="text-align: right;">-1.6987726</td>
<td style="text-align: right;">0.0899684</td>
<td style="text-align: right;">0.6297785</td>
<td style="text-align: right;">-6.6958570</td>
<td style="text-align: right;">0.4858737</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>At the high adherence level, there is no difference in log viral load change between current and previous hard drug users (p &gt; 0.05).</p>
<p>Change the reference categories to current users and low adherence to compare the impact of hard drug use groups for those with low adherence to the treatment regiment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel reference group</span></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Current User"</span>)</span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel reference group</span></span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the regression on log viral load change with the full model</span></span>
<span id="cb359-8"><a href="#cb359-8" aria-hidden="true" tabindex="-1"></a>model_VLOAD_full5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW <span class="sc">+</span> EDUC_COLLEGE, <span class="at">data =</span> data_wide_2)</span>
<span id="cb359-9"><a href="#cb359-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-10"><a href="#cb359-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine summary</span></span>
<span id="cb359-11"><a href="#cb359-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_VLOAD_full5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.2508 -1.6120 -0.2134  1.1308  9.2569 

Coefficients:
                                                        Estimate Std. Error
(Intercept)                                              -1.4569     1.3389
hard_drugs_grpPrevious User                               2.3325     1.7242
hard_drugs_grpNever User                                 -3.4758     1.4138
ADH_HIGHVSLOWHigh Adherence                              -3.5306     1.3823
EDUC_COLLEGECollege                                      -0.8489     0.2955
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -3.1050     1.8278
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      2.7430     1.4659
                                                        t value Pr(&gt;|t|)   
(Intercept)                                              -1.088  0.27704   
hard_drugs_grpPrevious User                               1.353  0.17672   
hard_drugs_grpNever User                                 -2.458  0.01428 * 
ADH_HIGHVSLOWHigh Adherence                              -2.554  0.01093 * 
EDUC_COLLEGECollege                                      -2.872  0.00424 **
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -1.699  0.08997 . 
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      1.871  0.06189 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.661 on 513 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1001,    Adjusted R-squared:  0.08956 
F-statistic:  9.51 on 6 and 513 DF,  p-value: 0.0000000006388</code></pre>
</div>
</div>
<p>For current hard drug users, those with high adherence have a lower increase in log viral load over 2 years compared to those with low adherence (p = 0.011).</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<p>We can see that all variables, including <code>EDUC_COLLEGE</code>, are significant, and thus there is no need to compare the full model to reduced models; <u>this is our final model for <code>VLOAD_log_CHANGE</code></u></p>
<p>We can double check this with a partial F-test comparing the full model with the reduced model without the interaction term</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform full model with interaction term</span></span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>model_log_VLOAD_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> EDUC_COLLEGE <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform reduced model without interaction term</span></span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true" tabindex="-1"></a>model_log_VLOAD_red <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> EDUC_COLLEGE, <span class="at">data =</span> data_wide_2)</span>
<span id="cb361-6"><a href="#cb361-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-7"><a href="#cb361-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform F-Test</span></span>
<span id="cb361-8"><a href="#cb361-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_log_VLOAD_red, model_log_VLOAD_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + EDUC_COLLEGE
Model 2: VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + EDUC_COLLEGE + 
    hard_drugs_grp * ADH_HIGHVSLOW
  Res.Df    RSS Df Sum of Sq      F     Pr(&gt;F)    
1    515 3794.7                                   
2    513 3633.5  2    161.24 11.382 0.00001456 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The p-value is significant (p &lt; 0.0001), indicating that the interaction term adds explanatory power to the model and should be included. Thus we move on with interpreting the interaction.</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<section id="overall-model" class="level4">
<h4 class="anchored" data-anchor-id="overall-model">Overall Model</h4>
<p>There were significant differences in change in log viral load based on hard drug usage and adherence to the treatment regiment, while controlling for education at baseline (F~(6, 513)~= 9.51), p &lt; 0.0001).</p>
</section>
<section id="hard-drug-use-1" class="level4">
<h4 class="anchored" data-anchor-id="hard-drug-use-1">Hard Drug Use</h4>
<p>The relationship between hard drug use and change in log viral load over 2 years depended on adherence to the treatment regiment.</p>
<section id="hard-drug-use-at-low-adherence" class="level5">
<h5 class="anchored" data-anchor-id="hard-drug-use-at-low-adherence">Hard Drug Use at Low Adherence</h5>
<p>For those with low adherence to the treatment regiment, current hard drug users had a change in log viral load that was 3.48 log copies/mL (or change in copies/mL that was 32.32 times) higher than never hard drug users (t = 2.458, p-adjusted = 0.04284, 95% CI: 0.70 to 6.25 log copies/mL, or 2.01 to 519.78 times copies/mL). Additionally, for those with low adherence to the treatment regimen, previous hard drug users had a change in log viral load that was 5.81 log copies/mL (or change in copies/mL that was 333.05 times) greater than never hard drug users (t = 4.90, p-adjusted &lt; 0.0001, 95% CI: 3.48 to 8.14 log copies/mL, or 32.42 to 3421.49 times copies/mL).</p>
<p>For those with low adherence to the treatment regiment, the difference between previous and current drug users was not statistically significant (t = -1.35, p-adjusted = 0.177, 95% CI: -5.72 to 1.05 log copies/mL, or 0.0033 to 2.87 times copies/mL).</p>
</section>
<section id="hard-drug-use-at-high-adherence" class="level5">
<h5 class="anchored" data-anchor-id="hard-drug-use-at-high-adherence">Hard Drug use at High Adherence</h5>
<p>For those with high adherence to the protocol, there was no difference in log viral load between current and never hard drug users (t = 1.920, p-adjusted = 0.388, 95% CI: -0.017 to 1.48 log copies/mL), previous and never hard drug users (t = -0.086, p-adjusted = 1.00, 95% CI: -0.86 to 0.94 log copies/mL), or previous and current hard drug users (t = 1.355, p-adjusted = 1.00, 95% CI: -0.35 to 1.89 log copies/mL).</p>
</section>
</section>
<section id="adherence-4" class="level4">
<h4 class="anchored" data-anchor-id="adherence-4">Adherence</h4>
<p>The relationship between adherence to the treatment regiment and change in log viral load over 2 years differed by hard drug use.</p>
<section id="adherence-for-current-hard-drug-users" class="level5">
<h5 class="anchored" data-anchor-id="adherence-for-current-hard-drug-users">Adherence for Current Hard Drug Users</h5>
<p>For current hard drug users, those with high adherence had a change in log viral load that was 3.53 log copies/mL (or 0.029 times) less than that of those with low adherence (t = -2.554, p-adjusted = 0.0999936, 95% CI: -6.25 to -0.70 log copies/mL, or 0.0019 to 0.50 times). However, this relationship was not statistically significant following Bonferroni correction, likely due to the small number of patients who were hard drug users with low protocol adherence (n = 4). This relationship however does appear to be real based on trends in the data, and we recommend increasing the sample size to discover the true differences.</p>
</section>
<section id="adherence-for-previous-hard-drug-users" class="level5">
<h5 class="anchored" data-anchor-id="adherence-for-previous-hard-drug-users">Adherence for Previous Hard Drug Users</h5>
<p>For previous hard drug users, those with high adherence had a change in log viral load that was 6.64 log copies/mL less (or 0.0013 times) than those with low adherence (t = -5.63, p-adjusted &lt; 0.0001, 95% CI: -8.95 to -4.32 log copies/mL, or 0.00013 to 0.013 times).</p>
</section>
<section id="adherence-for-never-hard-drug-users" class="level5">
<h5 class="anchored" data-anchor-id="adherence-for-never-hard-drug-users">Adherence for Never Hard Drug Users</h5>
<p>For never hard drug users, the difference in log viral load between those with high adherence and low adherence was not statistically significant (t = -1.61, p-adusted = 0.759, 95% CI: -1.75 to 0.17 log copies/mL, or 0.17 to 1.19 times).</p>
</section>
</section>
<section id="additional-interaction-comparisons" class="level4">
<h4 class="anchored" data-anchor-id="additional-interaction-comparisons">Additional Interaction Comparisons</h4>
<p>There are additional comparisons we can make in the interaction between hard drug usage and adherence, but they are of little clinical relevance (e.g.&nbsp;current hard drug users with low adherence had a higher viral load compared to never hard drug users with high adherence). Basically, any comparison made between a current or previous hard drug user with low adherence was significant.</p>
</section>
<section id="college-education-at-baseline" class="level4">
<h4 class="anchored" data-anchor-id="college-education-at-baseline">College Education at Baseline</h4>
<p>Education at baseline is a significant predictor for change in log viral load over 2 years, while controlling for hard drug use and adherence to treatment regiment (t = -2.872, p = 0.00424). On average, those with a college education had an 0.85 log copies/mL (or 2.34 times) greater decrease in log viral load than those without a college education (95% CI:-1.43 to -0.27 log copies/mL).</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-11-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-4-tab">
<p>The interaction between hard drug use and adherence group on log viral load can be visualized in the graph below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel reference group</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel reference group</span></span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a regression of the full model predicting log viral load change</span></span>
<span id="cb363-8"><a href="#cb363-8" aria-hidden="true" tabindex="-1"></a>model_VLOAD_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp <span class="sc">*</span> ADH_HIGHVSLOW <span class="sc">+</span> EDUC_COLLEGE, <span class="at">data =</span> data_wide_2)</span>
<span id="cb363-9"><a href="#cb363-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-10"><a href="#cb363-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(interactions)</span>
<span id="cb363-11"><a href="#cb363-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-12"><a href="#cb363-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Use interactions package to plot interaction</span></span>
<span id="cb363-13"><a href="#cb363-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat_plot</span>(</span>
<span id="cb363-14"><a href="#cb363-14" aria-hidden="true" tabindex="-1"></a>  model_VLOAD_full, </span>
<span id="cb363-15"><a href="#cb363-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> hard_drugs_grp, </span>
<span id="cb363-16"><a href="#cb363-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> ADH_HIGHVSLOW, </span>
<span id="cb363-17"><a href="#cb363-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">geom =</span> <span class="st">"line"</span>, </span>
<span id="cb363-18"><a href="#cb363-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> <span class="st">"Pastel2"</span>,</span>
<span id="cb363-19"><a href="#cb363-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">x.label =</span> <span class="st">"Hard Drugs Group"</span>,</span>
<span id="cb363-20"><a href="#cb363-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">y.label =</span> <span class="st">"Predicted Log Viral Load Change"</span></span>
<span id="cb363-21"><a href="#cb363-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-195-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This very clearly illustrates the relationships we saw in our model.</p>
<p>We can see the relationship between adherence and change in log viral load based on hard drug use: for previous and current hard drug users, those with high adherence had a reduced viral load compared to those with low adherence.</p>
<p>Similarly, we can see the relationship between hard drug use and change in log viral load based on adherence: For those with low adherence, previous and current drug users had a higher viral load compared to those with high adherence.</p>
<p>Interestingly, viral load did not seem to differ for never users based on adherence, <strong>suggesting that the ART treatment is most important for those with current or previous hard drug use history</strong>.</p>
<p>Importantly however, this plot is not replicated exactly when I recreate it in ggplot2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out NA values</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>data_no_na <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ADH_HIGHVSLOW))</span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the data (using mean as an example)</span></span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a>data_summary <span class="ot">&lt;-</span> data_no_na <span class="sc">%&gt;%</span></span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hard_drugs_grp, ADH_HIGHVSLOW) <span class="sc">%&gt;%</span></span>
<span id="cb364-7"><a href="#cb364-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_VLOAD_log_CHANGE =</span> <span class="fu">mean</span>(VLOAD_log_CHANGE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'hard_drugs_grp'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with lines</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_no_na, <span class="fu">aes</span>(<span class="at">x =</span> hard_drugs_grp, <span class="at">y =</span> VLOAD_log_CHANGE, <span class="at">fill =</span> ADH_HIGHVSLOW)) <span class="sc">+</span></span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interaction between Hard Drugs and Adherence on Log Viral Load Change"</span>,</span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drugs Group"</span>,</span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Log Viral Load Change"</span>) <span class="sc">+</span></span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Adherence Group"</span>)) <span class="sc">+</span></span>
<span id="cb366-9"><a href="#cb366-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_minimal</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-196-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can see that the boxplot for low adherence previous users (n = 4), and low adherence hard drug users (n = 6) are either really tiny or really large, respectively. This makes sense, because the sample size for both of those categories is so small.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table of hard drugs group by adherence group</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">table</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Low Adherence</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">High Adherence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Never User</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">399</td>
</tr>
<tr class="even">
<td style="text-align: left;">Current User</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Previous User</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">40</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>And let’s examine how close those 4 values all are to each other.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a>data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hard_drugs_grp <span class="sc">==</span> <span class="st">"Current User"</span> <span class="sc">&amp;</span> ADH_HIGHVSLOW <span class="sc">==</span> <span class="st">"Low Adherence"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, VLOAD_log_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  newid VLOAD_log_CHANGE hard_drugs_grp ADH_HIGHVSLOW
  &lt;dbl&gt;            &lt;dbl&gt; &lt;fct&gt;          &lt;fct&gt;        
1    11             1.21 Current User   Low Adherence
2    15            -4.96 Current User   Low Adherence
3   319             1.21 Current User   Low Adherence
4   356            -4.99 Current User   Low Adherence</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a>data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hard_drugs_grp <span class="sc">==</span> <span class="st">"Previous User"</span> <span class="sc">&amp;</span> ADH_HIGHVSLOW <span class="sc">==</span> <span class="st">"Low Adherence"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, VLOAD_log_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  newid VLOAD_log_CHANGE hard_drugs_grp ADH_HIGHVSLOW
  &lt;dbl&gt;            &lt;dbl&gt; &lt;fct&gt;          &lt;fct&gt;        
1    20           0.0114 Previous User  Low Adherence
2    36           0.0330 Previous User  Low Adherence
3    52           0.0335 Previous User  Low Adherence
4   425           0.0123 Previous User  Low Adherence
5   504           0.0349 Previous User  Low Adherence
6   547           0.0354 Previous User  Low Adherence</code></pre>
</div>
</div>
<p>The values for current users with low adherence have low variance, explaining the tiny boxplot, and the values for previous users with low adherence have high variance, explaining the larger boxplot.</p>
<p>So I guess that’s just a testament to the fact that you can’t rely on packages!</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is a very important limitation that will need to be addressed in the discussion!!</p>
<p>While we see this interaction between hard drug use and adherence on the outcome variables in the data, more data must be collected to get a minimum of 30 patients per group and the analyses re-run to confirm these relationships hold!!</p>
</div>
</div>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</div>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Interpretation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false">Comparisons</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>Understanding the limitations of an interaction model with only n=4 or n=6 in some categories, we chose to also run the model without the interaction term to acquire the main effects of hard drug use group and adherence on log viral load change, while controlling for baseline education.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel reference group</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a regression on log viral load change without interaction term</span></span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a>model_VLOAD_red1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> EDUC_COLLEGE, <span class="at">data =</span> data_wide_2)</span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine summary</span></span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_VLOAD_red1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    EDUC_COLLEGE, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.7941 -1.7418 -0.2149  1.2043  9.3073 

Coefficients:
                            Estimate Std. Error t value             Pr(&gt;|t|)
(Intercept)                  -4.0871     0.4910  -8.324 0.000000000000000771
hard_drugs_grpCurrent User    0.9170     0.3755   2.442               0.0149
hard_drugs_grpPrevious User   0.7190     0.4336   1.658               0.0978
ADH_HIGHVSLOWHigh Adherence  -1.8429     0.4377  -4.211 0.000030041916341915
EDUC_COLLEGECollege          -0.6897     0.2970  -2.322               0.0206
                               
(Intercept)                 ***
hard_drugs_grpCurrent User  *  
hard_drugs_grpPrevious User .  
ADH_HIGHVSLOWHigh Adherence ***
EDUC_COLLEGECollege         *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.714 on 515 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.06016,   Adjusted R-squared:  0.05286 
F-statistic: 8.241 on 4 and 515 DF,  p-value: 0.000001901</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_VLOAD_red1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-4.0870510</td>
<td style="text-align: right;">0.4910084</td>
<td style="text-align: right;">-8.323790</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-5.0516769</td>
<td style="text-align: right;">-3.1224251</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">0.9169947</td>
<td style="text-align: right;">0.3754605</td>
<td style="text-align: right;">2.442320</td>
<td style="text-align: right;">0.0149284</td>
<td style="text-align: right;">0.0746420</td>
<td style="text-align: right;">0.1793722</td>
<td style="text-align: right;">1.6546172</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">0.7190166</td>
<td style="text-align: right;">0.4335575</td>
<td style="text-align: right;">1.658411</td>
<td style="text-align: right;">0.0978434</td>
<td style="text-align: right;">0.4892169</td>
<td style="text-align: right;">-0.1327422</td>
<td style="text-align: right;">1.5707754</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-1.8428916</td>
<td style="text-align: right;">0.4376635</td>
<td style="text-align: right;">-4.210750</td>
<td style="text-align: right;">0.0000300</td>
<td style="text-align: right;">0.0001502</td>
<td style="text-align: right;">-2.7027170</td>
<td style="text-align: right;">-0.9830663</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EDUC_COLLEGECollege</td>
<td style="text-align: right;">-0.6896592</td>
<td style="text-align: right;">0.2969844</td>
<td style="text-align: right;">-2.322207</td>
<td style="text-align: right;">0.0206108</td>
<td style="text-align: right;">0.1030539</td>
<td style="text-align: right;">-1.2731090</td>
<td style="text-align: right;">-0.1062094</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb376"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel reference group</span></span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-4"><a href="#cb376-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a regression on log viral load change without interaction term</span></span>
<span id="cb376-5"><a href="#cb376-5" aria-hidden="true" tabindex="-1"></a>model_VLOAD_red2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> EDUC_COLLEGE, <span class="at">data =</span> data_wide_2)</span>
<span id="cb376-6"><a href="#cb376-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-7"><a href="#cb376-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine summary</span></span>
<span id="cb376-8"><a href="#cb376-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_VLOAD_red2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    EDUC_COLLEGE, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.7941 -1.7418 -0.2149  1.2043  9.3073 

Coefficients:
                            Estimate Std. Error t value      Pr(&gt;|t|)    
(Intercept)                  -3.3680     0.5718  -5.890 0.00000000697 ***
hard_drugs_grpNever User     -0.7190     0.4336  -1.658        0.0978 .  
hard_drugs_grpCurrent User    0.1980     0.5451   0.363        0.7166    
ADH_HIGHVSLOWHigh Adherence  -1.8429     0.4377  -4.211 0.00003004192 ***
EDUC_COLLEGECollege          -0.6897     0.2970  -2.322        0.0206 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.714 on 515 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.06016,   Adjusted R-squared:  0.05286 
F-statistic: 8.241 on 4 and 515 DF,  p-value: 0.000001901</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_VLOAD_red2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-3.3680344</td>
<td style="text-align: right;">0.5718018</td>
<td style="text-align: right;">-5.8902135</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-4.4913853</td>
<td style="text-align: right;">-2.2446835</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">-0.7190166</td>
<td style="text-align: right;">0.4335575</td>
<td style="text-align: right;">-1.6584112</td>
<td style="text-align: right;">0.0978434</td>
<td style="text-align: right;">0.4892169</td>
<td style="text-align: right;">-1.5707754</td>
<td style="text-align: right;">0.1327422</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">0.1979781</td>
<td style="text-align: right;">0.5451391</td>
<td style="text-align: right;">0.3631698</td>
<td style="text-align: right;">0.7166270</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-0.8729918</td>
<td style="text-align: right;">1.2689479</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-1.8428916</td>
<td style="text-align: right;">0.4376635</td>
<td style="text-align: right;">-4.2107503</td>
<td style="text-align: right;">0.0000300</td>
<td style="text-align: right;">0.0001502</td>
<td style="text-align: right;">-2.7027170</td>
<td style="text-align: right;">-0.9830663</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EDUC_COLLEGECollege</td>
<td style="text-align: right;">-0.6896592</td>
<td style="text-align: right;">0.2969844</td>
<td style="text-align: right;">-2.3222073</td>
<td style="text-align: right;">0.0206108</td>
<td style="text-align: right;">0.1030539</td>
<td style="text-align: right;">-1.2731090</td>
<td style="text-align: right;">-0.1062094</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The overall model is significant (F(~4, 515)~= 8.241, p &lt; 0.0001).</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<section id="hard-drug-use-2" class="level3">
<h3 class="anchored" data-anchor-id="hard-drug-use-2">Hard Drug Use</h3>
<p>Hard drug use is a significant predictor of log viral load change, while controlling for adherence to the treatment regiment and college education. Specifically, current hard drug users had a change in log viral load that was 0.92 log copies/mL (or 2.50 times) greater than never hard drug users (t = 2.442, p-adjusted = 0.0447, 95% CI: 0.18 to 1.65 log copies/mL, or 1.20 to 5.23 times). There was no difference between previous and current hard drug users in change in log viral load over 2 years (t = 0.363, p-adjusted = 1.00, 95% CI: -0.87 to 1.27 log copies/mL, or 0.42 to 4.81 times).</p>
</section>
<section id="adherence-5" class="level3">
<h3 class="anchored" data-anchor-id="adherence-5">Adherence</h3>
<p>Adherence to the treatment regiment is a significant predictor of change in log viral load, while controlling for hard drug usage and college education (t = -4.21, p &lt; 0.0001). Specifically, those with high adherence to the protocol had an average change in log viral load that was 1.84 log copies/mL (or 0.16 times) less than those with low adherence to the protocol.</p>
</section>
<section id="college-education-at-baseline-1" class="level3">
<h3 class="anchored" data-anchor-id="college-education-at-baseline-1">College Education at Baseline</h3>
<p>Finally, college education is a significant predictor of log viral load change, while controlling for hard drug usage and adherence to the treatment regiment (t = -2.32, p = 0.0206). On average, those with a college education had a change in log viral load that was 0.69 log copies/mL (or 1.99 times) less than those without a college education (95% CI: -2.70 to -0.98 log copies/mL, or 0.067 to 0.37 times).</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<p>The reduced model without the interaction has an adjusted R-squared of 0.0529, compared to the full model with the interaction term (R^2-adjusted = 0.090).</p>
<p>Therefore, dropping the interaction term causes us to lose explanation of 3.71% of the variance in log viral load change, but is also more statistically sound since we no longer have small sample size issues.</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</div>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<p>Under the classical definition of a confounder, a variable Z is a confounder if:</p>
<ul>
<li><ol type="1">
<li>It is associated with outcome Y</li>
</ol></li>
<li><ol start="2" type="1">
<li>It is associated with PEV X</li>
</ol></li>
<li><ol start="3" type="1">
<li>It is not on the causal pathway (not a mediator)</li>
</ol></li>
</ul>
<p>We know that <code>ADH_HIGHVSLOW</code> is a predictor of <code>VLOAD_log_CHANGE</code>.</p>
<p>To assess if <code>ADH_HIGHVSLOW</code> is associated with hard drug use group, we can run a Fisher’s test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a contingency table</span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW)</span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-4"><a href="#cb379-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We have to run Fisher's Exact test since we have fewer than 5 observations in some categories</span></span>
<span id="cb379-5"><a href="#cb379-5" aria-hidden="true" tabindex="-1"></a>fisher_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(contingency_table)</span>
<span id="cb379-6"><a href="#cb379-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-7"><a href="#cb379-7" aria-hidden="true" tabindex="-1"></a>fisher_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  contingency_table
p-value = 0.4168
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a contingency table</span></span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, data_wide_2<span class="sc">$</span>EDUC_COLLEGE)</span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We have to run Fisher's Exact test since we have fewer than 5 observations in some categories</span></span>
<span id="cb381-5"><a href="#cb381-5" aria-hidden="true" tabindex="-1"></a>fisher_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(contingency_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>They are not associated.</p>
<p>However, it is not necessary for this associaton to be statistically significant for there to be important confounding present.</p>
<p>When we ran <code>drug_use_grp</code> by itself as a predictor on log viral load, the overall model was significant, but after correcting for multiple pairwise comparisons, none of the between-group comparisons was significant (p &gt; 0.05).</p>
<p>However, after including <code>ADH_HIGHVSLOW</code> in the model, the current vs never drug use comparison is significant, even after performing a Bonferroni correction (p-adjusted = 0.0447). In the model without ADH, this same comparison was p-adjusted = 0.1377.</p>
<p>Thus, <code>ADH_HIGHVSLOW</code> is associated with the outcome variable, and changes the relationship between the PEV and outcome variable in a meaningful way when included in the model (changes it from not significant to significant), meeting the definition of a confounder under the classical definition. However, the beta coefficient of the PEV does not change by &gt; 20%, not satisfying the operational definition of a confounder.</p>
<p>Adherence to the treatment regiment is therefore a maverick variable!</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</div>
<div id="tabset-13-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<p>Here we will create some simple plots to help with visualizing the main effects of hard drug use and adherence on log viral load change.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of log viral load change by hard drug use group</span></span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> hard_drugs_grp, <span class="at">y =</span> VLOAD_log_CHANGE, <span class="at">fill =</span> hard_drugs_grp)) <span class="sc">+</span></span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb382-4"><a href="#cb382-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb382-5"><a href="#cb382-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb382-6"><a href="#cb382-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Log Viral Load Change by Hard Drug Use Group"</span>,</span>
<span id="cb382-7"><a href="#cb382-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drug Use Group"</span>,</span>
<span id="cb382-8"><a href="#cb382-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Log Viral Load Change"</span>) <span class="sc">+</span></span>
<span id="cb382-9"><a href="#cb382-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Hard Drug Use Group"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-206-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can see that current and previous drug users had less of a decrease in log viral load over 2 years compared to never hard drug users.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of log viral load change by adherence group</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_no_na, <span class="fu">aes</span>(<span class="at">x =</span> ADH_HIGHVSLOW, <span class="at">y =</span> VLOAD_log_CHANGE, <span class="at">fill =</span> ADH_HIGHVSLOW)) <span class="sc">+</span></span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb384-6"><a href="#cb384-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Log Viral Load Change by Adherence at Year 2"</span>,</span>
<span id="cb384-7"><a href="#cb384-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Adherence at year 2"</span>,</span>
<span id="cb384-8"><a href="#cb384-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Log Viral Load Change"</span>) <span class="sc">+</span></span>
<span id="cb384-9"><a href="#cb384-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Adherence Group"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-207-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>And here we can see those with high adherence had a higher decrease in log viral load over 2 years compared to those with low adherence.</p>
</div>
</div>
</div>
<p>:::</p>
</section>
<section id="cd4-t-cell-count-change-1" class="level2">
<h2 class="anchored" data-anchor-id="cd4-t-cell-count-change-1">CD4+ T Cell Count Change</h2>
<p>The second outcome variable of interest was change in CD4+ T Cell Count over the first 2 years of the study.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">Full Model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">Reduced Model - No Interaction</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">Model Selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false">Interpretation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-4" role="tab" aria-controls="tabset-14-4" aria-selected="false">Visualizing the Interaction</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<p>The candidate variables for inclusion in our model predicting <code>LEU3N_CHANGE</code> were <code>hard_drugs_grp</code>, <code>ADH_HIGHLOW</code>, <code>BMI_2</code>, <code>FRP_2</code>, and <code>EDUC_COLLEGE</code>.</p>
<p>The researchers are interested in if differences in treatment response between the drug use groups can be explained by differences in adherence to the HAART regimen, so we will also include an interaction term between hard drug use group and adherence.</p>
<p>We begin by examining the full model with all these variables included.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb386-5"><a href="#cb386-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb386-6"><a href="#cb386-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-7"><a href="#cb386-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on CD4+ T Cell count change by hard drugs group, include adherence as confounder, and BMI, frailty related phenotype, and college education as precision variables.</span></span>
<span id="cb386-8"><a href="#cb386-8" aria-hidden="true" tabindex="-1"></a>model_LEU3N_full1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> BMI_2 <span class="sc">+</span> FRP_2 <span class="sc">+</span> EDUC_COLLEGE <span class="sc">+</span> CESD_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb386-9"><a href="#cb386-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-10"><a href="#cb386-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Exmamine the summary</span></span>
<span id="cb386-11"><a href="#cb386-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_LEU3N_full1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    BMI_2 + FRP_2 + EDUC_COLLEGE + CESD_2 + hard_drugs_grp * 
    ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-665.80 -119.44   -3.02  110.80 1080.47 

Coefficients: (1 not defined because of singularities)
                                                         Estimate Std. Error
(Intercept)                                              -46.7866    63.8333
hard_drugs_grpPrevious User                              -92.1062    31.5556
hard_drugs_grpCurrent User                              -161.2223   132.3190
ADH_HIGHVSLOWHigh Adherence                               78.9814    35.0133
BMI_2                                                      6.0075     2.1384
FRP_2Yes                                                -101.6289    36.3579
EDUC_COLLEGECollege                                       28.7527    21.5453
CESD_2                                                    -1.0786     0.8141
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence        NA         NA
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    49.4909   134.8433
                                                        t value Pr(&gt;|t|)   
(Intercept)                                              -0.733  0.46397   
hard_drugs_grpPrevious User                              -2.919  0.00369 **
hard_drugs_grpCurrent User                               -1.218  0.22370   
ADH_HIGHVSLOWHigh Adherence                               2.256  0.02457 * 
BMI_2                                                     2.809  0.00518 **
FRP_2Yes                                                 -2.795  0.00541 **
EDUC_COLLEGECollege                                       1.335  0.18271   
CESD_2                                                   -1.325  0.18588   
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence      NA       NA   
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    0.367  0.71377   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 180.3 on 448 degrees of freedom
  (93 observations deleted due to missingness)
Multiple R-squared:  0.1193,    Adjusted R-squared:  0.1036 
F-statistic: 7.587 on 8 and 448 DF,  p-value: 0.000000001577</code></pre>
</div>
</div>
<p>We get an NA for the interaction term. This is likely because we dropped the n=6 patients that were previous hard drug users with low adherence, making the interaction impossible to make. Indeed we can see we only have 7, 453 degrees of freedom.</p>
<p>BMI is significant, but has 10% missing values. Let’s try running the regression without it so we can examine that interaction term, which is the main research question. (it’s also correlated to college education, so we can kind of capture it with that variable).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Current User"</span>)</span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb388-6"><a href="#cb388-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-7"><a href="#cb388-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on CD4+ T Cell count change by hard drugs group, include adherence as confounder, and BMI, frailty related phenotype, and college education as precision variables.</span></span>
<span id="cb388-8"><a href="#cb388-8" aria-hidden="true" tabindex="-1"></a>model_LEU3N_red1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2 <span class="sc">+</span> EDUC_COLLEGE <span class="sc">+</span> CESD_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb388-9"><a href="#cb388-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-10"><a href="#cb388-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Exmamine the summary</span></span>
<span id="cb388-11"><a href="#cb388-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_LEU3N_red1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    FRP_2 + EDUC_COLLEGE + CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, 
    data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-697.61 -112.73   -1.31  106.13 1073.99 

Coefficients:
                                                         Estimate Std. Error
(Intercept)                                              -30.8189    92.4188
hard_drugs_grpNever User                                 126.1630    96.3440
hard_drugs_grpPrevious User                              355.9657   119.3430
ADH_HIGHVSLOWHigh Adherence                              104.4788    94.2502
FRP_2Yes                                                -110.1432    35.5533
EDUC_COLLEGECollege                                       25.0343    20.1854
CESD_2                                                    -1.0187     0.7723
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     -17.0631    99.8903
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence -333.1581   126.6465
                                                        t value Pr(&gt;|t|)   
(Intercept)                                              -0.333  0.73892   
hard_drugs_grpNever User                                  1.310  0.19096   
hard_drugs_grpPrevious User                               2.983  0.00299 **
ADH_HIGHVSLOWHigh Adherence                               1.109  0.26816   
FRP_2Yes                                                 -3.098  0.00206 **
EDUC_COLLEGECollege                                       1.240  0.21547   
CESD_2                                                   -1.319  0.18776   
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     -0.171  0.86443   
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -2.631  0.00878 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 181.3 on 506 degrees of freedom
  (35 observations deleted due to missingness)
Multiple R-squared:  0.09847,   Adjusted R-squared:  0.08422 
F-statistic: 6.908 on 8 and 506 DF,  p-value: 0.000000012</code></pre>
</div>
</div>
<section id="backwards-elimination" class="level3">
<h3 class="anchored" data-anchor-id="backwards-elimination">Backwards Elimination</h3>
<p>We will perform model selection using backwards elimination and BIC to select the most parsimonious model.</p>
<p>A delta BIC of &gt;2 indicates a difference in model performance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb390"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform backward elimination regression selection based on BIC </span></span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_backward_sbc</span>(model_LEU3N_red1, <span class="at">include =</span> <span class="fu">c</span>(<span class="st">"hard_drugs_grp"</span>, <span class="st">"ADH_HIGHVSLOW"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                                Stepwise Summary                                
------------------------------------------------------------------------------
Step    Variable          AIC         SBC         SBIC        R2       Adj. R2 
------------------------------------------------------------------------------
 0      Full Model      6828.740    6871.181    5380.046    0.09847    0.08422 
 1      EDUC_COLLEGE    6828.303    6866.500    5355.906    0.09573    0.08324 
 2      CESD_2          6828.406    6862.359    5356.186    0.09203    0.08130 
------------------------------------------------------------------------------

Final Model Output 
------------------

                           Model Summary                            
-------------------------------------------------------------------
R                         0.303       RMSE                 180.377 
R-Squared                 0.092       MSE                32535.774 
Adj. R-Squared            0.081       Coef. Var            114.193 
Pred R-Squared            0.076       AIC                 6828.406 
MAE                     136.282       SBC                 6862.359 
-------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                 ANOVA                                   
------------------------------------------------------------------------
                    Sum of                                              
                   Squares         DF    Mean Square      F        Sig. 
------------------------------------------------------------------------
Regression     1698306.434          6     283051.072    8.581    0.0000 
Residual      16755923.716        508      32984.102                    
Total         18454230.150        514                                   
------------------------------------------------------------------------

                                                           Parameter Estimates                                                            
-----------------------------------------------------------------------------------------------------------------------------------------
                                                  model        Beta    Std. Error    Std. Beta      t        Sig        lower      upper 
-----------------------------------------------------------------------------------------------------------------------------------------
                                            (Intercept)     -36.638        90.808                 -0.403    0.687    -215.043    141.767 
                               hard_drugs_grpNever User     136.867        96.322        0.292     1.421    0.156     -52.373    326.106 
                            hard_drugs_grpPrevious User     341.997       117.232        0.515     2.917    0.004     111.678    572.317 
                            ADH_HIGHVSLOWHigh Adherence     116.056        94.071        0.168     1.234    0.218     -68.761    300.873 
                                               FRP_2Yes    -113.844        35.435       -0.136    -3.213    0.001    -183.462    -44.226 
   hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     -25.037        99.815       -0.059    -0.251    0.802    -221.138    171.064 
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence    -330.080       123.130       -0.467    -2.681    0.008    -571.988    -88.173 
-----------------------------------------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<p>As predicted, the most parsimonious model is with <code>CESD_2</code> and <code>EDUC_COLLEGE</code> removed, and only including <code>FRP_2</code> as a precision variable.</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<p>Let’s investigate the key relationships in the final model for <code>LEU3N_CHANGE</code> as determined through backwards selection.</p>
<p>First let’s look at the impact of hard drug use on CD4+ T Cell change, at low adherence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb392"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-4"><a href="#cb392-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb392-5"><a href="#cb392-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb392-6"><a href="#cb392-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-7"><a href="#cb392-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination</span></span>
<span id="cb392-8"><a href="#cb392-8" aria-hidden="true" tabindex="-1"></a>model_LEU3N_final1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb392-9"><a href="#cb392-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-10"><a href="#cb392-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb392-11"><a href="#cb392-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_LEU3N_final1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-700.74 -111.21   -1.67  112.23 1077.98 

Coefficients:
                                                        Estimate Std. Error
(Intercept)                                               107.46      31.59
hard_drugs_grpCurrent User                               -144.10      96.02
hard_drugs_grpPrevious User                               197.90      80.49
ADH_HIGHVSLOWHigh Adherence                                83.09      32.92
FRP_2Yes                                                 -113.63      35.38
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     32.94      99.51
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -297.13      85.95
                                                        t value Pr(&gt;|t|)    
(Intercept)                                               3.402 0.000721 ***
hard_drugs_grpCurrent User                               -1.501 0.134038    
hard_drugs_grpPrevious User                               2.459 0.014277 *  
ADH_HIGHVSLOWHigh Adherence                               2.524 0.011895 *  
FRP_2Yes                                                 -3.212 0.001402 ** 
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    0.331 0.740764    
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -3.457 0.000592 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 181.3 on 512 degrees of freedom
  (31 observations deleted due to missingness)
Multiple R-squared:  0.08984,   Adjusted R-squared:  0.07917 
F-statistic: 8.423 on 6 and 512 DF,  p-value: 0.000000009913</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_LEU3N_final1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">107.46049</td>
<td style="text-align: right;">31.58675</td>
<td style="text-align: right;">3.4020752</td>
<td style="text-align: right;">0.0007211</td>
<td style="text-align: right;">0.0050476</td>
<td style="text-align: right;">45.40491</td>
<td style="text-align: right;">169.51607</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">-144.09848</td>
<td style="text-align: right;">96.01798</td>
<td style="text-align: right;">-1.5007447</td>
<td style="text-align: right;">0.1340380</td>
<td style="text-align: right;">0.9382660</td>
<td style="text-align: right;">-332.73618</td>
<td style="text-align: right;">44.53922</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">197.89868</td>
<td style="text-align: right;">80.49146</td>
<td style="text-align: right;">2.4586294</td>
<td style="text-align: right;">0.0142768</td>
<td style="text-align: right;">0.0999374</td>
<td style="text-align: right;">39.76450</td>
<td style="text-align: right;">356.03287</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">83.09406</td>
<td style="text-align: right;">32.91813</td>
<td style="text-align: right;">2.5242642</td>
<td style="text-align: right;">0.0118953</td>
<td style="text-align: right;">0.0832670</td>
<td style="text-align: right;">18.42283</td>
<td style="text-align: right;">147.76529</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FRP_2Yes</td>
<td style="text-align: right;">-113.62595</td>
<td style="text-align: right;">35.37733</td>
<td style="text-align: right;">-3.2118295</td>
<td style="text-align: right;">0.0014019</td>
<td style="text-align: right;">0.0098130</td>
<td style="text-align: right;">-183.12853</td>
<td style="text-align: right;">-44.12336</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">32.93895</td>
<td style="text-align: right;">99.50721</td>
<td style="text-align: right;">0.3310208</td>
<td style="text-align: right;">0.7407642</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-162.55372</td>
<td style="text-align: right;">228.43162</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-297.12895</td>
<td style="text-align: right;">85.95111</td>
<td style="text-align: right;">-3.4569531</td>
<td style="text-align: right;">0.0005918</td>
<td style="text-align: right;">0.0041424</td>
<td style="text-align: right;">-465.98920</td>
<td style="text-align: right;">-128.26871</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The overall model is highly significant (F<sub>(6,512)</sub>= 8.42, p &lt; 0.00001).</p>
<p>At low adherence, previous hard drug users have a higher CD4+ T Cell count than never hard drug users (p-adjusted = 0.043), but current hard drugs users did not differ from never drug users (p-adjusted = 0.40).</p>
<p>Additionally, for never hard drug users, those with high adherence have a higher CD4+ T Cell count than those with low adherence (p = 0.011895)</p>
<p>Now let’s compare hard drug usage for those with high adherence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"High Adherence"</span>)</span>
<span id="cb395-6"><a href="#cb395-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-7"><a href="#cb395-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination</span></span>
<span id="cb395-8"><a href="#cb395-8" aria-hidden="true" tabindex="-1"></a>model_LEU3N_final2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb395-9"><a href="#cb395-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-10"><a href="#cb395-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb395-11"><a href="#cb395-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_LEU3N_final2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-700.74 -111.21   -1.67  112.23 1077.98 

Coefficients:
                                                       Estimate Std. Error
(Intercept)                                              190.56       9.47
hard_drugs_grpCurrent User                              -111.16      26.04
hard_drugs_grpPrevious User                              -99.23      30.14
ADH_HIGHVSLOWLow Adherence                               -83.09      32.92
FRP_2Yes                                                -113.63      35.38
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence    -32.94      99.51
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   297.13      85.95
                                                       t value
(Intercept)                                             20.123
hard_drugs_grpCurrent User                              -4.269
hard_drugs_grpPrevious User                             -3.292
ADH_HIGHVSLOWLow Adherence                              -2.524
FRP_2Yes                                                -3.212
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   -0.331
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   3.457
                                                                   Pr(&gt;|t|)    
(Intercept)                                            &lt; 0.0000000000000002 ***
hard_drugs_grpCurrent User                                        0.0000234 ***
hard_drugs_grpPrevious User                                        0.001064 ** 
ADH_HIGHVSLOWLow Adherence                                         0.011895 *  
FRP_2Yes                                                           0.001402 ** 
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence              0.740764    
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence             0.000592 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 181.3 on 512 degrees of freedom
  (31 observations deleted due to missingness)
Multiple R-squared:  0.08984,   Adjusted R-squared:  0.07917 
F-statistic: 8.423 on 6 and 512 DF,  p-value: 0.000000009913</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_LEU3N_final2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">190.55455</td>
<td style="text-align: right;">9.469605</td>
<td style="text-align: right;">20.1227563</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">171.9505</td>
<td style="text-align: right;">209.15861</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">-111.15953</td>
<td style="text-align: right;">26.036468</td>
<td style="text-align: right;">-4.2693782</td>
<td style="text-align: right;">0.0000234</td>
<td style="text-align: right;">0.0001636</td>
<td style="text-align: right;">-162.3110</td>
<td style="text-align: right;">-60.00807</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">-99.23027</td>
<td style="text-align: right;">30.144942</td>
<td style="text-align: right;">-3.2917718</td>
<td style="text-align: right;">0.0010643</td>
<td style="text-align: right;">0.0074500</td>
<td style="text-align: right;">-158.4533</td>
<td style="text-align: right;">-40.00727</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">-83.09406</td>
<td style="text-align: right;">32.918132</td>
<td style="text-align: right;">-2.5242642</td>
<td style="text-align: right;">0.0118953</td>
<td style="text-align: right;">0.0832670</td>
<td style="text-align: right;">-147.7653</td>
<td style="text-align: right;">-18.42283</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FRP_2Yes</td>
<td style="text-align: right;">-113.62595</td>
<td style="text-align: right;">35.377328</td>
<td style="text-align: right;">-3.2118295</td>
<td style="text-align: right;">0.0014019</td>
<td style="text-align: right;">0.0098130</td>
<td style="text-align: right;">-183.1285</td>
<td style="text-align: right;">-44.12336</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">-32.93895</td>
<td style="text-align: right;">99.507208</td>
<td style="text-align: right;">-0.3310208</td>
<td style="text-align: right;">0.7407642</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-228.4316</td>
<td style="text-align: right;">162.55372</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">297.12895</td>
<td style="text-align: right;">85.951110</td>
<td style="text-align: right;">3.4569531</td>
<td style="text-align: right;">0.0005918</td>
<td style="text-align: right;">0.0041424</td>
<td style="text-align: right;">128.2687</td>
<td style="text-align: right;">465.98920</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>For those with high adherence, previous hard drug users had a lower CD4+ T Cell count (p-adjusted = 0.0032), and current hard drug users had a lower CD4+ T Cell (p-adjusted &lt; 0.0001) count compared to never hard users.</p>
<p>Now we make the same comparisons with previous hard drug users as the baseline.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb398-5"><a href="#cb398-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb398-6"><a href="#cb398-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-7"><a href="#cb398-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination</span></span>
<span id="cb398-8"><a href="#cb398-8" aria-hidden="true" tabindex="-1"></a>model_LEU3N_final2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb398-9"><a href="#cb398-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-10"><a href="#cb398-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb398-11"><a href="#cb398-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_LEU3N_final2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-700.74 -111.21   -1.67  112.23 1077.98 

Coefficients:
                                                       Estimate Std. Error
(Intercept)                                              305.36      74.03
hard_drugs_grpNever User                                -197.90      80.49
hard_drugs_grpCurrent User                              -342.00     117.06
ADH_HIGHVSLOWHigh Adherence                             -214.03      79.41
FRP_2Yes                                                -113.63      35.38
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     297.13      85.95
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   330.07     122.95
                                                       t value  Pr(&gt;|t|)    
(Intercept)                                              4.125 0.0000433 ***
hard_drugs_grpNever User                                -2.459  0.014277 *  
hard_drugs_grpCurrent User                              -2.922  0.003636 ** 
ADH_HIGHVSLOWHigh Adherence                             -2.695  0.007266 ** 
FRP_2Yes                                                -3.212  0.001402 ** 
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     3.457  0.000592 ***
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   2.685  0.007497 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 181.3 on 512 degrees of freedom
  (31 observations deleted due to missingness)
Multiple R-squared:  0.08984,   Adjusted R-squared:  0.07917 
F-statistic: 8.423 on 6 and 512 DF,  p-value: 0.000000009913</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_LEU3N_final2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">305.3592</td>
<td style="text-align: right;">74.03481</td>
<td style="text-align: right;">4.124535</td>
<td style="text-align: right;">0.0000433</td>
<td style="text-align: right;">0.0003034</td>
<td style="text-align: right;">159.90978</td>
<td style="text-align: right;">450.80856</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">-197.8987</td>
<td style="text-align: right;">80.49146</td>
<td style="text-align: right;">-2.458629</td>
<td style="text-align: right;">0.0142768</td>
<td style="text-align: right;">0.0999374</td>
<td style="text-align: right;">-356.03287</td>
<td style="text-align: right;">-39.76450</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">-341.9972</td>
<td style="text-align: right;">117.05931</td>
<td style="text-align: right;">-2.921572</td>
<td style="text-align: right;">0.0036365</td>
<td style="text-align: right;">0.0254554</td>
<td style="text-align: right;">-571.97284</td>
<td style="text-align: right;">-112.02148</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-214.0349</td>
<td style="text-align: right;">79.41319</td>
<td style="text-align: right;">-2.695206</td>
<td style="text-align: right;">0.0072658</td>
<td style="text-align: right;">0.0508607</td>
<td style="text-align: right;">-370.05069</td>
<td style="text-align: right;">-58.01909</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FRP_2Yes</td>
<td style="text-align: right;">-113.6259</td>
<td style="text-align: right;">35.37733</td>
<td style="text-align: right;">-3.211829</td>
<td style="text-align: right;">0.0014019</td>
<td style="text-align: right;">0.0098130</td>
<td style="text-align: right;">-183.12853</td>
<td style="text-align: right;">-44.12336</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">297.1290</td>
<td style="text-align: right;">85.95111</td>
<td style="text-align: right;">3.456953</td>
<td style="text-align: right;">0.0005918</td>
<td style="text-align: right;">0.0041424</td>
<td style="text-align: right;">128.26871</td>
<td style="text-align: right;">465.98920</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">330.0679</td>
<td style="text-align: right;">122.94881</td>
<td style="text-align: right;">2.684596</td>
<td style="text-align: right;">0.0074971</td>
<td style="text-align: right;">0.0524799</td>
<td style="text-align: right;">88.52168</td>
<td style="text-align: right;">571.61413</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>At low adherence, current hard drug users had a CD4+ T Cell count compared to previous hard drug users (p-adjusted = 0.011).</p>
<p>Additionally, for previous hard drug users, those with high adherence had a greater decrease in CD4+ T Cell count compared to those with low adherence (p = 0.0073).</p>
<p>Now let’s change the reference level to compare high adherence previous vs current drug users.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb401-5"><a href="#cb401-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"High Adherence"</span>)</span>
<span id="cb401-6"><a href="#cb401-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-7"><a href="#cb401-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination</span></span>
<span id="cb401-8"><a href="#cb401-8" aria-hidden="true" tabindex="-1"></a>model_LEU3N_final3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb401-9"><a href="#cb401-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-10"><a href="#cb401-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb401-11"><a href="#cb401-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_LEU3N_final3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-700.74 -111.21   -1.67  112.23 1077.98 

Coefficients:
                                                      Estimate Std. Error
(Intercept)                                              91.32      28.73
hard_drugs_grpNever User                                 99.23      30.14
hard_drugs_grpCurrent User                              -11.93      37.60
ADH_HIGHVSLOWLow Adherence                              214.03      79.41
FRP_2Yes                                               -113.63      35.38
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    -297.13      85.95
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence  -330.07     122.95
                                                      t value Pr(&gt;|t|)    
(Intercept)                                             3.179 0.001568 ** 
hard_drugs_grpNever User                                3.292 0.001064 ** 
hard_drugs_grpCurrent User                             -0.317 0.751150    
ADH_HIGHVSLOWLow Adherence                              2.695 0.007266 ** 
FRP_2Yes                                               -3.212 0.001402 ** 
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    -3.457 0.000592 ***
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence  -2.685 0.007497 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 181.3 on 512 degrees of freedom
  (31 observations deleted due to missingness)
Multiple R-squared:  0.08984,   Adjusted R-squared:  0.07917 
F-statistic: 8.423 on 6 and 512 DF,  p-value: 0.000000009913</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_LEU3N_final3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">91.32428</td>
<td style="text-align: right;">28.72807</td>
<td style="text-align: right;">3.1789217</td>
<td style="text-align: right;">0.0015677</td>
<td style="text-align: right;">0.0109736</td>
<td style="text-align: right;">34.88488</td>
<td style="text-align: right;">147.76367</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">99.23027</td>
<td style="text-align: right;">30.14494</td>
<td style="text-align: right;">3.2917718</td>
<td style="text-align: right;">0.0010643</td>
<td style="text-align: right;">0.0074500</td>
<td style="text-align: right;">40.00727</td>
<td style="text-align: right;">158.45327</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">-11.92926</td>
<td style="text-align: right;">37.59689</td>
<td style="text-align: right;">-0.3172937</td>
<td style="text-align: right;">0.7511501</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-85.79241</td>
<td style="text-align: right;">61.93390</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">214.03489</td>
<td style="text-align: right;">79.41319</td>
<td style="text-align: right;">2.6952058</td>
<td style="text-align: right;">0.0072658</td>
<td style="text-align: right;">0.0508607</td>
<td style="text-align: right;">58.01909</td>
<td style="text-align: right;">370.05069</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FRP_2Yes</td>
<td style="text-align: right;">-113.62595</td>
<td style="text-align: right;">35.37733</td>
<td style="text-align: right;">-3.2118295</td>
<td style="text-align: right;">0.0014019</td>
<td style="text-align: right;">0.0098130</td>
<td style="text-align: right;">-183.12853</td>
<td style="text-align: right;">-44.12336</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">-297.12895</td>
<td style="text-align: right;">85.95111</td>
<td style="text-align: right;">-3.4569531</td>
<td style="text-align: right;">0.0005918</td>
<td style="text-align: right;">0.0041424</td>
<td style="text-align: right;">-465.98920</td>
<td style="text-align: right;">-128.26871</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">-330.06790</td>
<td style="text-align: right;">122.94881</td>
<td style="text-align: right;">-2.6845962</td>
<td style="text-align: right;">0.0074971</td>
<td style="text-align: right;">0.0524799</td>
<td style="text-align: right;">-571.61413</td>
<td style="text-align: right;">-88.52168</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>For those with high adherence, previous vs current hard drug users did not differ in CD4+ T Cell Count (p-adjusted= 1.00).</p>
<p>Finally let’s compare the impact of adherence for hard drug users.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Current User"</span>)</span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-4"><a href="#cb404-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb404-5"><a href="#cb404-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb404-6"><a href="#cb404-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-7"><a href="#cb404-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination</span></span>
<span id="cb404-8"><a href="#cb404-8" aria-hidden="true" tabindex="-1"></a>model_LEU3N_final4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb404-9"><a href="#cb404-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-10"><a href="#cb404-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb404-11"><a href="#cb404-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_LEU3N_final4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-700.74 -111.21   -1.67  112.23 1077.98 

Coefficients:
                                                        Estimate Std. Error
(Intercept)                                               -36.64      90.67
hard_drugs_grpPrevious User                               342.00     117.06
hard_drugs_grpNever User                                  144.10      96.02
ADH_HIGHVSLOWHigh Adherence                               116.03      93.93
FRP_2Yes                                                 -113.63      35.38
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -330.07     122.95
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      -32.94      99.51
                                                        t value Pr(&gt;|t|)   
(Intercept)                                              -0.404  0.68633   
hard_drugs_grpPrevious User                               2.922  0.00364 **
hard_drugs_grpNever User                                  1.501  0.13404   
ADH_HIGHVSLOWHigh Adherence                               1.235  0.21729   
FRP_2Yes                                                 -3.212  0.00140 **
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -2.685  0.00750 **
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     -0.331  0.74076   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 181.3 on 512 degrees of freedom
  (31 observations deleted due to missingness)
Multiple R-squared:  0.08984,   Adjusted R-squared:  0.07917 
F-statistic: 8.423 on 6 and 512 DF,  p-value: 0.000000009913</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_LEU3N_final4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-36.63799</td>
<td style="text-align: right;">90.67376</td>
<td style="text-align: right;">-0.4040639</td>
<td style="text-align: right;">0.6863344</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-214.77639</td>
<td style="text-align: right;">141.50040</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">341.99716</td>
<td style="text-align: right;">117.05931</td>
<td style="text-align: right;">2.9215715</td>
<td style="text-align: right;">0.0036365</td>
<td style="text-align: right;">0.0254554</td>
<td style="text-align: right;">112.02148</td>
<td style="text-align: right;">571.97284</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">144.09848</td>
<td style="text-align: right;">96.01798</td>
<td style="text-align: right;">1.5007447</td>
<td style="text-align: right;">0.1340380</td>
<td style="text-align: right;">0.9382660</td>
<td style="text-align: right;">-44.53922</td>
<td style="text-align: right;">332.73618</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">116.03301</td>
<td style="text-align: right;">93.93276</td>
<td style="text-align: right;">1.2352773</td>
<td style="text-align: right;">0.2172938</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-68.50805</td>
<td style="text-align: right;">300.57408</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FRP_2Yes</td>
<td style="text-align: right;">-113.62595</td>
<td style="text-align: right;">35.37733</td>
<td style="text-align: right;">-3.2118295</td>
<td style="text-align: right;">0.0014019</td>
<td style="text-align: right;">0.0098130</td>
<td style="text-align: right;">-183.12853</td>
<td style="text-align: right;">-44.12336</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-330.06790</td>
<td style="text-align: right;">122.94881</td>
<td style="text-align: right;">-2.6845962</td>
<td style="text-align: right;">0.0074971</td>
<td style="text-align: right;">0.0524799</td>
<td style="text-align: right;">-571.61413</td>
<td style="text-align: right;">-88.52168</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-32.93895</td>
<td style="text-align: right;">99.50721</td>
<td style="text-align: right;">-0.3310208</td>
<td style="text-align: right;">0.7407642</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-228.43162</td>
<td style="text-align: right;">162.55372</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>For current hard drug users, those with high adherence did not differ significantly compared to those with low adherence (p = 0.22)</p>
<p><code>FRP_2</code> was a significant predictor for <code>LEU3N_CHANGE</code>, while controlling for hard drug use and adherence to the treatment regiment (t = -3.21, p = 0.0014). On average, those with a Frailty Related Phenotype had a decrease in CD4+ T cells that was 113.63 cells greater than those without a Frailty Related Phenotype (95% CI: 44.12 to 183.13 cells).</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<section id="overall-model-1" class="level3">
<h3 class="anchored" data-anchor-id="overall-model-1">Overall Model</h3>
<p>There were significant differences in change in CD4+ T Cell count over 2 years based on hard drug usage and adherence to the treatment regiment, while controlling for Frailty Related Phenotype (F<sub>(6,512)</sub> = 8.42, p &lt; 0.00001).</p>
<section id="hard-drug-use-3" class="level4">
<h4 class="anchored" data-anchor-id="hard-drug-use-3">Hard Drug Use</h4>
<p>The relationship between hard drug use and change in CD4+ T Cell count over 2 years depended on adherence to the treatment regiment.</p>
<section id="hard-drug-use-at-low-adherence-1" class="level5">
<h5 class="anchored" data-anchor-id="hard-drug-use-at-low-adherence-1">Hard Drug Use at Low Adherence</h5>
<p>For those with low adherence to the treatment regiment, previous hard drug users had on average a 197.90 cells greater <em>increase</em> in CD4+ T Cell count compared to never hard drug users (t = 2.46, p-adjusted = 0.043, 95%: 39.77 to 356.03). Current hard drug users did not differ from never hard drug users (t = -1.50, p-adjusted = 0.40, 95% CI: -332.74 to 44.54). Additionally, current hard drug users had on average a -342.00 cells greater decrease in CD4+ T Cell count compared to previous hard drug users (t = -2.922, p-adjusted = 0.011, 95% CI: -571.97 to -112.02).</p>
</section>
<section id="hard-drug-use-at-high-adherence-1" class="level5">
<h5 class="anchored" data-anchor-id="hard-drug-use-at-high-adherence-1">Hard Drug Use at High Adherence</h5>
<p>For those with high adherence to the treatment regiment, previous hard drug users had on average a 99.23 cells greater decrease (t = -3.29, p-adjusted = 0.0032, 95% CI: -158.4533 to -40.00727), and current hard drug users had on average a 111.16 cells greater decrease (t = -4.27, p-adjusted &lt; 0.0001, 95% CI: -162.31 to -60.00) compared to never hard drug users. in CD4+ T cell count compared never hard drug users. Current hard drug users did not differ from previous hard drug users on change in CD4+ T Cell count over 2 years (t = -0.32, p-adjusted= 1.00, 95% CI: -85.79 to 61.93).</p>
</section>
</section>
</section>
<section id="adherence-6" class="level3">
<h3 class="anchored" data-anchor-id="adherence-6">Adherence</h3>
<p>The relationship between adherence to the treatment regiment and change in CD4+ T Cell count over 2 years differed by hard drug use.</p>
<section id="adherence-for-current-hard-drug-users-1" class="level4">
<h4 class="anchored" data-anchor-id="adherence-for-current-hard-drug-users-1">Adherence for Current Hard Drug Users</h4>
<p>For current hard drug users, those with high adherence did not differ significantly in average change in CD4+ T Cells over two years compared to those with low adherence (t = 1.24, p-adjusted = 0.22, 95% CI: -68.51 to 300.57).</p>
</section>
</section>
<section id="adherence-for-previous-hard-drug-users-1" class="level3">
<h3 class="anchored" data-anchor-id="adherence-for-previous-hard-drug-users-1">Adherence for Previous Hard Drug Users</h3>
<p>For previous hard drug users, those with high adherence had on average a 214.03 cells greater decrease in CD4+ T Cell count compared to those with low adherence (t = -2.70, p = 0.0073, 95% CI: -370.05 to -58.020).</p>
</section>
<section id="adherence-for-never-hard-drug-users-1" class="level3">
<h3 class="anchored" data-anchor-id="adherence-for-never-hard-drug-users-1">Adherence for Never Hard Drug Users</h3>
<p>For never drug users, those with high adherence had on average a 83.09 cells greater decrease in CD4+ T Cell count compared to those with low adherence (t = 2.52, p = 0.0119, 95% CI: 18.42283 147.76529).</p>
</section>
<section id="additional-interaction-comparisons-1" class="level3">
<h3 class="anchored" data-anchor-id="additional-interaction-comparisons-1">Additional Interaction Comparisons</h3>
<p>There are additional comparisons we can make in the interaction between hard drug usage and adherence, but they are of little clinical relevance (e.g.&nbsp;comparing current hard drug users with low adherence to never hard drug users with high adherence). ### Frailty Related Phenotype</p>
<p>Frailty Related Phenotype was a significant predictor for change in CD4+ T Cell count over 2 years, while controlling for hard drug use and adherence to the treatment regiment (t = -3.21, p = 0.0014). On average, those with a Frailty Related Phenotype had a 113.63 cells greater decrease in CD4+ T Cell count than those without a Frailty Related Phenotype (95% CI: 44.12 to 183.13 cells).</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-14-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-4-tab">
<p>The below plot is useful in interpreting the interaction</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use interactions package to plot interaction</span></span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat_plot</span>(</span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a>  model_LEU3N_final1, </span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> hard_drugs_grp, </span>
<span id="cb407-5"><a href="#cb407-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> ADH_HIGHVSLOW, </span>
<span id="cb407-6"><a href="#cb407-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">geom =</span> <span class="st">"line"</span>, </span>
<span id="cb407-7"><a href="#cb407-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> <span class="st">"Pastel2"</span>,</span>
<span id="cb407-8"><a href="#cb407-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x.label =</span> <span class="st">"Hard Drugs Group"</span>,</span>
<span id="cb407-9"><a href="#cb407-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y.label =</span> <span class="st">"Predicted CD4+ T Cell Count Change"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-221-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out NA values</span></span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a>data_no_na <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ADH_HIGHVSLOW))</span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-4"><a href="#cb408-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with lines</span></span>
<span id="cb408-5"><a href="#cb408-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_no_na, <span class="fu">aes</span>(<span class="at">x =</span> hard_drugs_grp, <span class="at">y =</span> LEU3N_CHANGE, <span class="at">fill =</span> ADH_HIGHVSLOW)) <span class="sc">+</span></span>
<span id="cb408-6"><a href="#cb408-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb408-7"><a href="#cb408-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb408-8"><a href="#cb408-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interaction between Hard Drugs and Adherence on LEU3N Change"</span>,</span>
<span id="cb408-9"><a href="#cb408-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drugs Group"</span>,</span>
<span id="cb408-10"><a href="#cb408-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"LEU3N Change"</span>) <span class="sc">+</span></span>
<span id="cb408-11"><a href="#cb408-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Adherence Group"</span>)) <span class="sc">+</span></span>
<span id="cb408-12"><a href="#cb408-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_minimal</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-221-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here we can see the key relationships in our model.</p>
<p>For current hard drug users, those with high adherence did not differ from those with low adherence. This may be an artifact of the small number of current hard drug users with low adherence, however (n = 6).</p>
<p>For previous hard drug users, those with high adherence had <em>a smaller increase</em> in CD4+ T Cell count compared to those with low adherence. <strong>This is a counter-inuitive finding and may be an artifact of the small number of previous hard drug users with low adherence, however (n=4).</strong> It may be of interest to the clinicians however, and we therefore report it here.</p>
<p>For never hard drug users, those with high adherence had a greater increase in CD4+ T Cell count compared to those with low adherence.</p>
<p>At low adherence, previous hard drug users had <em>greater increase</em> in CD4+ T Cell count compared to never hard drug users, and also when compared to current hard drug users. Current hard drugs users did not differ crom never hard drug users in change in CD4+ T Cell count at low adherence.</p>
<p>At high adherence, never drug users had a greater increase in CD4+ T cell count compared to previous and current hard drug users. Current hard drug users did not differ from previous hard drug users at high adherence.</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</div>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">Interpretation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">Visualizing Main Effects</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-4"><a href="#cb410-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb410-5"><a href="#cb410-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb410-6"><a href="#cb410-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-7"><a href="#cb410-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination</span></span>
<span id="cb410-8"><a href="#cb410-8" aria-hidden="true" tabindex="-1"></a>model_LEU3N_final_noX1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb410-9"><a href="#cb410-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-10"><a href="#cb410-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb410-11"><a href="#cb410-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_LEU3N_final_noX1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    FRP_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-697.88 -115.61   -3.14  114.98 1080.85 

Coefficients:
                            Estimate Std. Error t value    Pr(&gt;|t|)    
(Intercept)                   140.88      28.36   4.967 0.000000927 ***
hard_drugs_grpCurrent User   -112.84      25.38  -4.446 0.000010724 ***
hard_drugs_grpPrevious User   -62.31      28.51  -2.185     0.02932 *  
ADH_HIGHVSLOWHigh Adherence    46.81      29.24   1.601     0.11000    
FRP_2Yes                     -114.33      35.72  -3.201     0.00145 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 183.2 on 514 degrees of freedom
  (31 observations deleted due to missingness)
Multiple R-squared:  0.06752,   Adjusted R-squared:  0.06026 
F-statistic: 9.305 on 4 and 514 DF,  p-value: 0.000000289</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_LEU3N_final_noX1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">140.8774</td>
<td style="text-align: right;">28.36272</td>
<td style="text-align: right;">4.966993</td>
<td style="text-align: right;">0.0000009</td>
<td style="text-align: right;">0.0000046</td>
<td style="text-align: right;">85.15631</td>
<td style="text-align: right;">196.598539</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">-112.8387</td>
<td style="text-align: right;">25.37954</td>
<td style="text-align: right;">-4.446049</td>
<td style="text-align: right;">0.0000107</td>
<td style="text-align: right;">0.0000536</td>
<td style="text-align: right;">-162.69908</td>
<td style="text-align: right;">-62.978288</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">-62.3112</td>
<td style="text-align: right;">28.51439</td>
<td style="text-align: right;">-2.185255</td>
<td style="text-align: right;">0.0293209</td>
<td style="text-align: right;">0.1466044</td>
<td style="text-align: right;">-118.33027</td>
<td style="text-align: right;">-6.292117</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">46.8124</td>
<td style="text-align: right;">29.24046</td>
<td style="text-align: right;">1.600946</td>
<td style="text-align: right;">0.1100033</td>
<td style="text-align: right;">0.5500164</td>
<td style="text-align: right;">-10.63312</td>
<td style="text-align: right;">104.257925</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FRP_2Yes</td>
<td style="text-align: right;">-114.3343</td>
<td style="text-align: right;">35.72007</td>
<td style="text-align: right;">-3.200841</td>
<td style="text-align: right;">0.0014550</td>
<td style="text-align: right;">0.0072749</td>
<td style="text-align: right;">-184.50955</td>
<td style="text-align: right;">-44.158969</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Change the reference level to previous users and re-run the model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb413-5"><a href="#cb413-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb413-6"><a href="#cb413-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-7"><a href="#cb413-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on CD4+ T Cell count change by hard drugs group with covariates as determined by backward elimination</span></span>
<span id="cb413-8"><a href="#cb413-8" aria-hidden="true" tabindex="-1"></a>model_LEU3N_final_noX2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb413-9"><a href="#cb413-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-10"><a href="#cb413-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb413-11"><a href="#cb413-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_LEU3N_final_noX2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    FRP_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-697.88 -115.61   -3.14  114.98 1080.85 

Coefficients:
                            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)                    78.57      37.09   2.118  0.03462 * 
hard_drugs_grpNever User       62.31      28.51   2.185  0.02932 * 
hard_drugs_grpCurrent User    -50.53      36.00  -1.403  0.16110   
ADH_HIGHVSLOWHigh Adherence    46.81      29.24   1.601  0.11000   
FRP_2Yes                     -114.33      35.72  -3.201  0.00145 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 183.2 on 514 degrees of freedom
  (31 observations deleted due to missingness)
Multiple R-squared:  0.06752,   Adjusted R-squared:  0.06026 
F-statistic: 9.305 on 4 and 514 DF,  p-value: 0.000000289</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_LEU3N_final_noX2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">78.56623</td>
<td style="text-align: right;">37.08694</td>
<td style="text-align: right;">2.118434</td>
<td style="text-align: right;">0.0346175</td>
<td style="text-align: right;">0.1730874</td>
<td style="text-align: right;">5.705608</td>
<td style="text-align: right;">151.42685</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">62.31120</td>
<td style="text-align: right;">28.51439</td>
<td style="text-align: right;">2.185255</td>
<td style="text-align: right;">0.0293209</td>
<td style="text-align: right;">0.1466044</td>
<td style="text-align: right;">6.292117</td>
<td style="text-align: right;">118.33027</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">-50.52749</td>
<td style="text-align: right;">36.00333</td>
<td style="text-align: right;">-1.403412</td>
<td style="text-align: right;">0.1610979</td>
<td style="text-align: right;">0.8054896</td>
<td style="text-align: right;">-121.259266</td>
<td style="text-align: right;">20.20429</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">46.81240</td>
<td style="text-align: right;">29.24046</td>
<td style="text-align: right;">1.600946</td>
<td style="text-align: right;">0.1100033</td>
<td style="text-align: right;">0.5500164</td>
<td style="text-align: right;">-10.633119</td>
<td style="text-align: right;">104.25793</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FRP_2Yes</td>
<td style="text-align: right;">-114.33426</td>
<td style="text-align: right;">35.72007</td>
<td style="text-align: right;">-3.200841</td>
<td style="text-align: right;">0.0014550</td>
<td style="text-align: right;">0.0072749</td>
<td style="text-align: right;">-184.509547</td>
<td style="text-align: right;">-44.15897</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<section id="overall-model-2" class="level3">
<h3 class="anchored" data-anchor-id="overall-model-2">Overall Model</h3>
<p>The overall model is significant (F~(4, 514)~ = 9.31, p &lt; .0001).</p>
</section>
<section id="hard-drug-use-4" class="level3">
<h3 class="anchored" data-anchor-id="hard-drug-use-4">Hard Drug Use</h3>
<p>Hard drug use is a significant predictor of change in CD4+ T Cell count over 2 years.</p>
<p>Current hard drug users had an average change in CD4+ T Cell count that was 112.84 cells lower than never drug users, while controlling for adherence to treatment regiment and Frailty Related Phenotype (p-adjusted &lt; 0.0001, 95% CI: -162.70 to -62.98).</p>
<p>Previous hard drug users did not differ from never hard drugs users (p-adjusted = 0.088, 95% CI:-118.33 to -6.29), or current hard drug users (p-adjusted = 0.483, 95% CI: -121.26 to 20.20).</p>
</section>
<section id="adherence-7" class="level3">
<h3 class="anchored" data-anchor-id="adherence-7">Adherence</h3>
<p>Adherence was not a significant predictor for change in CD4+ T Cell count over 2 years, after controlling for hard drug use and Frailty Related Phenotype (t = 1.60, p = 0.110).</p>
</section>
<section id="frailty-related-phenotype-3" class="level3">
<h3 class="anchored" data-anchor-id="frailty-related-phenotype-3">Frailty Related Phenotype</h3>
<p>Frailty related phenotype is a significant predictor for change in CD4+ T Cell count over 2 years, while controlling for hard drug use and adherence to the treatment regiment (t = -3.20, p = 0.00145). On average, those with a frailty related phenotype had a change in CD4+ T Cell count that was 114.33 cells lower than those without a frailty related phenotype (95% CI: -184.51 to -44.16).</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<section id="hard-drug-use-5" class="level3">
<h3 class="anchored" data-anchor-id="hard-drug-use-5">Hard Drug Use</h3>
<p>Here we will create some simple plots to help with visualizing the main effects of hard drug use and adherence on change in CD4+ T Cell count.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb416"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change the reference cateory to Never User</span></span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-4"><a href="#cb416-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of CD4+ T Cell count change by hard drug use group</span></span>
<span id="cb416-5"><a href="#cb416-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> hard_drugs_grp, <span class="at">y =</span> LEU3N_CHANGE, <span class="at">fill =</span> hard_drugs_grp)) <span class="sc">+</span></span>
<span id="cb416-6"><a href="#cb416-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb416-7"><a href="#cb416-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb416-8"><a href="#cb416-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb416-9"><a href="#cb416-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of CD4+ T Cell Count Change by Hard Drug Use Group"</span>,</span>
<span id="cb416-10"><a href="#cb416-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drug Use Group"</span>,</span>
<span id="cb416-11"><a href="#cb416-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"CD4+ T Cell Count Change"</span>) <span class="sc">+</span></span>
<span id="cb416-12"><a href="#cb416-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Hard Drug Use Group"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-226-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Current hard drug users had less of an increase in CD4+ T Cells over 2 years compared to never hard drug users. All other between-group comparisons were not significant.</p>
</section>
<section id="adherence-8" class="level3">
<h3 class="anchored" data-anchor-id="adherence-8">Adherence</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb418"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of CD4+ T Cell count change by adherence group</span></span>
<span id="cb418-2"><a href="#cb418-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_no_na, <span class="fu">aes</span>(<span class="at">x =</span> ADH_HIGHVSLOW, <span class="at">y =</span> LEU3N_CHANGE, <span class="at">fill =</span> ADH_HIGHVSLOW)) <span class="sc">+</span></span>
<span id="cb418-3"><a href="#cb418-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb418-4"><a href="#cb418-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb418-5"><a href="#cb418-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb418-6"><a href="#cb418-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of CD4+ T Cell Count Change by Adherence at Year 2"</span>,</span>
<span id="cb418-7"><a href="#cb418-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Adherence Level"</span>,</span>
<span id="cb418-8"><a href="#cb418-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"CD4+ T Cell Count Change"</span>) <span class="sc">+</span></span>
<span id="cb418-9"><a href="#cb418-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Adherence Group"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-227-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Change in CD4+ T Cell count did not differ based on adherence.</p>
</section>
<section id="frailty-related-phenotype-4" class="level3">
<h3 class="anchored" data-anchor-id="frailty-related-phenotype-4">Frailty Related Phenotype</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb420"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out NA values</span></span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a>data_no_na <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(FRP_2))</span>
<span id="cb420-3"><a href="#cb420-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-4"><a href="#cb420-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots of CD4+ T Cell count change by frailty related phenotype at year 2</span></span>
<span id="cb420-5"><a href="#cb420-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_no_na, <span class="fu">aes</span>(<span class="at">x =</span> FRP_2, <span class="at">y =</span> LEU3N_CHANGE, <span class="at">fill =</span> FRP_2)) <span class="sc">+</span></span>
<span id="cb420-6"><a href="#cb420-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb420-7"><a href="#cb420-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb420-8"><a href="#cb420-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>) <span class="sc">+</span></span>
<span id="cb420-9"><a href="#cb420-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of CD4+ T Cell Count Change by Frailty Related Phenotype"</span>,</span>
<span id="cb420-10"><a href="#cb420-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Frailty Related Phenotype"</span>,</span>
<span id="cb420-11"><a href="#cb420-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"CD4+ T Cell Count Change"</span>) <span class="sc">+</span></span>
<span id="cb420-12"><a href="#cb420-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Frailty Related Phenotype"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-228-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Those with a Frailty Related Phenotype had less of an increase in CD4+ T Cell count compared to those without.</p>
</section>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="mental-qol-change" class="level2">
<h2 class="anchored" data-anchor-id="mental-qol-change">Mental QOL Change</h2>
<p>The candidate variables for mental QOL change as determined by interactive variable selection are <code>hard_drug_grp</code>, <code>ADH_HIGHLOW</code>, <code>CESD_2</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">Model Exploration</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">Model 1 - Main Research Question</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false">Model 2 - Depression Interaction Term</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-4" role="tab" aria-controls="tabset-20-4" aria-selected="false">Conclusion</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-5" role="tab" aria-controls="tabset-20-5" aria-selected="false">Bonus - Predicting Depression</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">Analyses</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">Depression as a Confounder</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false">Including Depression Interaction Term</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<p>Let’s begin by running the full model as determined by interactive model selection.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb422"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-4"><a href="#cb422-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb422-5"><a href="#cb422-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb422-6"><a href="#cb422-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-7"><a href="#cb422-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb422-8"><a href="#cb422-8" aria-hidden="true" tabindex="-1"></a>model_MENT_full1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span>  CESD_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb422-9"><a href="#cb422-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-10"><a href="#cb422-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb422-11"><a href="#cb422-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_full1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-32.537  -6.126  -1.540   5.582  38.662 

Coefficients:
                                                         Estimate Std. Error
(Intercept)                                               3.42934    2.16906
hard_drugs_grpPrevious User                              -6.80279    5.39588
hard_drugs_grpCurrent User                                9.20460    6.18696
ADH_HIGHVSLOWHigh Adherence                               2.68386    2.14723
CESD_2                                                   -0.30407    0.04914
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  10.70651    5.68836
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -10.79007    6.40420
                                                        t value      Pr(&gt;|t|)
(Intercept)                                               1.581        0.1145
hard_drugs_grpPrevious User                              -1.261        0.2080
hard_drugs_grpCurrent User                                1.488        0.1374
ADH_HIGHVSLOWHigh Adherence                               1.250        0.2119
CESD_2                                                   -6.188 0.00000000123
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   1.882        0.0604
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   -1.685        0.0926
                                                           
(Intercept)                                                
hard_drugs_grpPrevious User                                
hard_drugs_grpCurrent User                                 
ADH_HIGHVSLOWHigh Adherence                                
CESD_2                                                  ***
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence .  
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.66 on 521 degrees of freedom
  (22 observations deleted due to missingness)
Multiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 
F-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878</code></pre>
</div>
</div>
<p>Compare hard drug use groups at high adherence</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb424"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb424-3"><a href="#cb424-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-4"><a href="#cb424-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb424-5"><a href="#cb424-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"High Adherence"</span>)</span>
<span id="cb424-6"><a href="#cb424-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-7"><a href="#cb424-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb424-8"><a href="#cb424-8" aria-hidden="true" tabindex="-1"></a>model_MENT_full2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span>  CESD_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb424-9"><a href="#cb424-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-10"><a href="#cb424-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb424-11"><a href="#cb424-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_full2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-32.537  -6.126  -1.540   5.582  38.662 

Coefficients:
                                                        Estimate Std. Error
(Intercept)                                              6.11320    0.81275
hard_drugs_grpPrevious User                              3.90372    1.94422
hard_drugs_grpCurrent User                              -1.58547    1.68651
ADH_HIGHVSLOWLow Adherence                              -2.68386    2.14723
CESD_2                                                  -0.30407    0.04914
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence -10.70651    5.68836
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   10.79007    6.40420
                                                       t value
(Intercept)                                              7.522
hard_drugs_grpPrevious User                              2.008
hard_drugs_grpCurrent User                              -0.940
ADH_HIGHVSLOWLow Adherence                              -1.250
CESD_2                                                  -6.188
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -1.882
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence    1.685
                                                                Pr(&gt;|t|)    
(Intercept)                                            0.000000000000239 ***
hard_drugs_grpPrevious User                                       0.0452 *  
hard_drugs_grpCurrent User                                        0.3476    
ADH_HIGHVSLOWLow Adherence                                        0.2119    
CESD_2                                                 0.000000001234665 ***
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence            0.0604 .  
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence             0.0926 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.66 on 521 degrees of freedom
  (22 observations deleted due to missingness)
Multiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 
F-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878</code></pre>
</div>
</div>
<p>Compare hard drug use groups at low adherence</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb426"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-4"><a href="#cb426-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb426-5"><a href="#cb426-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb426-6"><a href="#cb426-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-7"><a href="#cb426-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb426-8"><a href="#cb426-8" aria-hidden="true" tabindex="-1"></a>model_MENT_full3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span>  CESD_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb426-9"><a href="#cb426-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-10"><a href="#cb426-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb426-11"><a href="#cb426-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_full3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-32.537  -6.126  -1.540   5.582  38.662 

Coefficients:
                                                        Estimate Std. Error
(Intercept)                                             -3.37346    5.22804
hard_drugs_grpNever User                                 6.80279    5.39588
hard_drugs_grpCurrent User                              16.00739    7.63391
ADH_HIGHVSLOWHigh Adherence                             13.39037    5.29906
CESD_2                                                  -0.30407    0.04914
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence   -10.70651    5.68836
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence -21.49658    8.01958
                                                       t value      Pr(&gt;|t|)
(Intercept)                                             -0.645       0.51904
hard_drugs_grpNever User                                 1.261       0.20797
hard_drugs_grpCurrent User                               2.097       0.03649
ADH_HIGHVSLOWHigh Adherence                              2.527       0.01180
CESD_2                                                  -6.188 0.00000000123
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    -1.882       0.06037
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -2.681       0.00758
                                                          
(Intercept)                                               
hard_drugs_grpNever User                                  
hard_drugs_grpCurrent User                             *  
ADH_HIGHVSLOWHigh Adherence                            *  
CESD_2                                                 ***
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence   .  
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.66 on 521 degrees of freedom
  (22 observations deleted due to missingness)
Multiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 
F-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb428"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb428-3"><a href="#cb428-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-4"><a href="#cb428-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb428-5"><a href="#cb428-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"High Adherence"</span>)</span>
<span id="cb428-6"><a href="#cb428-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-7"><a href="#cb428-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb428-8"><a href="#cb428-8" aria-hidden="true" tabindex="-1"></a>model_MENT_full4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span>  CESD_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb428-9"><a href="#cb428-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-10"><a href="#cb428-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb428-11"><a href="#cb428-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_full4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-32.537  -6.126  -1.540   5.582  38.662 

Coefficients:
                                                       Estimate Std. Error
(Intercept)                                            10.01691    1.98635
hard_drugs_grpNever User                               -3.90372    1.94422
hard_drugs_grpCurrent User                             -5.48919    2.41509
ADH_HIGHVSLOWLow Adherence                            -13.39037    5.29906
CESD_2                                                 -0.30407    0.04914
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    10.70651    5.68836
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence  21.49658    8.01958
                                                      t value      Pr(&gt;|t|)    
(Intercept)                                             5.043 0.00000063408 ***
hard_drugs_grpNever User                               -2.008       0.04517 *  
hard_drugs_grpCurrent User                             -2.273       0.02344 *  
ADH_HIGHVSLOWLow Adherence                             -2.527       0.01180 *  
CESD_2                                                 -6.188 0.00000000123 ***
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence     1.882       0.06037 .  
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   2.681       0.00758 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.66 on 521 degrees of freedom
  (22 observations deleted due to missingness)
Multiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 
F-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Current User"</span>)</span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb430-5"><a href="#cb430-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"High Adherence"</span>)</span>
<span id="cb430-6"><a href="#cb430-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-7"><a href="#cb430-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb430-8"><a href="#cb430-8" aria-hidden="true" tabindex="-1"></a>model_MENT_full5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span>  CESD_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb430-9"><a href="#cb430-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-10"><a href="#cb430-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb430-11"><a href="#cb430-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_full5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-32.537  -6.126  -1.540   5.582  38.662 

Coefficients:
                                                        Estimate Std. Error
(Intercept)                                              4.52773    1.76048
hard_drugs_grpPrevious User                              5.48919    2.41509
hard_drugs_grpNever User                                 1.58547    1.68651
ADH_HIGHVSLOWLow Adherence                               8.10621    6.03476
CESD_2                                                  -0.30407    0.04914
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence -21.49658    8.01958
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    -10.79007    6.40420
                                                       t value      Pr(&gt;|t|)
(Intercept)                                              2.572       0.01039
hard_drugs_grpPrevious User                              2.273       0.02344
hard_drugs_grpNever User                                 0.940       0.34761
ADH_HIGHVSLOWLow Adherence                               1.343       0.17978
CESD_2                                                  -6.188 0.00000000123
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -2.681       0.00758
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence     -1.685       0.09262
                                                          
(Intercept)                                            *  
hard_drugs_grpPrevious User                            *  
hard_drugs_grpNever User                                  
ADH_HIGHVSLOWLow Adherence                                
CESD_2                                                 ***
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence ** 
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence    .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.66 on 521 degrees of freedom
  (22 observations deleted due to missingness)
Multiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 
F-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb432"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Current User"</span>)</span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb432-5"><a href="#cb432-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb432-6"><a href="#cb432-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-7"><a href="#cb432-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb432-8"><a href="#cb432-8" aria-hidden="true" tabindex="-1"></a>model_MENT_full6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span>  CESD_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb432-9"><a href="#cb432-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-10"><a href="#cb432-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb432-11"><a href="#cb432-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_full6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-32.537  -6.126  -1.540   5.582  38.662 

Coefficients:
                                                         Estimate Std. Error
(Intercept)                                              12.63393    5.89652
hard_drugs_grpPrevious User                             -16.00739    7.63391
hard_drugs_grpNever User                                 -9.20460    6.18696
ADH_HIGHVSLOWHigh Adherence                              -8.10621    6.03476
CESD_2                                                   -0.30407    0.04914
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  21.49658    8.01958
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     10.79007    6.40420
                                                        t value      Pr(&gt;|t|)
(Intercept)                                               2.143       0.03261
hard_drugs_grpPrevious User                              -2.097       0.03649
hard_drugs_grpNever User                                 -1.488       0.13742
ADH_HIGHVSLOWHigh Adherence                              -1.343       0.17978
CESD_2                                                   -6.188 0.00000000123
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   2.681       0.00758
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      1.685       0.09262
                                                           
(Intercept)                                             *  
hard_drugs_grpPrevious User                             *  
hard_drugs_grpNever User                                   
ADH_HIGHVSLOWHigh Adherence                                
CESD_2                                                  ***
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence ** 
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.66 on 521 degrees of freedom
  (22 observations deleted due to missingness)
Multiple R-squared:  0.1089,    Adjusted R-squared:  0.09867 
F-statistic: 10.62 on 6 and 521 DF,  p-value: 0.00000000003878</code></pre>
</div>
</div>
<p>Interestingly, we have lost a lot of the significant relationships we were seeing before with our main predictors of hard drug use and adherence.</p>
<p>It seems that the main driver of this model, and best predictor of change in mental QOL score is depression score.</p>
<p>Within adherence levels, none of the hard drug use groups differed from each other on QOL (p-adjusted &gt; 0.05).</p>
<p>The only significant difference in mental QOL change is for previous drug users. For previous drug users, those with low adherence have a mental QOL change that is on average 13.39 points lower than those with high adherence (p= 0.0118). Depending on how we handle multiple pairwise comparisons, this may not be significant!</p>
<p>Something fishy is going on here…</p>
<p>Let’s examine this in a simplified model with no interactions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb434"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb434-3"><a href="#cb434-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-4"><a href="#cb434-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb434-5"><a href="#cb434-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb434-6"><a href="#cb434-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-7"><a href="#cb434-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb434-8"><a href="#cb434-8" aria-hidden="true" tabindex="-1"></a>model_MENT_simple <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span>  CESD_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb434-9"><a href="#cb434-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-10"><a href="#cb434-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb434-11"><a href="#cb434-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_simple)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    CESD_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-32.274  -6.421  -1.574   5.343  39.297 

Coefficients:
                            Estimate Std. Error t value        Pr(&gt;|t|)    
(Intercept)                  6.17713    2.64623   2.334           0.020 *  
hard_drugs_grpCurrent User  -3.44081    2.30106  -1.495           0.135    
hard_drugs_grpNever User    -2.70142    1.85281  -1.458           0.145    
ADH_HIGHVSLOWHigh Adherence  2.94279    1.90898   1.542           0.124    
CESD_2                      -0.32881    0.04803  -6.845 0.0000000000214 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.72 on 523 degrees of freedom
  (22 observations deleted due to missingness)
Multiple R-squared:  0.09648,   Adjusted R-squared:  0.08957 
F-statistic: 13.96 on 4 and 523 DF,  p-value: 0.00000000007883</code></pre>
</div>
</div>
<p>Indeed, we can see that, when including depression in the model, hard drug use and adherence are no longer significant predictors of change in mental QOL!</p>
<p>This suggests that depression score is either a mediator, a moderator, or a confounder for the relationship between hard drug use and adherence on mental QOL.</p>
<p>Let’s explore.</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<section id="confounder-is-related-to-pev" class="level3">
<h3 class="anchored" data-anchor-id="confounder-is-related-to-pev">Confounder is related to PEV</h3>
<p>We saw <a href="#EDA">earlier</a> that hard drug use was a significant predictor for depression. Specifically:</p>
<p>Hard drug use is a significant predictor of depression score (F~(2, 542)~= 14.31). On average, current hard drug users had depression scores that were 5.23 points higher than never hard drug users (p &lt; 0.0001), and previous hard drug users had depression scores that were 7.29 points higher than those who never used hard drugs (p &lt; 0.0001).</p>
<p>Thus, depression meets criteria 1 of the classical definition for a confounder: It is related to the PEV.</p>
</section>
<section id="confounder-is-related-to-the-outcome-measure" class="level3">
<h3 class="anchored" data-anchor-id="confounder-is-related-to-the-outcome-measure">Confounder is related to the Outcome Measure</h3>
<p>We also saw in the interactive variable selection that depression was significantly related change in mental QOL change.</p>
<p>Thus depression meets criteria 2 of the classical definition for a confounder: it is related to the main outcome.</p>
</section>
<section id="confounder-is-not-a-mediator" class="level3">
<h3 class="anchored" data-anchor-id="confounder-is-not-a-mediator">Confounder is not a Mediator</h3>
<p>It is possible that depression is on the causal pathway for mental QOL (hard drug use -&gt; depression -&gt; mental QOL), but it is likewise possible that mental QOL is on the causal pathway for depression (hard drug use -&gt; mental QOL -&gt; depression). Thus we cannot conclude that depression is a mediator.</p>
</section>
<section id="confounder-meaningfully-changes-the-relationship-of-pev-on-outcome" class="level3">
<h3 class="anchored" data-anchor-id="confounder-meaningfully-changes-the-relationship-of-pev-on-outcome">Confounder Meaningfully Changes the Relationship of PEV on Outcome</h3>
<p>We also saw that including depression in the model changed hard drug use from being significant to not significant. Thus depression score changes the relationship between the PEV and outcome measure in a very meaningful way.</p>
<p>I therefore feel justified in exploring depression as a confounder, and analyzing whether an interaction term between hard drug use group and depression will add explanatory power to our model.</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<p>Let’s run a new full model, with the included interaction term between hard drug use group and depression. In essence we are running a three way interaction. It will need to be emphasized in the discussion that this was exploratory data analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb436"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group</span></span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Current User"</span>)</span>
<span id="cb436-3"><a href="#cb436-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-4"><a href="#cb436-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group</span></span>
<span id="cb436-5"><a href="#cb436-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb436-6"><a href="#cb436-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-7"><a href="#cb436-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb436-8"><a href="#cb436-8" aria-hidden="true" tabindex="-1"></a>model_MENT_newfull <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span>  CESD_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>CESD_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb436-9"><a href="#cb436-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-10"><a href="#cb436-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb436-11"><a href="#cb436-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_newfull)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    CESD_2 + hard_drugs_grp * ADH_HIGHVSLOW + hard_drugs_grp * 
    CESD_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-33.459  -6.016  -1.375   5.512  37.513 

Coefficients:
                                                        Estimate Std. Error
(Intercept)                                              9.51665    6.16622
hard_drugs_grpPrevious User                             30.31096   10.51019
hard_drugs_grpNever User                                -7.17735    6.52016
ADH_HIGHVSLOWHigh Adherence                             -7.87736    5.82799
CESD_2                                                  -0.13089    0.14003
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence -7.15661    8.97026
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    10.75016    6.18586
hard_drugs_grpPrevious User:CESD_2                      -1.15503    0.21476
hard_drugs_grpNever User:CESD_2                         -0.09391    0.14973
                                                        t value    Pr(&gt;|t|)    
(Intercept)                                               1.543     0.12336    
hard_drugs_grpPrevious User                               2.884     0.00409 ** 
hard_drugs_grpNever User                                 -1.101     0.27150    
ADH_HIGHVSLOWHigh Adherence                              -1.352     0.17708    
CESD_2                                                   -0.935     0.35038    
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -0.798     0.42534    
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      1.738     0.08283 .  
hard_drugs_grpPrevious User:CESD_2                       -5.378 0.000000114 ***
hard_drugs_grpNever User:CESD_2                          -0.627     0.53083    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.26 on 519 degrees of freedom
  (22 observations deleted due to missingness)
Multiple R-squared:  0.1729,    Adjusted R-squared:  0.1601 
F-statistic: 13.56 on 8 and 519 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<p>We get a highly significant p-value for the interaction between hard drug use group and depression (p &lt; 0.0001)</p>
<p>Our adjusted R-squared also shot up from 0.090 to 0.16. We’re on to something here.</p>
<p>Let’s run backwards model selection and examine the BIC to see if we need to include the hard drug use * depression interaction score.</p>
<section id="backwards-elimination-1" class="level3">
<h3 class="anchored" data-anchor-id="backwards-elimination-1">Backwards Elimination</h3>
<p>We are going to force inclusion of our main variables of interest, <code>hard_drugs_grp</code> and <code>ADH_HIGHVSLOW</code>, and the interaction between them, since those were the main questions the researchers posed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb438"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb438-3"><a href="#cb438-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-4"><a href="#cb438-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb438-5"><a href="#cb438-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb438-6"><a href="#cb438-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-7"><a href="#cb438-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb438-8"><a href="#cb438-8" aria-hidden="true" tabindex="-1"></a>model_MENT_newfull <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span>  CESD_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>CESD_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb438-9"><a href="#cb438-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-10"><a href="#cb438-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform backward elimination regression selection based on BIC </span></span>
<span id="cb438-11"><a href="#cb438-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_backward_sbc</span>(model_MENT_newfull, <span class="at">include =</span> <span class="fu">c</span>(<span class="st">"hard_drugs_grp"</span>, <span class="st">"ADH_HIGHVSLOW"</span>, <span class="st">"hard_drugs_grp:ADH_HIGHVSLOW"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "No variables have been removed from the model."</code></pre>
</div>
</div>
<p>No variable was removed from the model, indicating that the interaction between hard drug use group and depression adds significant explanatory power and should be included in the model.</p>
<p>This puts us in a tricky position, it is clear that there is a relationship between hard drug use and mental quality of life, and that this differs based on both adherence and depression. However we don’t necessarily have the sample size to run a three-way interaction.</p>
</section>
<section id="next-steps" class="level3">
<h3 class="anchored" data-anchor-id="next-steps">Next Steps</h3>
<p>Thus, we will proceed in two ways from here, and run separate models for:</p>
<ul>
<li><ol type="1">
<li>Does the relationship between hard drug use and mental QOL differ based on adherence (irrespective of depression)?</li>
</ol></li>
<li><ol start="2" type="1">
<li>Does the relationship between hard drug use and mental QOL differ based on depression (irrespective of adherence)?</li>
</ol></li>
</ul>
<p>Removing the confounder of depression in model 1 allows us to answer the main research question for this project. Model 2) will be presented as an exploratory data analysis and allows us to explore how depression is related to hard drug use, and how that is affecting our main model.</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</section>
</div>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<p>This is the model predicting <code>AGG_MENT_CHANGE</code>, including only <code>hard_drugs_grp</code> and <code>ADH_HIGHVSLOW</code>, and their interaction term.</p>
<p>This addresses the main research question of how mental QOL is impacted by ART, based on hard drug use and adherence to the treatment regimen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">Interpretation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false">Visualizing the Interaction</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<p>Let’s run the regression as specified.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb440"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb440-3"><a href="#cb440-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-4"><a href="#cb440-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb440-5"><a href="#cb440-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb440-6"><a href="#cb440-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-7"><a href="#cb440-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb440-8"><a href="#cb440-8" aria-hidden="true" tabindex="-1"></a>model_MENT_main1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW<span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb440-9"><a href="#cb440-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-10"><a href="#cb440-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb440-11"><a href="#cb440-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_main1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-37.392  -5.850  -0.839   5.089  38.498 

Coefficients:
                                                        Estimate Std. Error
(Intercept)                                              -0.8003     2.0950
hard_drugs_grpCurrent User                                7.9610     6.3718
hard_drugs_grpPrevious User                             -15.9522     5.3413
ADH_HIGHVSLOWHigh Adherence                               3.4343     2.1812
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -11.1387     6.5996
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  18.7589     5.7025
                                                        t value Pr(&gt;|t|)   
(Intercept)                                              -0.382  0.70261   
hard_drugs_grpCurrent User                                1.249  0.21207   
hard_drugs_grpPrevious User                              -2.987  0.00295 **
ADH_HIGHVSLOWHigh Adherence                               1.574  0.11598   
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   -1.688  0.09204 . 
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.290  0.00107 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.03 on 526 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.04347,   Adjusted R-squared:  0.03438 
F-statistic: 4.781 on 5 and 526 DF,  p-value: 0.0002777</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb442"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb442-2"><a href="#cb442-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_MENT_main1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.8003171</td>
<td style="text-align: right;">2.095019</td>
<td style="text-align: right;">-0.3820094</td>
<td style="text-align: right;">0.7026087</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-4.9159498</td>
<td style="text-align: right;">3.315316</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">7.9609869</td>
<td style="text-align: right;">6.371753</td>
<td style="text-align: right;">1.2494186</td>
<td style="text-align: right;">0.2120677</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-4.5562212</td>
<td style="text-align: right;">20.478195</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">-15.9522320</td>
<td style="text-align: right;">5.341272</td>
<td style="text-align: right;">-2.9865976</td>
<td style="text-align: right;">0.0029525</td>
<td style="text-align: right;">0.0177150</td>
<td style="text-align: right;">-26.4450776</td>
<td style="text-align: right;">-5.459386</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">3.4342726</td>
<td style="text-align: right;">2.181205</td>
<td style="text-align: right;">1.5744837</td>
<td style="text-align: right;">0.1159769</td>
<td style="text-align: right;">0.6958614</td>
<td style="text-align: right;">-0.8506712</td>
<td style="text-align: right;">7.719216</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-11.1386718</td>
<td style="text-align: right;">6.599562</td>
<td style="text-align: right;">-1.6877895</td>
<td style="text-align: right;">0.0920444</td>
<td style="text-align: right;">0.5522667</td>
<td style="text-align: right;">-24.1034081</td>
<td style="text-align: right;">1.826064</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">18.7589336</td>
<td style="text-align: right;">5.702522</td>
<td style="text-align: right;">3.2895855</td>
<td style="text-align: right;">0.0010705</td>
<td style="text-align: right;">0.0064233</td>
<td style="text-align: right;">7.5564192</td>
<td style="text-align: right;">29.961448</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb443"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the VIFs</span></span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_MENT_main1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>there are higher-order terms (interactions) in this model
consider setting type = 'predictor'; see ?vif</code></pre>
</div>
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(vif_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GVIF</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GVIF^(1/(2*Df))</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grp</td>
<td style="text-align: right;">119.991456</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3.309692</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOW</td>
<td style="text-align: right;">1.298281</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.139422</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grp:ADH_HIGHVSLOW</td>
<td style="text-align: right;">121.957959</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3.323170</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The overall model is significant (F<sub>(5,526)</sub> = 4.78, p = 0.000278, and we are getting significant interactions.</p>
<p>At the same time, this is a weaker model than when we included depression. Our R-adjusted is now 0.034, meaning we now only explain 3.4% of the variance in mental QOL (compared to 16% in the full model).</p>
<p>At low adherence, the previous group has a greater decrease in mental QOL compared to never users.</p>
<p>For never users, there is no difference in mental QOL based on high or low adherence (t = 1.5744837, p-adjusted = 0.116, 95% CI: -0.85 to 7.72).</p>
<p>Change the reference group to compare drug use group at high adherence</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb446"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb446-3"><a href="#cb446-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-4"><a href="#cb446-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb446-5"><a href="#cb446-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"High Adherence"</span>)</span>
<span id="cb446-6"><a href="#cb446-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-7"><a href="#cb446-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb446-8"><a href="#cb446-8" aria-hidden="true" tabindex="-1"></a>model_MENT_main2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW<span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb446-9"><a href="#cb446-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-10"><a href="#cb446-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb446-11"><a href="#cb446-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_main2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-37.392  -5.850  -0.839   5.089  38.498 

Coefficients:
                                                       Estimate Std. Error
(Intercept)                                              2.6340     0.6071
hard_drugs_grpCurrent User                              -3.1777     1.7190
hard_drugs_grpPrevious User                              2.8067     1.9974
ADH_HIGHVSLOWLow Adherence                              -3.4343     2.1812
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   11.1387     6.5996
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence -18.7589     5.7025
                                                       t value  Pr(&gt;|t|)    
(Intercept)                                              4.339 0.0000172 ***
hard_drugs_grpCurrent User                              -1.849   0.06508 .  
hard_drugs_grpPrevious User                              1.405   0.16056    
ADH_HIGHVSLOWLow Adherence                              -1.574   0.11598    
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence    1.688   0.09204 .  
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -3.290   0.00107 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.03 on 526 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.04347,   Adjusted R-squared:  0.03438 
F-statistic: 4.781 on 5 and 526 DF,  p-value: 0.0002777</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb448"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_MENT_main2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">2.633955</td>
<td style="text-align: right;">0.607084</td>
<td style="text-align: right;">4.338700</td>
<td style="text-align: right;">0.0000172</td>
<td style="text-align: right;">0.0001031</td>
<td style="text-align: right;">1.441349</td>
<td style="text-align: right;">3.8265623</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">-3.177685</td>
<td style="text-align: right;">1.719008</td>
<td style="text-align: right;">-1.848557</td>
<td style="text-align: right;">0.0650828</td>
<td style="text-align: right;">0.3904967</td>
<td style="text-align: right;">-6.554649</td>
<td style="text-align: right;">0.1992793</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">2.806702</td>
<td style="text-align: right;">1.997389</td>
<td style="text-align: right;">1.405185</td>
<td style="text-align: right;">0.1605566</td>
<td style="text-align: right;">0.9633394</td>
<td style="text-align: right;">-1.117138</td>
<td style="text-align: right;">6.7305412</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">-3.434273</td>
<td style="text-align: right;">2.181205</td>
<td style="text-align: right;">-1.574484</td>
<td style="text-align: right;">0.1159769</td>
<td style="text-align: right;">0.6958614</td>
<td style="text-align: right;">-7.719216</td>
<td style="text-align: right;">0.8506712</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">11.138672</td>
<td style="text-align: right;">6.599562</td>
<td style="text-align: right;">1.687790</td>
<td style="text-align: right;">0.0920444</td>
<td style="text-align: right;">0.5522667</td>
<td style="text-align: right;">-1.826064</td>
<td style="text-align: right;">24.1034081</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">-18.758934</td>
<td style="text-align: right;">5.702522</td>
<td style="text-align: right;">-3.289585</td>
<td style="text-align: right;">0.0010705</td>
<td style="text-align: right;">0.0064233</td>
<td style="text-align: right;">-29.961448</td>
<td style="text-align: right;">-7.5564192</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>At high adherence, there is no difference in mental QOL between previous and never hard drug users (t = 1.41, p-adjusted = 0.48, 95% CI: -1.12 to 6.73), or between current and never hard drug users (t = -1.85, p-adjusted = 0.195, 95% CI: -6.55 to 0.20).</p>
<p>Change reference level to compare previous hard drug users at low adherence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb449"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb449-3"><a href="#cb449-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-4"><a href="#cb449-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb449-5"><a href="#cb449-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb449-6"><a href="#cb449-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-7"><a href="#cb449-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb449-8"><a href="#cb449-8" aria-hidden="true" tabindex="-1"></a>model_MENT_main3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW<span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb449-9"><a href="#cb449-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-10"><a href="#cb449-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb449-11"><a href="#cb449-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_main3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-37.392  -5.850  -0.839   5.089  38.498 

Coefficients:
                                                       Estimate Std. Error
(Intercept)                                             -16.753      4.913
hard_drugs_grpNever User                                 15.952      5.341
hard_drugs_grpCurrent User                               23.913      7.769
ADH_HIGHVSLOWHigh Adherence                              22.193      5.269
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    -18.759      5.703
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -29.898      8.158
                                                       t value  Pr(&gt;|t|)    
(Intercept)                                             -3.410  0.000700 ***
hard_drugs_grpNever User                                 2.987  0.002953 ** 
hard_drugs_grpCurrent User                               3.078  0.002191 ** 
ADH_HIGHVSLOWHigh Adherence                              4.212 0.0000298 ***
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    -3.290  0.001071 ** 
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -3.665  0.000273 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.03 on 526 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.04347,   Adjusted R-squared:  0.03438 
F-statistic: 4.781 on 5 and 526 DF,  p-value: 0.0002777</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb451"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_MENT_main3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-16.75255</td>
<td style="text-align: right;">4.913256</td>
<td style="text-align: right;">-3.409663</td>
<td style="text-align: right;">0.0007004</td>
<td style="text-align: right;">0.0042022</td>
<td style="text-align: right;">-26.404563</td>
<td style="text-align: right;">-7.100535</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">15.95223</td>
<td style="text-align: right;">5.341272</td>
<td style="text-align: right;">2.986598</td>
<td style="text-align: right;">0.0029525</td>
<td style="text-align: right;">0.0177150</td>
<td style="text-align: right;">5.459386</td>
<td style="text-align: right;">26.445078</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">23.91322</td>
<td style="text-align: right;">7.768540</td>
<td style="text-align: right;">3.078213</td>
<td style="text-align: right;">0.0021911</td>
<td style="text-align: right;">0.0131465</td>
<td style="text-align: right;">8.652045</td>
<td style="text-align: right;">39.174393</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">22.19321</td>
<td style="text-align: right;">5.268880</td>
<td style="text-align: right;">4.212130</td>
<td style="text-align: right;">0.0000298</td>
<td style="text-align: right;">0.0001786</td>
<td style="text-align: right;">11.842574</td>
<td style="text-align: right;">32.543838</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-18.75893</td>
<td style="text-align: right;">5.702522</td>
<td style="text-align: right;">-3.289585</td>
<td style="text-align: right;">0.0010705</td>
<td style="text-align: right;">0.0064233</td>
<td style="text-align: right;">-29.961448</td>
<td style="text-align: right;">-7.556419</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-29.89761</td>
<td style="text-align: right;">8.158288</td>
<td style="text-align: right;">-3.664691</td>
<td style="text-align: right;">0.0002728</td>
<td style="text-align: right;">0.0016365</td>
<td style="text-align: right;">-45.924434</td>
<td style="text-align: right;">-13.870777</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Here we can see that all our p-values are now very low (all have at least 2 decimal places). This gives me confidence that this is a meaningful and strong model. All the most important comparisons are with previous drug users at low adherence!</p>
<p>At low adherence, current hard drug users have a higher mental QOL (p-adjusted = 0.00657), and never hard drug users have a higher mental QOL (p-adjusted = 0.00886) compared to previous hard drug users.</p>
<p>Additionally, for previous hard drug users, those with high adherence had a higher increase in mental QOL compared to those with low adherence (p &lt; 0.0001).</p>
<p>Change reference category to compare high adherence previous hard drug users.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb452"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb452-3"><a href="#cb452-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-4"><a href="#cb452-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb452-5"><a href="#cb452-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"High Adherence"</span>)</span>
<span id="cb452-6"><a href="#cb452-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-7"><a href="#cb452-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb452-8"><a href="#cb452-8" aria-hidden="true" tabindex="-1"></a>model_MENT_main4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb452-9"><a href="#cb452-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-10"><a href="#cb452-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb452-11"><a href="#cb452-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_main4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-37.392  -5.850  -0.839   5.089  38.498 

Coefficients:
                                                      Estimate Std. Error
(Intercept)                                              5.441      1.903
hard_drugs_grpNever User                                -2.807      1.997
hard_drugs_grpCurrent User                              -5.984      2.491
ADH_HIGHVSLOWLow Adherence                             -22.193      5.269
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence     18.759      5.703
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   29.898      8.158
                                                      t value  Pr(&gt;|t|)    
(Intercept)                                             2.859  0.004416 ** 
hard_drugs_grpNever User                               -1.405  0.160557    
hard_drugs_grpCurrent User                             -2.402  0.016654 *  
ADH_HIGHVSLOWLow Adherence                             -4.212 0.0000298 ***
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence     3.290  0.001071 ** 
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   3.665  0.000273 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.03 on 526 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.04347,   Adjusted R-squared:  0.03438 
F-statistic: 4.781 on 5 and 526 DF,  p-value: 0.0002777</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_MENT_main4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">5.440657</td>
<td style="text-align: right;">1.902896</td>
<td style="text-align: right;">2.859146</td>
<td style="text-align: right;">0.0044164</td>
<td style="text-align: right;">0.0264985</td>
<td style="text-align: right;">1.702448</td>
<td style="text-align: right;">9.178866</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">-2.806702</td>
<td style="text-align: right;">1.997389</td>
<td style="text-align: right;">-1.405185</td>
<td style="text-align: right;">0.1605566</td>
<td style="text-align: right;">0.9633394</td>
<td style="text-align: right;">-6.730541</td>
<td style="text-align: right;">1.117138</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">-5.984387</td>
<td style="text-align: right;">2.491476</td>
<td style="text-align: right;">-2.401945</td>
<td style="text-align: right;">0.0166539</td>
<td style="text-align: right;">0.0999236</td>
<td style="text-align: right;">-10.878851</td>
<td style="text-align: right;">-1.089922</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">-22.193206</td>
<td style="text-align: right;">5.268880</td>
<td style="text-align: right;">-4.212130</td>
<td style="text-align: right;">0.0000298</td>
<td style="text-align: right;">0.0001786</td>
<td style="text-align: right;">-32.543838</td>
<td style="text-align: right;">-11.842574</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">18.758934</td>
<td style="text-align: right;">5.702522</td>
<td style="text-align: right;">3.289585</td>
<td style="text-align: right;">0.0010705</td>
<td style="text-align: right;">0.0064233</td>
<td style="text-align: right;">7.556419</td>
<td style="text-align: right;">29.961448</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">29.897605</td>
<td style="text-align: right;">8.158288</td>
<td style="text-align: right;">3.664691</td>
<td style="text-align: right;">0.0002728</td>
<td style="text-align: right;">0.0016365</td>
<td style="text-align: right;">13.870777</td>
<td style="text-align: right;">45.924434</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>At high adherence, there is a borderline significant difference between previous and current drug users (p-adjusted = 0.050). Considering the small sample size in both categories, this could become a non significant difference with a larger N.</p>
<p>Change the reference level to compare current hard drug users</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb455"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Current User"</span>)</span>
<span id="cb455-3"><a href="#cb455-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-4"><a href="#cb455-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb455-5"><a href="#cb455-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb455-6"><a href="#cb455-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-7"><a href="#cb455-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb455-8"><a href="#cb455-8" aria-hidden="true" tabindex="-1"></a>model_MENT_main5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb455-9"><a href="#cb455-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-10"><a href="#cb455-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb455-11"><a href="#cb455-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_main5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-37.392  -5.850  -0.839   5.089  38.498 

Coefficients:
                                                        Estimate Std. Error
(Intercept)                                                7.161      6.017
hard_drugs_grpPrevious User                              -23.913      7.769
hard_drugs_grpNever User                                  -7.961      6.372
ADH_HIGHVSLOWHigh Adherence                               -7.704      6.229
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   29.898      8.158
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      11.139      6.600
                                                        t value Pr(&gt;|t|)    
(Intercept)                                               1.190 0.234592    
hard_drugs_grpPrevious User                              -3.078 0.002191 ** 
hard_drugs_grpNever User                                 -1.249 0.212068    
ADH_HIGHVSLOWHigh Adherence                              -1.237 0.216668    
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.665 0.000273 ***
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      1.688 0.092044 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.03 on 526 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.04347,   Adjusted R-squared:  0.03438 
F-statistic: 4.781 on 5 and 526 DF,  p-value: 0.0002777</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb457"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_MENT_main5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">7.160670</td>
<td style="text-align: right;">6.017485</td>
<td style="text-align: right;">1.189977</td>
<td style="text-align: right;">0.2345922</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-4.660585</td>
<td style="text-align: right;">18.981925</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">-23.913219</td>
<td style="text-align: right;">7.768540</td>
<td style="text-align: right;">-3.078213</td>
<td style="text-align: right;">0.0021911</td>
<td style="text-align: right;">0.0131465</td>
<td style="text-align: right;">-39.174393</td>
<td style="text-align: right;">-8.652045</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">-7.960987</td>
<td style="text-align: right;">6.371753</td>
<td style="text-align: right;">-1.249419</td>
<td style="text-align: right;">0.2120677</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-20.478195</td>
<td style="text-align: right;">4.556221</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-7.704399</td>
<td style="text-align: right;">6.228689</td>
<td style="text-align: right;">-1.236922</td>
<td style="text-align: right;">0.2166682</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-19.940561</td>
<td style="text-align: right;">4.531762</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">29.897605</td>
<td style="text-align: right;">8.158288</td>
<td style="text-align: right;">3.664691</td>
<td style="text-align: right;">0.0002728</td>
<td style="text-align: right;">0.0016365</td>
<td style="text-align: right;">13.870777</td>
<td style="text-align: right;">45.924434</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">11.138672</td>
<td style="text-align: right;">6.599562</td>
<td style="text-align: right;">1.687790</td>
<td style="text-align: right;">0.0920444</td>
<td style="text-align: right;">0.5522667</td>
<td style="text-align: right;">-1.826064</td>
<td style="text-align: right;">24.103408</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>For current hard drug users, there was no difference in mental QOL based on adherence (t = -1.24, p = 0.227, 95% CI: -19.94 to 4.53).</p>
<p><a href="Data_Analysis">Top of Tabset</a></p>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<section id="overall-model-3" class="level3">
<h3 class="anchored" data-anchor-id="overall-model-3">Overall model</h3>
<p>There were significant differences in change mental QOL over 2 years based on hard drug usage and adherence to the treatment regiment (F<sub>(5,526)</sub> = 4.78, p = 0.000278).</p>
</section>
<section id="hard-drug-use-6" class="level3">
<h3 class="anchored" data-anchor-id="hard-drug-use-6">Hard Drug Use</h3>
<p>The relationship between hard drug use and change in mental QOL over 2 years depended on adherence to the treatment regiment.</p>
<section id="hard-drug-use-at-low-adherence-2" class="level4">
<h4 class="anchored" data-anchor-id="hard-drug-use-at-low-adherence-2">Hard Drug Use at Low Adherence</h4>
<p>For those with low adherence to the treatment regiment, previous hard drug users had a 15.95 point decrease in mental QOL compared to never hard drug users (t = -2.99, p-adjusted = 0.00886, 95% CI: -26.46 to -5.50), and a 23.91 point decrease compared to current hard drug users (t = 3.078, p-adjusted = 0.00657, 95% CI: 8.65 to 39.17). There was no difference in mental QOL between current and never hard drug users at low adherence (t = 1.25, p-adjusted = 0.636, 95% CI: -4.56 to 20.48).</p>
</section>
<section id="hard-drug-use-at-high-adherence-2" class="level4">
<h4 class="anchored" data-anchor-id="hard-drug-use-at-high-adherence-2">Hard Drug use at High Adherence</h4>
<p>For those with low adherence to the treatment regiment, there was no difference in mental QOL between previous and never hard drug users (t = 1.41, p-adjusted = 0.48, 95% CI: -1.12 to 6.73), or between current and never hard drug users (t = -1.85, p-adjusted = 0.195, 95% CI: -6.55 to 0.20). The difference in mental QOL for current and previous users was borderline significant (t= -2.40, p-adjusted = 0.050, 95% CI: -10.88 to -1.09), and with a larger sample size may become non-significant.</p>
</section>
</section>
<section id="adherence-9" class="level3">
<h3 class="anchored" data-anchor-id="adherence-9">Adherence</h3>
<p>The relationship between adherence to the treatment regiment and change in mental QOL over 2 years differed by hard drug use.</p>
<section id="adherence-for-current-hard-drug-users-2" class="level4">
<h4 class="anchored" data-anchor-id="adherence-for-current-hard-drug-users-2">Adherence for Current Hard Drug Users</h4>
<p>For current hard drug users,there was no difference in mental QOL change over 2 years based on adherence (t = -1.24, p = 0.227, 95% CI: -19.94 to 4.53).</p>
</section>
<section id="adherence-for-previous-hard-drug-users-2" class="level4">
<h4 class="anchored" data-anchor-id="adherence-for-previous-hard-drug-users-2">Adherence for Previous Hard Drug Users</h4>
<p>For previous hard drug users, there was a statistically significant difference in change in mental QOL over 2 years based on adherence (t = 4.21, p-adjusted = 0.000536). On average, previous hard drug users with high adherence had a 22.19 point increase in mental QOL over 2 years compared to those with low adherence (95% CI: 11.84 to 32.54).</p>
</section>
<section id="adherence-for-never-hard-drug-users-2" class="level4">
<h4 class="anchored" data-anchor-id="adherence-for-never-hard-drug-users-2">Adherence for Never Hard Drug Users</h4>
<p>For never hard drug users, there was no difference in change in mental QOL over 2 years based on high or low adherence (t = 1.5744837, p-adjusted = 0.116, 95% CI: -0.85 to 7.72).</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</section>
</section>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<p>The below plot is useful in interpreting the interaction</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-4"><a href="#cb458-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb458-5"><a href="#cb458-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb458-6"><a href="#cb458-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-7"><a href="#cb458-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Use interactions package to plot interaction</span></span>
<span id="cb458-8"><a href="#cb458-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat_plot</span>(</span>
<span id="cb458-9"><a href="#cb458-9" aria-hidden="true" tabindex="-1"></a>  model_MENT_main1, </span>
<span id="cb458-10"><a href="#cb458-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> hard_drugs_grp, </span>
<span id="cb458-11"><a href="#cb458-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> ADH_HIGHVSLOW, </span>
<span id="cb458-12"><a href="#cb458-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">geom =</span> <span class="st">"line"</span>, </span>
<span id="cb458-13"><a href="#cb458-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> <span class="st">"Pastel2"</span>,</span>
<span id="cb458-14"><a href="#cb458-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">x.label =</span> <span class="st">"Hard Drugs Group"</span>,</span>
<span id="cb458-15"><a href="#cb458-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">y.label =</span> <span class="st">"Predicted Mental QOL Change"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-248-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here we see the main interaction finding: for previous users, those with low adherence had a decrease in mental QOL over 2 years compared to those with high adherence who had an slight increase.</p>
<p>Additionally, for those with low adherence, previous hard drug users had a decrease in mental QOL over 2 years compared to current hard drug users and never hard drug users.</p>
<p>We interpret this to mean that previous hard drug users (those in either their first or second year of sobriety) are struggling to deal with withdrawals, addiction, or the adverse effects of the treatment. While current users are in the midst of using hard drugs as a coping mechanism, and thus are protected from the negative impact of the treatment on mental QOL.</p>
<p>Thus, <strong>previous hard drug users are a vulnerable population, and high adherence to the treatment regiment might buffer them against the adverse effects of the HAART treatment.</strong></p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</div>
</div>
</div>
</div>
<div id="tabset-20-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<p>This is the model predicting <code>AGG_MENT_CHANGE</code>, including only <code>hard_drugs_grp</code> and <code>CESD_2</code>, and their interaction term.</p>
<p>This addresses the confounding of depression on the relationship between hard drug use and change in mental QOL.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">Interpretation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false">Visualizing the Interaction</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<p>Compare slopes for never users.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb459"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb459-2"><a href="#cb459-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb459-3"><a href="#cb459-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-4"><a href="#cb459-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb459-5"><a href="#cb459-5" aria-hidden="true" tabindex="-1"></a>model_MENT_sub1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> CESD_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>CESD_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb459-6"><a href="#cb459-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-7"><a href="#cb459-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb459-8"><a href="#cb459-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_sub1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + CESD_2 + hard_drugs_grp * 
    CESD_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-34.141  -6.071  -1.545   5.758  37.779 

Coefficients:
                                   Estimate Std. Error t value       Pr(&gt;|t|)
(Intercept)                         5.10534    0.81668   6.251 0.000000000836
hard_drugs_grpCurrent User         -3.04165    2.90324  -1.048          0.295
hard_drugs_grpPrevious User        16.97744    2.91062   5.833 0.000000009463
CESD_2                             -0.23480    0.05313  -4.419 0.000011998960
hard_drugs_grpCurrent User:CESD_2   0.10992    0.15093   0.728          0.467
hard_drugs_grpPrevious User:CESD_2 -0.80296    0.13010  -6.172 0.000000001341
                                      
(Intercept)                        ***
hard_drugs_grpCurrent User            
hard_drugs_grpPrevious User        ***
CESD_2                             ***
hard_drugs_grpCurrent User:CESD_2     
hard_drugs_grpPrevious User:CESD_2 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.36 on 532 degrees of freedom
  (12 observations deleted due to missingness)
Multiple R-squared:  0.1571,    Adjusted R-squared:  0.1492 
F-statistic: 19.84 on 5 and 532 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb461"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the VIFs</span></span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_MENT_sub1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>there are higher-order terms (interactions) in this model
consider setting type = 'predictor'; see ?vif</code></pre>
</div>
<div class="sourceCode cell-code" id="cb463"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(vif_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GVIF</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GVIF^(1/(2*Df))</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grp</td>
<td style="text-align: right;">9.440857</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.752883</td>
</tr>
<tr class="even">
<td style="text-align: left;">CESD_2</td>
<td style="text-align: right;">1.416421</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.190135</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grp:CESD_2</td>
<td style="text-align: right;">11.642359</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.847184</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb464"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb464-2"><a href="#cb464-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_MENT_sub1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">5.1053388</td>
<td style="text-align: right;">0.8166797</td>
<td style="text-align: right;">6.2513354</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">3.5010261</td>
<td style="text-align: right;">6.7096514</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">-3.0416518</td>
<td style="text-align: right;">2.9032412</td>
<td style="text-align: right;">-1.0476745</td>
<td style="text-align: right;">0.2952643</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-8.7448750</td>
<td style="text-align: right;">2.6615715</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">16.9774420</td>
<td style="text-align: right;">2.9106247</td>
<td style="text-align: right;">5.8329203</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000001</td>
<td style="text-align: right;">11.2597144</td>
<td style="text-align: right;">22.6951696</td>
</tr>
<tr class="even">
<td style="text-align: left;">CESD_2</td>
<td style="text-align: right;">-0.2347979</td>
<td style="text-align: right;">0.0531285</td>
<td style="text-align: right;">-4.4194338</td>
<td style="text-align: right;">0.0000120</td>
<td style="text-align: right;">0.0000720</td>
<td style="text-align: right;">-0.3391653</td>
<td style="text-align: right;">-0.1304305</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User:CESD_2</td>
<td style="text-align: right;">0.1099198</td>
<td style="text-align: right;">0.1509341</td>
<td style="text-align: right;">0.7282635</td>
<td style="text-align: right;">0.4667728</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-0.1865801</td>
<td style="text-align: right;">0.4064197</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User:CESD_2</td>
<td style="text-align: right;">-0.8029584</td>
<td style="text-align: right;">0.1301049</td>
<td style="text-align: right;">-6.1716247</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-1.0585407</td>
<td style="text-align: right;">-0.5473761</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The overall model is highly significant (F~(5, 532)~ = 19.84, p &lt; 0.0001, adjusted R-squared = 0.149).</p>
<p>For never hard drug users, there was a significant relationship between depression and mental QOL (t = -4.42, p &lt; 0.0001). Specifically, for never hard drug users, a 1 point increase in depression score was associated with 0.23 point decrease in mental QOL (95% CI: -0.34 to -0.13).</p>
<p>Current hard drug users did not differ significantly from never hard drug users while controlling for the other variables in the model (t = -1.05, p-adjusted = 0.89, 95% CI: -8.74 to 2.66). Previous hard drug users had on average a 16.98 higher increase in mental QOL compared to never hard drug users (at low depression scores?) (t = 2.91062, p-adjusted &lt; 0.0001.</p>
<p>The slope for depression on mental QOL did not differ between current and never hard drug users (t = 0.73, p-adjusted = 1.00, 95% CI: -0.19 to 0.41). However, the slope for depression on mental QOL did differ between previous and never hard drug users (t = -6.17, p-adjusted &lt; 0.0001). For each point increase in depression, the mental QOL score for previous hard drug users decreases an additional 0.80 points compared to never hard drug users (95% CI: -1.06 to -0.55).</p>
<p>Previous hard drug users have an increase of approximately 16.98 units in mental QOL, holding all other variables constant. This difference is statistically significant, suggesting that prior hard drug use is associated with a considerably higher outcome measure in this model. (It’s significant because we’re not account for the interaction with this estimate.)</p>
<p>Compare slopes for previous users.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb465"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb465-2"><a href="#cb465-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb465-3"><a href="#cb465-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-4"><a href="#cb465-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb465-5"><a href="#cb465-5" aria-hidden="true" tabindex="-1"></a>model_MENT_sub2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> CESD_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>CESD_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb465-6"><a href="#cb465-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-7"><a href="#cb465-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb465-8"><a href="#cb465-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_sub2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + CESD_2 + hard_drugs_grp * 
    CESD_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-34.141  -6.071  -1.545   5.758  37.779 

Coefficients:
                                  Estimate Std. Error t value
(Intercept)                        22.0828     2.7937   7.904
hard_drugs_grpNever User          -16.9774     2.9106  -5.833
hard_drugs_grpCurrent User        -20.0191     3.9455  -5.074
CESD_2                             -1.0378     0.1188  -8.738
hard_drugs_grpNever User:CESD_2     0.8030     0.1301   6.172
hard_drugs_grpCurrent User:CESD_2   0.9129     0.1846   4.946
                                              Pr(&gt;|t|)    
(Intercept)                         0.0000000000000156 ***
hard_drugs_grpNever User            0.0000000094634100 ***
hard_drugs_grpCurrent User          0.0000005392622284 ***
CESD_2                            &lt; 0.0000000000000002 ***
hard_drugs_grpNever User:CESD_2     0.0000000013409353 ***
hard_drugs_grpCurrent User:CESD_2   0.0000010165357517 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.36 on 532 degrees of freedom
  (12 observations deleted due to missingness)
Multiple R-squared:  0.1571,    Adjusted R-squared:  0.1492 
F-statistic: 19.84 on 5 and 532 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb467"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb467-2"><a href="#cb467-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_MENT_sub2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">22.0827808</td>
<td style="text-align: right;">2.7937019</td>
<td style="text-align: right;">7.904487</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">16.5947401</td>
<td style="text-align: right;">27.5708214</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">-16.9774420</td>
<td style="text-align: right;">2.9106247</td>
<td style="text-align: right;">-5.832920</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000001</td>
<td style="text-align: right;">-22.6951696</td>
<td style="text-align: right;">-11.2597144</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">-20.0190937</td>
<td style="text-align: right;">3.9454549</td>
<td style="text-align: right;">-5.073963</td>
<td style="text-align: right;">0.0000005</td>
<td style="text-align: right;">0.0000032</td>
<td style="text-align: right;">-27.7696761</td>
<td style="text-align: right;">-12.2685114</td>
</tr>
<tr class="even">
<td style="text-align: left;">CESD_2</td>
<td style="text-align: right;">-1.0377563</td>
<td style="text-align: right;">0.1187629</td>
<td style="text-align: right;">-8.738048</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-1.2710581</td>
<td style="text-align: right;">-0.8044544</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpNever User:CESD_2</td>
<td style="text-align: right;">0.8029584</td>
<td style="text-align: right;">0.1301049</td>
<td style="text-align: right;">6.171625</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.5473761</td>
<td style="text-align: right;">1.0585407</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User:CESD_2</td>
<td style="text-align: right;">0.9128781</td>
<td style="text-align: right;">0.1845619</td>
<td style="text-align: right;">4.946190</td>
<td style="text-align: right;">0.0000010</td>
<td style="text-align: right;">0.0000061</td>
<td style="text-align: right;">0.5503186</td>
<td style="text-align: right;">1.2754377</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>For previous hard drug users, there was a significant relationship between depression and mental QOL (t = -8.74, p &lt; 0.0001). Specifically, for previous hard drug users, a 1 point increase in depression score was associated with a 1.04 point decrease in mental QOL (95% CI: -1.27 to -0.80). That is nearly 5 times more of a decrease compared to never users!</p>
<p>Compare slopes for current users.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb468"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Current User"</span>)</span>
<span id="cb468-3"><a href="#cb468-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-4"><a href="#cb468-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb468-5"><a href="#cb468-5" aria-hidden="true" tabindex="-1"></a>model_MENT_sub3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> CESD_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>CESD_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb468-6"><a href="#cb468-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-7"><a href="#cb468-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb468-8"><a href="#cb468-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_sub3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + CESD_2 + hard_drugs_grp * 
    CESD_2, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-34.141  -6.071  -1.545   5.758  37.779 

Coefficients:
                                   Estimate Std. Error t value    Pr(&gt;|t|)    
(Intercept)                          2.0637     2.7860   0.741       0.459    
hard_drugs_grpPrevious User         20.0191     3.9455   5.074 0.000000539 ***
hard_drugs_grpNever User             3.0417     2.9032   1.048       0.295    
CESD_2                              -0.1249     0.1413  -0.884       0.377    
hard_drugs_grpPrevious User:CESD_2  -0.9129     0.1846  -4.946 0.000001017 ***
hard_drugs_grpNever User:CESD_2     -0.1099     0.1509  -0.728       0.467    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.36 on 532 degrees of freedom
  (12 observations deleted due to missingness)
Multiple R-squared:  0.1571,    Adjusted R-squared:  0.1492 
F-statistic: 19.84 on 5 and 532 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb470"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_MENT_sub3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">2.0636870</td>
<td style="text-align: right;">2.7860086</td>
<td style="text-align: right;">0.7407325</td>
<td style="text-align: right;">0.4591825</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-3.4092406</td>
<td style="text-align: right;">7.5366146</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">20.0190937</td>
<td style="text-align: right;">3.9454549</td>
<td style="text-align: right;">5.0739634</td>
<td style="text-align: right;">0.0000005</td>
<td style="text-align: right;">0.0000032</td>
<td style="text-align: right;">12.2685114</td>
<td style="text-align: right;">27.7696761</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">3.0416518</td>
<td style="text-align: right;">2.9032412</td>
<td style="text-align: right;">1.0476745</td>
<td style="text-align: right;">0.2952643</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-2.6615715</td>
<td style="text-align: right;">8.7448750</td>
</tr>
<tr class="even">
<td style="text-align: left;">CESD_2</td>
<td style="text-align: right;">-0.1248781</td>
<td style="text-align: right;">0.1412744</td>
<td style="text-align: right;">-0.8839402</td>
<td style="text-align: right;">0.3771278</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-0.4024022</td>
<td style="text-align: right;">0.1526460</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpPrevious User:CESD_2</td>
<td style="text-align: right;">-0.9128781</td>
<td style="text-align: right;">0.1845619</td>
<td style="text-align: right;">-4.9461896</td>
<td style="text-align: right;">0.0000010</td>
<td style="text-align: right;">0.0000061</td>
<td style="text-align: right;">-1.2754377</td>
<td style="text-align: right;">-0.5503186</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User:CESD_2</td>
<td style="text-align: right;">-0.1099198</td>
<td style="text-align: right;">0.1509341</td>
<td style="text-align: right;">-0.7282635</td>
<td style="text-align: right;">0.4667728</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-0.4064197</td>
<td style="text-align: right;">0.1865801</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>For current users, the relationship between depression and mental QOL is not significant (t = 0.88, p = 0.377, 95% CI: -0.40 to 0.15).</p>
<p>The slope for depression on mental QOL depended on hard drug use (t = -4.946, p-adjusted &lt; 0.0001). For each point increase in depression, the mental QOL score for previous hard drug users decreased by an additional 0.91 points compared to current hard drug users (95%: -1.28 to -0.55).</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<section id="overall-model-4" class="level3">
<h3 class="anchored" data-anchor-id="overall-model-4">Overall Model</h3>
<p>The overall model is highly significant (F~(5, 532)~ = 19.84, p &lt; 0.0001, adjusted R-squared = 0.149).</p>
<p>The relationship between depression and mental QOL depended on hard drug use.</p>
</section>
<section id="depression-slopes-within-hard-drug-use-group" class="level3">
<h3 class="anchored" data-anchor-id="depression-slopes-within-hard-drug-use-group">Depression Slopes <strong>within</strong> Hard Drug Use Group</h3>
<section id="depression-for-current-hard-drug-users" class="level4">
<h4 class="anchored" data-anchor-id="depression-for-current-hard-drug-users">Depression for Current Hard Drug Users</h4>
<p>For current hard drug users, the relationship between depression and mental QOL is not significant (t = 0.88, p = 0.377, 95% CI: -0.40 to 0.15).</p>
</section>
<section id="depression-for-previous-hard-drug-users" class="level4">
<h4 class="anchored" data-anchor-id="depression-for-previous-hard-drug-users">Depression for Previous Hard Drug Users</h4>
<p>For previous hard drug users, there was a significant relationship between depression and mental QOL (t = -8.74, p &lt; 0.0001). Specifically, a 1 point increase in depression score was associated with a 1.04 point decrease in mental QOL for previous hard drug users (95% CI: -1.27 to -0.80). That is nearly 5 times more of a decrease compared to never users!</p>
</section>
<section id="depression-for-never-hard-drug-users" class="level4">
<h4 class="anchored" data-anchor-id="depression-for-never-hard-drug-users">Depression for Never Hard Drug Users</h4>
<p>For never hard drug users, there was a significant relationship between depression and mental QOL (t = -4.42, p &lt; 0.0001). Specifically, a 1 point increase in depression score was associated with 0.23 point decrease in mental QOL for never hard drug users (95% CI: -0.34 to -0.13).</p>
</section>
</section>
<section id="depression-slopes-between-hard-drug-use-group" class="level3">
<h3 class="anchored" data-anchor-id="depression-slopes-between-hard-drug-use-group">Depression Slopes <strong>between</strong> Hard Drug use Group</h3>
<p>The slopes for the relationship between depression and QOL differed based on hard drug use.</p>
<p>For each point increase in depression, the mental QOL score for previous hard drug users decreased an additional 0.80 points compared to never hard drug users (t = -6.17, p-adjusted &lt; 0.0001, 95% CI: -1.06 to -0.55).</p>
<p>Additionally, for each point increase in depression, the mental QOL score for previous hard drug users decreased by an additional 0.91 points compared to current hard drug users (t = -4.946, p-adjusted &lt; 0.0001, 95%: -1.28 to -0.55).</p>
<p>The slope for depression on mental QOL did not differ between current and never hard drug users (t = 0.73, p-adjusted = 1.00, 95% CI: -0.19 to 0.41).</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<p>The plot below is helpful in interpreting the interaction between hard drug use and depression on mental QOL.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb471"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of mental QOLchange by depression score, colored by hard drug use group.</span></span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_wide_2, <span class="fu">aes</span>(<span class="at">x =</span> CESD_2, <span class="at">y =</span> AGG_MENT_CHANGE, <span class="at">color =</span> hard_drugs_grp)) <span class="sc">+</span> </span>
<span id="cb471-3"><a href="#cb471-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb471-4"><a href="#cb471-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb471-5"><a href="#cb471-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb471-6"><a href="#cb471-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mental QOL Change by Depression at 2 years, Colored by Hard Drug Use Group"</span>,</span>
<span id="cb471-7"><a href="#cb471-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mental QOL Change"</span>,</span>
<span id="cb471-8"><a href="#cb471-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Depression Score"</span>) <span class="sc">+</span> </span>
<span id="cb471-9"><a href="#cb471-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 12 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 12 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-255-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here we can see the key relationships found in the model.</p>
<p>There is a negative relationship between depression and mental QOL scores at each level of drug usage. However, this relationship is much stronger for previous hard drug users, where every 1 point increase in depression scores is associated with an almost 5x greater decrease in mental QOL score over 2 years (~1 point for previous users compared to ~0.2 points for current and never user).</p>
<p>And most importantly the slopes differed significantly by hard drug use group, with previous hard drug users having an additional 0.8 or 0.9 greater decrease in mental QOL score compared to never and current hard drug users, respectively.</p>
<p>Thus, we used this relationship as <strong>further evidence that previous hard drug users are a vulnerable group</strong>. They are susceptible to losses in mental QOL if they have low adherence to the treatment regiment, and depression has a greater impact on the mental QOL of previous hard drug users compared to current and never hard drug users.</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</div>
</div>
</div>
</div>
<div id="tabset-20-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-4-tab">
<p>We found a dual interaction where the impact of hard drug use on mental QOL depended on both adherence to the treatment regimen and depression.</p>
<p>For adherence, those with previous hard drug use had a decrease in mental QOL if and only if they had low adherence to the treatment regiment.</p>
<p>For depression, previous hard drug users had a larger decrease in mental QOL compared to never and current hard drug users.</p>
<p>Thus, we used both of these relationships as <strong>strong evidence that previous hard drug users are a vulnerable population</strong>. They are susceptible to losses in mental QOL if they have low adherence to the treatment regiment, and depression has a greater impact on their mental QOL compared to current and never hard drug users.</p>
<p>This finding has great clinical relevance for the treatment of HIV in hard drug users. Specifically, extra efforts should be made to help previous hard drug users in two ways: One, adherence appears to serve as a buffer for previous hard drug users in the relationship between hard drug use and mental QOL. Efforts to increase adherence should therefore be made to help patients receive this ameliorative effect. Two, previous hard drug users do not have the coping mechanism of heroin or opiates available to them to buffer against the impact of adverse effects from ART, and thus extra aid perhaps in the form of increased therapy should be provided to these patients to provide them with alternate coping strategies.</p>
<p><a href="#Data_Analysis">Top of Tabset</a></p>
</div>
<div id="tabset-20-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-5-tab">
<p>Just for completion’s sake, we can run a regression predicting depression score based on the interaction between hard drug use and adherence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb475"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb475-2"><a href="#cb475-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb475-3"><a href="#cb475-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-4"><a href="#cb475-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb475-5"><a href="#cb475-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb475-6"><a href="#cb475-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-7"><a href="#cb475-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on mental QOL change by hard drugs group, full model</span></span>
<span id="cb475-8"><a href="#cb475-8" aria-hidden="true" tabindex="-1"></a>model_MENT_full1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(CESD_2 <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW<span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb475-9"><a href="#cb475-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-10"><a href="#cb475-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb475-11"><a href="#cb475-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_full1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = CESD_2 ~ hard_drugs_grp + ADH_HIGHVSLOW + hard_drugs_grp * 
    ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.679  -8.508  -2.508   6.492  38.492 

Coefficients:
                                                        Estimate Std. Error
(Intercept)                                               13.750      1.848
hard_drugs_grpCurrent User                                 4.250      5.544
hard_drugs_grpPrevious User                               30.250      4.651
ADH_HIGHVSLOWHigh Adherence                               -2.242      1.921
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     0.921      5.742
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -26.708      4.964
                                                        t value
(Intercept)                                               7.440
hard_drugs_grpCurrent User                                0.767
hard_drugs_grpPrevious User                               6.504
ADH_HIGHVSLOWHigh Adherence                              -1.167
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    0.160
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  -5.380
                                                                 Pr(&gt;|t|)    
(Intercept)                                             0.000000000000411 ***
hard_drugs_grpCurrent User                                          0.444    
hard_drugs_grpPrevious User                             0.000000000181686 ***
ADH_HIGHVSLOWHigh Adherence                                         0.244    
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence              0.873    
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence 0.000000111914533 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 10.45 on 528 degrees of freedom
  (16 observations deleted due to missingness)
Multiple R-squared:  0.1175,    Adjusted R-squared:  0.1091 
F-statistic: 14.06 on 5 and 528 DF,  p-value: 0.0000000000006409</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb477"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use interactions package to plot interaction</span></span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat_plot</span>(model_MENT_full1, <span class="at">pred =</span> hard_drugs_grp, <span class="at">modx =</span> ADH_HIGHVSLOW, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">colors =</span> <span class="st">"Pastel2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-257-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The interaction is significant, and we can see that previous hard drug users with low adherence had higher depression scores at year 2, and that those with high adherance were buffered from this effect.</p>
<p>The fact that depression and mental QOL both have this relationship, and are similar constructs, lends credence to the likelihood that this is a real relationship, and a strong one at that.</p>
</div>
</div>
</div>
</section>
<section id="Phys" class="level2">
<h2 class="anchored" data-anchor-id="Phys">Physical QOL Score</h2>
<p>The fourth outcome variable of interest was change physcal QOL over the first 2 years of the study.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">Full Model</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">Model Selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false">Interpretation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-4" role="tab" aria-controls="tabset-21-4" aria-selected="false">Visualizing the Interaction</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<p>The candidate variables for inclusion in our model predicting <code>AGG_PHYS_CHANGE</code> were <code>hard_drugs_grp</code>, <code>ADH_HIGHVSLOW</code>, <code>FRP_2</code>, <code>CESD_2</code>, <code>BMI</code>, and <code>DKGRP_2</code></p>
<p>We will remove <code>BMI</code> based on the missing values issue identified in the mental QOL model.</p>
<p>Let’s run the full model including all those variables and the interaction between hard drug use group and adherence high vs low.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb478"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb478-2"><a href="#cb478-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb478-3"><a href="#cb478-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-4"><a href="#cb478-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-5"><a href="#cb478-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb478-6"><a href="#cb478-6" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb478-7"><a href="#cb478-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-8"><a href="#cb478-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on Physical QOL change</span></span>
<span id="cb478-9"><a href="#cb478-9" aria-hidden="true" tabindex="-1"></a>model_PHYS_full1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2 <span class="sc">+</span> CESD_2 <span class="sc">+</span> DKGRP_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb478-10"><a href="#cb478-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-11"><a href="#cb478-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the model</span></span>
<span id="cb478-12"><a href="#cb478-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_PHYS_full1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    FRP_2 + CESD_2 + DKGRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, 
    data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-32.215  -3.939   0.013   3.673  31.134 

Coefficients:
                                                          Estimate Std. Error
(Intercept)                                              -4.584386   1.612457
hard_drugs_grpCurrent User                              -10.266222   4.130948
hard_drugs_grpPrevious User                             -11.067396   3.633010
ADH_HIGHVSLOWHigh Adherence                               3.209555   1.451052
FRP_2Yes                                                -12.656122   1.481490
CESD_2                                                    0.007245   0.033055
DKGRP_21-3 drinks/week                                    0.651656   0.906606
DKGRP_24-13 drinks/week                                   2.333646   1.035604
DKGRP_2&gt;13 drinks/week                                   -0.398119   1.636008
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    6.472409   4.284786
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  12.329569   3.847471
                                                        t value
(Intercept)                                              -2.843
hard_drugs_grpCurrent User                               -2.485
hard_drugs_grpPrevious User                              -3.046
ADH_HIGHVSLOWHigh Adherence                               2.212
FRP_2Yes                                                 -8.543
CESD_2                                                    0.219
DKGRP_21-3 drinks/week                                    0.719
DKGRP_24-13 drinks/week                                   2.253
DKGRP_2&gt;13 drinks/week                                   -0.243
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    1.511
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.205
                                                                    Pr(&gt;|t|)
(Intercept)                                                          0.00465
hard_drugs_grpCurrent User                                           0.01327
hard_drugs_grpPrevious User                                          0.00244
ADH_HIGHVSLOWHigh Adherence                                          0.02742
FRP_2Yes                                                &lt; 0.0000000000000002
CESD_2                                                               0.82659
DKGRP_21-3 drinks/week                                               0.47260
DKGRP_24-13 drinks/week                                              0.02466
DKGRP_2&gt;13 drinks/week                                               0.80783
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence               0.13152
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence              0.00144
                                                           
(Intercept)                                             ** 
hard_drugs_grpCurrent User                              *  
hard_drugs_grpPrevious User                             ** 
ADH_HIGHVSLOWHigh Adherence                             *  
FRP_2Yes                                                ***
CESD_2                                                     
DKGRP_21-3 drinks/week                                     
DKGRP_24-13 drinks/week                                 *  
DKGRP_2&gt;13 drinks/week                                     
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.757 on 510 degrees of freedom
  (29 observations deleted due to missingness)
Multiple R-squared:  0.2022,    Adjusted R-squared:  0.1865 
F-statistic: 12.92 on 10 and 510 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb480"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the VIFs</span></span>
<span id="cb480-2"><a href="#cb480-2" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_PHYS_full1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>there are higher-order terms (interactions) in this model
consider setting type = 'predictor'; see ?vif</code></pre>
</div>
<div class="sourceCode cell-code" id="cb482"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(vif_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GVIF</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GVIF^(1/(2*Df))</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grp</td>
<td style="text-align: right;">125.173912</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3.344864</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOW</td>
<td style="text-align: right;">1.321733</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.149667</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FRP_2</td>
<td style="text-align: right;">1.031224</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.015492</td>
</tr>
<tr class="even">
<td style="text-align: left;">CESD_2</td>
<td style="text-align: right;">1.157182</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.075724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DKGRP_2</td>
<td style="text-align: right;">1.052687</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.008594</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grp:ADH_HIGHVSLOW</td>
<td style="text-align: right;">124.834338</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3.342593</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The overall model is highly significant (F<sub>(10,510)</sub> = 12.92, p &lt; 0.0001, Adjusted R-squared = 0.187).</p>
<p>We have some nice significant covariates, but it looks like <code>FRP_2</code> is the main driver for this model.</p>
<p>We might have another double interaction situation like we did for the mental QOL model. Let’s create an interaction term between <code>hard_drugs_grp</code> and <code>FRP_2</code> and run it through backwards elimination to select our final model based on BIC.</p>
<section id="backwards-elimination-2" class="level3">
<h3 class="anchored" data-anchor-id="backwards-elimination-2">Backwards Elimination</h3>
<p>We will perform model selection using backwards elimination and BIC to select the most parsimonious model.</p>
<p>A delta BIC of &gt;2 indicates a difference in model performance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb483"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb483-2"><a href="#cb483-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb483-3"><a href="#cb483-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb483-4"><a href="#cb483-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb483-5"><a href="#cb483-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb483-6"><a href="#cb483-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb483-7"><a href="#cb483-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on physical QOL change</span></span>
<span id="cb483-8"><a href="#cb483-8" aria-hidden="true" tabindex="-1"></a>model_PHYS_full1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2 <span class="sc">+</span> CESD_2 <span class="sc">+</span> DKGRP_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>FRP_2, <span class="at">data =</span> data_wide_2)</span>
<span id="cb483-9"><a href="#cb483-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb483-10"><a href="#cb483-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform backward elimination regression selection based on BIC </span></span>
<span id="cb483-11"><a href="#cb483-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_backward_sbc</span>(model_PHYS_full1, <span class="at">include =</span> <span class="fu">c</span>(<span class="st">"hard_drugs_grp"</span>, <span class="st">"ADH_HIGHVSLOW"</span>, <span class="st">"hard_drugs_grp:ADH_HIGHVSLOW"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                                    Stepwise Summary                                    
--------------------------------------------------------------------------------------
Step    Variable                  AIC         SBC         SBIC        R2       Adj. R2 
--------------------------------------------------------------------------------------
 0      Full Model              3622.820    3682.401    2164.416    0.21322    0.19463 
 1      DKGRP_2                 3623.753    3670.567    2159.814    0.20268    0.18864 
 2      CESD_2                  3621.873    3664.430    2147.887    0.20250    0.19004 
 3      hard_drugs_grp:FRP_2    3625.025    3659.071    2143.951    0.19147    0.18204 
--------------------------------------------------------------------------------------

Final Model Output 
------------------

                         Model Summary                           
----------------------------------------------------------------
R                       0.438       RMSE                  7.726 
R-Squared               0.191       MSE                  59.694 
Adj. R-Squared          0.182       Coef. Var          -408.677 
Pred R-Squared          0.174       AIC                3625.025 
MAE                     5.577       SBC                3659.071 
----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                ANOVA                                  
----------------------------------------------------------------------
                 Sum of                                               
                Squares         DF    Mean Square      F         Sig. 
----------------------------------------------------------------------
Regression     7365.193          6       1227.532    20.287    0.0000 
Residual      31100.658        514         60.507                     
Total         38465.851        520                                    
----------------------------------------------------------------------

                                                         Parameter Estimates                                                           
--------------------------------------------------------------------------------------------------------------------------------------
                                                  model       Beta    Std. Error    Std. Beta      t        Sig       lower     upper 
--------------------------------------------------------------------------------------------------------------------------------------
                                            (Intercept)     -3.611         1.398                 -2.583    0.010     -6.357    -0.864 
                             hard_drugs_grpCurrent User     -9.617         4.133       -0.352    -2.327    0.020    -17.736    -1.497 
                            hard_drugs_grpPrevious User    -10.860         3.470       -0.351    -3.130    0.002    -17.676    -4.043 
                            ADH_HIGHVSLOWHigh Adherence      3.202         1.452        0.100     2.205    0.028      0.349     6.055 
                                               FRP_2Yes    -12.737         1.468       -0.345    -8.674    0.000    -15.622    -9.852 
 hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence      5.711         4.286        0.203     1.332    0.183     -2.710    14.132 
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence     12.158         3.713        0.368     3.274    0.001      4.863    19.453 
--------------------------------------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<p>The final model selected for <code>AGG_PHYS_CHANGE</code> includes the PEVs of <code>hard_drugs_grp</code> and <code>ADH_HIGHVSLOW</code> and their interaction term, and <code>FRP_2</code> as a precision variable. Luckily we only have to interpret one interaction for this model!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb485"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb485-3"><a href="#cb485-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-4"><a href="#cb485-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-5"><a href="#cb485-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb485-6"><a href="#cb485-6" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb485-7"><a href="#cb485-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-8"><a href="#cb485-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on Physical QOL change</span></span>
<span id="cb485-9"><a href="#cb485-9" aria-hidden="true" tabindex="-1"></a>model_PHYS_full1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2 <span class="sc">+</span> CESD_2 <span class="sc">+</span> DKGRP_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb485-10"><a href="#cb485-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-11"><a href="#cb485-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the model</span></span>
<span id="cb485-12"><a href="#cb485-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_PHYS_full1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    FRP_2 + CESD_2 + DKGRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, 
    data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-32.215  -3.939   0.013   3.673  31.134 

Coefficients:
                                                          Estimate Std. Error
(Intercept)                                              -4.584386   1.612457
hard_drugs_grpCurrent User                              -10.266222   4.130948
hard_drugs_grpPrevious User                             -11.067396   3.633010
ADH_HIGHVSLOWHigh Adherence                               3.209555   1.451052
FRP_2Yes                                                -12.656122   1.481490
CESD_2                                                    0.007245   0.033055
DKGRP_21-3 drinks/week                                    0.651656   0.906606
DKGRP_24-13 drinks/week                                   2.333646   1.035604
DKGRP_2&gt;13 drinks/week                                   -0.398119   1.636008
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    6.472409   4.284786
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence  12.329569   3.847471
                                                        t value
(Intercept)                                              -2.843
hard_drugs_grpCurrent User                               -2.485
hard_drugs_grpPrevious User                              -3.046
ADH_HIGHVSLOWHigh Adherence                               2.212
FRP_2Yes                                                 -8.543
CESD_2                                                    0.219
DKGRP_21-3 drinks/week                                    0.719
DKGRP_24-13 drinks/week                                   2.253
DKGRP_2&gt;13 drinks/week                                   -0.243
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    1.511
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.205
                                                                    Pr(&gt;|t|)
(Intercept)                                                          0.00465
hard_drugs_grpCurrent User                                           0.01327
hard_drugs_grpPrevious User                                          0.00244
ADH_HIGHVSLOWHigh Adherence                                          0.02742
FRP_2Yes                                                &lt; 0.0000000000000002
CESD_2                                                               0.82659
DKGRP_21-3 drinks/week                                               0.47260
DKGRP_24-13 drinks/week                                              0.02466
DKGRP_2&gt;13 drinks/week                                               0.80783
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence               0.13152
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence              0.00144
                                                           
(Intercept)                                             ** 
hard_drugs_grpCurrent User                              *  
hard_drugs_grpPrevious User                             ** 
ADH_HIGHVSLOWHigh Adherence                             *  
FRP_2Yes                                                ***
CESD_2                                                     
DKGRP_21-3 drinks/week                                     
DKGRP_24-13 drinks/week                                 *  
DKGRP_2&gt;13 drinks/week                                     
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.757 on 510 degrees of freedom
  (29 observations deleted due to missingness)
Multiple R-squared:  0.2022,    Adjusted R-squared:  0.1865 
F-statistic: 12.92 on 10 and 510 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb487"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb487-2"><a href="#cb487-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb487-3"><a href="#cb487-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-4"><a href="#cb487-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on Physical QOL change by hard drugs group, full model</span></span>
<span id="cb487-5"><a href="#cb487-5" aria-hidden="true" tabindex="-1"></a>model_PHYS_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb487-6"><a href="#cb487-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-7"><a href="#cb487-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Exmamine the summary</span></span>
<span id="cb487-8"><a href="#cb487-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_PHYS_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-36.596  -3.832   0.574   4.155  33.175 

Coefficients:
                                                        Estimate Std. Error
(Intercept)                                               -3.964      1.443
hard_drugs_grpCurrent User                                -9.263      4.389
hard_drugs_grpPrevious User                              -10.506      3.679
ADH_HIGHVSLOWHigh Adherence                                2.890      1.503
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     4.642      4.546
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   11.967      3.928
                                                        t value Pr(&gt;|t|)   
(Intercept)                                              -2.747  0.00622 **
hard_drugs_grpCurrent User                               -2.110  0.03529 * 
hard_drugs_grpPrevious User                              -2.856  0.00447 **
ADH_HIGHVSLOWHigh Adherence                               1.923  0.05498 . 
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    1.021  0.30771   
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.046  0.00243 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.29 on 526 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.07391,   Adjusted R-squared:  0.06511 
F-statistic: 8.396 on 5 and 526 DF,  p-value: 0.0000001181</code></pre>
</div>
<div class="sourceCode cell-code" id="cb489"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use interactions package to plot interaction</span></span>
<span id="cb489-2"><a href="#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat_plot</span>(model_PHYS_full, <span class="at">pred =</span> hard_drugs_grp, <span class="at">modx =</span> ADH_HIGHVSLOW, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">colors =</span> <span class="st">"Pastel2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-262-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><a href="#Phys">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<p>Let’s investigate the key relationships in the final model for <code>AGG_PHYS_CHANGE</code> as determined through backwards selection.</p>
<p>First let’s look at the impact of hard drug use on physical QOL at low adherence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb490"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb490-2"><a href="#cb490-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb490-3"><a href="#cb490-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-4"><a href="#cb490-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb490-5"><a href="#cb490-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb490-6"><a href="#cb490-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-7"><a href="#cb490-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on phys QOL</span></span>
<span id="cb490-8"><a href="#cb490-8" aria-hidden="true" tabindex="-1"></a>model_PHYS_final1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb490-9"><a href="#cb490-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-10"><a href="#cb490-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb490-11"><a href="#cb490-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_PHYS_final1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-33.074  -4.227  -0.026   3.800  32.493 

Coefficients:
                                                        Estimate Std. Error
(Intercept)                                               -3.578      1.351
hard_drugs_grpCurrent User                                -9.650      4.106
hard_drugs_grpPrevious User                              -10.893      3.442
ADH_HIGHVSLOWHigh Adherence                                3.185      1.406
FRP_2Yes                                                 -12.756      1.463
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     5.713      4.255
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   12.309      3.675
                                                        t value
(Intercept)                                              -2.648
hard_drugs_grpCurrent User                               -2.350
hard_drugs_grpPrevious User                              -3.164
ADH_HIGHVSLOWHigh Adherence                               2.265
FRP_2Yes                                                 -8.719
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence    1.343
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   3.349
                                                                    Pr(&gt;|t|)
(Intercept)                                                         0.008328
hard_drugs_grpCurrent User                                          0.019144
hard_drugs_grpPrevious User                                         0.001644
ADH_HIGHVSLOWHigh Adherence                                         0.023912
FRP_2Yes                                                &lt; 0.0000000000000002
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence              0.179911
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence             0.000868
                                                           
(Intercept)                                             ** 
hard_drugs_grpCurrent User                              *  
hard_drugs_grpPrevious User                             ** 
ADH_HIGHVSLOWHigh Adherence                             *  
FRP_2Yes                                                ***
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence     
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.756 on 525 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.1911,    Adjusted R-squared:  0.1818 
F-statistic: 20.67 on 6 and 525 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb492"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb492-2"><a href="#cb492-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_PHYS_final1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-3.577634</td>
<td style="text-align: right;">1.350818</td>
<td style="text-align: right;">-2.648494</td>
<td style="text-align: right;">0.0083285</td>
<td style="text-align: right;">0.0582993</td>
<td style="text-align: right;">-6.2313069</td>
<td style="text-align: right;">-0.9239609</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">-9.649910</td>
<td style="text-align: right;">4.106380</td>
<td style="text-align: right;">-2.349980</td>
<td style="text-align: right;">0.0191437</td>
<td style="text-align: right;">0.1340061</td>
<td style="text-align: right;">-17.7168637</td>
<td style="text-align: right;">-1.5829561</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">-10.892966</td>
<td style="text-align: right;">3.442355</td>
<td style="text-align: right;">-3.164394</td>
<td style="text-align: right;">0.0016441</td>
<td style="text-align: right;">0.0115089</td>
<td style="text-align: right;">-17.6554473</td>
<td style="text-align: right;">-4.1304844</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">3.184855</td>
<td style="text-align: right;">1.406039</td>
<td style="text-align: right;">2.265126</td>
<td style="text-align: right;">0.0239116</td>
<td style="text-align: right;">0.1673814</td>
<td style="text-align: right;">0.4227021</td>
<td style="text-align: right;">5.9470082</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FRP_2Yes</td>
<td style="text-align: right;">-12.755668</td>
<td style="text-align: right;">1.462953</td>
<td style="text-align: right;">-8.719122</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-15.6296286</td>
<td style="text-align: right;">-9.8817067</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">5.713316</td>
<td style="text-align: right;">4.254723</td>
<td style="text-align: right;">1.342817</td>
<td style="text-align: right;">0.1799114</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-2.6450571</td>
<td style="text-align: right;">14.0716887</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">12.309256</td>
<td style="text-align: right;">3.675079</td>
<td style="text-align: right;">3.349385</td>
<td style="text-align: right;">0.0008681</td>
<td style="text-align: right;">0.0060767</td>
<td style="text-align: right;">5.0895895</td>
<td style="text-align: right;">19.5289225</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The overall model is highly significant (F~(6, 525)~ = 20.67, p &lt; 0.0001, adjusted R-squared = 0.1818).</p>
<p>At low adherence, previous hard drug users had on average a 10.89 point decrease in physical QOL compared to never hard drug users (t = -3.16, p-adjusted = 0.00493, 95% CI: -17.66 to -4.13). Current hard drug users did not differ significantly from never hard drug users at low adherence (t = -2.35, p-adjusted =0.0574, 95% CI: -17.72 to -1.58), although with a larger sample size that could become significant.</p>
<p>For never hard drug users, those with high adherence had a 3.19 point increase in physical QOL compared to those with low adherence (t = 2.27, p = 0.0239).</p>
<p>Compare hard drug use groups at high adherence</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb493"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb493-2"><a href="#cb493-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Never User"</span>)</span>
<span id="cb493-3"><a href="#cb493-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-4"><a href="#cb493-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb493-5"><a href="#cb493-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"High Adherence"</span>)</span>
<span id="cb493-6"><a href="#cb493-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-7"><a href="#cb493-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on phys QOL</span></span>
<span id="cb493-8"><a href="#cb493-8" aria-hidden="true" tabindex="-1"></a>model_PHYS_final2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb493-9"><a href="#cb493-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-10"><a href="#cb493-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb493-11"><a href="#cb493-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_PHYS_final2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-33.074  -4.227  -0.026   3.800  32.493 

Coefficients:
                                                       Estimate Std. Error
(Intercept)                                             -0.3928     0.3990
hard_drugs_grpCurrent User                              -3.9366     1.1106
hard_drugs_grpPrevious User                              1.4163     1.2872
ADH_HIGHVSLOWLow Adherence                              -3.1849     1.4060
FRP_2Yes                                               -12.7557     1.4630
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   -5.7133     4.2547
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence -12.3093     3.6751
                                                       t value
(Intercept)                                             -0.985
hard_drugs_grpCurrent User                              -3.545
hard_drugs_grpPrevious User                              1.100
ADH_HIGHVSLOWLow Adherence                              -2.265
FRP_2Yes                                                -8.719
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence   -1.343
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -3.349
                                                                   Pr(&gt;|t|)    
(Intercept)                                                        0.325315    
hard_drugs_grpCurrent User                                         0.000428 ***
hard_drugs_grpPrevious User                                        0.271705    
ADH_HIGHVSLOWLow Adherence                                         0.023912 *  
FRP_2Yes                                               &lt; 0.0000000000000002 ***
hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence              0.179911    
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence             0.000868 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.756 on 525 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.1911,    Adjusted R-squared:  0.1818 
F-statistic: 20.67 on 6 and 525 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb495"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb495-2"><a href="#cb495-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_PHYS_final2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.3927788</td>
<td style="text-align: right;">0.3989561</td>
<td style="text-align: right;">-0.9845163</td>
<td style="text-align: right;">0.3253152</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-1.176525</td>
<td style="text-align: right;">0.3909676</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">-3.9365941</td>
<td style="text-align: right;">1.1105611</td>
<td style="text-align: right;">-3.5446893</td>
<td style="text-align: right;">0.0004282</td>
<td style="text-align: right;">0.0029973</td>
<td style="text-align: right;">-6.118283</td>
<td style="text-align: right;">-1.7549047</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">1.4162901</td>
<td style="text-align: right;">1.2871848</td>
<td style="text-align: right;">1.1003005</td>
<td style="text-align: right;">0.2717054</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-1.112375</td>
<td style="text-align: right;">3.9449554</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">-3.1848551</td>
<td style="text-align: right;">1.4060388</td>
<td style="text-align: right;">-2.2651261</td>
<td style="text-align: right;">0.0239116</td>
<td style="text-align: right;">0.1673814</td>
<td style="text-align: right;">-5.947008</td>
<td style="text-align: right;">-0.4227021</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FRP_2Yes</td>
<td style="text-align: right;">-12.7556677</td>
<td style="text-align: right;">1.4629531</td>
<td style="text-align: right;">-8.7191225</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-15.629629</td>
<td style="text-align: right;">-9.8817067</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">-5.7133158</td>
<td style="text-align: right;">4.2547230</td>
<td style="text-align: right;">-1.3428173</td>
<td style="text-align: right;">0.1799114</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-14.071689</td>
<td style="text-align: right;">2.6450571</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">-12.3092560</td>
<td style="text-align: right;">3.6750790</td>
<td style="text-align: right;">-3.3493854</td>
<td style="text-align: right;">0.0008681</td>
<td style="text-align: right;">0.0060767</td>
<td style="text-align: right;">-19.528923</td>
<td style="text-align: right;">-5.0895895</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>At high adherence, current hard drug users had on average a 3.94 point decrease in physical QOL compared to never hard drug users (t = -3.545, p-adjusted = 0.00128, 95% CI: -6.12 to -1.75). Additionally, previous hard drug users did not differ significantly from never hard drug users at high adherence (t = 1.100, p-adjusted = 0.815, 95% CI: -1.11 to 3.94).</p>
<p>Change reference level to compare previous users</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb496"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb496-2"><a href="#cb496-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Previous User"</span>)</span>
<span id="cb496-3"><a href="#cb496-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-4"><a href="#cb496-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb496-5"><a href="#cb496-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb496-6"><a href="#cb496-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-7"><a href="#cb496-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on phys QOL</span></span>
<span id="cb496-8"><a href="#cb496-8" aria-hidden="true" tabindex="-1"></a>model_PHYS_final3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb496-9"><a href="#cb496-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-10"><a href="#cb496-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb496-11"><a href="#cb496-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_PHYS_final3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-33.074  -4.227  -0.026   3.800  32.493 

Coefficients:
                                                       Estimate Std. Error
(Intercept)                                             -14.471      3.166
hard_drugs_grpNever User                                 10.893      3.442
hard_drugs_grpCurrent User                                1.243      5.006
ADH_HIGHVSLOWHigh Adherence                              15.494      3.396
FRP_2Yes                                                -12.756      1.463
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    -12.309      3.675
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence   -6.596      5.258
                                                       t value
(Intercept)                                             -4.570
hard_drugs_grpNever User                                 3.164
hard_drugs_grpCurrent User                               0.248
ADH_HIGHVSLOWHigh Adherence                              4.562
FRP_2Yes                                                -8.719
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence    -3.349
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence  -1.254
                                                                   Pr(&gt;|t|)    
(Intercept)                                                      0.00000608 ***
hard_drugs_grpNever User                                           0.001644 ** 
hard_drugs_grpCurrent User                                         0.804000    
ADH_HIGHVSLOWHigh Adherence                                      0.00000631 ***
FRP_2Yes                                               &lt; 0.0000000000000002 ***
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence               0.000868 ***
hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence             0.210242    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.756 on 525 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.1911,    Adjusted R-squared:  0.1818 
F-statistic: 20.67 on 6 and 525 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb498"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb498-2"><a href="#cb498-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_PHYS_final3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-14.470600</td>
<td style="text-align: right;">3.166243</td>
<td style="text-align: right;">-4.5702741</td>
<td style="text-align: right;">0.0000061</td>
<td style="text-align: right;">0.0000426</td>
<td style="text-align: right;">-20.690662</td>
<td style="text-align: right;">-8.250537</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">10.892966</td>
<td style="text-align: right;">3.442355</td>
<td style="text-align: right;">3.1643937</td>
<td style="text-align: right;">0.0016441</td>
<td style="text-align: right;">0.0115089</td>
<td style="text-align: right;">4.130484</td>
<td style="text-align: right;">17.655447</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User</td>
<td style="text-align: right;">1.243056</td>
<td style="text-align: right;">5.006270</td>
<td style="text-align: right;">0.2482998</td>
<td style="text-align: right;">0.8039995</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-8.591726</td>
<td style="text-align: right;">11.077838</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">15.494111</td>
<td style="text-align: right;">3.396206</td>
<td style="text-align: right;">4.5621830</td>
<td style="text-align: right;">0.0000063</td>
<td style="text-align: right;">0.0000442</td>
<td style="text-align: right;">8.822290</td>
<td style="text-align: right;">22.165933</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FRP_2Yes</td>
<td style="text-align: right;">-12.755668</td>
<td style="text-align: right;">1.462953</td>
<td style="text-align: right;">-8.7191225</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-15.629629</td>
<td style="text-align: right;">-9.881707</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-12.309256</td>
<td style="text-align: right;">3.675079</td>
<td style="text-align: right;">-3.3493854</td>
<td style="text-align: right;">0.0008681</td>
<td style="text-align: right;">0.0060767</td>
<td style="text-align: right;">-19.528923</td>
<td style="text-align: right;">-5.089589</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpCurrent User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-6.595940</td>
<td style="text-align: right;">5.258100</td>
<td style="text-align: right;">-1.2544342</td>
<td style="text-align: right;">0.2102424</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-16.925439</td>
<td style="text-align: right;">3.733559</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>At low adherence, previous hard drug users did not differ significantly on change in physical QOL compared to current hard drug users (t = 0.25, p-adjusted = 1.00, 95% CI: -8.59 to 11.08).</p>
<p>For previous hard drug users, those with high adherence to the treatment regiment had on average a 15.49 point increase in physical QOL compared to those with low adherence (t = 4.56, p-adjusted &lt; 0.0001, 95% CI: 8.82 to 22.17).</p>
<p>Change the reference level to current hard drug users.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb499"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb499-1"><a href="#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb499-2"><a href="#cb499-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Current User"</span>)</span>
<span id="cb499-3"><a href="#cb499-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-4"><a href="#cb499-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb499-5"><a href="#cb499-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"Low Adherence"</span>)</span>
<span id="cb499-6"><a href="#cb499-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-7"><a href="#cb499-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on phys QOL</span></span>
<span id="cb499-8"><a href="#cb499-8" aria-hidden="true" tabindex="-1"></a>model_PHYS_final4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb499-9"><a href="#cb499-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-10"><a href="#cb499-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb499-11"><a href="#cb499-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_PHYS_final4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-33.074  -4.227  -0.026   3.800  32.493 

Coefficients:
                                                        Estimate Std. Error
(Intercept)                                              -13.228      3.878
hard_drugs_grpPrevious User                               -1.243      5.006
hard_drugs_grpNever User                                   9.650      4.106
ADH_HIGHVSLOWHigh Adherence                                8.898      4.017
FRP_2Yes                                                 -12.756      1.463
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence    6.596      5.258
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence      -5.713      4.255
                                                        t value
(Intercept)                                              -3.411
hard_drugs_grpPrevious User                              -0.248
hard_drugs_grpNever User                                  2.350
ADH_HIGHVSLOWHigh Adherence                               2.215
FRP_2Yes                                                 -8.719
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence   1.254
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence     -1.343
                                                                    Pr(&gt;|t|)
(Intercept)                                                         0.000697
hard_drugs_grpPrevious User                                         0.804000
hard_drugs_grpNever User                                            0.019144
ADH_HIGHVSLOWHigh Adherence                                         0.027180
FRP_2Yes                                                &lt; 0.0000000000000002
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence             0.210242
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence                0.179911
                                                           
(Intercept)                                             ***
hard_drugs_grpPrevious User                                
hard_drugs_grpNever User                                *  
ADH_HIGHVSLOWHigh Adherence                             *  
FRP_2Yes                                                ***
hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence    
hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.756 on 525 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.1911,    Adjusted R-squared:  0.1818 
F-statistic: 20.67 on 6 and 525 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb501"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb501-2"><a href="#cb501-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_PHYS_final4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-13.227544</td>
<td style="text-align: right;">3.877840</td>
<td style="text-align: right;">-3.4110595</td>
<td style="text-align: right;">0.0006970</td>
<td style="text-align: right;">0.0048787</td>
<td style="text-align: right;">-20.845533</td>
<td style="text-align: right;">-5.609554</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">-1.243056</td>
<td style="text-align: right;">5.006270</td>
<td style="text-align: right;">-0.2482998</td>
<td style="text-align: right;">0.8039995</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-11.077838</td>
<td style="text-align: right;">8.591726</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">9.649910</td>
<td style="text-align: right;">4.106380</td>
<td style="text-align: right;">2.3499799</td>
<td style="text-align: right;">0.0191437</td>
<td style="text-align: right;">0.1340061</td>
<td style="text-align: right;">1.582956</td>
<td style="text-align: right;">17.716864</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">8.898171</td>
<td style="text-align: right;">4.017005</td>
<td style="text-align: right;">2.2151255</td>
<td style="text-align: right;">0.0271799</td>
<td style="text-align: right;">0.1902593</td>
<td style="text-align: right;">1.006793</td>
<td style="text-align: right;">16.789549</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FRP_2Yes</td>
<td style="text-align: right;">-12.755668</td>
<td style="text-align: right;">1.462953</td>
<td style="text-align: right;">-8.7191225</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-15.629629</td>
<td style="text-align: right;">-9.881707</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">6.595940</td>
<td style="text-align: right;">5.258100</td>
<td style="text-align: right;">1.2544342</td>
<td style="text-align: right;">0.2102424</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-3.733559</td>
<td style="text-align: right;">16.925439</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpNever User:ADH_HIGHVSLOWHigh Adherence</td>
<td style="text-align: right;">-5.713316</td>
<td style="text-align: right;">4.254723</td>
<td style="text-align: right;">-1.3428173</td>
<td style="text-align: right;">0.1799114</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-14.071689</td>
<td style="text-align: right;">2.645057</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>For current hard drug users, those with high adherence had on average an 8.90 point increase in physical QOL compared to those with low adherence (t = 2.22, p = 0.027, 95% CI: 1.00 to 16.79).</p>
<p>Change reference level to high adherence to compare last group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb502"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb502-1"><a href="#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb502-2"><a href="#cb502-2" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>hard_drugs_grp<span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>hard_drugs_grp, <span class="at">ref =</span> <span class="st">"Current User"</span>)</span>
<span id="cb502-3"><a href="#cb502-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-4"><a href="#cb502-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relevel to change to the reference group to never user</span></span>
<span id="cb502-5"><a href="#cb502-5" aria-hidden="true" tabindex="-1"></a>data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW <span class="ot">&lt;-</span> <span class="fu">relevel</span>(data_wide_2<span class="sc">$</span>ADH_HIGHVSLOW, <span class="at">ref =</span> <span class="st">"High Adherence"</span>)</span>
<span id="cb502-6"><a href="#cb502-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-7"><a href="#cb502-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform regression on phys QOL</span></span>
<span id="cb502-8"><a href="#cb502-8" aria-hidden="true" tabindex="-1"></a>model_PHYS_final5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> FRP_2 <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_wide_2)</span>
<span id="cb502-9"><a href="#cb502-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-10"><a href="#cb502-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the summary</span></span>
<span id="cb502-11"><a href="#cb502-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_PHYS_final5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_PHYS_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    FRP_2 + hard_drugs_grp * ADH_HIGHVSLOW, data = data_wide_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-33.074  -4.227  -0.026   3.800  32.493 

Coefficients:
                                                       Estimate Std. Error
(Intercept)                                              -4.329      1.048
hard_drugs_grpPrevious User                               5.353      1.608
hard_drugs_grpNever User                                  3.937      1.111
ADH_HIGHVSLOWLow Adherence                               -8.898      4.017
FRP_2Yes                                                -12.756      1.463
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   -6.596      5.258
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence       5.713      4.255
                                                       t value
(Intercept)                                             -4.130
hard_drugs_grpPrevious User                              3.329
hard_drugs_grpNever User                                 3.545
ADH_HIGHVSLOWLow Adherence                              -2.215
FRP_2Yes                                                -8.719
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -1.254
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence      1.343
                                                                   Pr(&gt;|t|)    
(Intercept)                                                       0.0000421 ***
hard_drugs_grpPrevious User                                        0.000931 ***
hard_drugs_grpNever User                                           0.000428 ***
ADH_HIGHVSLOWLow Adherence                                         0.027180 *  
FRP_2Yes                                               &lt; 0.0000000000000002 ***
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence             0.210242    
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence                0.179911    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.756 on 525 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.1911,    Adjusted R-squared:  0.1818 
F-statistic: 20.67 on 6 and 525 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb504"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print useful model parameters</span></span>
<span id="cb504-2"><a href="#cb504-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_results</span>(model_PHYS_final5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_adjusted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-4.329373</td>
<td style="text-align: right;">1.048183</td>
<td style="text-align: right;">-4.130362</td>
<td style="text-align: right;">0.0000421</td>
<td style="text-align: right;">0.0002950</td>
<td style="text-align: right;">-6.388520</td>
<td style="text-align: right;">-2.270226</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User</td>
<td style="text-align: right;">5.352884</td>
<td style="text-align: right;">1.607753</td>
<td style="text-align: right;">3.329419</td>
<td style="text-align: right;">0.0009314</td>
<td style="text-align: right;">0.0065198</td>
<td style="text-align: right;">2.194464</td>
<td style="text-align: right;">8.511304</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpNever User</td>
<td style="text-align: right;">3.936594</td>
<td style="text-align: right;">1.110561</td>
<td style="text-align: right;">3.544689</td>
<td style="text-align: right;">0.0004282</td>
<td style="text-align: right;">0.0029973</td>
<td style="text-align: right;">1.754905</td>
<td style="text-align: right;">6.118283</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">-8.898171</td>
<td style="text-align: right;">4.017005</td>
<td style="text-align: right;">-2.215126</td>
<td style="text-align: right;">0.0271799</td>
<td style="text-align: right;">0.1902593</td>
<td style="text-align: right;">-16.789549</td>
<td style="text-align: right;">-1.006793</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FRP_2Yes</td>
<td style="text-align: right;">-12.755668</td>
<td style="text-align: right;">1.462953</td>
<td style="text-align: right;">-8.719122</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-15.629629</td>
<td style="text-align: right;">-9.881707</td>
</tr>
<tr class="even">
<td style="text-align: left;">hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">-6.595940</td>
<td style="text-align: right;">5.258100</td>
<td style="text-align: right;">-1.254434</td>
<td style="text-align: right;">0.2102424</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-16.925439</td>
<td style="text-align: right;">3.733559</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence</td>
<td style="text-align: right;">5.713316</td>
<td style="text-align: right;">4.254723</td>
<td style="text-align: right;">1.342817</td>
<td style="text-align: right;">0.1799114</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-2.645057</td>
<td style="text-align: right;">14.071689</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>At high adherence, current hard drug users had on average a change in physical QOL that was 5.35 points less than previous hard drug users (t = 3.33, p-adjusted = 0.00279, 95% CI: 2.19 to 8.51).</p>
<p><a href="#Phys">Top of Tabset</a></p>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<section id="overall-model-5" class="level3">
<h3 class="anchored" data-anchor-id="overall-model-5">Overall Model</h3>
<p>There were significant differences in change in physical QOL over 2 years based on hard drug usage and adherence to the treatment regiment, while controlling for Frailty Related Phenotype (F~(6, 525)~ = 20.67, p &lt; 0.0001, adjusted R-squared = 0.1818).</p>
<section id="hard-drug-use-7" class="level4">
<h4 class="anchored" data-anchor-id="hard-drug-use-7">Hard Drug Use</h4>
<p>The relationship between hard drug use and change in physical QOL over 2 years depended on adherence to the treatment regiment.</p>
</section>
<section id="hard-drug-use-at-low-adherence-3" class="level4">
<h4 class="anchored" data-anchor-id="hard-drug-use-at-low-adherence-3">Hard Drug Use at Low Adherence</h4>
<p>At low adherence, previous hard drug users had on average a 10.89 point decrease in physical QOL compared to never hard drug users (t = -3.16, p-adjusted = 0.00493, 95% CI: -17.66 to -4.13), but did not differ significantly on change in physical QOL compared to current hard drug users (t = 0.25, p-adjusted = 1.00, 95% CI: -8.59 to 11.08). . Current hard drug users did not differ significantly from never hard drug users at low adherence (t = -2.35, p-adjusted =0.0574, 95% CI: -17.72 to -1.58), although with a larger sample size that could become significant.</p>
</section>
<section id="hard-drug-use-at-high-adherence-3" class="level4">
<h4 class="anchored" data-anchor-id="hard-drug-use-at-high-adherence-3">Hard Drug Use at High Adherence</h4>
<p>At high adherence, current hard drug users had on average a 3.94 point decrease in physical QOL compared to never hard drug users (t = -3.545, p-adjusted = 0.00128, 95% CI: -6.12 to -1.75), and 5.35 points decrease compared to previous hard drug users (t = 3.33, p-adjusted = 0.00279, 95% CI: 2.19 to 8.51). Additionally, previous hard drug users did not differ significantly from never hard drug users at high adherence (t = 1.100, p-adjusted = 0.815, 95% CI: -1.11 to 3.94).</p>
</section>
</section>
<section id="adherence-10" class="level3">
<h3 class="anchored" data-anchor-id="adherence-10">Adherence</h3>
<p>The relationship between adherence and change in physical QOL over 2 years depended on hard drug use.</p>
<section id="adherence-for-current-hard-drug-users-3" class="level4">
<h4 class="anchored" data-anchor-id="adherence-for-current-hard-drug-users-3">Adherence for Current Hard Drug Users</h4>
<p>For current hard drug users, those with high adherence had on average an 8.90 point increase in physical QOL compared to those with low adherence (t = 2.22, p = 0.027, 95% CI: 1.00 to 16.79).</p>
</section>
<section id="adherence-for-previous-hard-drug-users-3" class="level4">
<h4 class="anchored" data-anchor-id="adherence-for-previous-hard-drug-users-3">Adherence for Previous Hard Drug Users</h4>
<p>For previous hard drug users, those with high adherence to the treatment regiment had on average a 15.49 point increase in physical QOL compared to those with low adherence (t = 4.56, p-adjusted &lt; 0.0001, 95% CI: 8.82 to 22.17).</p>
</section>
<section id="adherence-for-never-hard-drug-users-3" class="level4">
<h4 class="anchored" data-anchor-id="adherence-for-never-hard-drug-users-3">Adherence for Never Hard Drug Users</h4>
<p>For never hard drug users, those with high adherence had a 3.19 point increase in physical QOL compared to those with low adherence (t = 2.27, p = 0.0239).</p>
</section>
</section>
<section id="frailty-related-phenotype-5" class="level3">
<h3 class="anchored" data-anchor-id="frailty-related-phenotype-5">Frailty Related Phenotype</h3>
<p>Frailty related phenotype was a significant predictor of change in physical QOL over 2 years (t = -8.72, p &lt; 0.0001). On average, those with a frailty related phenotype had a 12.76 decrease in physical QOL compared to those without a frailty related phenotype (95% CI: -15.63 to -9.88).</p>
<p><a href="#Phys">Top of Tabset</a></p>
</section>
</div>
<div id="tabset-21-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-4-tab">
<p>The below plot is useful in interpreting the interaction.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb505"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb505-1"><a href="#cb505-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use interactions package to plot interaction</span></span>
<span id="cb505-2"><a href="#cb505-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat_plot</span>(</span>
<span id="cb505-3"><a href="#cb505-3" aria-hidden="true" tabindex="-1"></a>  model_PHYS_final1, </span>
<span id="cb505-4"><a href="#cb505-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> hard_drugs_grp, </span>
<span id="cb505-5"><a href="#cb505-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> ADH_HIGHVSLOW, </span>
<span id="cb505-6"><a href="#cb505-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">geom =</span> <span class="st">"line"</span>, </span>
<span id="cb505-7"><a href="#cb505-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> <span class="st">"Pastel2"</span>,</span>
<span id="cb505-8"><a href="#cb505-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x.label =</span> <span class="st">"Hard Drugs Group"</span>,</span>
<span id="cb505-9"><a href="#cb505-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y.label =</span> <span class="st">"Predicted Physical QOL Change"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-273-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For those with low adherence, previous users had a greater decrease in physical QOL compared to never users. The difference between current and never hard drug users at low adherence is borderline significant, and may be so with a larger sample size.</p>
<p>For those with high adherence, the current hard drug use group had a greater decrease in physical QOL compared to both never and previous hard drug users.</p>
<p>And most importantly, for previous hard drug users, those with low adherence had a decrease in physical QOL when compared to those with high adherence.</p>
<p>We take this as <strong>further evidence that previous hard drug users are at a vulnerable population</strong>. High adherence serves as a buffer and could protect patients that have quit heroin or opiates within the past 2 years.</p>
<p>Additionally, we have evidence that even at high adherence, current hard drug users have worse overall physical QOL.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="Assumptions" class="level1">
<h1>Evaluating Assumptions</h1>
<p>In order to evaluate the assumptions of our models, we will first gather the residuals for the final model predicting each outcome variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb506"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the jackknife residuals of the model predicting VLOAD</span></span>
<span id="cb506-2"><a href="#cb506-2" aria-hidden="true" tabindex="-1"></a>jackknife_residuals_VLOAD <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(model_VLOAD_full1)</span>
<span id="cb506-3"><a href="#cb506-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-4"><a href="#cb506-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the jackknife residuals of the model predicting VLOAD sub analyss</span></span>
<span id="cb506-5"><a href="#cb506-5" aria-hidden="true" tabindex="-1"></a>jackknife_residuals_VLOAD_sub <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(model_VLOAD_red1)</span>
<span id="cb506-6"><a href="#cb506-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-7"><a href="#cb506-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the jackknife residuals of the model predicting LEU3N</span></span>
<span id="cb506-8"><a href="#cb506-8" aria-hidden="true" tabindex="-1"></a>jackknife_residuals_LEU3N <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(model_LEU3N_final1)</span>
<span id="cb506-9"><a href="#cb506-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-10"><a href="#cb506-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the jackknife residuals of the model predicting mental QOL 1</span></span>
<span id="cb506-11"><a href="#cb506-11" aria-hidden="true" tabindex="-1"></a>jackknife_residuals_MENT_main <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(model_MENT_main1)</span>
<span id="cb506-12"><a href="#cb506-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-13"><a href="#cb506-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the jackknife residuals of the model predicting mental QOL 2</span></span>
<span id="cb506-14"><a href="#cb506-14" aria-hidden="true" tabindex="-1"></a>jackknife_residuals_MENT_sub <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(model_MENT_sub1)</span>
<span id="cb506-15"><a href="#cb506-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-16"><a href="#cb506-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the jackknife residuals of the model predicting physical QOL</span></span>
<span id="cb506-17"><a href="#cb506-17" aria-hidden="true" tabindex="-1"></a>jackknife_residuals_PHYS <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(model_PHYS_final1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="log-viral-load-1" class="level2">
<h2 class="anchored" data-anchor-id="log-viral-load-1">Log Viral Load</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true">Linearity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false">Independence</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false">Normality</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-4" role="tab" aria-controls="tabset-23-4" aria-selected="false">Equal Variances (Homoscedasticity)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-5" role="tab" aria-controls="tabset-23-5" aria-selected="false">Residuals Centered Around Zero</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-6" role="tab" aria-controls="tabset-23-6" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<p>Since the mains IVs are categorical, we do not need to evaluate linearity.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<p>Independence can be assessed in part by the study design and how the data was collected. Based on the information provided by the PI, I will assume subjects are independent from each other.</p>
<p>Additionally, we can examine a scatter plot of the model’s residuals against any time point variable (such as ID).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb507"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb507-1"><a href="#cb507-1" aria-hidden="true" tabindex="-1"></a>data_VLOAD <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb507-2"><a href="#cb507-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(newid, VLOAD_log_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW, EDUC_COLLEGE) <span class="sc">%&gt;%</span></span>
<span id="cb507-3"><a href="#cb507-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb507-4"><a href="#cb507-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(newid) <span class="sc">&amp;</span> </span>
<span id="cb507-5"><a href="#cb507-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(VLOAD_log_CHANGE) <span class="sc">&amp;</span></span>
<span id="cb507-6"><a href="#cb507-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(hard_drugs_grp) <span class="sc">&amp;</span> </span>
<span id="cb507-7"><a href="#cb507-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(ADH_HIGHVSLOW) <span class="sc">&amp;</span> </span>
<span id="cb507-8"><a href="#cb507-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(EDUC_COLLEGE) </span>
<span id="cb507-9"><a href="#cb507-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb507-10"><a href="#cb507-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-11"><a href="#cb507-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of jackknife residuals vs ID to assess independence </span></span>
<span id="cb507-12"><a href="#cb507-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_VLOAD, <span class="fu">aes</span>(<span class="at">x =</span> newid, <span class="at">y =</span> jackknife_residuals_VLOAD)) <span class="sc">+</span> </span>
<span id="cb507-13"><a href="#cb507-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb507-14"><a href="#cb507-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb507-15"><a href="#cb507-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Jackknife Residuals vs ID for Log Viral Load"</span>,</span>
<span id="cb507-16"><a href="#cb507-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb507-17"><a href="#cb507-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Jackknife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-275-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We may have some non-independence as seen by the further spread above 0.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-23-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">
<p>Here we will asses that, for any fixed value of X, Y has a normal distribution. We will do this using Q-Q plots and histograms of the residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb508"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the Q-Q plots using the jackknife residuals</span></span>
<span id="cb508-2"><a href="#cb508-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(jackknife_residuals_VLOAD, <span class="at">main =</span> <span class="st">"Q-Q plots of Jackknife Residuals for Log Viral Load"</span>)</span>
<span id="cb508-3"><a href="#cb508-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(jackknife_residuals_VLOAD, <span class="at">col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-276-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb509"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb509-1"><a href="#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of jackknife residuals</span></span>
<span id="cb509-2"><a href="#cb509-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(jackknife_residuals_VLOAD, <span class="at">main =</span> <span class="st">"Histogram of Jackknife Residuals"</span>,</span>
<span id="cb509-3"><a href="#cb509-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">24</span>,</span>
<span id="cb509-4"><a href="#cb509-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Jackknife Residuals"</span>,</span>
<span id="cb509-5"><a href="#cb509-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb509-6"><a href="#cb509-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-276-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also include the Shapiro-Wilk test of normality, which provides a p-value and allows us to numerically establish that the assumption of normality is met. If the p-value is &lt; 0.05 you conclude that the assumption of normality is not met.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb510"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(jackknife_residuals_VLOAD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  jackknife_residuals_VLOAD
W = 0.97025, p-value = 0.000000008927</code></pre>
</div>
</div>
<p>We have some non-normality as seen by the higher end of the Q-Q Plot.</p>
<p>Looking at the histograms, the pattern is slightly bimodal, and may have some outliers at the high range.</p>
<p>We also fail Shapiro-Wilk’s test, indicating non-normality.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-23-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-4-tab">
<p>To assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb512"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the residual scatterplot using the jackknife residuals</span></span>
<span id="cb512-2"><a href="#cb512-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_VLOAD, <span class="fu">aes</span>(<span class="at">x =</span> hard_drugs_grp, <span class="at">y =</span> jackknife_residuals_VLOAD)) <span class="sc">+</span></span>
<span id="cb512-3"><a href="#cb512-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb512-4"><a href="#cb512-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Jackknife Residuals vs Hard Drug Use for Log Viral Load"</span>,</span>
<span id="cb512-5"><a href="#cb512-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drug Use Group"</span>,</span>
<span id="cb512-6"><a href="#cb512-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"JackKnife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-278-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb513"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb513-1"><a href="#cb513-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the residual scatterplot using the jackknife residuals</span></span>
<span id="cb513-2"><a href="#cb513-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_VLOAD, <span class="fu">aes</span>(<span class="at">x =</span> ADH_HIGHVSLOW, <span class="at">y =</span> jackknife_residuals_VLOAD)) <span class="sc">+</span></span>
<span id="cb513-3"><a href="#cb513-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb513-4"><a href="#cb513-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Jackknife Residuals vs Adherence for Log Viral Load"</span>,</span>
<span id="cb513-5"><a href="#cb513-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Adherence"</span>,</span>
<span id="cb513-6"><a href="#cb513-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"JackKnife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-279-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It appears that our hard drug use groups have unequal variances.</p>
<p>Additionally, while it is not recommended to perform a statistical test to assess for equality of variances (because formal tests of equality of variance are not very powerful), we can still do this using Bartlett’s test. The null hypothesis of the Bartlett test is that the variances are equal. Thus failing to reject the null (p &gt; 0.05) indicates that the data are consistent with the equal variance assumption.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb514"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Bartlett's test to check for homogeneity of variances</span></span>
<span id="cb514-2"><a href="#cb514-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(VLOAD_log_CHANGE <span class="sc">~</span> hard_drugs_grp, <span class="at">data =</span> data_VLOAD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  VLOAD_log_CHANGE by hard_drugs_grp
Bartlett's K-squared = 23.563, df = 2, p-value = 0.000007644</code></pre>
</div>
</div>
<p>We also do not meet the assumption for equality of variances (p &lt; 0.05).</p>
<p>This is likely because our patients were not randomly assigned into these groups!</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-23-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-5-tab">
<p>To start, we can simply check that the mean of our residuals is close to 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb516"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the mean of the jackknife residuals. Should be close to 0.</span></span>
<span id="cb516-2"><a href="#cb516-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(jackknife_residuals_VLOAD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0004681325</code></pre>
</div>
<div class="sourceCode cell-code" id="cb518"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate vectors containing the fitted values vs jackknife residuals so we can plot them </span></span>
<span id="cb518-2"><a href="#cb518-2" aria-hidden="true" tabindex="-1"></a>fitted_values_VLOAD <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model_VLOAD_full1)</span>
<span id="cb518-3"><a href="#cb518-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-4"><a href="#cb518-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_VLOAD, <span class="fu">aes</span>(<span class="at">x =</span> fitted_values_VLOAD, <span class="at">y =</span> jackknife_residuals_VLOAD)) <span class="sc">+</span> </span>
<span id="cb518-5"><a href="#cb518-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb518-6"><a href="#cb518-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-281-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We definitely have outliers present.</p>
<p>The mean is close to 0.</p>
<p>A more sophisticated approach is to plot the fitted values vs jackknife residuals. We can then compare the trend between groups to see if they are random. The fitted line should gravitate around 0 with no obvious trends.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-23-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-6-tab">
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
</div>
</div>
</section>
<section id="cd4-t-cell-count-3" class="level2">
<h2 class="anchored" data-anchor-id="cd4-t-cell-count-3">CD4+ T Cell Count</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true">Linearity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false">Independence</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-3" role="tab" aria-controls="tabset-24-3" aria-selected="false">Normality</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-4" role="tab" aria-controls="tabset-24-4" aria-selected="false">Equal Variances (Homoscedasticity)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-5" role="tab" aria-controls="tabset-24-5" aria-selected="false">Residuals Centered Around Zero</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-6" role="tab" aria-controls="tabset-24-6" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<p>We do not need to assess linearity since our main PEVs are categorical.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<p>Independence can be assessed in part by the study design and how the data was collected. Based on the information provided by the PI, I will assume subjects are independent from each other.</p>
<p>Additionally, we can examine a scatter plot of the model’s residuals against any time point variable (such as ID).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb520"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to create same data set as in the final analysis</span></span>
<span id="cb520-2"><a href="#cb520-2" aria-hidden="true" tabindex="-1"></a>data_LEU3N <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb520-3"><a href="#cb520-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(newid, LEU3N_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW, FRP_2) <span class="sc">%&gt;%</span></span>
<span id="cb520-4"><a href="#cb520-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb520-5"><a href="#cb520-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(newid) <span class="sc">&amp;</span> </span>
<span id="cb520-6"><a href="#cb520-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(LEU3N_CHANGE) <span class="sc">&amp;</span></span>
<span id="cb520-7"><a href="#cb520-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(hard_drugs_grp) <span class="sc">&amp;</span> </span>
<span id="cb520-8"><a href="#cb520-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(ADH_HIGHVSLOW) <span class="sc">&amp;</span> </span>
<span id="cb520-9"><a href="#cb520-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(FRP_2) </span>
<span id="cb520-10"><a href="#cb520-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb520-11"><a href="#cb520-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-12"><a href="#cb520-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of jackknife residuals vs ID to assess independence </span></span>
<span id="cb520-13"><a href="#cb520-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_LEU3N, <span class="fu">aes</span>(<span class="at">x =</span> newid, <span class="at">y =</span> jackknife_residuals_LEU3N)) <span class="sc">+</span> </span>
<span id="cb520-14"><a href="#cb520-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb520-15"><a href="#cb520-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb520-16"><a href="#cb520-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Jackknife Residuals vs ID for CD4+ T Cells"</span>,</span>
<span id="cb520-17"><a href="#cb520-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb520-18"><a href="#cb520-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Jackknife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-282-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks like we have 4 outlier points beyound 3 residuals from 0, but otherwise looking good.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-24-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-3-tab">
<p>Here we will asses that, for any fixed value of X, Y has a normal distribution. We will do this using Q-Q plots and histograms of the residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb521"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the Q-Q plots using the jackknife residuals</span></span>
<span id="cb521-2"><a href="#cb521-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(jackknife_residuals_LEU3N, <span class="at">main =</span> <span class="st">"Q-Q plots of Jackknife Residuals for Log Viral Load"</span>)</span>
<span id="cb521-3"><a href="#cb521-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(jackknife_residuals_LEU3N, <span class="at">col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-283-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb522"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of jackknife residuals</span></span>
<span id="cb522-2"><a href="#cb522-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(jackknife_residuals_LEU3N, <span class="at">main =</span> <span class="st">"Histogram of Jackknife Residuals"</span>,</span>
<span id="cb522-3"><a href="#cb522-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">24</span>,</span>
<span id="cb522-4"><a href="#cb522-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Jackknife Residuals"</span>,</span>
<span id="cb522-5"><a href="#cb522-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb522-6"><a href="#cb522-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-283-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We look very normal here, sans some obvious outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb523"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(jackknife_residuals_LEU3N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  jackknife_residuals_LEU3N
W = 0.97052, p-value = 0.00000001042</code></pre>
</div>
</div>
<p>We have non-normality, but that is due to outliers.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-24-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-4-tab">
<p>To assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb525"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb525-1"><a href="#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the residual scatterplot using the jackknife residuals</span></span>
<span id="cb525-2"><a href="#cb525-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_LEU3N, <span class="fu">aes</span>(<span class="at">x =</span> hard_drugs_grp, <span class="at">y =</span> jackknife_residuals_LEU3N)) <span class="sc">+</span></span>
<span id="cb525-3"><a href="#cb525-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb525-4"><a href="#cb525-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Jackknife Residuals vs Hard Drug Use for CD4+ T Cell Count Change"</span>,</span>
<span id="cb525-5"><a href="#cb525-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drug Use Group"</span>,</span>
<span id="cb525-6"><a href="#cb525-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"JackKnife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-285-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb526"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the residual scatterplot using the jackknife residuals</span></span>
<span id="cb526-2"><a href="#cb526-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_LEU3N, <span class="fu">aes</span>(<span class="at">x =</span> ADH_HIGHVSLOW, <span class="at">y =</span> jackknife_residuals_LEU3N)) <span class="sc">+</span></span>
<span id="cb526-3"><a href="#cb526-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb526-4"><a href="#cb526-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Jackknife Residuals vs Adherence for CD4+ T Cell Count Change"</span>,</span>
<span id="cb526-5"><a href="#cb526-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drug Use Group"</span>,</span>
<span id="cb526-6"><a href="#cb526-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"JackKnife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-285-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb527"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb527-1"><a href="#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Bartlett's test to check for homogeneity of variances</span></span>
<span id="cb527-2"><a href="#cb527-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(LEU3N_CHANGE <span class="sc">~</span> hard_drugs_grp, <span class="at">data =</span> data_LEU3N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  LEU3N_CHANGE by hard_drugs_grp
Bartlett's K-squared = 5.8811, df = 2, p-value = 0.05284</code></pre>
</div>
</div>
<p>We can actually conclude that we have equality of variances! This will look even better once we get rid of outliers.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-24-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-5-tab">
<p>to start, we can simply check that the mean of our residuals is close to 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb529"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb529-1"><a href="#cb529-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the mean of the jackknife residuals. Should be close to 0.</span></span>
<span id="cb529-2"><a href="#cb529-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(jackknife_residuals_LEU3N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0004433429</code></pre>
</div>
<div class="sourceCode cell-code" id="cb531"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb531-1"><a href="#cb531-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate vectors containing the fitted values vs jackknife residuals so we can plot them </span></span>
<span id="cb531-2"><a href="#cb531-2" aria-hidden="true" tabindex="-1"></a>fitted_values_LEU3N <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model_LEU3N_final1)</span>
<span id="cb531-3"><a href="#cb531-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-4"><a href="#cb531-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_LEU3N, <span class="fu">aes</span>(<span class="at">x =</span> fitted_values_LEU3N, <span class="at">y =</span> jackknife_residuals_LEU3N)) <span class="sc">+</span> </span>
<span id="cb531-5"><a href="#cb531-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb531-6"><a href="#cb531-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-287-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The mean is close to 0. The residuals look centered around 0 excepting the outliers.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-24-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-6-tab">
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
</div>
</div>
</section>
<section id="mental-quality-of-life" class="level2">
<h2 class="anchored" data-anchor-id="mental-quality-of-life">Mental Quality of Life</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true">Linearity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false">Independence</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-3" role="tab" aria-controls="tabset-25-3" aria-selected="false">Normality</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-4" role="tab" aria-controls="tabset-25-4" aria-selected="false">Equal Variances (Homoscedasticity)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-5" role="tab" aria-controls="tabset-25-5" aria-selected="false">Residuals Centered Around Zero</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-6" role="tab" aria-controls="tabset-25-6" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<p>We do not need to assess linearity since our main PEVs are categorical.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<p>Independence can be assessed in part by the study design and how the data was collected. Based on the information provided by the PI, I will assume subjects are independent from each other.</p>
<p>Additionally, we can examine a scatter plot of the model’s residuals against any time point variable (such as ID).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb533"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb533-1"><a href="#cb533-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to create same data set as in the final analysis</span></span>
<span id="cb533-2"><a href="#cb533-2" aria-hidden="true" tabindex="-1"></a>data_MENT_main <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb533-3"><a href="#cb533-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(newid, AGG_MENT_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW) <span class="sc">%&gt;%</span></span>
<span id="cb533-4"><a href="#cb533-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb533-5"><a href="#cb533-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(newid) <span class="sc">&amp;</span> </span>
<span id="cb533-6"><a href="#cb533-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(AGG_MENT_CHANGE) <span class="sc">&amp;</span></span>
<span id="cb533-7"><a href="#cb533-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(hard_drugs_grp) <span class="sc">&amp;</span> </span>
<span id="cb533-8"><a href="#cb533-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(ADH_HIGHVSLOW) </span>
<span id="cb533-9"><a href="#cb533-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb533-10"><a href="#cb533-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-11"><a href="#cb533-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of jackknife residuals vs ID to assess independence </span></span>
<span id="cb533-12"><a href="#cb533-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_MENT_main, <span class="fu">aes</span>(<span class="at">x =</span> newid, <span class="at">y =</span> jackknife_residuals_MENT_main)) <span class="sc">+</span> </span>
<span id="cb533-13"><a href="#cb533-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb533-14"><a href="#cb533-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb533-15"><a href="#cb533-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Jackknife Residuals vs ID for Mental QOL Change"</span>,</span>
<span id="cb533-16"><a href="#cb533-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb533-17"><a href="#cb533-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Jackknife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-288-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No clear pattern, we meet the assumption of independence.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-25-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-3-tab">
<p>Here we will asses that, for any fixed value of X, Y has a normal distribution. We will do this using Q-Q plots and histograms of the residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb534"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the Q-Q plots using the jackknife residuals</span></span>
<span id="cb534-2"><a href="#cb534-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(jackknife_residuals_MENT_main, <span class="at">main =</span> <span class="st">"Q-Q plots of Jackknife Residuals for Mental QOL Change"</span>)</span>
<span id="cb534-3"><a href="#cb534-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(jackknife_residuals_MENT_main, <span class="at">col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-289-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb535"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb535-1"><a href="#cb535-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of jackknife residuals</span></span>
<span id="cb535-2"><a href="#cb535-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(jackknife_residuals_MENT_main, <span class="at">main =</span> <span class="st">"Histogram of Jackknife Residuals"</span>,</span>
<span id="cb535-3"><a href="#cb535-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">24</span>,</span>
<span id="cb535-4"><a href="#cb535-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Jackknife Residuals"</span>,</span>
<span id="cb535-5"><a href="#cb535-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb535-6"><a href="#cb535-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-289-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb536"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(jackknife_residuals_MENT_main)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  jackknife_residuals_MENT_main
W = 0.96193, p-value = 0.0000000001675</code></pre>
</div>
</div>
<p>We have non-normality. It does not look like outliers are driving this.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-25-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-4-tab">
<p>To assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb538"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the residual scatterplot using the jackknife residuals</span></span>
<span id="cb538-2"><a href="#cb538-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_MENT_main, <span class="fu">aes</span>(<span class="at">x =</span> hard_drugs_grp, <span class="at">y =</span> jackknife_residuals_MENT_main)) <span class="sc">+</span></span>
<span id="cb538-3"><a href="#cb538-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb538-4"><a href="#cb538-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Jackknife Residuals vs Hard Drug Use for Mental QOL Change"</span>,</span>
<span id="cb538-5"><a href="#cb538-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drug Use Group"</span>,</span>
<span id="cb538-6"><a href="#cb538-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"JackKnife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-291-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb539"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the residual scatterplot using the jackknife residuals</span></span>
<span id="cb539-2"><a href="#cb539-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_MENT_main, <span class="fu">aes</span>(<span class="at">x =</span> ADH_HIGHVSLOW, <span class="at">y =</span> jackknife_residuals_MENT_main)) <span class="sc">+</span></span>
<span id="cb539-3"><a href="#cb539-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb539-4"><a href="#cb539-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Jackknife Residuals vs Adherence for Mental QOL Change"</span>,</span>
<span id="cb539-5"><a href="#cb539-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drug Use Group"</span>,</span>
<span id="cb539-6"><a href="#cb539-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"JackKnife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-292-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb540"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Bartlett's test to check for homogeneity of variances</span></span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp, <span class="at">data =</span> data_MENT_main)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  AGG_MENT_CHANGE by hard_drugs_grp
Bartlett's K-squared = 19.522, df = 2, p-value = 0.00005765</code></pre>
</div>
</div>
<p>The test is significant, and we conclude we do not have homogeneity of variances.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-25-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb542"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the mean of the jackknife residuals. Should be close to 0.</span></span>
<span id="cb542-2"><a href="#cb542-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(jackknife_residuals_MENT_main)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0001715436</code></pre>
</div>
<div class="sourceCode cell-code" id="cb544"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate vectors containing the fitted values vs jackknife residuals so we can plot them </span></span>
<span id="cb544-2"><a href="#cb544-2" aria-hidden="true" tabindex="-1"></a>fitted_values_MENT_main <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model_MENT_main1)</span>
<span id="cb544-3"><a href="#cb544-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb544-4"><a href="#cb544-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_MENT_main, <span class="fu">aes</span>(<span class="at">x =</span> fitted_values_MENT_main, <span class="at">y =</span> jackknife_residuals_MENT_main)) <span class="sc">+</span> </span>
<span id="cb544-5"><a href="#cb544-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb544-6"><a href="#cb544-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-294-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Our residuals look centered around 0, sans a few outlier points.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-25-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-6-tab">
<p>We have non-normality and non homogeneity of variances.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
</div>
</div>
</section>
<section id="physical-quality-of-life" class="level2">
<h2 class="anchored" data-anchor-id="physical-quality-of-life">Physical Quality of Life</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true">Linearity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false">Independence</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-3" role="tab" aria-controls="tabset-26-3" aria-selected="false">Normality</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-4" role="tab" aria-controls="tabset-26-4" aria-selected="false">Equal Variances (Homoscedasticity)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-5" role="tab" aria-controls="tabset-26-5" aria-selected="false">Residuals Centered Around Zero</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-6" role="tab" aria-controls="tabset-26-6" aria-selected="false">Summary</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-7" role="tab" aria-controls="tabset-26-7" aria-selected="false">Residuals Centered Around Zero</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-8" role="tab" aria-controls="tabset-26-8" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<p>We do not need to assess linearity since our main PEVs are categorical.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-26-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<p>Independence can be assessed in part by the study design and how the data was collected. Based on the information provided by the PI, I will assume subjects are independent from each other.</p>
<p>Additionally, we can examine a scatter plot of the model’s residuals against any time point variable (such as ID).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb546"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to create same data set as in the final analysis</span></span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true" tabindex="-1"></a>data_PHYS <span class="ot">&lt;-</span> data_wide_2 <span class="sc">%&gt;%</span></span>
<span id="cb546-3"><a href="#cb546-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(newid, AGG_PHYS_CHANGE, hard_drugs_grp, ADH_HIGHVSLOW, FRP_2) <span class="sc">%&gt;%</span></span>
<span id="cb546-4"><a href="#cb546-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb546-5"><a href="#cb546-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(newid) <span class="sc">&amp;</span> </span>
<span id="cb546-6"><a href="#cb546-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(AGG_PHYS_CHANGE) <span class="sc">&amp;</span></span>
<span id="cb546-7"><a href="#cb546-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(hard_drugs_grp) <span class="sc">&amp;</span> </span>
<span id="cb546-8"><a href="#cb546-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(ADH_HIGHVSLOW) <span class="sc">&amp;</span></span>
<span id="cb546-9"><a href="#cb546-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(FRP_2)</span>
<span id="cb546-10"><a href="#cb546-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb546-11"><a href="#cb546-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-12"><a href="#cb546-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of jackknife residuals vs ID to assess independence </span></span>
<span id="cb546-13"><a href="#cb546-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_PHYS, <span class="fu">aes</span>(<span class="at">x =</span> newid, <span class="at">y =</span> jackknife_residuals_PHYS)) <span class="sc">+</span> </span>
<span id="cb546-14"><a href="#cb546-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb546-15"><a href="#cb546-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb546-16"><a href="#cb546-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Jackknife Residuals vs ID for Physical QOL Change"</span>,</span>
<span id="cb546-17"><a href="#cb546-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ID"</span>,</span>
<span id="cb546-18"><a href="#cb546-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Jackknife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-295-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Independence looks pretty good.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-26-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-3-tab">
<p>Here we will asses that, for any fixed value of X, Y has a normal distribution. We will do this using Q-Q plots and histograms of the residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb547"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb547-1"><a href="#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the Q-Q plots using the jackknife residuals</span></span>
<span id="cb547-2"><a href="#cb547-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(jackknife_residuals_PHYS, <span class="at">main =</span> <span class="st">"Q-Q plots of Jackknife Residuals for Mental QOL Change"</span>)</span>
<span id="cb547-3"><a href="#cb547-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(jackknife_residuals_PHYS, <span class="at">col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-296-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb548"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of jackknife residuals</span></span>
<span id="cb548-2"><a href="#cb548-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(jackknife_residuals_PHYS, <span class="at">main =</span> <span class="st">"Histogram of Jackknife Residuals"</span>,</span>
<span id="cb548-3"><a href="#cb548-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">24</span>,</span>
<span id="cb548-4"><a href="#cb548-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Jackknife Residuals"</span>,</span>
<span id="cb548-5"><a href="#cb548-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb548-6"><a href="#cb548-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-296-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb549"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb549-1"><a href="#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(jackknife_residuals_PHYS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  jackknife_residuals_PHYS
W = 0.9682, p-value = 0.000000002488</code></pre>
</div>
</div>
<p>Physical QOL looks mostly normal. There may be 1 outier at the upper and lower bound.</p>
<p>Shapiro Wilk’s does say we fail normality however.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-26-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-4-tab">
<p>To assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb551"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb551-1"><a href="#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the residual scatterplot using the jackknife residuals</span></span>
<span id="cb551-2"><a href="#cb551-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_PHYS, <span class="fu">aes</span>(<span class="at">x =</span> hard_drugs_grp, <span class="at">y =</span> jackknife_residuals_PHYS)) <span class="sc">+</span></span>
<span id="cb551-3"><a href="#cb551-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb551-4"><a href="#cb551-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Jackknife Residuals vs Hard Drug Use for Physical QOL Change"</span>,</span>
<span id="cb551-5"><a href="#cb551-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drug Use Group"</span>,</span>
<span id="cb551-6"><a href="#cb551-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"JackKnife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-297-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb552"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb552-1"><a href="#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Bartlett's test to check for homogeneity of variances</span></span>
<span id="cb552-2"><a href="#cb552-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(AGG_PHYS_CHANGE <span class="sc">~</span> hard_drugs_grp, <span class="at">data =</span> data_PHYS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  AGG_PHYS_CHANGE by hard_drugs_grp
Bartlett's K-squared = 4.2398, df = 2, p-value = 0.12</code></pre>
</div>
</div>
<p>We do have homogeneity of variances for physical QOL.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-26-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb554"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb554-1"><a href="#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the mean of the jackknife residuals. Should be close to 0.</span></span>
<span id="cb554-2"><a href="#cb554-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(jackknife_residuals_PHYS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0002469251</code></pre>
</div>
<div class="sourceCode cell-code" id="cb556"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb556-1"><a href="#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate vectors containing the fitted values vs jackknife residuals so we can plot them </span></span>
<span id="cb556-2"><a href="#cb556-2" aria-hidden="true" tabindex="-1"></a>fitted_values_PHYS <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model_PHYS_final1)</span>
<span id="cb556-3"><a href="#cb556-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-4"><a href="#cb556-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_PHYS, <span class="fu">aes</span>(<span class="at">x =</span> fitted_values_PHYS, <span class="at">y =</span> jackknife_residuals_PHYS)) <span class="sc">+</span> </span>
<span id="cb556-5"><a href="#cb556-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb556-6"><a href="#cb556-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-298-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><a href="#Assumptions">Top of Tabset</a></p>
</div>
<div id="tabset-26-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-6-tab">
<p>The assumptions for CD4+ T cell count are almost met. Likely once removing those 4 or so outliers they would be perfect.</p>
<p><a href="#Assumptions">Top of Tabset</a></p>
<p>To assess homoscedasticity we examine the residual scatterplots by treatment group. The warning sign to look for here is if the variance differs greatly across groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb558"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb558-1"><a href="#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the residual scatterplot using the jackknife residuals</span></span>
<span id="cb558-2"><a href="#cb558-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_PHYS, <span class="fu">aes</span>(<span class="at">x =</span> hard_drugs_grp, <span class="at">y =</span> jackknife_residuals_PHYS)) <span class="sc">+</span></span>
<span id="cb558-3"><a href="#cb558-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb558-4"><a href="#cb558-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Jackknife Residuals vs Hard Drug Use for Physical QOL Change"</span>,</span>
<span id="cb558-5"><a href="#cb558-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drug Use Group"</span>,</span>
<span id="cb558-6"><a href="#cb558-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"JackKnife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-299-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb559"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb559-1"><a href="#cb559-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the residual scatterplot using the jackknife residuals</span></span>
<span id="cb559-2"><a href="#cb559-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_PHYS, <span class="fu">aes</span>(<span class="at">x =</span> ADH_HIGHVSLOW, <span class="at">y =</span> jackknife_residuals_PHYS)) <span class="sc">+</span></span>
<span id="cb559-3"><a href="#cb559-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb559-4"><a href="#cb559-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Jackknife Residuals vs Adherence for Physical QOL Change"</span>,</span>
<span id="cb559-5"><a href="#cb559-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hard Drug Use Group"</span>,</span>
<span id="cb559-6"><a href="#cb559-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"JackKnife Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-300-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb560"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb560-1"><a href="#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Bartlett's test to check for homogeneity of variances</span></span>
<span id="cb560-2"><a href="#cb560-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(AGG_PHYS_CHANGE <span class="sc">~</span> hard_drugs_grp, <span class="at">data =</span> data_PHYS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  AGG_PHYS_CHANGE by hard_drugs_grp
Bartlett's K-squared = 4.2398, df = 2, p-value = 0.12</code></pre>
</div>
</div>
<p>We do have homogeneity of variances.</p>
</div>
<div id="tabset-26-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb562"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb562-1"><a href="#cb562-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the mean of the jackknife residuals. Should be close to 0.</span></span>
<span id="cb562-2"><a href="#cb562-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(jackknife_residuals_PHYS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0002469251</code></pre>
</div>
<div class="sourceCode cell-code" id="cb564"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate vectors containing the fitted values vs jackknife residuals so we can plot them </span></span>
<span id="cb564-2"><a href="#cb564-2" aria-hidden="true" tabindex="-1"></a>fitted_values_PHYS <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model_PHYS_final1)</span>
<span id="cb564-3"><a href="#cb564-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb564-4"><a href="#cb564-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_PHYS, <span class="fu">aes</span>(<span class="at">x =</span> fitted_values_PHYS, <span class="at">y =</span> jackknife_residuals_PHYS)) <span class="sc">+</span> </span>
<span id="cb564-5"><a href="#cb564-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb564-6"><a href="#cb564-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-302-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The residuals appear centered around zero, for the most part.</p>
</div>
<div id="tabset-26-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-8-tab">
<p>We do not meet the assumption of normality for physical QOL.</p>
</div>
</div>
</div>
</section>
</section>
<section id="outliers" class="level1">
<h1>Outliers</h1>
<p>Here we will investigate outliers using the jackknife residuals to assess leverage and influence.</p>
<p>Let’s generate a table so we can handily compare: ID, jackknife residual, leverage (diagonal hat), DFFITS, and DFBETAs for each participant.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-27-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-1" role="tab" aria-controls="tabset-27-1" aria-selected="true">Log Viral Load</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-2" role="tab" aria-controls="tabset-27-2" aria-selected="false">CD4 + T Cell Count</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-3" role="tab" aria-controls="tabset-27-3" aria-selected="false">Mental QOL Change</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-4" role="tab" aria-controls="tabset-27-4" aria-selected="false">Physical Quality of Life</a></li></ul>
<div class="tab-content">
<div id="tabset-27-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-27-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb566"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb566-1"><a href="#cb566-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get leverage values (hat values)</span></span>
<span id="cb566-2"><a href="#cb566-2" aria-hidden="true" tabindex="-1"></a>hat_values_VLOAD <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(model_VLOAD_full1)</span>
<span id="cb566-3"><a href="#cb566-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-4"><a href="#cb566-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Cook's D values</span></span>
<span id="cb566-5"><a href="#cb566-5" aria-hidden="true" tabindex="-1"></a>cooks_d_VLOAD <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(model_VLOAD_full1)</span>
<span id="cb566-6"><a href="#cb566-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-7"><a href="#cb566-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the DFFITS values</span></span>
<span id="cb566-8"><a href="#cb566-8" aria-hidden="true" tabindex="-1"></a>dffits_VLOAD <span class="ot">&lt;-</span> <span class="fu">dffits</span>(model_VLOAD_full1)</span>
<span id="cb566-9"><a href="#cb566-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-10"><a href="#cb566-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the DFBETAS</span></span>
<span id="cb566-11"><a href="#cb566-11" aria-hidden="true" tabindex="-1"></a>dfbetas_VLOAD <span class="ot">&lt;-</span> <span class="fu">dfbetas</span>(model_VLOAD_full1)</span>
<span id="cb566-12"><a href="#cb566-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-13"><a href="#cb566-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a table with ID and all diagnostic values</span></span>
<span id="cb566-14"><a href="#cb566-14" aria-hidden="true" tabindex="-1"></a>diagnostics_VLOAD <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> data_VLOAD<span class="sc">$</span>newid, <span class="at">jackknife_residuals =</span> jackknife_residuals_VLOAD, <span class="at">leverage =</span> hat_values_VLOAD, <span class="at">cooks_D =</span> cooks_d_VLOAD, <span class="at">dffits =</span> dffits_VLOAD, <span class="at">dfbetas =</span> dfbetas_VLOAD)</span>
<span id="cb566-15"><a href="#cb566-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-16"><a href="#cb566-16" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty_print</span>(<span class="fu">head</span>(diagnostics_VLOAD))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">jackknife_residuals</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">leverage</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cooks_D</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dffits</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas..Intercept.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.hard_drugs_grpPrevious.User</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.hard_drugs_grpCurrent.User</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.ADH_HIGHVSLOWHigh.Adherence</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.EDUC_COLLEGECollege</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.hard_drugs_grpPrevious.User.ADH_HIGHVSLOWHigh.Adherence</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dfbetas.hard_drugs_grpCurrent.User.ADH_HIGHVSLOWHigh.Adherence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.3161770</td>
<td style="text-align: right;">0.0294395</td>
<td style="text-align: right;">0.0004339</td>
<td style="text-align: right;">-0.0550661</td>
<td style="text-align: right;">0.0094211</td>
<td style="text-align: right;">0.0011659</td>
<td style="text-align: right;">-0.0012572</td>
<td style="text-align: right;">0.0003230</td>
<td style="text-align: right;">-0.0213838</td>
<td style="text-align: right;">-0.0198096</td>
<td style="text-align: right;">0.0015858</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.2393356</td>
<td style="text-align: right;">0.0269731</td>
<td style="text-align: right;">0.0002273</td>
<td style="text-align: right;">0.0398483</td>
<td style="text-align: right;">0.0047483</td>
<td style="text-align: right;">0.0005876</td>
<td style="text-align: right;">-0.0006336</td>
<td style="text-align: right;">0.0001628</td>
<td style="text-align: right;">-0.0107775</td>
<td style="text-align: right;">0.0110797</td>
<td style="text-align: right;">0.0007992</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.3244571</td>
<td style="text-align: right;">0.0179987</td>
<td style="text-align: right;">0.0002761</td>
<td style="text-align: right;">0.0439260</td>
<td style="text-align: right;">-0.0017163</td>
<td style="text-align: right;">-0.0002124</td>
<td style="text-align: right;">0.0002290</td>
<td style="text-align: right;">-0.0000588</td>
<td style="text-align: right;">0.0038956</td>
<td style="text-align: right;">0.0005634</td>
<td style="text-align: right;">0.0103259</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1.2585889</td>
<td style="text-align: right;">0.0294395</td>
<td style="text-align: right;">0.0068562</td>
<td style="text-align: right;">0.2191985</td>
<td style="text-align: right;">-0.0375022</td>
<td style="text-align: right;">-0.0046410</td>
<td style="text-align: right;">0.0050043</td>
<td style="text-align: right;">-0.0012856</td>
<td style="text-align: right;">0.0851213</td>
<td style="text-align: right;">0.0788552</td>
<td style="text-align: right;">-0.0063123</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.3140120</td>
<td style="text-align: right;">0.0179987</td>
<td style="text-align: right;">0.0002586</td>
<td style="text-align: right;">0.0425119</td>
<td style="text-align: right;">-0.0016611</td>
<td style="text-align: right;">-0.0002056</td>
<td style="text-align: right;">0.0002217</td>
<td style="text-align: right;">-0.0000569</td>
<td style="text-align: right;">0.0037702</td>
<td style="text-align: right;">0.0005452</td>
<td style="text-align: right;">0.0099935</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.0574866</td>
<td style="text-align: right;">0.0179987</td>
<td style="text-align: right;">0.0000087</td>
<td style="text-align: right;">0.0077827</td>
<td style="text-align: right;">-0.0003041</td>
<td style="text-align: right;">-0.0000376</td>
<td style="text-align: right;">0.0000406</td>
<td style="text-align: right;">-0.0000104</td>
<td style="text-align: right;">0.0006902</td>
<td style="text-align: right;">0.0000998</td>
<td style="text-align: right;">0.0018295</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Plot to assess influence and leverage.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb567"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb567-1"><a href="#cb567-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb567-2"><a href="#cb567-2" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(model_VLOAD_full1, <span class="at">main =</span> <span class="st">"Influence Plot"</span>,</span>
<span id="cb567-3"><a href="#cb567-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">sub =</span> <span class="st">"Circle size is proportional to Cook's Distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-304-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      StudRes         Hat       CookD
11   1.160300 0.253082963 0.065123814
138  3.522163 0.003080571 0.005357250
319  1.160588 0.253082963 0.065156076
325  3.200900 0.003080571 0.004442831
356 -1.166058 0.253082963 0.065770137</code></pre>
</div>
<div class="sourceCode cell-code" id="cb569"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb569-1"><a href="#cb569-1" aria-hidden="true" tabindex="-1"></a><span class="co"># infIndexPlot gives us a series of plots that we need to investigate influence points</span></span>
<span id="cb569-2"><a href="#cb569-2" aria-hidden="true" tabindex="-1"></a><span class="fu">infIndexPlot</span>(model_VLOAD_full1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-304-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We have two immediately obvious values for participants 319 and 356. Let’s examine them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb570"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb570-1"><a href="#cb570-1" aria-hidden="true" tabindex="-1"></a>diagnostics_VLOAD <span class="sc">%&gt;%</span></span>
<span id="cb570-2"><a href="#cb570-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>cooks_D) <span class="sc">%&gt;%</span></span>
<span id="cb570-3"><a href="#cb570-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id jackknife_residuals   leverage    cooks_D     dffits
356 356           -1.166058 0.25308296 0.06577014 -0.6787590
319 319            1.160588 0.25308296 0.06515608  0.6755746
11   11            1.160300 0.25308296 0.06512381  0.6754069
15   15           -1.154829 0.25308296 0.06451278 -0.6722226
294 294           -2.331200 0.02943947 0.02334696 -0.4060067
249 249            1.962508 0.03877677 0.02207318  0.3941714
    dfbetas..Intercept. dfbetas.hard_drugs_grpPrevious.User
356          0.03300553                         0.004084538
319          0.03285068                         0.004065375
11           0.03284253                         0.004064366
15           0.03268769                         0.004045204
294          0.06946277                         0.008596234
249          0.39417142                        -0.130929822
    dfbetas.hard_drugs_grpCurrent.User dfbetas.ADH_HIGHVSLOWHigh.Adherence
356                         -0.6393346                         0.001131482
319                          0.6275679                         0.001126173
11                           0.6274121                         0.001125894
15                          -0.6331778                         0.001120586
294                         -0.0092692                         0.002381293
249                         -0.1279571                        -0.337242003
    dfbetas.EDUC_COLLEGECollege
356                 -0.07491492
319                 -0.07456345
11                  -0.07454494
15                  -0.07419349
294                 -0.15766441
249                 -0.17366150
    dfbetas.hard_drugs_grpPrevious.User.ADH_HIGHVSLOWHigh.Adherence
356                                                     -0.01083401
319                                                     -0.01078318
11                                                      -0.01078050
15                                                      -0.01072968
294                                                     -0.14605820
249                                                      0.10521817
    dfbetas.hard_drugs_grpCurrent.User.ADH_HIGHVSLOWHigh.Adherence
356                                                     0.61793560
319                                                    -0.60397775
11                                                     -0.60382781
15                                                      0.61198491
294                                                     0.01169191
249                                                     0.12644368</code></pre>
</div>
</div>
<p>The values for 319 and 356 are actually all comparable to 11 and 15, I think they are just so far off to the side like that because otherwise you wouldn’t be able to see anything in all those overlapping circles.</p>
<p>Let’s remove them and replot, and I bet 11 and 15 will flag as outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb572"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb572-1"><a href="#cb572-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove outlier patients</span></span>
<span id="cb572-2"><a href="#cb572-2" aria-hidden="true" tabindex="-1"></a>data_VLOAD_outliers <span class="ot">&lt;-</span> data_VLOAD <span class="sc">%&gt;%</span></span>
<span id="cb572-3"><a href="#cb572-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>newid <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">15</span>, <span class="dv">319</span>, <span class="dv">356</span>))</span>
<span id="cb572-4"><a href="#cb572-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-5"><a href="#cb572-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run the model</span></span>
<span id="cb572-6"><a href="#cb572-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the regression on log viral load change with the full model</span></span>
<span id="cb572-7"><a href="#cb572-7" aria-hidden="true" tabindex="-1"></a>model_VLOAD_full1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(VLOAD_log_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW <span class="sc">+</span> EDUC_COLLEGE, <span class="at">data =</span> data_VLOAD_outliers)</span>
<span id="cb572-8"><a href="#cb572-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-9"><a href="#cb572-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb572-10"><a href="#cb572-10" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(model_VLOAD_full1, <span class="at">main =</span> <span class="st">"Influence Plot"</span>,</span>
<span id="cb572-11"><a href="#cb572-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">sub =</span> <span class="st">"Circle size is proportional to Cook's Distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-306-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>         StudRes         Hat           CookD
18  -0.006320994 0.166666667 0.0000013344488
34   0.002586461 0.166666667 0.0000002234308
129  3.521161391 0.003086349 0.0062576091114
233  1.984898220 0.038870744 0.0264040195974
276 -2.349300505 0.029494897 0.0277104476175
301  3.199508011 0.003086349 0.0051880876727</code></pre>
</div>
<div class="sourceCode cell-code" id="cb574"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb574-1"><a href="#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="co"># infIndexPlot gives us a series of plots that we need to investigate influence points</span></span>
<span id="cb574-2"><a href="#cb574-2" aria-hidden="true" tabindex="-1"></a><span class="fu">infIndexPlot</span>(model_VLOAD_full1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-306-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Yup, 11 and 15 are now flagging as outliers, which makes sense because they had basically exactly the same values of who we just deleted.</p>
<p>That looks as good as it gets without removing too many observations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb575"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb575-1"><a href="#cb575-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_VLOAD_full1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VLOAD_log_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    hard_drugs_grp * ADH_HIGHVSLOW + EDUC_COLLEGE, data = data_VLOAD_outliers)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.2637 -1.6014 -0.2047  1.1243  9.2440 

Coefficients: (1 not defined because of singularities)
                                                       Estimate Std. Error
(Intercept)                                             -5.0469     0.4434
hard_drugs_grpPrevious User                             -0.7396     0.5695
hard_drugs_grpNever User                                -0.7271     0.3813
ADH_HIGHVSLOWLow Adherence                               0.7893     0.4893
EDUC_COLLEGECollege                                     -0.7823     0.2971
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   5.8063     1.2761
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence          NA         NA
                                                       t value
(Intercept)                                            -11.383
hard_drugs_grpPrevious User                             -1.299
hard_drugs_grpNever User                                -1.907
ADH_HIGHVSLOWLow Adherence                               1.613
EDUC_COLLEGECollege                                     -2.633
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   4.550
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence         NA
                                                                   Pr(&gt;|t|)    
(Intercept)                                            &lt; 0.0000000000000002 ***
hard_drugs_grpPrevious User                                         0.19464    
hard_drugs_grpNever User                                            0.05709 .  
ADH_HIGHVSLOWLow Adherence                                          0.10735    
EDUC_COLLEGECollege                                                 0.00871 ** 
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence           0.00000672 ***
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence                      NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.659 on 510 degrees of freedom
Multiple R-squared:  0.08182,   Adjusted R-squared:  0.07281 
F-statistic: 9.089 on 5 and 510 DF,  p-value: 0.00000002716</code></pre>
</div>
<div class="sourceCode cell-code" id="cb577"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb577-1"><a href="#cb577-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove outlier patients</span></span>
<span id="cb577-2"><a href="#cb577-2" aria-hidden="true" tabindex="-1"></a>diagnostics_VLOAD <span class="ot">&lt;-</span> diagnostics_VLOAD <span class="sc">%&gt;%</span></span>
<span id="cb577-3"><a href="#cb577-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">15</span>, <span class="dv">319</span>, <span class="dv">356</span>))</span>
<span id="cb577-4"><a href="#cb577-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-5"><a href="#cb577-5" aria-hidden="true" tabindex="-1"></a>diagnostics_VLOAD <span class="sc">%&gt;%</span></span>
<span id="cb577-6"><a href="#cb577-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>cooks_D) <span class="sc">%&gt;%</span></span>
<span id="cb577-7"><a href="#cb577-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id jackknife_residuals   leverage    cooks_D     dffits
294 294           -2.331200 0.02943947 0.02334696 -0.4060067
249 249            1.962508 0.03877677 0.02207318  0.3941714
115 115            2.062544 0.03184010 0.01986047  0.3740389
400 400            2.034632 0.03184010 0.01933086  0.3689773
8     8           -2.063342 0.02943947 0.01833171 -0.3593560
529 529           -2.063335 0.02943947 0.01833158 -0.3593548
    dfbetas..Intercept. dfbetas.hard_drugs_grpPrevious.User
294          0.06946277                         0.008596234
249          0.39417142                        -0.130929822
115          0.31022065                        -0.149801564
400          0.30602260                        -0.147774382
8            0.06148140                         0.007608516
529          0.06148119                         0.007608489
    dfbetas.hard_drugs_grpCurrent.User dfbetas.ADH_HIGHVSLOWHigh.Adherence
294                       -0.009269200                         0.002381293
249                       -0.127957064                        -0.337242003
115                       -0.120311591                        -0.356676123
400                       -0.118683481                        -0.351849423
8                         -0.008204157                         0.002107680
529                       -0.008204129                         0.002107672
    dfbetas.EDUC_COLLEGECollege
294                 -0.15766441
249                 -0.17366150
115                  0.05092040
400                  0.05023133
8                   -0.13954856
529                 -0.13954808
    dfbetas.hard_drugs_grpPrevious.User.ADH_HIGHVSLOWHigh.Adherence
294                                                      -0.1460582
249                                                       0.1052182
115                                                       0.1438485
400                                                       0.1419019
8                                                        -0.1292759
529                                                      -0.1292755
    dfbetas.hard_drugs_grpCurrent.User.ADH_HIGHVSLOWHigh.Adherence
294                                                     0.01169191
249                                                     0.12644368
115                                                     0.11514983
400                                                     0.11359158
8                                                       0.01034849
529                                                     0.01034846</code></pre>
</div>
</div>
<p>At this point it appears that we have removed too many data points to be able to run our main interaction of interest.</p>
<p>This will have to be noted as a limitation in this analysis!</p>
</div>
<div id="tabset-27-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb579"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb579-1"><a href="#cb579-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb579-2"><a href="#cb579-2" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(model_LEU3N_final1, <span class="at">main =</span> <span class="st">"Influence Plot"</span>,</span>
<span id="cb579-3"><a href="#cb579-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">sub =</span> <span class="st">"Circle size is proportional to Cook's Distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-308-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       StudRes        Hat       CookD
11   0.1766928 0.25000000 0.001489502
15  -0.1770161 0.25000000 0.001494957
19   1.3573297 0.05934583 0.016577499
63   6.1637006 0.00272672 0.013839357
255  4.4007180 0.00272672 0.007302463
413  1.3689020 0.05934583 0.016860339</code></pre>
</div>
<div class="sourceCode cell-code" id="cb581"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb581-1"><a href="#cb581-1" aria-hidden="true" tabindex="-1"></a><span class="co"># infIndexPlot gives us a series of plots that we need to investigate influence points</span></span>
<span id="cb581-2"><a href="#cb581-2" aria-hidden="true" tabindex="-1"></a><span class="fu">infIndexPlot</span>(model_LEU3N_final1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-308-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Remove 63, 255, and 88, and 301 (residuals &gt; +- 3)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb582"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb582-1"><a href="#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove outlier patients</span></span>
<span id="cb582-2"><a href="#cb582-2" aria-hidden="true" tabindex="-1"></a>data_LEU3N_outliers <span class="ot">&lt;-</span> data_LEU3N <span class="sc">%&gt;%</span></span>
<span id="cb582-3"><a href="#cb582-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>newid <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">63</span>, <span class="dv">255</span>, <span class="dv">301</span>, <span class="dv">88</span>))</span>
<span id="cb582-4"><a href="#cb582-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-5"><a href="#cb582-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run the model</span></span>
<span id="cb582-6"><a href="#cb582-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the regression on log viral load change with the full model</span></span>
<span id="cb582-7"><a href="#cb582-7" aria-hidden="true" tabindex="-1"></a>model_LEU3N_final1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(LEU3N_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW <span class="sc">+</span> FRP_2, <span class="at">data =</span> data_LEU3N_outliers)</span>
<span id="cb582-8"><a href="#cb582-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-9"><a href="#cb582-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb582-10"><a href="#cb582-10" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(model_LEU3N_final1, <span class="at">main =</span> <span class="st">"Influence Plot"</span>,</span>
<span id="cb582-11"><a href="#cb582-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">sub =</span> <span class="st">"Circle size is proportional to Cook's Distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-309-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       StudRes         Hat       CookD
11   0.1921663 0.250000000 0.001761810
15  -0.1925179 0.250000000 0.001768263
19   1.4711192 0.059359050 0.019465547
127  2.9908535 0.002756788 0.003478201
387  1.4837175 0.059359050 0.019798923
403 -3.0739474 0.002756788 0.003670567</code></pre>
</div>
<div class="sourceCode cell-code" id="cb584"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb584-1"><a href="#cb584-1" aria-hidden="true" tabindex="-1"></a><span class="co"># infIndexPlot gives us a series of plots that we need to investigate influence points</span></span>
<span id="cb584-2"><a href="#cb584-2" aria-hidden="true" tabindex="-1"></a><span class="fu">infIndexPlot</span>(model_LEU3N_final1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-309-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb585"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb585-1"><a href="#cb585-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_LEU3N_final1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = LEU3N_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    hard_drugs_grp * ADH_HIGHVSLOW + FRP_2, data = data_LEU3N_outliers)

Residuals:
    Min      1Q  Median      3Q     Max 
-507.65 -107.10   -0.31  111.82  494.17 

Coefficients:
                                                       Estimate Std. Error
(Intercept)                                               79.29      22.55
hard_drugs_grpPrevious User                               11.98      34.57
hard_drugs_grpNever User                                 109.90      23.95
ADH_HIGHVSLOWLow Adherence                              -115.93      86.37
FRP_2Yes                                                -112.68      32.53
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   330.01     113.05
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence       34.16      91.50
                                                       t value   Pr(&gt;|t|)    
(Intercept)                                              3.516   0.000478 ***
hard_drugs_grpPrevious User                              0.347   0.729002    
hard_drugs_grpNever User                                 4.588 0.00000564 ***
ADH_HIGHVSLOWLow Adherence                              -1.342   0.180104    
FRP_2Yes                                                -3.463   0.000579 ***
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence   2.919   0.003665 ** 
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence      0.373   0.709012    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 166.7 on 508 degrees of freedom
Multiple R-squared:  0.1033,    Adjusted R-squared:  0.0927 
F-statistic: 9.753 on 6 and 508 DF,  p-value: 0.0000000003506</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb587"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb587-1"><a href="#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the jackknife residuals of the model predicting LEU3N</span></span>
<span id="cb587-2"><a href="#cb587-2" aria-hidden="true" tabindex="-1"></a>jackknife_residuals_LEU3N <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(model_LEU3N_final1)</span>
<span id="cb587-3"><a href="#cb587-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb587-4"><a href="#cb587-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the Q-Q plots using the jackknife residuals</span></span>
<span id="cb587-5"><a href="#cb587-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(jackknife_residuals_LEU3N, <span class="at">main =</span> <span class="st">"Q-Q plots of Jackknife Residuals for Log Viral Load"</span>)</span>
<span id="cb587-6"><a href="#cb587-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(jackknife_residuals_LEU3N, <span class="at">col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-310-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The final model for <code>LEU3N_CHANGE</code> now meets all assumptions! And it doesn’t look like any of our p-values changed.</p>
</div>
<div id="tabset-27-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb588"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb588-1"><a href="#cb588-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb588-2"><a href="#cb588-2" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(model_MENT_main1, <span class="at">main =</span> <span class="st">"Influence Plot"</span>,</span>
<span id="cb588-3"><a href="#cb588-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">sub =</span> <span class="st">"Circle size is proportional to Cook's Distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-311-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       StudRes         Hat       CookD
11   0.7565009 0.250000000 0.031819963
15  -0.5726461 0.250000000 0.018241281
27  -3.0992751 0.025000000 0.040388406
115 -3.1823928 0.030303030 0.051848323
383  3.2017709 0.002544529 0.004283228
499  3.2315736 0.002544529 0.004361775</code></pre>
</div>
<div class="sourceCode cell-code" id="cb590"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb590-1"><a href="#cb590-1" aria-hidden="true" tabindex="-1"></a><span class="co"># infIndexPlot gives us a series of plots that we need to investigate influence points</span></span>
<span id="cb590-2"><a href="#cb590-2" aria-hidden="true" tabindex="-1"></a><span class="fu">infIndexPlot</span>(model_MENT_main1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-311-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>11 and 15 are flagging as outliers again. Let’s remove them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb591"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb591-1"><a href="#cb591-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove outlier patients</span></span>
<span id="cb591-2"><a href="#cb591-2" aria-hidden="true" tabindex="-1"></a>data_MENT_outliers <span class="ot">&lt;-</span> data_MENT_main <span class="sc">%&gt;%</span></span>
<span id="cb591-3"><a href="#cb591-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>newid <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">15</span>, <span class="dv">319</span>, <span class="dv">356</span>))</span>
<span id="cb591-4"><a href="#cb591-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb591-5"><a href="#cb591-5" aria-hidden="true" tabindex="-1"></a>data_MENT_outliers <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(AGG_MENT_CHANGE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 528 × 4
   newid AGG_MENT_CHANGE hard_drugs_grp ADH_HIGHVSLOW 
   &lt;dbl&gt;           &lt;dbl&gt; &lt;fct&gt;          &lt;fct&gt;         
 1   115           -38.2 Never User     Low Adherence 
 2   421           -33.4 Never User     High Adherence
 3    27           -31.1 Previous User  High Adherence
 4   140           -30.2 Never User     Low Adherence 
 5   526           -27.6 Never User     High Adherence
 6   486           -27.6 Previous User  High Adherence
 7   529           -26.9 Previous User  High Adherence
 8   483           -26.4 Never User     High Adherence
 9   294           -26.2 Previous User  High Adherence
10    43           -26.0 Previous User  High Adherence
# ℹ 518 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb593"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb593-1"><a href="#cb593-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run the model</span></span>
<span id="cb593-2"><a href="#cb593-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the regression on log viral load change with the full model</span></span>
<span id="cb593-3"><a href="#cb593-3" aria-hidden="true" tabindex="-1"></a>model_MENT_main1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_MENT_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW, <span class="at">data =</span> data_MENT_outliers)</span>
<span id="cb593-4"><a href="#cb593-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb593-5"><a href="#cb593-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb593-6"><a href="#cb593-6" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(model_MENT_main1, <span class="at">main =</span> <span class="st">"Influence Plot"</span>,</span>
<span id="cb593-7"><a href="#cb593-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">sub =</span> <span class="st">"Circle size is proportional to Cook's Distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-312-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        StudRes         Hat        CookD
18   0.04434285 0.166666667 0.0000788019
25  -3.09444752 0.025000000 0.0483134755
34  -0.09645958 0.166666667 0.0003728843
110 -3.17743980 0.030303030 0.0620220724
365  3.19678871 0.002544529 0.0051236887
479  3.22654658 0.002544529 0.0052176483</code></pre>
</div>
<div class="sourceCode cell-code" id="cb595"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb595-1"><a href="#cb595-1" aria-hidden="true" tabindex="-1"></a><span class="co"># infIndexPlot gives us a series of plots that we need to investigate influence points</span></span>
<span id="cb595-2"><a href="#cb595-2" aria-hidden="true" tabindex="-1"></a><span class="fu">infIndexPlot</span>(model_MENT_main1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-312-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb596"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb596-1"><a href="#cb596-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_MENT_main1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AGG_MENT_CHANGE ~ hard_drugs_grp + ADH_HIGHVSLOW + 
    hard_drugs_grp * ADH_HIGHVSLOW, data = data_MENT_outliers)

Residuals:
    Min      1Q  Median      3Q     Max 
-37.392  -5.814  -0.839   4.980  38.498 

Coefficients: (1 not defined because of singularities)
                                                       Estimate Std. Error
(Intercept)                                             -0.5437     1.6108
hard_drugs_grpPrevious User                              5.9844     2.4954
hard_drugs_grpNever User                                 3.1777     1.7217
ADH_HIGHVSLOWLow Adherence                              -3.4343     2.1846
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence -18.7589     5.7115
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence          NA         NA
                                                       t value Pr(&gt;|t|)   
(Intercept)                                             -0.338  0.73583   
hard_drugs_grpPrevious User                              2.398  0.01683 * 
hard_drugs_grpNever User                                 1.846  0.06551 . 
ADH_HIGHVSLOWLow Adherence                              -1.572  0.11655   
hard_drugs_grpPrevious User:ADH_HIGHVSLOWLow Adherence  -3.284  0.00109 **
hard_drugs_grpNever User:ADH_HIGHVSLOWLow Adherence         NA       NA   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.05 on 523 degrees of freedom
Multiple R-squared:  0.04234,   Adjusted R-squared:  0.03501 
F-statistic: 5.781 on 4 and 523 DF,  p-value: 0.0001475</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb598"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb598-1"><a href="#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the Q-Q plots using the jackknife residuals</span></span>
<span id="cb598-2"><a href="#cb598-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(jackknife_residuals_MENT_main, <span class="at">main =</span> <span class="st">"Q-Q plots of Jackknife Residuals for Mental QOL Change"</span>)</span>
<span id="cb598-3"><a href="#cb598-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(jackknife_residuals_MENT_main, <span class="at">col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-313-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb599"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb599-1"><a href="#cb599-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of jackknife residuals</span></span>
<span id="cb599-2"><a href="#cb599-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(jackknife_residuals_MENT_main, <span class="at">main =</span> <span class="st">"Histogram of Jackknife Residuals"</span>,</span>
<span id="cb599-3"><a href="#cb599-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">24</span>,</span>
<span id="cb599-4"><a href="#cb599-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Jackknife Residuals"</span>,</span>
<span id="cb599-5"><a href="#cb599-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb599-6"><a href="#cb599-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-313-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This doesn’t appear to do much for our assumptions for this model however.</p>
<p>It doesn’t appear that outliers are driving this shape.</p>
</div>
<div id="tabset-27-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb600"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb600-1"><a href="#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb600-2"><a href="#cb600-2" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(model_PHYS_final1, <span class="at">main =</span> <span class="st">"Influence Plot"</span>,</span>
<span id="cb600-3"><a href="#cb600-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">sub =</span> <span class="st">"Circle size is proportional to Cook's Distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-314-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       StudRes         Hat       CookD
11  -0.4163080 0.250000000 0.008265987
15   0.5655178 0.250000000 0.015248823
310  2.7057912 0.034424784 0.036844928
432  4.2632413 0.002646125 0.006670562
433 -4.3421118 0.002646125 0.006911007
454 -3.2468258 0.034424784 0.052733017</code></pre>
</div>
<div class="sourceCode cell-code" id="cb602"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb602-1"><a href="#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="co"># infIndexPlot gives us a series of plots that we need to investigate influence points</span></span>
<span id="cb602-2"><a href="#cb602-2" aria-hidden="true" tabindex="-1"></a><span class="fu">infIndexPlot</span>(model_PHYS_final1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-314-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Same high leverage points we saw with mental QOL.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb603"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb603-1"><a href="#cb603-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove outlier patients</span></span>
<span id="cb603-2"><a href="#cb603-2" aria-hidden="true" tabindex="-1"></a>data_PHYS_outliers <span class="ot">&lt;-</span> data_PHYS <span class="sc">%&gt;%</span></span>
<span id="cb603-3"><a href="#cb603-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>newid <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">15</span>, <span class="dv">319</span>, <span class="dv">356</span>))</span>
<span id="cb603-4"><a href="#cb603-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb603-5"><a href="#cb603-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the regression on log viral load change with the full model</span></span>
<span id="cb603-6"><a href="#cb603-6" aria-hidden="true" tabindex="-1"></a>model_PHYS_final1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW <span class="sc">+</span> FRP_2, <span class="at">data =</span> data_PHYS_outliers)</span>
<span id="cb603-7"><a href="#cb603-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb603-8"><a href="#cb603-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb603-9"><a href="#cb603-9" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(model_PHYS_final1, <span class="at">main =</span> <span class="st">"Influence Plot"</span>,</span>
<span id="cb603-10"><a href="#cb603-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">sub =</span> <span class="st">"Circle size is proportional to Cook's Distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-315-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        StudRes         Hat         CookD
18  -0.18295228 0.166666667 0.00111778762
34   0.04301554 0.166666667 0.00006179605
296  2.70027129 0.034424784 0.04281003428
413  4.25461621 0.002646125 0.00775051075
414 -4.33333176 0.002646125 0.00802988231
435 -3.24021846 0.034424784 0.06127036814</code></pre>
</div>
<div class="sourceCode cell-code" id="cb605"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb605-1"><a href="#cb605-1" aria-hidden="true" tabindex="-1"></a><span class="co"># infIndexPlot gives us a series of plots that we need to investigate influence points</span></span>
<span id="cb605-2"><a href="#cb605-2" aria-hidden="true" tabindex="-1"></a><span class="fu">infIndexPlot</span>(model_PHYS_final1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-315-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb606"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb606-1"><a href="#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get leverage values (hat values)</span></span>
<span id="cb606-2"><a href="#cb606-2" aria-hidden="true" tabindex="-1"></a>hat_values_PHYS <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(model_PHYS_final1)</span>
<span id="cb606-3"><a href="#cb606-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb606-4"><a href="#cb606-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a table with ID and all diagnostic values</span></span>
<span id="cb606-5"><a href="#cb606-5" aria-hidden="true" tabindex="-1"></a>diagnostics_PHYS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> data_PHYS_outliers<span class="sc">$</span>newid, <span class="at">leverage =</span> hat_values_PHYS)</span>
<span id="cb606-6"><a href="#cb606-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb606-7"><a href="#cb606-7" aria-hidden="true" tabindex="-1"></a>diagnostics_PHYS <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="sc">-</span>leverage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id    leverage
18   20 0.166666667
34   36 0.166666667
50   52 0.166666667
406 425 0.166666667
484 504 0.166666667
525 547 0.166666667
234 246 0.063760499
17   19 0.057112064
395 413 0.057112064
23   25 0.046222285
39   41 0.046222285
260 272 0.046222285
462 482 0.046222285
503 525 0.046222285
5     5 0.046222285
115 121 0.034424784
152 160 0.034424784
166 175 0.034424784
187 197 0.034424784
207 217 0.034424784
214 224 0.034424784
291 305 0.034424784
295 309 0.034424784
296 310 0.034424784
310 326 0.034424784
376 394 0.034424784
396 414 0.034424784
410 429 0.034424784
417 436 0.034424784
435 454 0.034424784
454 474 0.034424784
455 475 0.034424784
468 488 0.034424784
495 517 0.034424784
496 518 0.034424784
509 531 0.034424784
53   55 0.030335704
72   74 0.030335704
83   86 0.030335704
97  102 0.030335704
101 106 0.030335704
104 109 0.030335704
110 115 0.030335704
113 119 0.030335704
121 127 0.030335704
134 140 0.030335704
147 155 0.030335704
153 161 0.030335704
156 165 0.030335704
162 171 0.030335704
226 238 0.030335704
229 241 0.030335704
232 244 0.030335704
237 249 0.030335704
254 266 0.030335704
270 283 0.030335704
305 321 0.030335704
328 344 0.030335704
357 375 0.030335704
368 386 0.030335704
382 400 0.030335704
407 426 0.030335704
421 440 0.030335704
426 445 0.030335704
428 447 0.030335704
446 465 0.030335704
488 508 0.030335704
526 548 0.030335704
8     8 0.025088953
10   10 0.025088953
12   13 0.025088953
16   18 0.025088953
20   22 0.025088953
21   23 0.025088953
25   27 0.025088953
27   29 0.025088953
29   31 0.025088953
33   35 0.025088953
36   38 0.025088953
37   39 0.025088953
41   43 0.025088953
43   45 0.025088953
45   47 0.025088953
49   51 0.025088953
123 129 0.025088953
184 194 0.025088953
217 227 0.025088953
281 294 0.025088953
294 308 0.025088953
335 351 0.025088953
388 406 0.025088953
452 472 0.025088953
458 478 0.025088953
466 486 0.025088953
469 489 0.025088953
475 495 0.025088953
482 502 0.025088953
493 515 0.025088953
499 521 0.025088953
507 529 0.025088953
510 532 0.025088953
516 538 0.025088953
523 545 0.025088953
4     4 0.025088953
1     1 0.025088953
2     2 0.025088953
6     6 0.018265601
7     7 0.018265601
9     9 0.018265601
11   12 0.018265601
13   14 0.018265601
14   16 0.018265601
15   17 0.018265601
19   21 0.018265601
22   24 0.018265601
24   26 0.018265601
26   28 0.018265601
28   30 0.018265601
30   32 0.018265601
31   33 0.018265601
32   34 0.018265601
35   37 0.018265601
38   40 0.018265601
40   42 0.018265601
42   44 0.018265601
44   46 0.018265601
46   48 0.018265601
47   49 0.018265601
48   50 0.018265601
51   53 0.018265601
203 213 0.018265601
272 285 0.018265601
278 291 0.018265601
285 299 0.018265601
321 337 0.018265601
336 352 0.018265601
379 397 0.018265601
384 402 0.018265601
437 456 0.018265601
459 479 0.018265601
465 485 0.018265601
467 487 0.018265601
472 492 0.018265601
476 496 0.018265601
480 500 0.018265601
481 501 0.018265601
487 507 0.018265601
500 522 0.018265601
506 528 0.018265601
508 530 0.018265601
513 535 0.018265601
517 539 0.018265601
521 543 0.018265601
522 544 0.018265601
528 550 0.018265601
3     3 0.018265601
52   54 0.002646125
54   56 0.002646125
55   57 0.002646125
56   58 0.002646125
57   59 0.002646125
58   60 0.002646125
59   61 0.002646125
60   62 0.002646125
61   63 0.002646125
62   64 0.002646125
63   65 0.002646125
64   66 0.002646125
65   67 0.002646125
66   68 0.002646125
67   69 0.002646125
68   70 0.002646125
69   71 0.002646125
70   72 0.002646125
71   73 0.002646125
73   75 0.002646125
74   76 0.002646125
75   77 0.002646125
76   78 0.002646125
77   79 0.002646125
78   81 0.002646125
79   82 0.002646125
80   83 0.002646125
81   84 0.002646125
82   85 0.002646125
84   87 0.002646125
85   88 0.002646125
86   89 0.002646125
87   90 0.002646125
88   91 0.002646125
89   93 0.002646125
90   94 0.002646125
91   95 0.002646125
92   96 0.002646125
93   97 0.002646125
94   98 0.002646125
95  100 0.002646125
96  101 0.002646125
98  103 0.002646125
99  104 0.002646125
100 105 0.002646125
102 107 0.002646125
103 108 0.002646125
105 110 0.002646125
106 111 0.002646125
107 112 0.002646125
108 113 0.002646125
109 114 0.002646125
111 116 0.002646125
112 117 0.002646125
114 120 0.002646125
116 122 0.002646125
117 123 0.002646125
118 124 0.002646125
119 125 0.002646125
120 126 0.002646125
122 128 0.002646125
124 130 0.002646125
125 131 0.002646125
126 132 0.002646125
127 133 0.002646125
128 134 0.002646125
129 135 0.002646125
130 136 0.002646125
131 137 0.002646125
132 138 0.002646125
133 139 0.002646125
135 141 0.002646125
136 142 0.002646125
137 144 0.002646125
138 145 0.002646125
139 146 0.002646125
140 147 0.002646125
141 148 0.002646125
142 149 0.002646125
143 150 0.002646125
144 151 0.002646125
145 153 0.002646125
146 154 0.002646125
148 156 0.002646125
149 157 0.002646125
150 158 0.002646125
151 159 0.002646125
154 162 0.002646125
155 164 0.002646125
157 166 0.002646125
158 167 0.002646125
159 168 0.002646125
160 169 0.002646125
161 170 0.002646125
163 172 0.002646125
164 173 0.002646125
165 174 0.002646125
167 176 0.002646125
168 177 0.002646125
169 178 0.002646125
170 179 0.002646125
171 180 0.002646125
172 181 0.002646125
173 182 0.002646125
174 183 0.002646125
175 184 0.002646125
176 185 0.002646125
177 186 0.002646125
178 187 0.002646125
179 188 0.002646125
180 189 0.002646125
181 190 0.002646125
182 191 0.002646125
183 192 0.002646125
185 195 0.002646125
186 196 0.002646125
188 198 0.002646125
189 199 0.002646125
190 200 0.002646125
191 201 0.002646125
192 202 0.002646125
193 203 0.002646125
194 204 0.002646125
195 205 0.002646125
196 206 0.002646125
197 207 0.002646125
198 208 0.002646125
199 209 0.002646125
200 210 0.002646125
201 211 0.002646125
202 212 0.002646125
204 214 0.002646125
205 215 0.002646125
206 216 0.002646125
208 218 0.002646125
209 219 0.002646125
210 220 0.002646125
211 221 0.002646125
212 222 0.002646125
213 223 0.002646125
215 225 0.002646125
216 226 0.002646125
218 228 0.002646125
219 229 0.002646125
220 230 0.002646125
221 232 0.002646125
222 233 0.002646125
223 234 0.002646125
224 236 0.002646125
225 237 0.002646125
227 239 0.002646125
228 240 0.002646125
230 242 0.002646125
231 243 0.002646125
233 245 0.002646125
235 247 0.002646125
236 248 0.002646125
238 250 0.002646125
239 251 0.002646125
240 252 0.002646125
241 253 0.002646125
242 254 0.002646125
243 255 0.002646125
244 256 0.002646125
245 257 0.002646125
246 258 0.002646125
247 259 0.002646125
248 260 0.002646125
249 261 0.002646125
250 262 0.002646125
251 263 0.002646125
252 264 0.002646125
253 265 0.002646125
255 267 0.002646125
256 268 0.002646125
257 269 0.002646125
258 270 0.002646125
259 271 0.002646125
261 273 0.002646125
262 274 0.002646125
263 275 0.002646125
264 276 0.002646125
265 277 0.002646125
266 278 0.002646125
267 279 0.002646125
268 281 0.002646125
269 282 0.002646125
271 284 0.002646125
273 286 0.002646125
274 287 0.002646125
275 288 0.002646125
276 289 0.002646125
277 290 0.002646125
279 292 0.002646125
280 293 0.002646125
282 296 0.002646125
283 297 0.002646125
284 298 0.002646125
286 300 0.002646125
287 301 0.002646125
288 302 0.002646125
289 303 0.002646125
290 304 0.002646125
292 306 0.002646125
293 307 0.002646125
297 312 0.002646125
298 313 0.002646125
299 314 0.002646125
300 315 0.002646125
301 316 0.002646125
302 317 0.002646125
303 318 0.002646125
304 320 0.002646125
306 322 0.002646125
307 323 0.002646125
308 324 0.002646125
309 325 0.002646125
311 327 0.002646125
312 328 0.002646125
313 329 0.002646125
314 330 0.002646125
315 331 0.002646125
316 332 0.002646125
317 333 0.002646125
318 334 0.002646125
319 335 0.002646125
320 336 0.002646125
322 338 0.002646125
323 339 0.002646125
324 340 0.002646125
325 341 0.002646125
326 342 0.002646125
327 343 0.002646125
329 345 0.002646125
330 346 0.002646125
331 347 0.002646125
332 348 0.002646125
333 349 0.002646125
334 350 0.002646125
337 353 0.002646125
338 354 0.002646125
339 355 0.002646125
340 357 0.002646125
341 358 0.002646125
342 359 0.002646125
343 360 0.002646125
344 361 0.002646125
345 362 0.002646125
346 363 0.002646125
347 364 0.002646125
348 366 0.002646125
349 367 0.002646125
350 368 0.002646125
351 369 0.002646125
352 370 0.002646125
353 371 0.002646125
354 372 0.002646125
355 373 0.002646125
356 374 0.002646125
358 376 0.002646125
359 377 0.002646125
360 378 0.002646125
361 379 0.002646125
362 380 0.002646125
363 381 0.002646125
364 382 0.002646125
365 383 0.002646125
366 384 0.002646125
367 385 0.002646125
369 387 0.002646125
370 388 0.002646125
371 389 0.002646125
372 390 0.002646125
373 391 0.002646125
374 392 0.002646125
375 393 0.002646125
377 395 0.002646125
378 396 0.002646125
380 398 0.002646125
381 399 0.002646125
383 401 0.002646125
385 403 0.002646125
386 404 0.002646125
387 405 0.002646125
389 407 0.002646125
390 408 0.002646125
391 409 0.002646125
392 410 0.002646125
393 411 0.002646125
394 412 0.002646125
397 415 0.002646125
398 416 0.002646125
399 418 0.002646125
400 419 0.002646125
401 420 0.002646125
402 421 0.002646125
403 422 0.002646125
404 423 0.002646125
405 424 0.002646125
408 427 0.002646125
409 428 0.002646125
411 430 0.002646125
412 431 0.002646125
413 432 0.002646125
414 433 0.002646125
415 434 0.002646125
416 435 0.002646125
418 437 0.002646125
419 438 0.002646125
420 439 0.002646125
422 441 0.002646125
423 442 0.002646125
424 443 0.002646125
425 444 0.002646125
427 446 0.002646125
429 448 0.002646125
430 449 0.002646125
431 450 0.002646125
432 451 0.002646125
433 452 0.002646125
434 453 0.002646125
436 455 0.002646125
438 457 0.002646125
439 458 0.002646125
440 459 0.002646125
441 460 0.002646125
442 461 0.002646125
443 462 0.002646125
444 463 0.002646125
445 464 0.002646125
447 466 0.002646125
448 467 0.002646125
449 469 0.002646125
450 470 0.002646125
451 471 0.002646125
453 473 0.002646125
456 476 0.002646125
457 477 0.002646125
460 480 0.002646125
461 481 0.002646125
463 483 0.002646125
464 484 0.002646125
470 490 0.002646125
471 491 0.002646125
473 493 0.002646125
474 494 0.002646125
477 497 0.002646125
478 498 0.002646125
479 499 0.002646125
483 503 0.002646125
485 505 0.002646125
486 506 0.002646125
489 509 0.002646125
490 510 0.002646125
491 512 0.002646125
492 514 0.002646125
494 516 0.002646125
497 519 0.002646125
498 520 0.002646125
501 523 0.002646125
502 524 0.002646125
504 526 0.002646125
505 527 0.002646125
511 533 0.002646125
512 534 0.002646125
514 536 0.002646125
515 537 0.002646125
518 540 0.002646125
519 541 0.002646125
520 542 0.002646125
524 546 0.002646125
527 549 0.002646125</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb608"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb608-1"><a href="#cb608-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the regression on log viral load change with the full model</span></span>
<span id="cb608-2"><a href="#cb608-2" aria-hidden="true" tabindex="-1"></a>model_PHYS_final1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(AGG_PHYS_CHANGE <span class="sc">~</span> hard_drugs_grp <span class="sc">+</span> ADH_HIGHVSLOW <span class="sc">+</span> hard_drugs_grp<span class="sc">*</span>ADH_HIGHVSLOW <span class="sc">+</span> FRP_2, <span class="at">data =</span> data_PHYS_outliers)</span>
<span id="cb608-3"><a href="#cb608-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-4"><a href="#cb608-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb608-5"><a href="#cb608-5" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(model_PHYS_final1, <span class="at">main =</span> <span class="st">"Influence Plot"</span>,</span>
<span id="cb608-6"><a href="#cb608-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">sub =</span> <span class="st">"Circle size is proportional to Cook's Distance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-317-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        StudRes         Hat         CookD
18  -0.18295228 0.166666667 0.00111778762
34   0.04301554 0.166666667 0.00006179605
296  2.70027129 0.034424784 0.04281003428
413  4.25461621 0.002646125 0.00775051075
414 -4.33333176 0.002646125 0.00802988231
435 -3.24021846 0.034424784 0.06127036814</code></pre>
</div>
<div class="sourceCode cell-code" id="cb610"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb610-1"><a href="#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="co"># infIndexPlot gives us a series of plots that we need to investigate influence points</span></span>
<span id="cb610-2"><a href="#cb610-2" aria-hidden="true" tabindex="-1"></a><span class="fu">infIndexPlot</span>(model_PHYS_final1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-317-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb611"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb611-1"><a href="#cb611-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the Q-Q plots using the jackknife residuals</span></span>
<span id="cb611-2"><a href="#cb611-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(jackknife_residuals_PHYS, <span class="at">main =</span> <span class="st">"Q-Q plots of Jackknife Residuals for Physical QOL Change"</span>)</span>
<span id="cb611-3"><a href="#cb611-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(jackknife_residuals_PHYS, <span class="at">col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-318-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb612"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb612-1"><a href="#cb612-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram of jackknife residuals</span></span>
<span id="cb612-2"><a href="#cb612-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(jackknife_residuals_PHYS, <span class="at">main =</span> <span class="st">"Histogram of Jackknife Residuals"</span>,</span>
<span id="cb612-3"><a href="#cb612-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">24</span>,</span>
<span id="cb612-4"><a href="#cb612-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Jackknife Residuals"</span>,</span>
<span id="cb612-5"><a href="#cb612-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb612-6"><a href="#cb612-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-318-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The data looks slightly more normally distributed</p>
</div>
</div>
</div>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<p>Note: Co-written with project partner Dominick Demarsico (30% Dominick 70% Sean)</p>
<p>The total population of the study was 550 participants. Of that total, all were male, HIV+, and taking HAART treatment after baseline. Never drug use had 444 subjects, past drug use had 46 subjects, and current drug use had 60 subjects. While there are large population size discrepancies, all of the groups were sufficiently large (&gt;30) (See Table 1). Primary outcome data was missing in 18 patients for Viral Load, 18 for Leukocyte count, 7 for Mental Wellbeing, and 7 for Physical wellbeing. Income, Triglycerides, LDL, and BMI were all dropped from analysis due to missingness being greater than 20%. We then decided to move forward with a complete case analysis. Figure 1 reveals that there were moderate correlations (r = ~30% - 60%) between at least one of our primary outcome variables and education, frailty phenotype, age, smoking status, depression, and adherence.</p>
<p>Backward elimination using BIC determined the final covariates to be included for viral load were education, hard drug use, adherence, and the interaction between drug use and adherence. There were significant differences in change in log viral load based on hard drug usage and adherence to the treatment regimen, while controlling for education at baseline (F(6, 513)= 9.51), p &lt; 0.0001). Low Adherence led to 3.48 increased log viral load in Current users (p = .04) and 5.81 increased log viral load in past users (p &lt;.001). However, there were no significant differences in viral load for drug users with High Adherence (See Figure 2)</p>
<p>Backwards elimination using BIC determined the covariates to be included for CD4+ T Cell count were frailty phenotype along with adherence, drug use category, and their interaction. There were significant differences in change in CD4+ T Cell count over 2 years based on hard drug usage and adherence to the treatment regimen, while controlling for Frailty Related Phenotype (F(6,512) = 8.42, p &lt; 0.00001). Low Adherence led to a 197.90 cell increase in CD4 in previous users compared to never users (p = .04). Never users and current users did not differ significantly from each other. Current users had a 342.0 cell decrease compared to past users (p = 01). High Adherence led to a 99.23 cell decrease in past users (p = .003) and a 111.16 cell decrease in current users (p &lt;.001) when compared to never users (See Figure 3)</p>
<p>For Mental Wellbeing, backward elimination using BIC determined that the final covariates to include were drug use, adherence, and their interaction. There were significant differences in mental QOL over 2 years based on hard drug usage and adherence to the treatment regimen (F(5,526) = 4.78, p = 0.000278). Low Adherence led to a 15.95 point decrease in mental QoL in previous drug users compared to never drug users (p =.009), and a 23.91 decrease compared to never hard drug users (p = 0.007). There was no difference in mental QOL between current and never hard drug users at low adherence (p = 0.64). At high adherence, there was no difference in mental QOL between previous and never hard drug users (p = 0.48), or between current and never hard drug users (p = 0.20). The difference in mental QOL for current and previous users was borderline significant (p = 0.050) (See Figure 3). While depression was highly correlated to mental QOL, it was determined to be a confounder and a separate analysis run, showing heightened risk of depression for previous users (See Figure 3a).</p>
<p>For Physical wellbeing, backward elimination using BIC selected the final model to include frailty related phenotype along with drug use, adherence, and their interaction. There were significant differences in change in physical QOL over 2 years based on hard drug usage and adherence to the treatment regimen, while controlling for Frailty Related Phenotype (F(6, 525) = 20.67, p &lt; 0.0001). Low Adherence led to a 10.89 point decrease in physical QoL in past drug users compared to never drug users (p =.004). Current users did not differ significantly from never users. High Adherence led to current users having a 3.94 point decrease in physical QoL compared to never users (p = .001), and a 5.35 point decrease when compared to past users (p = .002). There was no difference between previous and never users (p = 0.8). See Figure 5.</p>
<p>Assumptions for a regression were assessed using Q-Q plots, histograms of the residuals, scale-location plots, and scatterplots of the residuals against the fitted-values. All assumptions were met for Leukocyte levels. However, Viral Load, Mental QoL, and Physical QoL have slight violations of normality and homogeneity of variances.</p>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<p>Note: Co-written with project partner Dominick DeMarsico (50% Dominick 50% Sean)</p>
<p>With regard to our research question, adherence played a major role in affecting the reliability of the models. We have evidence to suggest that the relationship between treatment outcomes and drug use is modified by the interaction of adherence and drug use. Therefore, we have evidence to reject the null hypothesis. From our perspective, adherence would act as a confounder if it were not already accounted for in our model. Specifically, low adherence leads to worsened outcomes in current users for viral load, and in previous users for all outcome variables including mental and physical well being. Thus, previous hard drug users are a vulnerable population and appear to be struggling with quitting, and more aggressive treatment strategies should be considered to support them.</p>
<p>Additionally, only 7.8% of subjects fell into the category of low adherence, with only 4 previous and 6 current drug users. The lack of subjects in this category severely hampers our ability to use an interaction term at all for certain groups. A larger N in this category would allow for more information on the true interaction within these groups.</p>
<p>Another consideration should be physical and mental changes that occur during pathology but can not be explained by treatment. Access to a list of Adverse Events suffered by the subjects would be very helpful to better understand what is causing changes. Additionally, the slight deviation from normality with some of our outcome variables can be attributed to using change scores rather than each individual time point as a unique observation. This method effectively cut our N by two-thirds. We expect that longitudinal analyses allowing for an N closer to the original value of 1600 would alleviate these symptoms for normality.</p>
</section>
<section id="bonus" class="level1">
<h1>Bonus</h1>
<section id="plotting-outcome-variables-across-full-8-years" class="level2">
<h2 class="anchored" data-anchor-id="plotting-outcome-variables-across-full-8-years">Plotting Outcome Variables Across Full 8 Years</h2>
<p>The below plots were used as justification and evidence for separating adherence from four levels to two levels, as this seemed to be whether the most meaninfgul and true split was.</p>
<section id="mental-qol" class="level3">
<h3 class="anchored" data-anchor-id="mental-qol">Mental QOL</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb613"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb613-1"><a href="#cb613-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of that value of 1 for adherence at baseline for patient 426</span></span>
<span id="cb613-2"><a href="#cb613-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ADH[data<span class="sc">$</span>years <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb613-3"><a href="#cb613-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb613-4"><a href="#cb613-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get means for each year</span></span>
<span id="cb613-5"><a href="#cb613-5" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb613-6"><a href="#cb613-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADH, years) <span class="sc">%&gt;%</span></span>
<span id="cb613-7"><a href="#cb613-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_QOL =</span> <span class="fu">mean</span>(AGG_MENT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ADH'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb615"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb615-1"><a href="#cb615-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb615-2"><a href="#cb615-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> years, <span class="at">y =</span> Average_QOL, <span class="at">color =</span> ADH)) <span class="sc">+</span></span>
<span id="cb615-3"><a href="#cb615-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="co"># Line plot</span></span>
<span id="cb615-4"><a href="#cb615-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Add points for clarity</span></span>
<span id="cb615-5"><a href="#cb615-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Mental QOL Score by Adherence Group Over 8 Years"</span>,</span>
<span id="cb615-6"><a href="#cb615-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb615-7"><a href="#cb615-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Mental QOL Score"</span>,</span>
<span id="cb615-8"><a href="#cb615-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Adherence Group"</span>) <span class="sc">+</span></span>
<span id="cb615-9"><a href="#cb615-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>       <span class="co"># Clean theme</span></span>
<span id="cb615-10"><a href="#cb615-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)  <span class="co"># Nice color palette for groups</span></span>
<span id="cb615-11"><a href="#cb615-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb615-12"><a href="#cb615-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-fc535161feb9cb7bca29" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-fc535161feb9cb7bca29">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8],"y":[47.080598898534795,49.932325535947136,50.007513196263737,49.722346176206898,50.572593847972222,52.113649462076921,50.380592808743593,51.684046215000002],"text":["years: 1<br />Average_QOL: 47.08060<br />ADH: 100%","years: 2<br />Average_QOL: 49.93233<br />ADH: 100%","years: 3<br />Average_QOL: 50.00751<br />ADH: 100%","years: 4<br />Average_QOL: 49.72235<br />ADH: 100%","years: 5<br />Average_QOL: 50.57259<br />ADH: 100%","years: 6<br />Average_QOL: 52.11365<br />ADH: 100%","years: 7<br />Average_QOL: 50.38059<br />ADH: 100%","years: 8<br />Average_QOL: 51.68405<br />ADH: 100%"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(179,226,205,1)","dash":"solid"},"hoveron":"points","name":"100%","legendgroup":"100%","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(179,226,205,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(179,226,205,1)"}},"frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[46.132743641650485,45.609151841673004,45.55399797874118,45.991109738388886,46.141880501257859,46.259709397675003,49.946615863593749,46.903431481964283],"text":["years: 1<br />Average_QOL: 46.13274<br />ADH: 95-99%","years: 2<br />Average_QOL: 45.60915<br />ADH: 95-99%","years: 3<br />Average_QOL: 45.55400<br />ADH: 95-99%","years: 4<br />Average_QOL: 45.99111<br />ADH: 95-99%","years: 5<br />Average_QOL: 46.14188<br />ADH: 95-99%","years: 6<br />Average_QOL: 46.25971<br />ADH: 95-99%","years: 7<br />Average_QOL: 49.94662<br />ADH: 95-99%","years: 8<br />Average_QOL: 46.90343<br />ADH: 95-99%"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(253,205,172,1)","dash":"solid"},"hoveron":"points","name":"95-99%","legendgroup":"95-99%","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(253,205,172,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(253,205,172,1)"}},"frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[44.574401681186444,42.310305652093021,45.061226262982458,38.808215253235296,48.118869594838714,45.624502319565217,43.087397573157894,47.353961322631577],"text":["years: 1<br />Average_QOL: 44.57440<br />ADH: 75-94%","years: 2<br />Average_QOL: 42.31031<br />ADH: 75-94%","years: 3<br />Average_QOL: 45.06123<br />ADH: 75-94%","years: 4<br />Average_QOL: 38.80822<br />ADH: 75-94%","years: 5<br />Average_QOL: 48.11887<br />ADH: 75-94%","years: 6<br />Average_QOL: 45.62450<br />ADH: 75-94%","years: 7<br />Average_QOL: 43.08740<br />ADH: 75-94%","years: 8<br />Average_QOL: 47.35396<br />ADH: 75-94%"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(203,213,232,1)","dash":"solid"},"hoveron":"points","name":"75-94%","legendgroup":"75-94%","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(203,213,232,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(203,213,232,1)"}},"frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[51.806363477777779,52.033987411818181,37.071305609999996,48.877614637500002,40.336675143333338,47.061343600000001,57.2068769475,46.757900755000001],"text":["years: 1<br />Average_QOL: 51.80636<br />ADH: <75%","years: 2<br />Average_QOL: 52.03399<br />ADH: <75%","years: 3<br />Average_QOL: 37.07131<br />ADH: <75%","years: 4<br />Average_QOL: 48.87761<br />ADH: <75%","years: 5<br />Average_QOL: 40.33668<br />ADH: <75%","years: 6<br />Average_QOL: 47.06134<br />ADH: <75%","years: 7<br />Average_QOL: 57.20688<br />ADH: <75%","years: 8<br />Average_QOL: 46.75790<br />ADH: <75%"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(244,202,228,1)","dash":"solid"},"hoveron":"points","name":"<75%","legendgroup":"<75%","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(244,202,228,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(244,202,228,1)"}},"frame":null},{"x":[0],"y":[45.178146551739523],"text":"years: 0<br />Average_QOL: 45.17815<br />ADH: NA","type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"transparent","dash":"solid"},"hoveron":"points","name":"NA","legendgroup":"NA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"transparent"}},"frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":37.260273972602747},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Average Mental QOL Score by Adherence Group Over 8 Years","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.40000000000000002,8.4000000000000004],"tickmode":"array","ticktext":["0","2","4","6","8"],"tickvals":[0,2,4,6,8],"categoryorder":"array","categoryarray":["0","2","4","6","8"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[36.064527043124997,58.213655514374999],"tickmode":"array","ticktext":["40","45","50","55"],"tickvals":[40,45,50,55],"categoryorder":"array","categoryarray":["40","45","50","55"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Average Mental QOL Score","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Adherence Group","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"3d385c2d4043":{"x":{},"y":{},"colour":{},"type":"scatter"},"3d382963720a":{"x":{},"y":{},"colour":{}}},"cur_data":"3d385c2d4043","visdat":{"3d385c2d4043":["function (y) ","x"],"3d382963720a":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Success! This is very interesting. It appears that the 100% adherence group has the highest average mental QOL score across the 8 year study, followed by the 95-99% group, followed by the &lt;75% group and followed by (with some variation) the &lt;75% and 75-94% groups.</p>
</section>
<section id="physical-qol" class="level3">
<h3 class="anchored" data-anchor-id="physical-qol">Physical QOL</h3>
<p>Let’s do the same thing but for <code>AGG_PHYS</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb616"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb616-1"><a href="#cb616-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get means for each year</span></span>
<span id="cb616-2"><a href="#cb616-2" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb616-3"><a href="#cb616-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADH, years) <span class="sc">%&gt;%</span></span>
<span id="cb616-4"><a href="#cb616-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_QOL =</span> <span class="fu">mean</span>(AGG_PHYS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ADH'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb618"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb618-1"><a href="#cb618-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb618-2"><a href="#cb618-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> years, <span class="at">y =</span> Average_QOL, <span class="at">color =</span> ADH)) <span class="sc">+</span></span>
<span id="cb618-3"><a href="#cb618-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="co"># Line plot</span></span>
<span id="cb618-4"><a href="#cb618-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Add points for clarity</span></span>
<span id="cb618-5"><a href="#cb618-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Physical QOL Score by Adherence Group Over 8 Years"</span>,</span>
<span id="cb618-6"><a href="#cb618-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb618-7"><a href="#cb618-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Physical QOL Score"</span>,</span>
<span id="cb618-8"><a href="#cb618-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Adherence Group"</span>) <span class="sc">+</span></span>
<span id="cb618-9"><a href="#cb618-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>       <span class="co"># Clean theme</span></span>
<span id="cb618-10"><a href="#cb618-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)  <span class="co"># Nice color palette for groups</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Project2_files/figure-html/unnamed-chunk-320-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see a similiar relationship here, though there’s more variation. For some reason that &lt;75% group likes to spike in their QOL at year 7. Interesting.</p>
</section>
<section id="log-viral-load-3" class="level3">
<h3 class="anchored" data-anchor-id="log-viral-load-3">Log Viral Load</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb621"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb621-1"><a href="#cb621-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get means for each year</span></span>
<span id="cb621-2"><a href="#cb621-2" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb621-3"><a href="#cb621-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADH, years) <span class="sc">%&gt;%</span></span>
<span id="cb621-4"><a href="#cb621-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_LEU3N =</span> <span class="fu">mean</span>(LEU3N, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ADH'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb623"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb623-1"><a href="#cb623-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb623-2"><a href="#cb623-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> years, <span class="at">y =</span> Average_LEU3N, <span class="at">color =</span> ADH)) <span class="sc">+</span></span>
<span id="cb623-3"><a href="#cb623-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="co"># Line plot</span></span>
<span id="cb623-4"><a href="#cb623-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Add points for clarity</span></span>
<span id="cb623-5"><a href="#cb623-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average LEU3N  by Adherence Group Over 8 Years"</span>,</span>
<span id="cb623-6"><a href="#cb623-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb623-7"><a href="#cb623-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average LEU3N"</span>,</span>
<span id="cb623-8"><a href="#cb623-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Adherence Group"</span>) <span class="sc">+</span></span>
<span id="cb623-9"><a href="#cb623-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>       <span class="co"># Clean theme</span></span>
<span id="cb623-10"><a href="#cb623-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)  <span class="co"># Nice color palette for groups</span></span>
<span id="cb623-11"><a href="#cb623-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-12"><a href="#cb623-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-5ba86c9b45eb414ee912" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5ba86c9b45eb414ee912">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8],"y":[507.17085980724528,504.32902078240909,577.08661758143683,591.64562416648812,611.05707271172935,641.21580871664116,663.46065034000003,660.96623328828832],"text":["years: 1<br />Average_LEU3N: 507.1709<br />ADH: 100%","years: 2<br />Average_LEU3N: 504.3290<br />ADH: 100%","years: 3<br />Average_LEU3N: 577.0866<br />ADH: 100%","years: 4<br />Average_LEU3N: 591.6456<br />ADH: 100%","years: 5<br />Average_LEU3N: 611.0571<br />ADH: 100%","years: 6<br />Average_LEU3N: 641.2158<br />ADH: 100%","years: 7<br />Average_LEU3N: 663.4607<br />ADH: 100%","years: 8<br />Average_LEU3N: 660.9662<br />ADH: 100%"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(179,226,205,1)","dash":"solid"},"hoveron":"points","name":"100%","legendgroup":"100%","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(179,226,205,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(179,226,205,1)"}},"frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[476.54107108472363,582.30917328910505,604.00928153250004,585.78143546415583,590.84678069251697,615.72916638181255,622.01653082869916,601.55662175154544],"text":["years: 1<br />Average_LEU3N: 476.5411<br />ADH: 95-99%","years: 2<br />Average_LEU3N: 582.3092<br />ADH: 95-99%","years: 3<br />Average_LEU3N: 604.0093<br />ADH: 95-99%","years: 4<br />Average_LEU3N: 585.7814<br />ADH: 95-99%","years: 5<br />Average_LEU3N: 590.8468<br />ADH: 95-99%","years: 6<br />Average_LEU3N: 615.7292<br />ADH: 95-99%","years: 7<br />Average_LEU3N: 622.0165<br />ADH: 95-99%","years: 8<br />Average_LEU3N: 601.5566<br />ADH: 95-99%"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(253,205,172,1)","dash":"solid"},"hoveron":"points","name":"95-99%","legendgroup":"95-99%","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(253,205,172,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(253,205,172,1)"}},"frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[344.47277031711866,481.91096051093024,491.77272718821428,579.39515941060608,642.90953610093754,574.23164525826087,618.49242141111108,454.00901368026314],"text":["years: 1<br />Average_LEU3N: 344.4728<br />ADH: 75-94%","years: 2<br />Average_LEU3N: 481.9110<br />ADH: 75-94%","years: 3<br />Average_LEU3N: 491.7727<br />ADH: 75-94%","years: 4<br />Average_LEU3N: 579.3952<br />ADH: 75-94%","years: 5<br />Average_LEU3N: 642.9095<br />ADH: 75-94%","years: 6<br />Average_LEU3N: 574.2316<br />ADH: 75-94%","years: 7<br />Average_LEU3N: 618.4924<br />ADH: 75-94%","years: 8<br />Average_LEU3N: 454.0090<br />ADH: 75-94%"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(203,213,232,1)","dash":"solid"},"hoveron":"points","name":"75-94%","legendgroup":"75-94%","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(203,213,232,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(203,213,232,1)"}},"frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[475.14149744444444,552.71378844833339,655.25427478000006,650.91517291428568,343.91951069999999,782.27683175555558,397.98291705000003,858.73250795000001],"text":["years: 1<br />Average_LEU3N: 475.1415<br />ADH: <75%","years: 2<br />Average_LEU3N: 552.7138<br />ADH: <75%","years: 3<br />Average_LEU3N: 655.2543<br />ADH: <75%","years: 4<br />Average_LEU3N: 650.9152<br />ADH: <75%","years: 5<br />Average_LEU3N: 343.9195<br />ADH: <75%","years: 6<br />Average_LEU3N: 782.2768<br />ADH: <75%","years: 7<br />Average_LEU3N: 397.9829<br />ADH: <75%","years: 8<br />Average_LEU3N: 858.7325<br />ADH: <75%"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(244,202,228,1)","dash":"solid"},"hoveron":"points","name":"<75%","legendgroup":"<75%","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(244,202,228,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(244,202,228,1)"}},"frame":null},{"x":[0],"y":[381.46249748743543],"text":"years: 0<br />Average_LEU3N: 381.4625<br />ADH: NA","type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"transparent","dash":"solid"},"hoveron":"points","name":"NA","legendgroup":"NA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"transparent"}},"frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Average LEU3N  by Adherence Group Over 8 Years","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.40000000000000002,8.4000000000000004],"tickmode":"array","ticktext":["0","2","4","6","8"],"tickvals":[0,2,4,6,8],"categoryorder":"array","categoryarray":["0","2","4","6","8"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[318.1788608375,884.47315781250006],"tickmode":"array","ticktext":["400","500","600","700","800"],"tickvals":[400,500,600,700,800],"categoryorder":"array","categoryarray":["400","500","600","700","800"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Average LEU3N","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Adherence Group","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"3d382bf9580f":{"x":{},"y":{},"colour":{},"type":"scatter"},"3d38750a5c13":{"x":{},"y":{},"colour":{}}},"cur_data":"3d382bf9580f","visdat":{"3d382bf9580f":["function (y) ","x"],"3d38750a5c13":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="cd4-t-cell-count-5" class="level3">
<h3 class="anchored" data-anchor-id="cd4-t-cell-count-5">CD4+ T Cell Count</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb624"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb624-1"><a href="#cb624-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create log vload variable for original 8 year data set.</span></span>
<span id="cb624-2"><a href="#cb624-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>VLOAD_log <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>VLOAD)</span>
<span id="cb624-3"><a href="#cb624-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb624-4"><a href="#cb624-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get means for each year</span></span>
<span id="cb624-5"><a href="#cb624-5" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb624-6"><a href="#cb624-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADH, years) <span class="sc">%&gt;%</span></span>
<span id="cb624-7"><a href="#cb624-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_VLOAD_log =</span> <span class="fu">mean</span>(VLOAD_log, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ADH'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb626"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb626-1"><a href="#cb626-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb626-2"><a href="#cb626-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> years, <span class="at">y =</span> Average_VLOAD_log, <span class="at">color =</span> ADH)) <span class="sc">+</span></span>
<span id="cb626-3"><a href="#cb626-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="co"># Line plot</span></span>
<span id="cb626-4"><a href="#cb626-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Add points for clarity</span></span>
<span id="cb626-5"><a href="#cb626-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average VLOAD log by Adherence Group Over 8 Years"</span>,</span>
<span id="cb626-6"><a href="#cb626-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb626-7"><a href="#cb626-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average VLOAD log"</span>,</span>
<span id="cb626-8"><a href="#cb626-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Adherence Group"</span>) <span class="sc">+</span></span>
<span id="cb626-9"><a href="#cb626-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>       <span class="co"># Clean theme</span></span>
<span id="cb626-10"><a href="#cb626-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)  <span class="co"># Nice color palette for groups</span></span>
<span id="cb626-11"><a href="#cb626-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb626-12"><a href="#cb626-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-b70b5ec1f418ecfda3f7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b70b5ec1f418ecfda3f7">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8],"y":[4.9303199485076661,3.9021712149393095,3.8574180404896117,3.5873466455835614,3.5011229958593737,3.3666760911144489,2.7514343274137083,2.7478707642888924],"text":["years: 1<br />Average_VLOAD_log:  4.930320<br />ADH: 100%","years: 2<br />Average_VLOAD_log:  3.902171<br />ADH: 100%","years: 3<br />Average_VLOAD_log:  3.857418<br />ADH: 100%","years: 4<br />Average_VLOAD_log:  3.587347<br />ADH: 100%","years: 5<br />Average_VLOAD_log:  3.501123<br />ADH: 100%","years: 6<br />Average_VLOAD_log:  3.366676<br />ADH: 100%","years: 7<br />Average_VLOAD_log:  2.751434<br />ADH: 100%","years: 8<br />Average_VLOAD_log:  2.747871<br />ADH: 100%"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(179,226,205,1)","dash":"solid"},"hoveron":"points","name":"100%","legendgroup":"100%","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(179,226,205,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(179,226,205,1)"}},"frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[5.6679821990994395,4.2743316247663445,3.7842317312415754,3.9120230396739917,3.5304254350265727,3.4061126557826285,3.2232552330286879,3.8164382924650098],"text":["years: 1<br />Average_VLOAD_log:  5.667982<br />ADH: 95-99%","years: 2<br />Average_VLOAD_log:  4.274332<br />ADH: 95-99%","years: 3<br />Average_VLOAD_log:  3.784232<br />ADH: 95-99%","years: 4<br />Average_VLOAD_log:  3.912023<br />ADH: 95-99%","years: 5<br />Average_VLOAD_log:  3.530425<br />ADH: 95-99%","years: 6<br />Average_VLOAD_log:  3.406113<br />ADH: 95-99%","years: 7<br />Average_VLOAD_log:  3.223255<br />ADH: 95-99%","years: 8<br />Average_VLOAD_log:  3.816438<br />ADH: 95-99%"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(253,205,172,1)","dash":"solid"},"hoveron":"points","name":"95-99%","legendgroup":"95-99%","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(253,205,172,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(253,205,172,1)"}},"frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[7.0204892527893019,5.2790040578225899,4.7069961502067912,5.165021130840489,3.861753602781536,4.2245838625662264,4.3514487576189493,4.5154639323040735],"text":["years: 1<br />Average_VLOAD_log:  7.020489<br />ADH: 75-94%","years: 2<br />Average_VLOAD_log:  5.279004<br />ADH: 75-94%","years: 3<br />Average_VLOAD_log:  4.706996<br />ADH: 75-94%","years: 4<br />Average_VLOAD_log:  5.165021<br />ADH: 75-94%","years: 5<br />Average_VLOAD_log:  3.861754<br />ADH: 75-94%","years: 6<br />Average_VLOAD_log:  4.224584<br />ADH: 75-94%","years: 7<br />Average_VLOAD_log:  4.351449<br />ADH: 75-94%","years: 8<br />Average_VLOAD_log:  4.515464<br />ADH: 75-94%"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(203,213,232,1)","dash":"solid"},"hoveron":"points","name":"75-94%","legendgroup":"75-94%","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(203,213,232,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(203,213,232,1)"}},"frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[6.0343948701374668,6.5843847171317096,5.1812360490940019,4.6343829239557595,8.74435220903516,4.6405241352587963,7.5849058815144952,3.978778100398872],"text":["years: 1<br />Average_VLOAD_log:  6.034395<br />ADH: <75%","years: 2<br />Average_VLOAD_log:  6.584385<br />ADH: <75%","years: 3<br />Average_VLOAD_log:  5.181236<br />ADH: <75%","years: 4<br />Average_VLOAD_log:  4.634383<br />ADH: <75%","years: 5<br />Average_VLOAD_log:  8.744352<br />ADH: <75%","years: 6<br />Average_VLOAD_log:  4.640524<br />ADH: <75%","years: 7<br />Average_VLOAD_log:  7.584906<br />ADH: <75%","years: 8<br />Average_VLOAD_log:  3.978778<br />ADH: <75%"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(244,202,228,1)","dash":"solid"},"hoveron":"points","name":"<75%","legendgroup":"<75%","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(244,202,228,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(244,202,228,1)"}},"frame":null},{"x":[0],"y":[10.355468027944854],"text":"years: 0<br />Average_VLOAD_log: 10.355468<br />ADH: NA","type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"transparent","dash":"solid"},"hoveron":"points","name":"NA","legendgroup":"NA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"transparent"}},"frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":37.260273972602747},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Average VLOAD log by Adherence Group Over 8 Years","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.40000000000000002,8.4000000000000004],"tickmode":"array","ticktext":["0","2","4","6","8"],"tickvals":[0,2,4,6,8],"categoryorder":"array","categoryarray":["0","2","4","6","8"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2.3674909011060943,10.735847891127651],"tickmode":"array","ticktext":["4","6","8","10"],"tickvals":[4,6,8,10],"categoryorder":"array","categoryarray":["4","6","8","10"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Average VLOAD log","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Adherence Group","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"3d3846805cc5":{"x":{},"y":{},"colour":{},"type":"scatter"},"3d3853693f57":{"x":{},"y":{},"colour":{}}},"cur_data":"3d3846805cc5","visdat":{"3d3846805cc5":["function (y) ","x"],"3d3853693f57":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>That’s very interesting. The groups with the highest vload log had the least adherence. There is an inverse relationship here.</p>
<p>This is strong evidence that the treatment is efficacious and the <code>ADH</code> should be considered as a confounder.</p>
<p>Ohhhhh, that’s super cool. So there is an inverse relationship between <code>LEU3N</code> and <code>VLOAD_log</code>, such that spikes in one should be dips in the other. We can see that in this data set! It appears that for the adherence group of &lt;75%, they had viral load spikes at years 5 and 7, which correspond with leukocyte dips at years 5 and 7! They weren’t adhering to the protocol, which resulted in them getting infected (?) more and having more of the virus present compared to the other groups.</p>
</section>
<section id="comparing-high-vs-low-adherence-groups" class="level3">
<h3 class="anchored" data-anchor-id="comparing-high-vs-low-adherence-groups">Comparing High Vs Low Adherence Groups</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb627"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb627-1"><a href="#cb627-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ADH_HIGHLOW <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>ADH <span class="sc">==</span> <span class="st">"&lt;75%"</span> <span class="sc">|</span> data<span class="sc">$</span>ADH <span class="sc">==</span> <span class="st">"75-94%"</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb627-2"><a href="#cb627-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb627-3"><a href="#cb627-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ADH_HIGHLOW <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>ADH_HIGHLOW,</span>
<span id="cb627-4"><a href="#cb627-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb627-5"><a href="#cb627-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low Adherence"</span>, <span class="st">"High Adherence"</span>))</span>
<span id="cb627-6"><a href="#cb627-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb627-7"><a href="#cb627-7" aria-hidden="true" tabindex="-1"></a><span class="do">#### tRY WITH HIGH LOW ADH</span></span>
<span id="cb627-8"><a href="#cb627-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create log vload variable for original 8 year data set.</span></span>
<span id="cb627-9"><a href="#cb627-9" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>VLOAD_log <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>VLOAD)</span>
<span id="cb627-10"><a href="#cb627-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb627-11"><a href="#cb627-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Get means for each year</span></span>
<span id="cb627-12"><a href="#cb627-12" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb627-13"><a href="#cb627-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADH_HIGHLOW, years) <span class="sc">%&gt;%</span></span>
<span id="cb627-14"><a href="#cb627-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_VLOAD_log =</span> <span class="fu">mean</span>(VLOAD_log, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ADH_HIGHLOW'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb629"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb629-1"><a href="#cb629-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb629-2"><a href="#cb629-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> years, <span class="at">y =</span> Average_VLOAD_log, <span class="at">color =</span> ADH_HIGHLOW)) <span class="sc">+</span></span>
<span id="cb629-3"><a href="#cb629-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="co"># Line plot</span></span>
<span id="cb629-4"><a href="#cb629-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Add points for clarity</span></span>
<span id="cb629-5"><a href="#cb629-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average VLOAD log by Adherence Group Over 8 Years"</span>,</span>
<span id="cb629-6"><a href="#cb629-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb629-7"><a href="#cb629-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average VLOAD log"</span>,</span>
<span id="cb629-8"><a href="#cb629-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Adherence Group"</span>) <span class="sc">+</span></span>
<span id="cb629-9"><a href="#cb629-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>       <span class="co"># Clean theme</span></span>
<span id="cb629-10"><a href="#cb629-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)  <span class="co"># Nice color palette for groups</span></span>
<span id="cb629-11"><a href="#cb629-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb629-12"><a href="#cb629-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-27ea7f0eed72f95657df" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-27ea7f0eed72f95657df">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8],"y":[6.8880288133286074,5.5690886487801716,4.7386121434659385,5.0614819685215169,4.2802620547461325,4.3415670642610111,5.3463586418945015,4.4643509959321497],"text":["years: 1<br />Average_VLOAD_log:  6.888029<br />ADH_HIGHLOW: Low Adherence","years: 2<br />Average_VLOAD_log:  5.569089<br />ADH_HIGHLOW: Low Adherence","years: 3<br />Average_VLOAD_log:  4.738612<br />ADH_HIGHLOW: Low Adherence","years: 4<br />Average_VLOAD_log:  5.061482<br />ADH_HIGHLOW: Low Adherence","years: 5<br />Average_VLOAD_log:  4.280262<br />ADH_HIGHLOW: Low Adherence","years: 6<br />Average_VLOAD_log:  4.341567<br />ADH_HIGHLOW: Low Adherence","years: 7<br />Average_VLOAD_log:  5.346359<br />ADH_HIGHLOW: Low Adherence","years: 8<br />Average_VLOAD_log:  4.464351<br />ADH_HIGHLOW: Low Adherence"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(179,226,205,1)","dash":"solid"},"hoveron":"points","name":"Low Adherence","legendgroup":"Low Adherence","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(179,226,205,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(179,226,205,1)"}},"frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[5.24714668520435,4.1022658285910838,3.8223496006415942,3.7426266601485501,3.5164066421875888,3.387595845848824,3.0015807558216503,3.2749668544206094],"text":["years: 1<br />Average_VLOAD_log:  5.247147<br />ADH_HIGHLOW: High Adherence","years: 2<br />Average_VLOAD_log:  4.102266<br />ADH_HIGHLOW: High Adherence","years: 3<br />Average_VLOAD_log:  3.822350<br />ADH_HIGHLOW: High Adherence","years: 4<br />Average_VLOAD_log:  3.742627<br />ADH_HIGHLOW: High Adherence","years: 5<br />Average_VLOAD_log:  3.516407<br />ADH_HIGHLOW: High Adherence","years: 6<br />Average_VLOAD_log:  3.387596<br />ADH_HIGHLOW: High Adherence","years: 7<br />Average_VLOAD_log:  3.001581<br />ADH_HIGHLOW: High Adherence","years: 8<br />Average_VLOAD_log:  3.274967<br />ADH_HIGHLOW: High Adherence"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(253,205,172,1)","dash":"solid"},"hoveron":"points","name":"High Adherence","legendgroup":"High Adherence","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(253,205,172,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(253,205,172,1)"}},"frame":null},{"x":[0],"y":[10.355468027944854],"text":"years: 0<br />Average_VLOAD_log: 10.355468<br />ADH_HIGHLOW: NA","type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"transparent","dash":"solid"},"hoveron":"points","name":"NA","legendgroup":"NA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"transparent"}},"frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":37.260273972602747},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Average VLOAD log by Adherence Group Over 8 Years","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.40000000000000002,8.4000000000000004],"tickmode":"array","ticktext":["0","2","4","6","8"],"tickvals":[0,2,4,6,8],"categoryorder":"array","categoryarray":["0","2","4","6","8"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2.6338863922154903,10.723162391551014],"tickmode":"array","ticktext":["4","6","8","10"],"tickvals":[4,6,8,10],"categoryorder":"array","categoryarray":["4","6","8","10"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Average VLOAD log","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Adherence Group","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"3d3870be2973":{"x":{},"y":{},"colour":{},"type":"scatter"},"3d3879855d6d":{"x":{},"y":{},"colour":{}}},"cur_data":"3d3870be2973","visdat":{"3d3870be2973":["function (y) ","x"],"3d3879855d6d":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>High adherence patients have lower viral load then low adherence</p>
<p>Same for leu3n</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb630"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb630-1"><a href="#cb630-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### tRY WITH HIGH LOW ADH</span></span>
<span id="cb630-2"><a href="#cb630-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb630-3"><a href="#cb630-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get means for each year</span></span>
<span id="cb630-4"><a href="#cb630-4" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb630-5"><a href="#cb630-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADH_HIGHLOW, years) <span class="sc">%&gt;%</span></span>
<span id="cb630-6"><a href="#cb630-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_LEU3N =</span> <span class="fu">mean</span>(LEU3N, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ADH_HIGHLOW'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb632"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb632-1"><a href="#cb632-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb632-2"><a href="#cb632-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> years, <span class="at">y =</span> Average_LEU3N, <span class="at">color =</span> ADH_HIGHLOW)) <span class="sc">+</span></span>
<span id="cb632-3"><a href="#cb632-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="co"># Line plot</span></span>
<span id="cb632-4"><a href="#cb632-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Add points for clarity</span></span>
<span id="cb632-5"><a href="#cb632-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average LEU3N by Adherence Group Over 8 Years"</span>,</span>
<span id="cb632-6"><a href="#cb632-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb632-7"><a href="#cb632-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average LEU3N"</span>,</span>
<span id="cb632-8"><a href="#cb632-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Adherence Group"</span>) <span class="sc">+</span></span>
<span id="cb632-9"><a href="#cb632-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>       <span class="co"># Clean theme</span></span>
<span id="cb632-10"><a href="#cb632-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel2"</span>)  <span class="co"># Nice color palette for groups</span></span>
<span id="cb632-11"><a href="#cb632-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-12"><a href="#cb632-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-dcfb01e02d1e3d9c08d8" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-dcfb01e02d1e3d9c08d8">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8],"y":[361.76716067220588,497.35885024272727,505.17285404,591.91116177375,617.281819638,632.74435396062495,550.64334314615382,492.55410837261905],"text":["years: 1<br />Average_LEU3N: 361.7672<br />ADH_HIGHLOW: Low Adherence","years: 2<br />Average_LEU3N: 497.3589<br />ADH_HIGHLOW: Low Adherence","years: 3<br />Average_LEU3N: 505.1729<br />ADH_HIGHLOW: Low Adherence","years: 4<br />Average_LEU3N: 591.9112<br />ADH_HIGHLOW: Low Adherence","years: 5<br />Average_LEU3N: 617.2818<br />ADH_HIGHLOW: Low Adherence","years: 6<br />Average_LEU3N: 632.7444<br />ADH_HIGHLOW: Low Adherence","years: 7<br />Average_LEU3N: 550.6433<br />ADH_HIGHLOW: Low Adherence","years: 8<br />Average_LEU3N: 492.5541<br />ADH_HIGHLOW: Low Adherence"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(179,226,205,1)","dash":"solid"},"hoveron":"points","name":"Low Adherence","legendgroup":"Low Adherence","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(179,226,205,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(179,226,205,1)"}},"frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[494.03437714392243,546.34348450194966,589.9837021088922,588.84101217841612,600.44666940164291,627.87007600313086,641.5824241602146,631.39583840574664],"text":["years: 1<br />Average_LEU3N: 494.0344<br />ADH_HIGHLOW: High Adherence","years: 2<br />Average_LEU3N: 546.3435<br />ADH_HIGHLOW: High Adherence","years: 3<br />Average_LEU3N: 589.9837<br />ADH_HIGHLOW: High Adherence","years: 4<br />Average_LEU3N: 588.8410<br />ADH_HIGHLOW: High Adherence","years: 5<br />Average_LEU3N: 600.4467<br />ADH_HIGHLOW: High Adherence","years: 6<br />Average_LEU3N: 627.8701<br />ADH_HIGHLOW: High Adherence","years: 7<br />Average_LEU3N: 641.5824<br />ADH_HIGHLOW: High Adherence","years: 8<br />Average_LEU3N: 631.3958<br />ADH_HIGHLOW: High Adherence"],"type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"rgba(253,205,172,1)","dash":"solid"},"hoveron":"points","name":"High Adherence","legendgroup":"High Adherence","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(253,205,172,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(253,205,172,1)"}},"frame":null},{"x":[0],"y":[381.46249748743543],"text":"years: 0<br />Average_LEU3N: 381.4625<br />ADH_HIGHLOW: NA","type":"scatter","mode":"lines+markers","line":{"width":3.7795275590551185,"color":"transparent","dash":"solid"},"hoveron":"points","name":"NA","legendgroup":"NA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"transparent"}},"frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Average LEU3N by Adherence Group Over 8 Years","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.40000000000000002,8.4000000000000004],"tickmode":"array","ticktext":["0","2","4","6","8"],"tickvals":[0,2,4,6,8],"categoryorder":"array","categoryarray":["0","2","4","6","8"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[347.77639749780542,655.573187334615],"tickmode":"array","ticktext":["350","400","450","500","550","600","650"],"tickvals":[350,400,450,500,550,600,650],"categoryorder":"array","categoryarray":["350","400","450","500","550","600","650"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Average LEU3N","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Adherence Group","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"3d387edc1314":{"x":{},"y":{},"colour":{},"type":"scatter"},"3d384c12555c":{"x":{},"y":{},"colour":{}}},"cur_data":"3d387edc1314","visdat":{"3d387edc1314":["function (y) ","x"],"3d384c12555c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>High adherence users have higher CD4+ T Cells, for the most part.</p>
</section>
<section id="other-literature" class="level3">
<h3 class="anchored" data-anchor-id="other-literature">Other literature</h3>
<p>https://pmc.ncbi.nlm.nih.gov/articles/PMC9234842/</p>
<p>This one shows that poor adherence is related to anxiety and depression, leading credence to why I want to examine the impact of hard drugs and adherence while controlling for depression.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/svieau\.quarto\.pub\/portfolio");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>